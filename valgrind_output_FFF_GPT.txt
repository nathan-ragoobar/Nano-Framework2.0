==972215== Memcheck, a memory error detector
==972215== Copyright (C) 2002-2022, and GNU GPL'd, by Julian Seward et al.
==972215== Using Valgrind-3.22.0 and LibVEX; rerun with -h for copyright info
==972215== Command: ./train_gpt2_cpu
==972215== 
Configuration:
  Batch size: 4
  Sequence length: 64
  Learning rate: 0.001
  Training steps: 35000
  Checkpoint every: 5000 steps

[GPT-2] Initializing model from scratch
max_seq_len: 1024
vocab_size: 50257
padded_vocab_size: 50304
num_layers: 12
num_heads: 12
channels: 768
num_parameters: 124531236 (475 MB)
Initializing parameter: wte (size: 38633472)
Initializing parameter: wpe (size: 786432)
Initializing parameter: ln1w-L0 (size: 768)
Initializing parameter: ln1w-L1 (size: 768)
Initializing parameter: ln1w-L2 (size: 768)
Initializing parameter: ln1w-L3 (size: 768)
Initializing parameter: ln1w-L4 (size: 768)
Initializing parameter: ln1w-L5 (size: 768)
Initializing parameter: ln1w-L6 (size: 768)
Initializing parameter: ln1w-L7 (size: 768)
Initializing parameter: ln1w-L8 (size: 768)
Initializing parameter: ln1w-L9 (size: 768)
Initializing parameter: ln1w-L10 (size: 768)
Initializing parameter: ln1w-L11 (size: 768)
Initializing parameter: ln1b-L0 (size: 768)
Initializing parameter: ln1b-L1 (size: 768)
Initializing parameter: ln1b-L2 (size: 768)
Initializing parameter: ln1b-L3 (size: 768)
Initializing parameter: ln1b-L4 (size: 768)
Initializing parameter: ln1b-L5 (size: 768)
Initializing parameter: ln1b-L6 (size: 768)
Initializing parameter: ln1b-L7 (size: 768)
Initializing parameter: ln1b-L8 (size: 768)
Initializing parameter: ln1b-L9 (size: 768)
Initializing parameter: ln1b-L10 (size: 768)
Initializing parameter: ln1b-L11 (size: 768)
Initializing parameter: qkvw-L0 (size: 1769472)
Initializing parameter: qkvw-L1 (size: 1769472)
Initializing parameter: qkvw-L2 (size: 1769472)
Initializing parameter: qkvw-L3 (size: 1769472)
Initializing parameter: qkvw-L4 (size: 1769472)
Initializing parameter: qkvw-L5 (size: 1769472)
Initializing parameter: qkvw-L6 (size: 1769472)
Initializing parameter: qkvw-L7 (size: 1769472)
Initializing parameter: qkvw-L8 (size: 1769472)
Initializing parameter: qkvw-L9 (size: 1769472)
Initializing parameter: qkvw-L10 (size: 1769472)
Initializing parameter: qkvw-L11 (size: 1769472)
Initializing parameter: qkvb-L0 (size: 2304)
Initializing parameter: qkvb-L1 (size: 2304)
Initializing parameter: qkvb-L2 (size: 2304)
Initializing parameter: qkvb-L3 (size: 2304)
Initializing parameter: qkvb-L4 (size: 2304)
Initializing parameter: qkvb-L5 (size: 2304)
Initializing parameter: qkvb-L6 (size: 2304)
Initializing parameter: qkvb-L7 (size: 2304)
Initializing parameter: qkvb-L8 (size: 2304)
Initializing parameter: qkvb-L9 (size: 2304)
Initializing parameter: qkvb-L10 (size: 2304)
Initializing parameter: qkvb-L11 (size: 2304)
Initializing parameter: attprojw-L0 (size: 589824)
Initializing parameter: attprojw-L1 (size: 589824)
Initializing parameter: attprojw-L2 (size: 589824)
Initializing parameter: attprojw-L3 (size: 589824)
Initializing parameter: attprojw-L4 (size: 589824)
Initializing parameter: attprojw-L5 (size: 589824)
Initializing parameter: attprojw-L6 (size: 589824)
Initializing parameter: attprojw-L7 (size: 589824)
Initializing parameter: attprojw-L8 (size: 589824)
Initializing parameter: attprojw-L9 (size: 589824)
Initializing parameter: attprojw-L10 (size: 589824)
Initializing parameter: attprojw-L11 (size: 589824)
Initializing parameter: attprojb-L0 (size: 768)
Initializing parameter: attprojb-L1 (size: 768)
Initializing parameter: attprojb-L2 (size: 768)
Initializing parameter: attprojb-L3 (size: 768)
Initializing parameter: attprojb-L4 (size: 768)
Initializing parameter: attprojb-L5 (size: 768)
Initializing parameter: attprojb-L6 (size: 768)
Initializing parameter: attprojb-L7 (size: 768)
Initializing parameter: attprojb-L8 (size: 768)
Initializing parameter: attprojb-L9 (size: 768)
Initializing parameter: attprojb-L10 (size: 768)
Initializing parameter: attprojb-L11 (size: 768)
Initializing parameter: ln2w-L0 (size: 768)
Initializing parameter: ln2w-L1 (size: 768)
Initializing parameter: ln2w-L2 (size: 768)
Initializing parameter: ln2w-L3 (size: 768)
Initializing parameter: ln2w-L4 (size: 768)
Initializing parameter: ln2w-L5 (size: 768)
Initializing parameter: ln2w-L6 (size: 768)
Initializing parameter: ln2w-L7 (size: 768)
Initializing parameter: ln2w-L8 (size: 768)
Initializing parameter: ln2w-L9 (size: 768)
Initializing parameter: ln2w-L10 (size: 768)
Initializing parameter: ln2w-L11 (size: 768)
Initializing parameter: ln2b-L0 (size: 768)
Initializing parameter: ln2b-L1 (size: 768)
Initializing parameter: ln2b-L2 (size: 768)
Initializing parameter: ln2b-L3 (size: 768)
Initializing parameter: ln2b-L4 (size: 768)
Initializing parameter: ln2b-L5 (size: 768)
Initializing parameter: ln2b-L6 (size: 768)
Initializing parameter: ln2b-L7 (size: 768)
Initializing parameter: ln2b-L8 (size: 768)
Initializing parameter: ln2b-L9 (size: 768)
Initializing parameter: ln2b-L10 (size: 768)
Initializing parameter: ln2b-L11 (size: 768)
Initializing parameter: ffn_decision_0_w-L0 (size: 768)
Initializing parameter: ffn_decision_0_b-L0 (size: 1)
Initializing parameter: ffn_decision_1_w-L0 (size: 768)
Initializing parameter: ffn_decision_1_b-L0 (size: 1)
Initializing parameter: ffn_decision_2_w-L0 (size: 768)
Initializing parameter: ffn_decision_2_b-L0 (size: 1)
Initializing parameter: ffn_leaf_0_fc1_w-L0 (size: 589824)
Initializing parameter: ffn_leaf_0_fc1_b-L0 (size: 768)
Initializing parameter: ffn_leaf_0_fc2_w-L0 (size: 589824)
Initializing parameter: ffn_leaf_0_fc2_b-L0 (size: 768)
Initializing parameter: ffn_leaf_1_fc1_w-L0 (size: 589824)
Initializing parameter: ffn_leaf_1_fc1_b-L0 (size: 768)
Initializing parameter: ffn_leaf_1_fc2_w-L0 (size: 589824)
Initializing parameter: ffn_leaf_1_fc2_b-L0 (size: 768)
Initializing parameter: ffn_leaf_2_fc1_w-L0 (size: 589824)
Initializing parameter: ffn_leaf_2_fc1_b-L0 (size: 768)
Initializing parameter: ffn_leaf_2_fc2_w-L0 (size: 589824)
Initializing parameter: ffn_leaf_2_fc2_b-L0 (size: 768)
Initializing parameter: ffn_leaf_3_fc1_w-L0 (size: 589824)
Initializing parameter: ffn_leaf_3_fc1_b-L0 (size: 768)
Initializing parameter: ffn_leaf_3_fc2_w-L0 (size: 589824)
Initializing parameter: ffn_leaf_3_fc2_b-L0 (size: 768)
Initializing parameter: ffn_decision_0_w-L1 (size: 768)
Initializing parameter: ffn_decision_0_b-L1 (size: 1)
Initializing parameter: ffn_decision_1_w-L1 (size: 768)
Initializing parameter: ffn_decision_1_b-L1 (size: 1)
Initializing parameter: ffn_decision_2_w-L1 (size: 768)
Initializing parameter: ffn_decision_2_b-L1 (size: 1)
Initializing parameter: ffn_leaf_0_fc1_w-L1 (size: 589824)
Initializing parameter: ffn_leaf_0_fc1_b-L1 (size: 768)
Initializing parameter: ffn_leaf_0_fc2_w-L1 (size: 589824)
Initializing parameter: ffn_leaf_0_fc2_b-L1 (size: 768)
Initializing parameter: ffn_leaf_1_fc1_w-L1 (size: 589824)
Initializing parameter: ffn_leaf_1_fc1_b-L1 (size: 768)
Initializing parameter: ffn_leaf_1_fc2_w-L1 (size: 589824)
Initializing parameter: ffn_leaf_1_fc2_b-L1 (size: 768)
Initializing parameter: ffn_leaf_2_fc1_w-L1 (size: 589824)
Initializing parameter: ffn_leaf_2_fc1_b-L1 (size: 768)
Initializing parameter: ffn_leaf_2_fc2_w-L1 (size: 589824)
Initializing parameter: ffn_leaf_2_fc2_b-L1 (size: 768)
Initializing parameter: ffn_leaf_3_fc1_w-L1 (size: 589824)
Initializing parameter: ffn_leaf_3_fc1_b-L1 (size: 768)
Initializing parameter: ffn_leaf_3_fc2_w-L1 (size: 589824)
Initializing parameter: ffn_leaf_3_fc2_b-L1 (size: 768)
Initializing parameter: ffn_decision_0_w-L2 (size: 768)
Initializing parameter: ffn_decision_0_b-L2 (size: 1)
Initializing parameter: ffn_decision_1_w-L2 (size: 768)
Initializing parameter: ffn_decision_1_b-L2 (size: 1)
Initializing parameter: ffn_decision_2_w-L2 (size: 768)
Initializing parameter: ffn_decision_2_b-L2 (size: 1)
Initializing parameter: ffn_leaf_0_fc1_w-L2 (size: 589824)
Initializing parameter: ffn_leaf_0_fc1_b-L2 (size: 768)
Initializing parameter: ffn_leaf_0_fc2_w-L2 (size: 589824)
Initializing parameter: ffn_leaf_0_fc2_b-L2 (size: 768)
Initializing parameter: ffn_leaf_1_fc1_w-L2 (size: 589824)
Initializing parameter: ffn_leaf_1_fc1_b-L2 (size: 768)
Initializing parameter: ffn_leaf_1_fc2_w-L2 (size: 589824)
Initializing parameter: ffn_leaf_1_fc2_b-L2 (size: 768)
Initializing parameter: ffn_leaf_2_fc1_w-L2 (size: 589824)
Initializing parameter: ffn_leaf_2_fc1_b-L2 (size: 768)
Initializing parameter: ffn_leaf_2_fc2_w-L2 (size: 589824)
Initializing parameter: ffn_leaf_2_fc2_b-L2 (size: 768)
Initializing parameter: ffn_leaf_3_fc1_w-L2 (size: 589824)
Initializing parameter: ffn_leaf_3_fc1_b-L2 (size: 768)
Initializing parameter: ffn_leaf_3_fc2_w-L2 (size: 589824)
Initializing parameter: ffn_leaf_3_fc2_b-L2 (size: 768)
Initializing parameter: ffn_decision_0_w-L3 (size: 768)
Initializing parameter: ffn_decision_0_b-L3 (size: 1)
Initializing parameter: ffn_decision_1_w-L3 (size: 768)
Initializing parameter: ffn_decision_1_b-L3 (size: 1)
Initializing parameter: ffn_decision_2_w-L3 (size: 768)
Initializing parameter: ffn_decision_2_b-L3 (size: 1)
Initializing parameter: ffn_leaf_0_fc1_w-L3 (size: 589824)
Initializing parameter: ffn_leaf_0_fc1_b-L3 (size: 768)
Initializing parameter: ffn_leaf_0_fc2_w-L3 (size: 589824)
Initializing parameter: ffn_leaf_0_fc2_b-L3 (size: 768)
Initializing parameter: ffn_leaf_1_fc1_w-L3 (size: 589824)
Initializing parameter: ffn_leaf_1_fc1_b-L3 (size: 768)
Initializing parameter: ffn_leaf_1_fc2_w-L3 (size: 589824)
Initializing parameter: ffn_leaf_1_fc2_b-L3 (size: 768)
Initializing parameter: ffn_leaf_2_fc1_w-L3 (size: 589824)
Initializing parameter: ffn_leaf_2_fc1_b-L3 (size: 768)
Initializing parameter: ffn_leaf_2_fc2_w-L3 (size: 589824)
Initializing parameter: ffn_leaf_2_fc2_b-L3 (size: 768)
Initializing parameter: ffn_leaf_3_fc1_w-L3 (size: 589824)
Initializing parameter: ffn_leaf_3_fc1_b-L3 (size: 768)
Initializing parameter: ffn_leaf_3_fc2_w-L3 (size: 589824)
Initializing parameter: ffn_leaf_3_fc2_b-L3 (size: 768)
Initializing parameter: ffn_decision_0_w-L4 (size: 768)
Initializing parameter: ffn_decision_0_b-L4 (size: 1)
Initializing parameter: ffn_decision_1_w-L4 (size: 768)
Initializing parameter: ffn_decision_1_b-L4 (size: 1)
Initializing parameter: ffn_decision_2_w-L4 (size: 768)
Initializing parameter: ffn_decision_2_b-L4 (size: 1)
Initializing parameter: ffn_leaf_0_fc1_w-L4 (size: 589824)
Initializing parameter: ffn_leaf_0_fc1_b-L4 (size: 768)
Initializing parameter: ffn_leaf_0_fc2_w-L4 (size: 589824)
Initializing parameter: ffn_leaf_0_fc2_b-L4 (size: 768)
Initializing parameter: ffn_leaf_1_fc1_w-L4 (size: 589824)
Initializing parameter: ffn_leaf_1_fc1_b-L4 (size: 768)
Initializing parameter: ffn_leaf_1_fc2_w-L4 (size: 589824)
Initializing parameter: ffn_leaf_1_fc2_b-L4 (size: 768)
Initializing parameter: ffn_leaf_2_fc1_w-L4 (size: 589824)
Initializing parameter: ffn_leaf_2_fc1_b-L4 (size: 768)
Initializing parameter: ffn_leaf_2_fc2_w-L4 (size: 589824)
Initializing parameter: ffn_leaf_2_fc2_b-L4 (size: 768)
Initializing parameter: ffn_leaf_3_fc1_w-L4 (size: 589824)
Initializing parameter: ffn_leaf_3_fc1_b-L4 (size: 768)
Initializing parameter: ffn_leaf_3_fc2_w-L4 (size: 589824)
Initializing parameter: ffn_leaf_3_fc2_b-L4 (size: 768)
Initializing parameter: ffn_decision_0_w-L5 (size: 768)
Initializing parameter: ffn_decision_0_b-L5 (size: 1)
Initializing parameter: ffn_decision_1_w-L5 (size: 768)
Initializing parameter: ffn_decision_1_b-L5 (size: 1)
Initializing parameter: ffn_decision_2_w-L5 (size: 768)
Initializing parameter: ffn_decision_2_b-L5 (size: 1)
Initializing parameter: ffn_leaf_0_fc1_w-L5 (size: 589824)
Initializing parameter: ffn_leaf_0_fc1_b-L5 (size: 768)
Initializing parameter: ffn_leaf_0_fc2_w-L5 (size: 589824)
Initializing parameter: ffn_leaf_0_fc2_b-L5 (size: 768)
Initializing parameter: ffn_leaf_1_fc1_w-L5 (size: 589824)
Initializing parameter: ffn_leaf_1_fc1_b-L5 (size: 768)
Initializing parameter: ffn_leaf_1_fc2_w-L5 (size: 589824)
Initializing parameter: ffn_leaf_1_fc2_b-L5 (size: 768)
Initializing parameter: ffn_leaf_2_fc1_w-L5 (size: 589824)
Initializing parameter: ffn_leaf_2_fc1_b-L5 (size: 768)
Initializing parameter: ffn_leaf_2_fc2_w-L5 (size: 589824)
Initializing parameter: ffn_leaf_2_fc2_b-L5 (size: 768)
Initializing parameter: ffn_leaf_3_fc1_w-L5 (size: 589824)
Initializing parameter: ffn_leaf_3_fc1_b-L5 (size: 768)
Initializing parameter: ffn_leaf_3_fc2_w-L5 (size: 589824)
Initializing parameter: ffn_leaf_3_fc2_b-L5 (size: 768)
Initializing parameter: ffn_decision_0_w-L6 (size: 768)
Initializing parameter: ffn_decision_0_b-L6 (size: 1)
Initializing parameter: ffn_decision_1_w-L6 (size: 768)
Initializing parameter: ffn_decision_1_b-L6 (size: 1)
Initializing parameter: ffn_decision_2_w-L6 (size: 768)
Initializing parameter: ffn_decision_2_b-L6 (size: 1)
Initializing parameter: ffn_leaf_0_fc1_w-L6 (size: 589824)
Initializing parameter: ffn_leaf_0_fc1_b-L6 (size: 768)
Initializing parameter: ffn_leaf_0_fc2_w-L6 (size: 589824)
Initializing parameter: ffn_leaf_0_fc2_b-L6 (size: 768)
Initializing parameter: ffn_leaf_1_fc1_w-L6 (size: 589824)
Initializing parameter: ffn_leaf_1_fc1_b-L6 (size: 768)
Initializing parameter: ffn_leaf_1_fc2_w-L6 (size: 589824)
Initializing parameter: ffn_leaf_1_fc2_b-L6 (size: 768)
Initializing parameter: ffn_leaf_2_fc1_w-L6 (size: 589824)
Initializing parameter: ffn_leaf_2_fc1_b-L6 (size: 768)
Initializing parameter: ffn_leaf_2_fc2_w-L6 (size: 589824)
Initializing parameter: ffn_leaf_2_fc2_b-L6 (size: 768)
Initializing parameter: ffn_leaf_3_fc1_w-L6 (size: 589824)
Initializing parameter: ffn_leaf_3_fc1_b-L6 (size: 768)
Initializing parameter: ffn_leaf_3_fc2_w-L6 (size: 589824)
Initializing parameter: ffn_leaf_3_fc2_b-L6 (size: 768)
Initializing parameter: ffn_decision_0_w-L7 (size: 768)
Initializing parameter: ffn_decision_0_b-L7 (size: 1)
Initializing parameter: ffn_decision_1_w-L7 (size: 768)
Initializing parameter: ffn_decision_1_b-L7 (size: 1)
Initializing parameter: ffn_decision_2_w-L7 (size: 768)
Initializing parameter: ffn_decision_2_b-L7 (size: 1)
Initializing parameter: ffn_leaf_0_fc1_w-L7 (size: 589824)
Initializing parameter: ffn_leaf_0_fc1_b-L7 (size: 768)
Initializing parameter: ffn_leaf_0_fc2_w-L7 (size: 589824)
Initializing parameter: ffn_leaf_0_fc2_b-L7 (size: 768)
Initializing parameter: ffn_leaf_1_fc1_w-L7 (size: 589824)
Initializing parameter: ffn_leaf_1_fc1_b-L7 (size: 768)
Initializing parameter: ffn_leaf_1_fc2_w-L7 (size: 589824)
Initializing parameter: ffn_leaf_1_fc2_b-L7 (size: 768)
Initializing parameter: ffn_leaf_2_fc1_w-L7 (size: 589824)
Initializing parameter: ffn_leaf_2_fc1_b-L7 (size: 768)
Initializing parameter: ffn_leaf_2_fc2_w-L7 (size: 589824)
Initializing parameter: ffn_leaf_2_fc2_b-L7 (size: 768)
Initializing parameter: ffn_leaf_3_fc1_w-L7 (size: 589824)
Initializing parameter: ffn_leaf_3_fc1_b-L7 (size: 768)
Initializing parameter: ffn_leaf_3_fc2_w-L7 (size: 589824)
Initializing parameter: ffn_leaf_3_fc2_b-L7 (size: 768)
Initializing parameter: ffn_decision_0_w-L8 (size: 768)
Initializing parameter: ffn_decision_0_b-L8 (size: 1)
Initializing parameter: ffn_decision_1_w-L8 (size: 768)
Initializing parameter: ffn_decision_1_b-L8 (size: 1)
Initializing parameter: ffn_decision_2_w-L8 (size: 768)
Initializing parameter: ffn_decision_2_b-L8 (size: 1)
Initializing parameter: ffn_leaf_0_fc1_w-L8 (size: 589824)
Initializing parameter: ffn_leaf_0_fc1_b-L8 (size: 768)
Initializing parameter: ffn_leaf_0_fc2_w-L8 (size: 589824)
Initializing parameter: ffn_leaf_0_fc2_b-L8 (size: 768)
Initializing parameter: ffn_leaf_1_fc1_w-L8 (size: 589824)
Initializing parameter: ffn_leaf_1_fc1_b-L8 (size: 768)
Initializing parameter: ffn_leaf_1_fc2_w-L8 (size: 589824)
Initializing parameter: ffn_leaf_1_fc2_b-L8 (size: 768)
Initializing parameter: ffn_leaf_2_fc1_w-L8 (size: 589824)
Initializing parameter: ffn_leaf_2_fc1_b-L8 (size: 768)
Initializing parameter: ffn_leaf_2_fc2_w-L8 (size: 589824)
Initializing parameter: ffn_leaf_2_fc2_b-L8 (size: 768)
Initializing parameter: ffn_leaf_3_fc1_w-L8 (size: 589824)
Initializing parameter: ffn_leaf_3_fc1_b-L8 (size: 768)
Initializing parameter: ffn_leaf_3_fc2_w-L8 (size: 589824)
Initializing parameter: ffn_leaf_3_fc2_b-L8 (size: 768)
Initializing parameter: ffn_decision_0_w-L9 (size: 768)
Initializing parameter: ffn_decision_0_b-L9 (size: 1)
Initializing parameter: ffn_decision_1_w-L9 (size: 768)
Initializing parameter: ffn_decision_1_b-L9 (size: 1)
Initializing parameter: ffn_decision_2_w-L9 (size: 768)
Initializing parameter: ffnWARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1742183462.941738  972215 AttentionLayer.hpp:60] B: 4, T: 64, C: 768
==972215== Thread 17:
==972215== Invalid read of size 4
==972215==    at 0x16CD65: _mm256_add_ps (avxintrin.h:149)
==972215==    by 0x16CD65: padd<__vector(8) float> (PacketMath.h:262)
==972215==    by 0x16CD65: packetOp<__vector(8) float> (BinaryFunctors.h:45)
==972215==    by 0x16CD65: packet<16> (TensorEvaluator.h:645)
==972215==    by 0x16CD65: evalPacket (TensorAssign.h:178)
==972215==    by 0x16CD65: run (TensorExecutor.h:301)
==972215==    by 0x16CD65: operator() (TensorExecutor.h:341)
==972215==    by 0x16CD65: __invoke_impl<void, Eigen::internal::TensorExecutor<const Eigen::TensorAssignOp<Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer>, const Eigen::TensorCwiseBinaryOp<Eigen::internal::scalar_sum_op<float, float>, const Eigen::TensorCwiseUnaryOp<Eigen::internal::bind1st_op<Eigen::internal::scalar_product_op<float, float> >, const Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer> >, const Eigen::TensorCwiseUnaryOp<Eigen::internal::bind1st_op<Eigen::internal::scalar_product_op<float, float> >, const Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer> > > >, Eigen::ThreadPoolDevice, true, (Eigen::internal::TiledEvaluation)0>::run(const Eigen::TensorAssignOp<Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer>, const Eigen::TensorCwiseBinaryOp<Eigen::internal::scalar_sum_op<float, float>, const Eigen::TensorCwiseUnaryOp<Eigen::internal::bind1st_op<Eigen::internal::scalar_product_op<float, float> >, const Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer> >, const Eigen::TensorCwiseUnaryOp<Eigen::internal::bind1st_op<Eigen::internal::scalar_product_op<float, float> >, const Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer> > > >&, const Eigen::ThreadPoolDevice&)::<lambda(Eigen::internal::TensorExecutor<const Eigen::TensorAssignOp<Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer>, const Eigen::TensorCwiseBinaryOp<Eigen::internal::scalar_sum_op<float, float>, const Eigen::TensorCwiseUnaryOp<Eigen::internal::bind1st_op<Eigen::internal::scalar_product_op<float, float> >, const Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer> >, const Eigen::TensorCwiseUnaryOp<Eigen::internal::bind1st_op<Eigen::internal::scalar_product_op<float, float> >, const Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer> > > >, Eigen::ThreadPoolDevice, true, (Eigen::internal::TiledEvaluation)0>::StorageIndex, Eigen::internal::TensorExecutor<const Eigen::TensorAssignOp<Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer>, const Eigen::TensorCwiseBinaryOp<Eigen::internal::scalar_sum_op<float, float>, const Eigen::TensorCwiseUnaryOp<Eigen::internal::bind1st_op<Eigen::internal::scalar_product_op<float, float> >, const Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer> >, const Eigen::TensorCwiseUnaryOp<Eigen::internal::bind1st_op<Eigen::internal::scalar_product_op<float, float> >, const Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer> > > >, Eigen::ThreadPoolDevice, true, (Eigen::internal::TiledEvaluation)0>::StorageIndex)>&, long int, long int> (invoke.h:61)
==972215==    by 0x16CD65: __invoke_r<void, Eigen::internal::TensorExecutor<const Eigen::TensorAssignOp<Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer>, const Eigen::TensorCwiseBinaryOp<Eigen::internal::scalar_sum_op<float, float>, const Eigen::TensorCwiseUnaryOp<Eigen::internal::bind1st_op<Eigen::internal::scalar_product_op<float, float> >, const Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer> >, const Eigen::TensorCwiseUnaryOp<Eigen::internal::bind1st_op<Eigen::internal::scalar_product_op<float, float> >, const Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer> > > >, Eigen::ThreadPoolDevice, true, (Eigen::internal::TiledEvaluation)0>::run(const Eigen::TensorAssignOp<Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer>, const Eigen::TensorCwiseBinaryOp<Eigen::internal::scalar_sum_op<float, float>, const Eigen::TensorCwiseUnaryOp<Eigen::internal::bind1st_op<Eigen::internal::scalar_product_op<float, float> >, const Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer> >, const Eigen::TensorCwiseUnaryOp<Eigen::internal::bind1st_op<Eigen::internal::scalar_product_op<float, float> >, const Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer> > > >&, const Eigen::ThreadPoolDevice&)::<lambda(Eigen::internal::TensorExecutor<const Eigen::TensorAssignOp<Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer>, const Eigen::TensorCwiseBinaryOp<Eigen::internal::scalar_sum_op<float, float>, const Eigen::TensorCwiseUnaryOp<Eigen::internal::bind1st_op<Eigen::internal::scalar_product_op<float, float> >, const Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer> >, const Eigen::TensorCwiseUnaryOp<Eigen::internal::bind1st_op<Eigen::internal::scalar_product_op<float, float> >, const Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer> > > >, Eigen::ThreadPoolDevice, true, (Eigen::internal::TiledEvaluation)0>::StorageIndex, Eigen::internal::TensorExecutor<const Eigen::TensorAssignOp<Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer>, const Eigen::TensorCwiseBinaryOp<Eigen::internal::scalar_sum_op<float, float>, const Eigen::TensorCwiseUnaryOp<Eigen::internal::bind1st_op<Eigen::internal::scalar_product_op<float, float> >, const Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer> >, const Eigen::TensorCwiseUnaryOp<Eigen::internal::bind1st_op<Eigen::internal::scalar_product_op<float, float> >, const Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer> > > >, Eigen::ThreadPoolDevice, true, (Eigen::internal::TiledEvaluation)0>::StorageIndex)>&, long int, long int> (invoke.h:111)
==972215==    by 0x16CD65: std::_Function_handler<void (long, long), Eigen::internal::TensorExecutor<Eigen::TensorAssignOp<Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorCwiseBinaryOp<Eigen::internal::scalar_sum_op<float, float>, Eigen::TensorCwiseUnaryOp<Eigen::internal::bind1st_op<Eigen::internal::scalar_product_op<float, float> >, Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long>, 16, Eigen::MakePointer> const> const, Eigen::TensorCwiseUnaryOp<Eigen::internal::bind1st_op<Eigen::internal::scalar_product_op<float, float> >, Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long>, 16, Eigen::MakePointer> const> const> const> const, Eigen::ThreadPoolDevice, true, (Eigen::internal::TiledEvaluation)0>::run(Eigen::TensorAssignOp<Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorCwiseBinaryOp<Eigen::internal::scalar_sum_op<float, float>, Eigen::TensorCwiseUnaryOp<Eigen::internal::bind1st_op<Eigen::internal::scalar_product_op<float, float> >, Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long>, 16, Eigen::MakePointer> const> const, Eigen::TensorCwiseUnaryOp<Eigen::internal::bind1st_op<Eigen::internal::scalar_product_op<float, float> >, Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long>, 16, Eigen::MakePointer> const> const> const> const&, Eigen::ThreadPoolDevice const&)::{lambda(long, long)#1}>::_M_invoke(std::_Any_data const&, long&&, long&&) (std_function.h:290)
==972215==    by 0x173965: operator() (std_function.h:591)
==972215==    by 0x173965: operator() (TensorDeviceThreadPool.h:219)
==972215==    by 0x173965: __invoke_impl<void, Eigen::ThreadPoolDevice::parallelFor(Eigen::Index, const Eigen::TensorOpCost&, std::function<long int(long int)>, std::function<void(long int, long int)>) const::<lambda(Eigen::Index, Eigen::Index)>&, long int, long int> (invoke.h:61)
==972215==    by 0x173965: __invoke_r<void, Eigen::ThreadPoolDevice::parallelFor(Eigen::Index, const Eigen::TensorOpCost&, std::function<long int(long int)>, std::function<void(long int, long int)>) const::<lambda(Eigen::Index, Eigen::Index)>&, long int, long int> (invoke.h:111)
==972215==    by 0x173965: std::_Function_handler<void (long, long), Eigen::ThreadPoolDevice::parallelFor(long, Eigen::TensorOpCost const&, std::function<long (long)>, std::function<void (long, long)>) const::{lambda(long, long)#1}>::_M_invoke(std::_Any_data const&, long&&, long&&) (std_function.h:290)
==972215==    by 0x164FC3: operator() (std_function.h:591)
==972215==    by 0x164FC3: operator() (TensorDeviceThreadPool.h:215)
==972215==    by 0x164FC3: __invoke_impl<void, Eigen::ThreadPoolDevice::parallelFor(Eigen::Index, const Eigen::TensorOpCost&, std::function<long int(long int)>, std::function<void(long int, long int)>) const::<lambda(Eigen::Index, Eigen::Index)>::<lambda()>&> (invoke.h:61)
==972215==    by 0x164FC3: __invoke_r<void, Eigen::ThreadPoolDevice::parallelFor(Eigen::Index, const Eigen::TensorOpCost&, std::function<long int(long int)>, std::function<void(long int, long int)>) const::<lambda(Eigen::Index, Eigen::Index)>::<lambda()>&> (invoke.h:111)
==972215==    by 0x164FC3: std::_Function_handler<void (), Eigen::ThreadPoolDevice::parallelFor(long, Eigen::TensorOpCost const&, std::function<long (long)>, std::function<void (long, long)>) const::{lambda(long, long)#1}::operator()(long, long) const::{lambda()#1}>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==972215==    by 0x19B426: operator() (std_function.h:591)
==972215==    by 0x19B426: ExecuteTask (ThreadEnvironment.h:35)
==972215==    by 0x19B426: Eigen::ThreadPoolTempl<Eigen::StlThreadEnvironment>::WorkerLoop(int) (NonBlockingThreadPool.h:328)
==972215==    by 0x4953DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==972215==    by 0x4D93AA3: start_thread (pthread_create.c:447)
==972215==    by 0x4E20A33: clone (clone.S:100)
==972215==  Address 0x70380 is not stack'd, malloc'd or (recently) free'd
==972215== 
==972215== 
==972215== Process terminating with default action of signal 11 (SIGSEGV)
==972215==  Access not within mapped region at address 0x70380
==972215==    at 0x16CD65: _mm256_add_ps (avxintrin.h:149)
==972215==    by 0x16CD65: padd<__vector(8) float> (PacketMath.h:262)
==972215==    by 0x16CD65: packetOp<__vector(8) float> (BinaryFunctors.h:45)
==972215==    by 0x16CD65: packet<16> (TensorEvaluator.h:645)
==972215==    by 0x16CD65: evalPacket (TensorAssign.h:178)
==972215==    by 0x16CD65: run (TensorExecutor.h:301)
==972215==    by 0x16CD65: operator() (TensorExecutor.h:341)
==972215==    by 0x16CD65: __invoke_impl<void, Eigen::internal::TensorExecutor<const Eigen::TensorAssignOp<Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer>, const Eigen::TensorCwiseBinaryOp<Eigen::internal::scalar_sum_op<float, float>, const Eigen::TensorCwiseUnaryOp<Eigen::internal::bind1st_op<Eigen::internal::scalar_product_op<float, float> >, const Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer> >, const Eigen::TensorCwiseUnaryOp<Eigen::internal::bind1st_op<Eigen::internal::scalar_product_op<float, float> >, const Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer> > > >, Eigen::ThreadPoolDevice, true, (Eigen::internal::TiledEvaluation)0>::run(const Eigen::TensorAssignOp<Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer>, const Eigen::TensorCwiseBinaryOp<Eigen::internal::scalar_sum_op<float, float>, const Eigen::TensorCwiseUnaryOp<Eigen::internal::bind1st_op<Eigen::internal::scalar_product_op<float, float> >, const Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer> >, const Eigen::TensorCwiseUnaryOp<Eigen::internal::bind1st_op<Eigen::internal::scalar_product_op<float, float> >, const Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer> > > >&, const Eigen::ThreadPoolDevice&)::<lambda(Eigen::internal::TensorExecutor<const Eigen::TensorAssignOp<Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer>, const Eigen::TensorCwiseBinaryOp<Eigen::internal::scalar_sum_op<float, float>, const Eigen::TensorCwiseUnaryOp<Eigen::internal::bind1st_op<Eigen::internal::scalar_product_op<float, float> >, const Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer> >, const Eigen::TensorCwiseUnaryOp<Eigen::internal::bind1st_op<Eigen::internal::scalar_product_op<float, float> >, const Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer> > > >, Eigen::ThreadPoolDevice, true, (Eigen::internal::TiledEvaluation)0>::StorageIndex, Eigen::internal::TensorExecutor<const Eigen::TensorAssignOp<Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer>, const Eigen::TensorCwiseBinaryOp<Eigen::internal::scalar_sum_op<float, float>, const Eigen::TensorCwiseUnaryOp<Eigen::internal::bind1st_op<Eigen::internal::scalar_product_op<float, float> >, const Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer> >, const Eigen::TensorCwiseUnaryOp<Eigen::internal::bind1st_op<Eigen::internal::scalar_product_op<float, float> >, const Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer> > > >, Eigen::ThreadPoolDevice, true, (Eigen::internal::TiledEvaluation)0>::StorageIndex)>&, long int, long int> (invoke.h:61)
==972215==    by 0x16CD65: __invoke_r<void, Eigen::internal::TensorExecutor<const Eigen::TensorAssignOp<Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer>, const Eigen::TensorCwiseBinaryOp<Eigen::internal::scalar_sum_op<float, float>, const Eigen::TensorCwiseUnaryOp<Eigen::internal::bind1st_op<Eigen::internal::scalar_product_op<float, float> >, const Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer> >, const Eigen::TensorCwiseUnaryOp<Eigen::internal::bind1st_op<Eigen::internal::scalar_product_op<float, float> >, const Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer> > > >, Eigen::ThreadPoolDevice, true, (Eigen::internal::TiledEvaluation)0>::run(const Eigen::TensorAssignOp<Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer>, const Eigen::TensorCwiseBinaryOp<Eigen::internal::scalar_sum_op<float, float>, const Eigen::TensorCwiseUnaryOp<Eigen::internal::bind1st_op<Eigen::internal::scalar_product_op<float, float> >, const Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer> >, const Eigen::TensorCwiseUnaryOp<Eigen::internal::bind1st_op<Eigen::internal::scalar_product_op<float, float> >, const Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer> > > >&, const Eigen::ThreadPoolDevice&)::<lambda(Eigen::internal::TensorExecutor<const Eigen::TensorAssignOp<Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer>, const Eigen::TensorCwiseBinaryOp<Eigen::internal::scalar_sum_op<float, float>, const Eigen::TensorCwiseUnaryOp<Eigen::internal::bind1st_op<Eigen::internal::scalar_product_op<float, float> >, const Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer> >, const Eigen::TensorCwiseUnaryOp<Eigen::internal::bind1st_op<Eigen::internal::scalar_product_op<float, float> >, const Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer> > > >, Eigen::ThreadPoolDevice, true, (Eigen::internal::TiledEvaluation)0>::StorageIndex, Eigen::internal::TensorExecutor<const Eigen::TensorAssignOp<Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer>, const Eigen::TensorCwiseBinaryOp<Eigen::internal::scalar_sum_op<float, float>, const Eigen::TensorCwiseUnaryOp<Eigen::internal::bind1st_op<Eigen::internal::scalar_product_op<float, float> >, const Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer> >, const Eigen::TensorCwiseUnaryOp<Eigen::internal::bind1st_op<Eigen::internal::scalar_product_op<float, float> >, const Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long int>, 16, Eigen::MakePointer> > > >, Eigen::ThreadPoolDevice, true, (Eigen::internal::TiledEvaluation)0>::StorageIndex)>&, long int, long int> (invoke.h:111)
==972215==    by 0x16CD65: std::_Function_handler<void (long, long), Eigen::internal::TensorExecutor<Eigen::TensorAssignOp<Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorCwiseBinaryOp<Eigen::internal::scalar_sum_op<float, float>, Eigen::TensorCwiseUnaryOp<Eigen::internal::bind1st_op<Eigen::internal::scalar_product_op<float, float> >, Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long>, 16, Eigen::MakePointer> const> const, Eigen::TensorCwiseUnaryOp<Eigen::internal::bind1st_op<Eigen::internal::scalar_product_op<float, float> >, Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long>, 16, Eigen::MakePointer> const> const> const> const, Eigen::ThreadPoolDevice, true, (Eigen::internal::TiledEvaluation)0>::run(Eigen::TensorAssignOp<Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorCwiseBinaryOp<Eigen::internal::scalar_sum_op<float, float>, Eigen::TensorCwiseUnaryOp<Eigen::internal::bind1st_op<Eigen::internal::scalar_product_op<float, float> >, Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long>, 16, Eigen::MakePointer> const> const, Eigen::TensorCwiseUnaryOp<Eigen::internal::bind1st_op<Eigen::internal::scalar_product_op<float, float> >, Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long>, 16, Eigen::MakePointer> const> const> const> const&, Eigen::ThreadPoolDevice const&)::{lambda(long, long)#1}>::_M_invoke(std::_Any_data const&, long&&, long&&) (std_function.h:290)
==972215==    by 0x173965: operator() (std_function.h:591)
==972215==    by 0x173965: operator() (TensorDeviceThreadPool.h:219)
==972215==    by 0x173965: __invoke_impl<void, Eigen::ThreadPoolDevice::parallelFor(Eigen::Index, const Eigen::TensorOpCost&, std::function<long int(long int)>, std::function<void(long int, long int)>) const::<lambda(Eigen::Index, Eigen::Index)>&, long int, long int> (invoke.h:61)
==972215==    by 0x173965: __invoke_r<void, Eigen::ThreadPoolDevice::parallelFor(Eigen::Index, const Eigen::TensorOpCost&, std::function<long int(long int)>, std::function<void(long int, long int)>) const::<lambda(Eigen::Index, Eigen::Index)>&, long int, long int> (invoke.h:111)
==972215==    by 0x173965: std::_Function_handler<void (long, long), Eigen::ThreadPoolDevice::parallelFor(long, Eigen::TensorOpCost const&, std::function<long (long)>, std::function<void (long, long)>) const::{lambda(long, long)#1}>::_M_invoke(std::_Any_data const&, long&&, long&&) (std_function.h:290)
==972215==    by 0x164FC3: operator() (std_function.h:591)
==972215==    by 0x164FC3: operator() (TensorDeviceThreadPool.h:215)
==972215==    by 0x164FC3: __invoke_impl<void, Eigen::ThreadPoolDevice::parallelFor(Eigen::Index, const Eigen::TensorOpCost&, std::function<long int(long int)>, std::function<void(long int, long int)>) const::<lambda(Eigen::Index, Eigen::Index)>::<lambda()>&> (invoke.h:61)
==972215==    by 0x164FC3: __invoke_r<void, Eigen::ThreadPoolDevice::parallelFor(Eigen::Index, const Eigen::TensorOpCost&, std::function<long int(long int)>, std::function<void(long int, long int)>) const::<lambda(Eigen::Index, Eigen::Index)>::<lambda()>&> (invoke.h:111)
==972215==    by 0x164FC3: std::_Function_handler<void (), Eigen::ThreadPoolDevice::parallelFor(long, Eigen::TensorOpCost const&, std::function<long (long)>, std::function<void (long, long)>) const::{lambda(long, long)#1}::operator()(long, long) const::{lambda()#1}>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==972215==    by 0x19B426: operator() (std_function.h:591)
==972215==    by 0x19B426: ExecuteTask (ThreadEnvironment.h:35)
==972215==    by 0x19B426: Eigen::ThreadPoolTempl<Eigen::StlThreadEnvironment>::WorkerLoop(int) (NonBlockingThreadPool.h:328)
==972215==    by 0x4953DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==972215==    by 0x4D93AA3: start_thread (pthread_create.c:447)
==972215==    by 0x4E20A33: clone (clone.S:100)
==972215==  If you believe this happened as a result of a stack
==972215==  overflow in your program's main thread (unlikely but
==972215==  possible), you can try to increase the size of the
==972215==  main thread stack using the --main-stacksize= flag.
==972215==  The main thread stack size used in this run was 8388608.
==972215== 
==972215== HEAP SUMMARY:
==972215==     in use at exit: 2,775,364,419 bytes in 206,140 blocks
==972215==   total heap usage: 615,927 allocs, 409,787 frees, 7,396,751,690 bytes allocated
==972215== 
==972215== Thread 1:
==972215== 72 bytes in 3 blocks are possibly lost in loss record 44 of 272
==972215==    at 0x4846FA3: operator new(unsigned long) (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x17387B: _M_create<Eigen::ThreadPoolDevice::parallelFor(Eigen::Index, const Eigen::TensorOpCost&, std::function<long int(long int)>, std::function<void(long int, long int)>) const::<lambda(Eigen::Index, Eigen::Index)>::<lambda()> > (std_function.h:161)
==972215==    by 0x17387B: _M_init_functor<Eigen::ThreadPoolDevice::parallelFor(Eigen::Index, const Eigen::TensorOpCost&, std::function<long int(long int)>, std::function<void(long int, long int)>) const::<lambda(Eigen::Index, Eigen::Index)>::<lambda()> > (std_function.h:215)
==972215==    by 0x17387B: function<Eigen::ThreadPoolDevice::parallelFor(Eigen::Index, const Eigen::TensorOpCost&, std::function<long int(long int)>, std::function<void(long int, long int)>) const::<lambda(Eigen::Index, Eigen::Index)>::<lambda()> > (std_function.h:449)
==972215==    by 0x17387B: operator() (TensorDeviceThreadPool.h:215)
==972215==    by 0x17387B: __invoke_impl<void, Eigen::ThreadPoolDevice::parallelFor(Eigen::Index, const Eigen::TensorOpCost&, std::function<long int(long int)>, std::function<void(long int, long int)>) const::<lambda(Eigen::Index, Eigen::Index)>&, long int, long int> (invoke.h:61)
==972215==    by 0x17387B: __invoke_r<void, Eigen::ThreadPoolDevice::parallelFor(Eigen::Index, const Eigen::TensorOpCost&, std::function<long int(long int)>, std::function<void(long int, long int)>) const::<lambda(Eigen::Index, Eigen::Index)>&, long int, long int> (invoke.h:111)
==972215==    by 0x17387B: std::_Function_handler<void (long, long), Eigen::ThreadPoolDevice::parallelFor(long, Eigen::TensorOpCost const&, std::function<long (long)>, std::function<void (long, long)>) const::{lambda(long, long)#1}>::_M_invoke(std::_Any_data const&, long&&, long&&) (std_function.h:290)
==972215==    by 0x164FC3: operator() (std_function.h:591)
==972215==    by 0x164FC3: operator() (TensorDeviceThreadPool.h:215)
==972215==    by 0x164FC3: __invoke_impl<void, Eigen::ThreadPoolDevice::parallelFor(Eigen::Index, const Eigen::TensorOpCost&, std::function<long int(long int)>, std::function<void(long int, long int)>) const::<lambda(Eigen::Index, Eigen::Index)>::<lambda()>&> (invoke.h:61)
==972215==    by 0x164FC3: __invoke_r<void, Eigen::ThreadPoolDevice::parallelFor(Eigen::Index, const Eigen::TensorOpCost&, std::function<long int(long int)>, std::function<void(long int, long int)>) const::<lambda(Eigen::Index, Eigen::Index)>::<lambda()>&> (invoke.h:111)
==972215==    by 0x164FC3: std::_Function_handler<void (), Eigen::ThreadPoolDevice::parallelFor(long, Eigen::TensorOpCost const&, std::function<long (long)>, std::function<void (long, long)>) const::{lambda(long, long)#1}::operator()(long, long) const::{lambda()#1}>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==972215==    by 0x19B426: operator() (std_function.h:591)
==972215==    by 0x19B426: ExecuteTask (ThreadEnvironment.h:35)
==972215==    by 0x19B426: Eigen::ThreadPoolTempl<Eigen::StlThreadEnvironment>::WorkerLoop(int) (NonBlockingThreadPool.h:328)
==972215==    by 0x4953DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==972215==    by 0x4D93AA3: start_thread (pthread_create.c:447)
==972215==    by 0x4E20A33: clone (clone.S:100)
==972215== 
==972215== 128 bytes in 16 blocks are possibly lost in loss record 46 of 272
==972215==    at 0x4846FA3: operator new(unsigned long) (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x183E67: CreateThread (ThreadEnvironment.h:33)
==972215==    by 0x183E67: Eigen::ThreadPoolTempl<Eigen::StlThreadEnvironment>::ThreadPoolTempl(int, bool, Eigen::StlThreadEnvironment) (NonBlockingThreadPool.h:57)
==972215==    by 0x11CA15: ThreadPoolTempl (NonBlockingThreadPool.h:22)
==972215==    by 0x11CA15: __static_initialization_and_destruction_0 (Parameter.hpp:40)
==972215==    by 0x11CA15: _GLOBAL__sub_I__Z11manual_seedP13mt19937_statej (train_gpt2.cpp:672)
==972215==    by 0x4D21303: call_init (libc-start.c:145)
==972215==    by 0x4D21303: __libc_start_main@@GLIBC_2.34 (libc-start.c:347)
==972215==    by 0x11CA74: (below main) (in /home/nathan/Nano-Framework2.0/train_gpt2_cpu)
==972215== 
==972215== 320 bytes in 1 blocks are possibly lost in loss record 50 of 272
==972215==    at 0x484D953: calloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x40145AB: calloc (rtld-malloc.h:44)
==972215==    by 0x40145AB: allocate_dtv (dl-tls.c:370)
==972215==    by 0x40145AB: _dl_allocate_tls (dl-tls.c:629)
==972215==    by 0x4D94616: allocate_stack (allocatestack.c:429)
==972215==    by 0x4D94616: pthread_create@@GLIBC_2.34 (pthread_create.c:655)
==972215==    by 0x4953EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==972215==    by 0x195D7A: thread<void (MetricWriter::*)(), MetricWriter*> (std_thread.h:164)
==972215==    by 0x195D7A: MetricWriter::MetricWriter(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) (writer.hpp:127)
==972215==    by 0x11AAAC: main (train_gpt2.cpp:350)
==972215== 
==972215== 392 bytes in 1 blocks are possibly lost in loss record 96 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x11CCDC: Eigen::internal::handmade_aligned_malloc(unsigned long, unsigned long) [clone .constprop.0] (Memory.h:105)
==972215==    by 0x183A92: MaxSizeVector (MaxSizeVector.h:38)
==972215==    by 0x183A92: Eigen::ThreadPoolTempl<Eigen::StlThreadEnvironment>::ThreadPoolTempl(int, bool, Eigen::StlThreadEnvironment) (NonBlockingThreadPool.h:30)
==972215==    by 0x11CA15: ThreadPoolTempl (NonBlockingThreadPool.h:22)
==972215==    by 0x11CA15: __static_initialization_and_destruction_0 (Parameter.hpp:40)
==972215==    by 0x11CA15: _GLOBAL__sub_I__Z11manual_seedP13mt19937_statej (train_gpt2.cpp:672)
==972215==    by 0x4D21303: call_init (libc-start.c:145)
==972215==    by 0x4D21303: __libc_start_main@@GLIBC_2.34 (libc-start.c:347)
==972215==    by 0x11CA74: (below main) (in /home/nathan/Nano-Framework2.0/train_gpt2_cpu)
==972215== 
==972215== 672 bytes in 16 blocks are possibly lost in loss record 107 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x183BD4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x183BD4: MaxSizeVector (MaxSizeVector.h:38)
==972215==    by 0x183BD4: emplace_back<int> (MaxSizeVector.h:92)
==972215==    by 0x183BD4: Eigen::ThreadPoolTempl<Eigen::StlThreadEnvironment>::ThreadPoolTempl(int, bool, Eigen::StlThreadEnvironment) (NonBlockingThreadPool.h:48)
==972215==    by 0x11CA15: ThreadPoolTempl (NonBlockingThreadPool.h:22)
==972215==    by 0x11CA15: __static_initialization_and_destruction_0 (Parameter.hpp:40)
==972215==    by 0x11CA15: _GLOBAL__sub_I__Z11manual_seedP13mt19937_statej (train_gpt2.cpp:672)
==972215==    by 0x4D21303: call_init (libc-start.c:145)
==972215==    by 0x4D21303: __libc_start_main@@GLIBC_2.34 (libc-start.c:347)
==972215==    by 0x11CA74: (below main) (in /home/nathan/Nano-Framework2.0/train_gpt2_cpu)
==972215== 
==972215== 1,056 bytes in 1 blocks are possibly lost in loss record 113 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x26F713: gpt::GPT::__Forward(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:89)
==972215==    by 0x270162: gpt::GPT::ForwardCPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>, float*) (gpt.hpp:214)
==972215==    by 0x11BFC2: main (train_gpt2.cpp:439)
==972215== 
==972215== 1,056 bytes in 1 blocks are possibly lost in loss record 114 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x26F722: gpt::GPT::__Forward(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:90)
==972215==    by 0x270162: gpt::GPT::ForwardCPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>, float*) (gpt.hpp:214)
==972215==    by 0x11BFC2: main (train_gpt2.cpp:439)
==972215== 
==972215== 1,056 bytes in 1 blocks are possibly lost in loss record 115 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x1B03A0: nn::LayerNorm::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) (LayerNorm.hpp:121)
==972215==    by 0x26BCF8: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:330)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 1,056 bytes in 1 blocks are possibly lost in loss record 116 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x1B03AC: nn::LayerNorm::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) (LayerNorm.hpp:122)
==972215==    by 0x26BCF8: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:330)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 1,296 bytes in 36 blocks are possibly lost in loss record 129 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EEB6: nn::Parameter::LazyAllocate(int) [clone .constprop.0] (Parameter.hpp:200)
==972215==    by 0x1909D0: Parameter (Parameter.hpp:183)
==972215==    by 0x1909D0: make_unique<nn::Parameter, nn::DataType&, int&> (unique_ptr.h:1070)
==972215==    by 0x1909D0: Linear (Linear.hpp:24)
==972215==    by 0x1909D0: make_unique<nn::Linear, int&, int> (unique_ptr.h:1070)
==972215==    by 0x1909D0: DecisionNode (fastfeedforward.hpp:23)
==972215==    by 0x1909D0: make_unique<gpt::DecisionNode, int&, int&> (unique_ptr.h:1070)
==972215==    by 0x1909D0: gpt::FastFeedforwardNetwork::FastFeedforwardNetwork(int, int, int, int, bool, float) (fastfeedforward.hpp:269)
==972215==    by 0x191F63: make_unique<gpt::FastFeedforwardNetwork, int&, int&, int&, int&> (unique_ptr.h:1070)
==972215==    by 0x191F63: gpt::FFFBlock::FFFBlock(int, int, int) (Block.hpp:222)
==972215==    by 0x1927ED: make_unique<gpt::FFFBlock, int&, int&, int&> (unique_ptr.h:1070)
==972215==    by 0x1927ED: gpt::GPT::GPT(int, int, int, int, int, int) (gpt.hpp:38)
==972215==    by 0x1935D6: make_unique<gpt::GPT, int const&, int const&, int const&, int const&, int const&, int const&> (unique_ptr.h:1070)
==972215==    by 0x1935D6: gpt2::GPT2::InitializeFromScratch(gpt2::GPT2Config const&) (gpt2.hpp:87)
==972215==    by 0x11AAF9: main (train_gpt2.cpp:369)
==972215== 
==972215== 1,296 bytes in 36 blocks are possibly lost in loss record 130 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x264A2E: LazyAllocateGradient (Linear.hpp:91)
==972215==    by 0x264A2E: nn::Linear::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) (Linear.hpp:86)
==972215==    by 0x265CB6: Backward (fastfeedforward.hpp:87)
==972215==    by 0x265CB6: gpt::FastFeedforwardNetwork::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) (fastfeedforward.hpp:736)
==972215==    by 0x26AF6C: gpt::FFFBlock::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:336)
==972215==    by 0x26BE52: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:344)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 2,176 bytes in 1 blocks are possibly lost in loss record 137 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x183AB0: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x183AB0: MaxSizeVector (MaxSizeVector.h:38)
==972215==    by 0x183AB0: Eigen::ThreadPoolTempl<Eigen::StlThreadEnvironment>::ThreadPoolTempl(int, bool, Eigen::StlThreadEnvironment) (NonBlockingThreadPool.h:31)
==972215==    by 0x11CA15: ThreadPoolTempl (NonBlockingThreadPool.h:22)
==972215==    by 0x11CA15: __static_initialization_and_destruction_0 (Parameter.hpp:40)
==972215==    by 0x11CA15: _GLOBAL__sub_I__Z11manual_seedP13mt19937_statej (train_gpt2.cpp:672)
==972215==    by 0x4D21303: call_init (libc-start.c:145)
==972215==    by 0x4D21303: __libc_start_main@@GLIBC_2.34 (libc-start.c:347)
==972215==    by 0x11CA74: (below main) (in /home/nathan/Nano-Framework2.0/train_gpt2_cpu)
==972215== 
==972215== 3,104 bytes in 1 blocks are possibly lost in loss record 140 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EEB6: nn::Parameter::LazyAllocate(int) [clone .constprop.0] (Parameter.hpp:200)
==972215==    by 0x19323A: Parameter (Parameter.hpp:183)
==972215==    by 0x19323A: make_unique<nn::Parameter, nn::DataType&, int&> (unique_ptr.h:1070)
==972215==    by 0x19323A: LayerNorm (LayerNorm.hpp:24)
==972215==    by 0x19323A: make_unique<nn::LayerNorm, int&> (unique_ptr.h:1070)
==972215==    by 0x19323A: gpt::GPT::GPT(int, int, int, int, int, int) (gpt.hpp:40)
==972215==    by 0x1935D6: make_unique<gpt::GPT, int const&, int const&, int const&, int const&, int const&, int const&> (unique_ptr.h:1070)
==972215==    by 0x1935D6: gpt2::GPT2::InitializeFromScratch(gpt2::GPT2Config const&) (gpt2.hpp:87)
==972215==    by 0x11AAF9: main (train_gpt2.cpp:369)
==972215== 
==972215== 3,104 bytes in 1 blocks are possibly lost in loss record 141 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EEB6: nn::Parameter::LazyAllocate(int) [clone .constprop.0] (Parameter.hpp:200)
==972215==    by 0x19326A: Parameter (Parameter.hpp:183)
==972215==    by 0x19326A: make_unique<nn::Parameter, nn::DataType&, int&> (unique_ptr.h:1070)
==972215==    by 0x19326A: LayerNorm (LayerNorm.hpp:27)
==972215==    by 0x19326A: make_unique<nn::LayerNorm, int&> (unique_ptr.h:1070)
==972215==    by 0x19326A: gpt::GPT::GPT(int, int, int, int, int, int) (gpt.hpp:40)
==972215==    by 0x1935D6: make_unique<gpt::GPT, int const&, int const&, int const&, int const&, int const&, int const&> (unique_ptr.h:1070)
==972215==    by 0x1935D6: gpt2::GPT2::InitializeFromScratch(gpt2::GPT2Config const&) (gpt2.hpp:87)
==972215==    by 0x11AAF9: main (train_gpt2.cpp:369)
==972215== 
==972215== 3,104 bytes in 1 blocks are possibly lost in loss record 142 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x1B08FC: LazyAllocateGradient (Parameter.hpp:234)
==972215==    by 0x1B08FC: nn::LayerNorm::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) (LayerNorm.hpp:105)
==972215==    by 0x26BCF8: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:330)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 3,104 bytes in 1 blocks are possibly lost in loss record 143 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x1B08CC: LazyAllocateGradient (TensorEvaluator.h:580)
==972215==    by 0x1B08CC: nn::LayerNorm::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) (LayerNorm.hpp:106)
==972215==    by 0x26BCF8: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:330)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 5,120 bytes in 16 blocks are possibly lost in loss record 150 of 272
==972215==    at 0x484D953: calloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x40145AB: calloc (rtld-malloc.h:44)
==972215==    by 0x40145AB: allocate_dtv (dl-tls.c:370)
==972215==    by 0x40145AB: _dl_allocate_tls (dl-tls.c:629)
==972215==    by 0x4D94616: allocate_stack (allocatestack.c:429)
==972215==    by 0x4D94616: pthread_create@@GLIBC_2.34 (pthread_create.c:655)
==972215==    by 0x4953EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==972215==    by 0x183F17: thread<std::function<void()> > (std_thread.h:164)
==972215==    by 0x183F17: EnvThread (ThreadEnvironment.h:24)
==972215==    by 0x183F17: CreateThread (ThreadEnvironment.h:33)
==972215==    by 0x183F17: Eigen::ThreadPoolTempl<Eigen::StlThreadEnvironment>::ThreadPoolTempl(int, bool, Eigen::StlThreadEnvironment) (NonBlockingThreadPool.h:57)
==972215==    by 0x11CA15: ThreadPoolTempl (NonBlockingThreadPool.h:22)
==972215==    by 0x11CA15: __static_initialization_and_destruction_0 (Parameter.hpp:40)
==972215==    by 0x11CA15: _GLOBAL__sub_I__Z11manual_seedP13mt19937_statej (train_gpt2.cpp:672)
==972215==    by 0x4D21303: call_init (libc-start.c:145)
==972215==    by 0x4D21303: __libc_start_main@@GLIBC_2.34 (libc-start.c:347)
==972215==    by 0x11CA74: (below main) (in /home/nathan/Nano-Framework2.0/train_gpt2_cpu)
==972215== 
==972215== 12,672 bytes in 12 blocks are possibly lost in loss record 156 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x26EC90: gpt::FFFBlock::Forward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:250)
==972215==    by 0x26FC6C: gpt::GPT::__Forward(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:112)
==972215==    by 0x270162: gpt::GPT::ForwardCPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>, float*) (gpt.hpp:214)
==972215==    by 0x11BFC2: main (train_gpt2.cpp:439)
==972215== 
==972215== 12,672 bytes in 12 blocks are possibly lost in loss record 157 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x26EC9C: gpt::FFFBlock::Forward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:251)
==972215==    by 0x26FC6C: gpt::GPT::__Forward(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:112)
==972215==    by 0x270162: gpt::GPT::ForwardCPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>, float*) (gpt.hpp:214)
==972215==    by 0x11BFC2: main (train_gpt2.cpp:439)
==972215== 
==972215== 12,672 bytes in 12 blocks are possibly lost in loss record 158 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x26ECCC: gpt::FFFBlock::Forward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:255)
==972215==    by 0x26FC6C: gpt::GPT::__Forward(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:112)
==972215==    by 0x270162: gpt::GPT::ForwardCPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>, float*) (gpt.hpp:214)
==972215==    by 0x11BFC2: main (train_gpt2.cpp:439)
==972215== 
==972215== 12,672 bytes in 12 blocks are possibly lost in loss record 159 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x26ECD8: gpt::FFFBlock::Forward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:256)
==972215==    by 0x26FC6C: gpt::GPT::__Forward(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:112)
==972215==    by 0x270162: gpt::GPT::ForwardCPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>, float*) (gpt.hpp:214)
==972215==    by 0x11BFC2: main (train_gpt2.cpp:439)
==972215== 
==972215== 12,672 bytes in 12 blocks are possibly lost in loss record 160 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x225AE7: gpt::FastFeedforwardNetwork::TrainingForward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>, bool) (fastfeedforward.hpp:371)
==972215==    by 0x26F05C: Forward (fastfeedforward.hpp:293)
==972215==    by 0x26F05C: gpt::FFFBlock::Forward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:288)
==972215==    by 0x26FC6C: gpt::GPT::__Forward(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:112)
==972215==    by 0x270162: gpt::GPT::ForwardCPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>, float*) (gpt.hpp:214)
==972215==    by 0x11BFC2: main (train_gpt2.cpp:439)
==972215== 
==972215== 12,672 bytes in 12 blocks are possibly lost in loss record 161 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x2666B4: LazyAllocateGradient (fastfeedforward.hpp:75)
==972215==    by 0x2666B4: gpt::FastFeedforwardNetwork::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) (fastfeedforward.hpp:696)
==972215==    by 0x26AF6C: gpt::FFFBlock::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:336)
==972215==    by 0x26BE52: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:344)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 12,672 bytes in 12 blocks are possibly lost in loss record 162 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x1B03A0: nn::LayerNorm::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) (LayerNorm.hpp:121)
==972215==    by 0x26B026: gpt::FFFBlock::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:344)
==972215==    by 0x26BE52: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:344)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 12,672 bytes in 12 blocks are possibly lost in loss record 163 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x1B03AC: nn::LayerNorm::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) (LayerNorm.hpp:122)
==972215==    by 0x26B026: gpt::FFFBlock::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:344)
==972215==    by 0x26BE52: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:344)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 12,672 bytes in 12 blocks are possibly lost in loss record 164 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x1B03A0: nn::LayerNorm::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) (LayerNorm.hpp:121)
==972215==    by 0x26BE52: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:344)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 12,672 bytes in 12 blocks are possibly lost in loss record 165 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x1B03AC: nn::LayerNorm::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) (LayerNorm.hpp:122)
==972215==    by 0x26BE52: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:344)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 37,248 bytes in 12 blocks are possibly lost in loss record 167 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EEB6: nn::Parameter::LazyAllocate(int) [clone .constprop.0] (Parameter.hpp:200)
==972215==    by 0x19234A: Parameter (Parameter.hpp:183)
==972215==    by 0x19234A: make_unique<nn::Parameter, nn::DataType&, int&> (unique_ptr.h:1070)
==972215==    by 0x19234A: LayerNorm (LayerNorm.hpp:24)
==972215==    by 0x19234A: make_unique<nn::LayerNorm, int&> (unique_ptr.h:1070)
==972215==    by 0x19234A: gpt::FFFBlock::FFFBlock(int, int, int) (Block.hpp:205)
==972215==    by 0x1927ED: make_unique<gpt::FFFBlock, int&, int&, int&> (unique_ptr.h:1070)
==972215==    by 0x1927ED: gpt::GPT::GPT(int, int, int, int, int, int) (gpt.hpp:38)
==972215==    by 0x1935D6: make_unique<gpt::GPT, int const&, int const&, int const&, int const&, int const&, int const&> (unique_ptr.h:1070)
==972215==    by 0x1935D6: gpt2::GPT2::InitializeFromScratch(gpt2::GPT2Config const&) (gpt2.hpp:87)
==972215==    by 0x11AAF9: main (train_gpt2.cpp:369)
==972215== 
==972215== 37,248 bytes in 12 blocks are possibly lost in loss record 168 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EEB6: nn::Parameter::LazyAllocate(int) [clone .constprop.0] (Parameter.hpp:200)
==972215==    by 0x19232A: Parameter (Parameter.hpp:183)
==972215==    by 0x19232A: make_unique<nn::Parameter, nn::DataType&, int&> (unique_ptr.h:1070)
==972215==    by 0x19232A: LayerNorm (LayerNorm.hpp:27)
==972215==    by 0x19232A: make_unique<nn::LayerNorm, int&> (unique_ptr.h:1070)
==972215==    by 0x19232A: gpt::FFFBlock::FFFBlock(int, int, int) (Block.hpp:205)
==972215==    by 0x1927ED: make_unique<gpt::FFFBlock, int&, int&, int&> (unique_ptr.h:1070)
==972215==    by 0x1927ED: gpt::GPT::GPT(int, int, int, int, int, int) (gpt.hpp:38)
==972215==    by 0x1935D6: make_unique<gpt::GPT, int const&, int const&, int const&, int const&, int const&, int const&> (unique_ptr.h:1070)
==972215==    by 0x1935D6: gpt2::GPT2::InitializeFromScratch(gpt2::GPT2Config const&) (gpt2.hpp:87)
==972215==    by 0x11AAF9: main (train_gpt2.cpp:369)
==972215== 
==972215== 37,248 bytes in 12 blocks are possibly lost in loss record 169 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EEB6: nn::Parameter::LazyAllocate(int) [clone .constprop.0] (Parameter.hpp:200)
==972215==    by 0x18015A: Parameter (Parameter.hpp:183)
==972215==    by 0x18015A: make_unique<nn::Parameter, nn::DataType&, int&> (unique_ptr.h:1070)
==972215==    by 0x18015A: nn::Linear::Linear(int, int, bool) (Linear.hpp:24)
==972215==    by 0x1803B7: make_unique<nn::Linear, int&, int&> (unique_ptr.h:1070)
==972215==    by 0x1803B7: gpt::CausalSelfAttention::CausalSelfAttention(int, int, int) (AttentionLayer.hpp:34)
==972215==    by 0x191BE6: make_unique<gpt::CausalSelfAttention, int&, int&, int&> (unique_ptr.h:1070)
==972215==    by 0x191BE6: gpt::FFFBlock::FFFBlock(int, int, int) (Block.hpp:206)
==972215==    by 0x1927ED: make_unique<gpt::FFFBlock, int&, int&, int&> (unique_ptr.h:1070)
==972215==    by 0x1927ED: gpt::GPT::GPT(int, int, int, int, int, int) (gpt.hpp:38)
==972215==    by 0x1935D6: make_unique<gpt::GPT, int const&, int const&, int const&, int const&, int const&, int const&> (unique_ptr.h:1070)
==972215==    by 0x1935D6: gpt2::GPT2::InitializeFromScratch(gpt2::GPT2Config const&) (gpt2.hpp:87)
==972215==    by 0x11AAF9: main (train_gpt2.cpp:369)
==972215== 
==972215== 37,248 bytes in 12 blocks are possibly lost in loss record 170 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EEB6: nn::Parameter::LazyAllocate(int) [clone .constprop.0] (Parameter.hpp:200)
==972215==    by 0x19233A: Parameter (Parameter.hpp:183)
==972215==    by 0x19233A: make_unique<nn::Parameter, nn::DataType&, int&> (unique_ptr.h:1070)
==972215==    by 0x19233A: LayerNorm (LayerNorm.hpp:24)
==972215==    by 0x19233A: make_unique<nn::LayerNorm, int&> (unique_ptr.h:1070)
==972215==    by 0x19233A: gpt::FFFBlock::FFFBlock(int, int, int) (Block.hpp:207)
==972215==    by 0x1927ED: make_unique<gpt::FFFBlock, int&, int&, int&> (unique_ptr.h:1070)
==972215==    by 0x1927ED: gpt::GPT::GPT(int, int, int, int, int, int) (gpt.hpp:38)
==972215==    by 0x1935D6: make_unique<gpt::GPT, int const&, int const&, int const&, int const&, int const&, int const&> (unique_ptr.h:1070)
==972215==    by 0x1935D6: gpt2::GPT2::InitializeFromScratch(gpt2::GPT2Config const&) (gpt2.hpp:87)
==972215==    by 0x11AAF9: main (train_gpt2.cpp:369)
==972215== 
==972215== 37,248 bytes in 12 blocks are possibly lost in loss record 171 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EEB6: nn::Parameter::LazyAllocate(int) [clone .constprop.0] (Parameter.hpp:200)
==972215==    by 0x19235A: Parameter (Parameter.hpp:183)
==972215==    by 0x19235A: make_unique<nn::Parameter, nn::DataType&, int&> (unique_ptr.h:1070)
==972215==    by 0x19235A: LayerNorm (LayerNorm.hpp:27)
==972215==    by 0x19235A: make_unique<nn::LayerNorm, int&> (unique_ptr.h:1070)
==972215==    by 0x19235A: gpt::FFFBlock::FFFBlock(int, int, int) (Block.hpp:207)
==972215==    by 0x1927ED: make_unique<gpt::FFFBlock, int&, int&, int&> (unique_ptr.h:1070)
==972215==    by 0x1927ED: gpt::GPT::GPT(int, int, int, int, int, int) (gpt.hpp:38)
==972215==    by 0x1935D6: make_unique<gpt::GPT, int const&, int const&, int const&, int const&, int const&, int const&> (unique_ptr.h:1070)
==972215==    by 0x1935D6: gpt2::GPT2::InitializeFromScratch(gpt2::GPT2Config const&) (gpt2.hpp:87)
==972215==    by 0x11AAF9: main (train_gpt2.cpp:369)
==972215== 
==972215== 37,248 bytes in 12 blocks are possibly lost in loss record 172 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x1B08FC: LazyAllocateGradient (Parameter.hpp:234)
==972215==    by 0x1B08FC: nn::LayerNorm::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) (LayerNorm.hpp:105)
==972215==    by 0x26B026: gpt::FFFBlock::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:344)
==972215==    by 0x26BE52: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:344)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 37,248 bytes in 12 blocks are possibly lost in loss record 173 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x1B08CC: LazyAllocateGradient (TensorEvaluator.h:580)
==972215==    by 0x1B08CC: nn::LayerNorm::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) (LayerNorm.hpp:106)
==972215==    by 0x26B026: gpt::FFFBlock::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:344)
==972215==    by 0x26BE52: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:344)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 37,248 bytes in 12 blocks are possibly lost in loss record 174 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x264A2E: LazyAllocateGradient (Linear.hpp:91)
==972215==    by 0x264A2E: nn::Linear::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) (Linear.hpp:86)
==972215==    by 0x268F90: gpt::CausalSelfAttention::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (AttentionLayer.hpp:188)
==972215==    by 0x26B18B: gpt::FFFBlock::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:358)
==972215==    by 0x26BE52: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:344)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 37,248 bytes in 12 blocks are possibly lost in loss record 175 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x1B08FC: LazyAllocateGradient (Parameter.hpp:234)
==972215==    by 0x1B08FC: nn::LayerNorm::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) (LayerNorm.hpp:105)
==972215==    by 0x26BE52: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:344)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 37,248 bytes in 12 blocks are possibly lost in loss record 176 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x1B08CC: LazyAllocateGradient (TensorEvaluator.h:580)
==972215==    by 0x1B08CC: nn::LayerNorm::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) (LayerNorm.hpp:106)
==972215==    by 0x26BE52: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:344)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 37,248 bytes in 12 blocks are possibly lost in loss record 177 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x264A2E: LazyAllocateGradient (Linear.hpp:91)
==972215==    by 0x264A2E: nn::Linear::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) (Linear.hpp:86)
==972215==    by 0x264E49: gpt::LeafNetwork::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) [clone .isra.0] (fastfeedforward.hpp:205)
==972215==    by 0x266BA8: gpt::FastFeedforwardNetwork::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) (fastfeedforward.hpp:675)
==972215==    by 0x26AF6C: gpt::FFFBlock::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:336)
==972215==    by 0x26BE52: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:344)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 37,248 bytes in 12 blocks are possibly lost in loss record 178 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x264A2E: LazyAllocateGradient (Linear.hpp:91)
==972215==    by 0x264A2E: nn::Linear::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) (Linear.hpp:86)
==972215==    by 0x265020: gpt::LeafNetwork::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) [clone .isra.0] (fastfeedforward.hpp:216)
==972215==    by 0x266BA8: gpt::FastFeedforwardNetwork::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) (fastfeedforward.hpp:675)
==972215==    by 0x26AF6C: gpt::FFFBlock::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:336)
==972215==    by 0x26BE52: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:344)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 38,016 bytes in 36 blocks are possibly lost in loss record 179 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x226C22: Allocate (Parameter.hpp:361)
==972215==    by 0x226C22: LazyAllocate (Parameter.hpp:200)
==972215==    by 0x226C22: Forward (fastfeedforward.hpp:42)
==972215==    by 0x226C22: gpt::FastFeedforwardNetwork::TrainingForward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>, bool) (fastfeedforward.hpp:383)
==972215==    by 0x26F05C: Forward (fastfeedforward.hpp:293)
==972215==    by 0x26F05C: gpt::FFFBlock::Forward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:288)
==972215==    by 0x26FC6C: gpt::GPT::__Forward(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:112)
==972215==    by 0x270162: gpt::GPT::ForwardCPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>, float*) (gpt.hpp:214)
==972215==    by 0x11B166: main (train_gpt2.cpp:604)
==972215== 
==972215== 38,016 bytes in 36 blocks are possibly lost in loss record 180 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x226BFB: Allocate (Parameter.hpp:361)
==972215==    by 0x226BFB: LazyAllocate (Parameter.hpp:200)
==972215==    by 0x226BFB: Forward (fastfeedforward.hpp:43)
==972215==    by 0x226BFB: gpt::FastFeedforwardNetwork::TrainingForward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>, bool) (fastfeedforward.hpp:383)
==972215==    by 0x26F05C: Forward (fastfeedforward.hpp:293)
==972215==    by 0x26F05C: gpt::FFFBlock::Forward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:288)
==972215==    by 0x26FC6C: gpt::GPT::__Forward(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:112)
==972215==    by 0x270162: gpt::GPT::ForwardCPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>, float*) (gpt.hpp:214)
==972215==    by 0x11B166: main (train_gpt2.cpp:604)
==972215== 
==972215== 38,016 bytes in 36 blocks are possibly lost in loss record 181 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x265FC3: LazyAllocateGradient (fastfeedforward.hpp:716)
==972215==    by 0x265FC3: Backward (fastfeedforward.hpp:66)
==972215==    by 0x265FC3: gpt::FastFeedforwardNetwork::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) (fastfeedforward.hpp:736)
==972215==    by 0x26AF6C: gpt::FFFBlock::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:336)
==972215==    by 0x26BE52: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:344)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 38,016 bytes in 36 blocks are possibly lost in loss record 182 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x2662D3: LazyAllocateGradient (fastfeedforward.hpp:740)
==972215==    by 0x2662D3: Backward (fastfeedforward.hpp:67)
==972215==    by 0x2662D3: gpt::FastFeedforwardNetwork::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) (fastfeedforward.hpp:736)
==972215==    by 0x26AF6C: gpt::FFFBlock::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:336)
==972215==    by 0x26BE52: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:344)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 49,536 bytes in 12 blocks are possibly lost in loss record 183 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x2259A1: gpt::FastFeedforwardNetwork::TrainingForward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>, bool) (fastfeedforward.hpp:360)
==972215==    by 0x26F05C: Forward (fastfeedforward.hpp:293)
==972215==    by 0x26F05C: gpt::FFFBlock::Forward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:288)
==972215==    by 0x26FC6C: gpt::GPT::__Forward(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:112)
==972215==    by 0x270162: gpt::GPT::ForwardCPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>, float*) (gpt.hpp:214)
==972215==    by 0x11BFC2: main (train_gpt2.cpp:439)
==972215== 
==972215== 49,536 bytes in 12 blocks are possibly lost in loss record 184 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x2666E4: LazyAllocateGradient (Parameter.hpp:222)
==972215==    by 0x2666E4: gpt::FastFeedforwardNetwork::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) (fastfeedforward.hpp:622)
==972215==    by 0x26AF6C: gpt::FFFBlock::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:336)
==972215==    by 0x26BE52: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:344)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 110,976 bytes in 12 blocks are possibly lost in loss record 186 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EEB6: nn::Parameter::LazyAllocate(int) [clone .constprop.0] (Parameter.hpp:200)
==972215==    by 0x18015A: Parameter (Parameter.hpp:183)
==972215==    by 0x18015A: make_unique<nn::Parameter, nn::DataType&, int&> (unique_ptr.h:1070)
==972215==    by 0x18015A: nn::Linear::Linear(int, int, bool) (Linear.hpp:24)
==972215==    by 0x180363: make_unique<nn::Linear, int&, int> (unique_ptr.h:1070)
==972215==    by 0x180363: gpt::CausalSelfAttention::CausalSelfAttention(int, int, int) (AttentionLayer.hpp:31)
==972215==    by 0x191BE6: make_unique<gpt::CausalSelfAttention, int&, int&, int&> (unique_ptr.h:1070)
==972215==    by 0x191BE6: gpt::FFFBlock::FFFBlock(int, int, int) (Block.hpp:206)
==972215==    by 0x1927ED: make_unique<gpt::FFFBlock, int&, int&, int&> (unique_ptr.h:1070)
==972215==    by 0x1927ED: gpt::GPT::GPT(int, int, int, int, int, int) (gpt.hpp:38)
==972215==    by 0x1935D6: make_unique<gpt::GPT, int const&, int const&, int const&, int const&, int const&, int const&> (unique_ptr.h:1070)
==972215==    by 0x1935D6: gpt2::GPT2::InitializeFromScratch(gpt2::GPT2Config const&) (gpt2.hpp:87)
==972215==    by 0x11AAF9: main (train_gpt2.cpp:369)
==972215== 
==972215== 110,976 bytes in 12 blocks are possibly lost in loss record 187 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x264A2E: LazyAllocateGradient (Linear.hpp:91)
==972215==    by 0x264A2E: nn::Linear::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) (Linear.hpp:86)
==972215==    by 0x26B18B: gpt::FFFBlock::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:358)
==972215==    by 0x26BE52: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:344)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 111,744 bytes in 36 blocks are possibly lost in loss record 188 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EEB6: nn::Parameter::LazyAllocate(int) [clone .constprop.0] (Parameter.hpp:200)
==972215==    by 0x19114A: Parameter (Parameter.hpp:183)
==972215==    by 0x19114A: make_unique<nn::Parameter, nn::DataType&, int> (unique_ptr.h:1070)
==972215==    by 0x19114A: Linear (Linear.hpp:21)
==972215==    by 0x19114A: make_unique<nn::Linear, int&, int> (unique_ptr.h:1070)
==972215==    by 0x19114A: DecisionNode (fastfeedforward.hpp:23)
==972215==    by 0x19114A: make_unique<gpt::DecisionNode, int&, int&> (unique_ptr.h:1070)
==972215==    by 0x19114A: gpt::FastFeedforwardNetwork::FastFeedforwardNetwork(int, int, int, int, bool, float) (fastfeedforward.hpp:269)
==972215==    by 0x191F63: make_unique<gpt::FastFeedforwardNetwork, int&, int&, int&, int&> (unique_ptr.h:1070)
==972215==    by 0x191F63: gpt::FFFBlock::FFFBlock(int, int, int) (Block.hpp:222)
==972215==    by 0x1927ED: make_unique<gpt::FFFBlock, int&, int&, int&> (unique_ptr.h:1070)
==972215==    by 0x1927ED: gpt::GPT::GPT(int, int, int, int, int, int) (gpt.hpp:38)
==972215==    by 0x1935D6: make_unique<gpt::GPT, int const&, int const&, int const&, int const&, int const&, int const&> (unique_ptr.h:1070)
==972215==    by 0x1935D6: gpt2::GPT2::InitializeFromScratch(gpt2::GPT2Config const&) (gpt2.hpp:87)
==972215==    by 0x11AAF9: main (train_gpt2.cpp:369)
==972215== 
==972215== 111,744 bytes in 36 blocks are possibly lost in loss record 189 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x264294: LazyAllocateGradient (TensorAssign.h:146)
==972215==    by 0x264294: nn::Linear::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) (Linear.hpp:63)
==972215==    by 0x265CB6: Backward (fastfeedforward.hpp:87)
==972215==    by 0x265CB6: gpt::FastFeedforwardNetwork::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) (fastfeedforward.hpp:736)
==972215==    by 0x26AF6C: gpt::FFFBlock::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:336)
==972215==    by 0x26BE52: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:344)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 148,992 bytes in 48 blocks are possibly lost in loss record 190 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EEB6: nn::Parameter::LazyAllocate(int) [clone .constprop.0] (Parameter.hpp:200)
==972215==    by 0x19111A: Parameter (Parameter.hpp:183)
==972215==    by 0x19111A: make_unique<nn::Parameter, nn::DataType&, int&> (unique_ptr.h:1070)
==972215==    by 0x19111A: Linear (Linear.hpp:24)
==972215==    by 0x19111A: make_unique<nn::Linear, int&, int&> (unique_ptr.h:1070)
==972215==    by 0x19111A: LeafNetwork (fastfeedforward.hpp:119)
==972215==    by 0x19111A: make_unique<gpt::LeafNetwork, int&, int&, int&, int&> (unique_ptr.h:1070)
==972215==    by 0x19111A: gpt::FastFeedforwardNetwork::FastFeedforwardNetwork(int, int, int, int, bool, float) (fastfeedforward.hpp:274)
==972215==    by 0x191F63: make_unique<gpt::FastFeedforwardNetwork, int&, int&, int&, int&> (unique_ptr.h:1070)
==972215==    by 0x191F63: gpt::FFFBlock::FFFBlock(int, int, int) (Block.hpp:222)
==972215==    by 0x1927ED: make_unique<gpt::FFFBlock, int&, int&, int&> (unique_ptr.h:1070)
==972215==    by 0x1927ED: gpt::GPT::GPT(int, int, int, int, int, int) (gpt.hpp:38)
==972215==    by 0x1935D6: make_unique<gpt::GPT, int const&, int const&, int const&, int const&, int const&, int const&> (unique_ptr.h:1070)
==972215==    by 0x1935D6: gpt2::GPT2::InitializeFromScratch(gpt2::GPT2Config const&) (gpt2.hpp:87)
==972215==    by 0x11AAF9: main (train_gpt2.cpp:369)
==972215== 
==972215== 148,992 bytes in 48 blocks are possibly lost in loss record 191 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EEB6: nn::Parameter::LazyAllocate(int) [clone .constprop.0] (Parameter.hpp:200)
==972215==    by 0x1910DD: Parameter (Parameter.hpp:183)
==972215==    by 0x1910DD: make_unique<nn::Parameter, nn::DataType&, int&> (unique_ptr.h:1070)
==972215==    by 0x1910DD: Linear (Linear.hpp:24)
==972215==    by 0x1910DD: make_unique<nn::Linear, int&, int&> (unique_ptr.h:1070)
==972215==    by 0x1910DD: LeafNetwork (fastfeedforward.hpp:120)
==972215==    by 0x1910DD: make_unique<gpt::LeafNetwork, int&, int&, int&, int&> (unique_ptr.h:1070)
==972215==    by 0x1910DD: gpt::FastFeedforwardNetwork::FastFeedforwardNetwork(int, int, int, int, bool, float) (fastfeedforward.hpp:274)
==972215==    by 0x191F63: make_unique<gpt::FastFeedforwardNetwork, int&, int&, int&, int&> (unique_ptr.h:1070)
==972215==    by 0x191F63: gpt::FFFBlock::FFFBlock(int, int, int) (Block.hpp:222)
==972215==    by 0x1927ED: make_unique<gpt::FFFBlock, int&, int&, int&> (unique_ptr.h:1070)
==972215==    by 0x1927ED: gpt::GPT::GPT(int, int, int, int, int, int) (gpt.hpp:38)
==972215==    by 0x1935D6: make_unique<gpt::GPT, int const&, int const&, int const&, int const&, int const&, int const&> (unique_ptr.h:1070)
==972215==    by 0x1935D6: gpt2::GPT2::InitializeFromScratch(gpt2::GPT2Config const&) (gpt2.hpp:87)
==972215==    by 0x11AAF9: main (train_gpt2.cpp:369)
==972215== 
==972215== 196,640 bytes in 1 blocks are possibly lost in loss record 192 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x26F6BA: gpt::GPT::__Forward(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:85)
==972215==    by 0x270162: gpt::GPT::ForwardCPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>, float*) (gpt.hpp:214)
==972215==    by 0x11BFC2: main (train_gpt2.cpp:439)
==972215== 
==972215== 196,640 bytes in 1 blocks are possibly lost in loss record 193 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x26B824: LazyAllocateGradient (TensorAssign.h:146)
==972215==    by 0x26B824: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:295)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 201,060 bytes in 1 blocks are possibly lost in loss record 194 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EEB6: nn::Parameter::LazyAllocate(int) [clone .constprop.0] (Parameter.hpp:200)
==972215==    by 0x18015A: Parameter (Parameter.hpp:183)
==972215==    by 0x18015A: make_unique<nn::Parameter, nn::DataType&, int&> (unique_ptr.h:1070)
==972215==    by 0x18015A: nn::Linear::Linear(int, int, bool) (Linear.hpp:24)
==972215==    by 0x192EF3: make_unique<nn::Linear, int&, int&> (unique_ptr.h:1070)
==972215==    by 0x192EF3: gpt::GPT::GPT(int, int, int, int, int, int) (gpt.hpp:42)
==972215==    by 0x1935D6: make_unique<gpt::GPT, int const&, int const&, int const&, int const&, int const&, int const&> (unique_ptr.h:1070)
==972215==    by 0x1935D6: gpt2::GPT2::InitializeFromScratch(gpt2::GPT2Config const&) (gpt2.hpp:87)
==972215==    by 0x11AAF9: main (train_gpt2.cpp:369)
==972215== 
==972215== 656,392 bytes in 1 blocks are possibly lost in loss record 197 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x11CCDC: Eigen::internal::handmade_aligned_malloc(unsigned long, unsigned long) [clone .constprop.0] (Memory.h:105)
==972215==    by 0x183A75: MaxSizeVector (MaxSizeVector.h:38)
==972215==    by 0x183A75: Eigen::ThreadPoolTempl<Eigen::StlThreadEnvironment>::ThreadPoolTempl(int, bool, Eigen::StlThreadEnvironment) (NonBlockingThreadPool.h:29)
==972215==    by 0x11CA15: ThreadPoolTempl (NonBlockingThreadPool.h:22)
==972215==    by 0x11CA15: __static_initialization_and_destruction_0 (Parameter.hpp:40)
==972215==    by 0x11CA15: _GLOBAL__sub_I__Z11manual_seedP13mt19937_statej (train_gpt2.cpp:672)
==972215==    by 0x4D21303: call_init (libc-start.c:145)
==972215==    by 0x4D21303: __libc_start_main@@GLIBC_2.34 (libc-start.c:347)
==972215==    by 0x11CA74: (below main) (in /home/nathan/Nano-Framework2.0/train_gpt2_cpu)
==972215== 
==972215== 786,464 bytes in 1 blocks are possibly lost in loss record 201 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x26F6AB: gpt::GPT::__Forward(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:84)
==972215==    by 0x270162: gpt::GPT::ForwardCPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>, float*) (gpt.hpp:214)
==972215==    by 0x11BFC2: main (train_gpt2.cpp:439)
==972215== 
==972215== 786,464 bytes in 1 blocks are possibly lost in loss record 202 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x26F6C6: gpt::GPT::__Forward(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:86)
==972215==    by 0x270162: gpt::GPT::ForwardCPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>, float*) (gpt.hpp:214)
==972215==    by 0x11BFC2: main (train_gpt2.cpp:439)
==972215== 
==972215== 786,464 bytes in 1 blocks are possibly lost in loss record 203 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x26F6FD: gpt::GPT::__Forward(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:88)
==972215==    by 0x270162: gpt::GPT::ForwardCPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>, float*) (gpt.hpp:214)
==972215==    by 0x11BFC2: main (train_gpt2.cpp:439)
==972215== 
==972215== 786,464 bytes in 1 blocks are possibly lost in loss record 204 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x26B834: LazyAllocateGradient (TensorAssign.h:146)
==972215==    by 0x26B834: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:294)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 786,464 bytes in 1 blocks are possibly lost in loss record 205 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x26B814: LazyAllocateGradient (TensorAssign.h:146)
==972215==    by 0x26B814: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:296)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 786,464 bytes in 1 blocks are possibly lost in loss record 206 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x26B7F4: LazyAllocateGradient (TensorAssign.h:146)
==972215==    by 0x26B7F4: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:298)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 786,464 bytes in 1 blocks are possibly lost in loss record 207 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x1B0384: nn::LayerNorm::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) (LayerNorm.hpp:119)
==972215==    by 0x26BCF8: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:330)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 786,464 bytes in 1 blocks are possibly lost in loss record 208 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x1B0394: nn::LayerNorm::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) (LayerNorm.hpp:120)
==972215==    by 0x26BCF8: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:330)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 3,145,760 bytes in 1 blocks are possibly lost in loss record 212 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EEB6: nn::Parameter::LazyAllocate(int) [clone .constprop.0] (Parameter.hpp:200)
==972215==    by 0x19324A: Parameter (Parameter.hpp:183)
==972215==    by 0x19324A: make_unique<nn::Parameter, nn::DataType, int> (unique_ptr.h:1070)
==972215==    by 0x19324A: Embedding (Embedding.hpp:17)
==972215==    by 0x19324A: make_unique<nn::Embedding, int&, int&> (unique_ptr.h:1070)
==972215==    by 0x19324A: gpt::GPT::GPT(int, int, int, int, int, int) (gpt.hpp:36)
==972215==    by 0x1935D6: make_unique<gpt::GPT, int const&, int const&, int const&, int const&, int const&, int const&> (unique_ptr.h:1070)
==972215==    by 0x1935D6: gpt2::GPT2::InitializeFromScratch(gpt2::GPT2Config const&) (gpt2.hpp:87)
==972215==    by 0x11AAF9: main (train_gpt2.cpp:369)
==972215== 
==972215== 3,145,760 bytes in 1 blocks are possibly lost in loss record 213 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x17CBD4: LazyAllocateGradient (Embedding.hpp:40)
==972215==    by 0x17CBD4: nn::Embedding::Backward(absl::Span<int const>, absl::Span<float const>) (Embedding.hpp:36)
==972215==    by 0x26C465: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:359)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 9,437,216 bytes in 1 blocks are possibly lost in loss record 214 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x26F6EE: gpt::GPT::__Forward(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:87)
==972215==    by 0x270162: gpt::GPT::ForwardCPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>, float*) (gpt.hpp:214)
==972215==    by 0x11BFC2: main (train_gpt2.cpp:439)
==972215== 
==972215== 9,437,216 bytes in 1 blocks are possibly lost in loss record 215 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x26B804: LazyAllocateGradient (TensorAssign.h:146)
==972215==    by 0x26B804: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:297)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 9,437,568 bytes in 12 blocks are possibly lost in loss record 216 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x26EC84: gpt::FFFBlock::Forward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:249)
==972215==    by 0x26FC6C: gpt::GPT::__Forward(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:112)
==972215==    by 0x270162: gpt::GPT::ForwardCPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>, float*) (gpt.hpp:214)
==972215==    by 0x11BFC2: main (train_gpt2.cpp:439)
==972215== 
==972215== 9,437,568 bytes in 12 blocks are possibly lost in loss record 217 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x26ECA8: gpt::FFFBlock::Forward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:252)
==972215==    by 0x26FC6C: gpt::GPT::__Forward(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:112)
==972215==    by 0x270162: gpt::GPT::ForwardCPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>, float*) (gpt.hpp:214)
==972215==    by 0x11BFC2: main (train_gpt2.cpp:439)
==972215== 
==972215== 9,437,568 bytes in 12 blocks are possibly lost in loss record 218 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x26ECB4: gpt::FFFBlock::Forward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:253)
==972215==    by 0x26FC6C: gpt::GPT::__Forward(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:112)
==972215==    by 0x270162: gpt::GPT::ForwardCPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>, float*) (gpt.hpp:214)
==972215==    by 0x11BFC2: main (train_gpt2.cpp:439)
==972215== 
==972215== 9,437,568 bytes in 12 blocks are possibly lost in loss record 219 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x26ECC0: gpt::FFFBlock::Forward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:254)
==972215==    by 0x26FC6C: gpt::GPT::__Forward(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:112)
==972215==    by 0x270162: gpt::GPT::ForwardCPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>, float*) (gpt.hpp:214)
==972215==    by 0x11BFC2: main (train_gpt2.cpp:439)
==972215== 
==972215== 9,437,568 bytes in 12 blocks are possibly lost in loss record 220 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x26ECE4: gpt::FFFBlock::Forward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:257)
==972215==    by 0x26FC6C: gpt::GPT::__Forward(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:112)
==972215==    by 0x270162: gpt::GPT::ForwardCPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>, float*) (gpt.hpp:214)
==972215==    by 0x11BFC2: main (train_gpt2.cpp:439)
==972215== 
==972215== 9,437,568 bytes in 12 blocks are possibly lost in loss record 221 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x26CD6E: gpt::CausalSelfAttention::Forward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (AttentionLayer.hpp:68)
==972215==    by 0x26EDDC: gpt::FFFBlock::Forward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:269)
==972215==    by 0x26FC6C: gpt::GPT::__Forward(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:112)
==972215==    by 0x270162: gpt::GPT::ForwardCPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>, float*) (gpt.hpp:214)
==972215==    by 0x11BFC2: main (train_gpt2.cpp:439)
==972215== 
==972215== 9,437,568 bytes in 12 blocks are possibly lost in loss record 222 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x26CD8F: gpt::CausalSelfAttention::Forward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (AttentionLayer.hpp:69)
==972215==    by 0x26EDDC: gpt::FFFBlock::Forward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:269)
==972215==    by 0x26FC6C: gpt::GPT::__Forward(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:112)
==972215==    by 0x270162: gpt::GPT::ForwardCPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>, float*) (gpt.hpp:214)
==972215==    by 0x11BFC2: main (train_gpt2.cpp:439)
==972215== 
==972215== 9,437,568 bytes in 12 blocks are possibly lost in loss record 223 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x26CD9A: gpt::CausalSelfAttention::Forward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (AttentionLayer.hpp:70)
==972215==    by 0x26EDDC: gpt::FFFBlock::Forward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:269)
==972215==    by 0x26FC6C: gpt::GPT::__Forward(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:112)
==972215==    by 0x270162: gpt::GPT::ForwardCPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>, float*) (gpt.hpp:214)
==972215==    by 0x11BFC2: main (train_gpt2.cpp:439)
==972215== 
==972215== 9,437,568 bytes in 12 blocks are possibly lost in loss record 224 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x26CDBA: gpt::CausalSelfAttention::Forward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (AttentionLayer.hpp:71)
==972215==    by 0x26EDDC: gpt::FFFBlock::Forward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:269)
==972215==    by 0x26FC6C: gpt::GPT::__Forward(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:112)
==972215==    by 0x270162: gpt::GPT::ForwardCPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>, float*) (gpt.hpp:214)
==972215==    by 0x11BFC2: main (train_gpt2.cpp:439)
==972215== 
==972215== 9,437,568 bytes in 12 blocks are possibly lost in loss record 225 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x26CDC9: gpt::CausalSelfAttention::Forward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (AttentionLayer.hpp:72)
==972215==    by 0x26EDDC: gpt::FFFBlock::Forward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:269)
==972215==    by 0x26FC6C: gpt::GPT::__Forward(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:112)
==972215==    by 0x270162: gpt::GPT::ForwardCPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>, float*) (gpt.hpp:214)
==972215==    by 0x11BFC2: main (train_gpt2.cpp:439)
==972215== 
==972215== 9,437,568 bytes in 12 blocks are possibly lost in loss record 226 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x26CDD4: gpt::CausalSelfAttention::Forward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (AttentionLayer.hpp:73)
==972215==    by 0x26EDDC: gpt::FFFBlock::Forward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:269)
==972215==    by 0x26FC6C: gpt::GPT::__Forward(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:112)
==972215==    by 0x270162: gpt::GPT::ForwardCPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>, float*) (gpt.hpp:214)
==972215==    by 0x11BFC2: main (train_gpt2.cpp:439)
==972215== 
==972215== 9,437,568 bytes in 12 blocks are possibly lost in loss record 227 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x26CDF9: gpt::CausalSelfAttention::Forward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (AttentionLayer.hpp:74)
==972215==    by 0x26EDDC: gpt::FFFBlock::Forward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:269)
==972215==    by 0x26FC6C: gpt::GPT::__Forward(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:112)
==972215==    by 0x270162: gpt::GPT::ForwardCPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>, float*) (gpt.hpp:214)
==972215==    by 0x11BFC2: main (train_gpt2.cpp:439)
==972215== 
==972215== 9,437,568 bytes in 12 blocks are possibly lost in loss record 228 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x1595C7: gpt::LeafNetwork::Forward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) [clone .isra.0] (fastfeedforward.hpp:146)
==972215==    by 0x226DF9: gpt::FastFeedforwardNetwork::TrainingForward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>, bool) (fastfeedforward.hpp:456)
==972215==    by 0x26F05C: Forward (fastfeedforward.hpp:293)
==972215==    by 0x26F05C: gpt::FFFBlock::Forward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:288)
==972215==    by 0x26FC6C: gpt::GPT::__Forward(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:112)
==972215==    by 0x270162: gpt::GPT::ForwardCPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>, float*) (gpt.hpp:214)
==972215==    by 0x11B166: main (train_gpt2.cpp:604)
==972215== 
==972215== 9,437,568 bytes in 12 blocks are possibly lost in loss record 229 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x1595D6: gpt::LeafNetwork::Forward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) [clone .isra.0] (fastfeedforward.hpp:147)
==972215==    by 0x226DF9: gpt::FastFeedforwardNetwork::TrainingForward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>, bool) (fastfeedforward.hpp:456)
==972215==    by 0x26F05C: Forward (fastfeedforward.hpp:293)
==972215==    by 0x26F05C: gpt::FFFBlock::Forward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:288)
==972215==    by 0x26FC6C: gpt::GPT::__Forward(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:112)
==972215==    by 0x270162: gpt::GPT::ForwardCPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>, float*) (gpt.hpp:214)
==972215==    by 0x11B166: main (train_gpt2.cpp:604)
==972215== 
==972215== 9,437,568 bytes in 12 blocks are possibly lost in loss record 230 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x1595E6: gpt::LeafNetwork::Forward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) [clone .isra.0] (fastfeedforward.hpp:148)
==972215==    by 0x226DF9: gpt::FastFeedforwardNetwork::TrainingForward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>, bool) (fastfeedforward.hpp:456)
==972215==    by 0x26F05C: Forward (fastfeedforward.hpp:293)
==972215==    by 0x26F05C: gpt::FFFBlock::Forward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:288)
==972215==    by 0x26FC6C: gpt::GPT::__Forward(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:112)
==972215==    by 0x270162: gpt::GPT::ForwardCPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>, float*) (gpt.hpp:214)
==972215==    by 0x11B166: main (train_gpt2.cpp:604)
==972215== 
==972215== 9,437,568 bytes in 12 blocks are possibly lost in loss record 231 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x26B274: LazyAllocateGradient (Block.hpp:366)
==972215==    by 0x26B274: gpt::FFFBlock::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:314)
==972215==    by 0x26BE52: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:344)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 9,437,568 bytes in 12 blocks are possibly lost in loss record 232 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x26B289: LazyAllocateGradient (Parameter.hpp:208)
==972215==    by 0x26B289: gpt::FFFBlock::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:315)
==972215==    by 0x26BE52: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:344)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 9,437,568 bytes in 12 blocks are possibly lost in loss record 233 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x26B29E: LazyAllocateGradient (Parameter.hpp:208)
==972215==    by 0x26B29E: gpt::FFFBlock::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:316)
==972215==    by 0x26BE52: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:344)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 9,437,568 bytes in 12 blocks are possibly lost in loss record 234 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x26B2B3: LazyAllocateGradient (Parameter.hpp:208)
==972215==    by 0x26B2B3: gpt::FFFBlock::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:317)
==972215==    by 0x26BE52: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:344)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 9,437,568 bytes in 12 blocks are possibly lost in loss record 235 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x26B2C8: LazyAllocateGradient (Parameter.hpp:208)
==972215==    by 0x26B2C8: gpt::FFFBlock::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:318)
==972215==    by 0x26BE52: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:344)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 9,437,568 bytes in 12 blocks are possibly lost in loss record 236 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x1B0384: nn::LayerNorm::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) (LayerNorm.hpp:119)
==972215==    by 0x26B026: gpt::FFFBlock::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:344)
==972215==    by 0x26BE52: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:344)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 9,437,568 bytes in 12 blocks are possibly lost in loss record 237 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x1B0394: nn::LayerNorm::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) (LayerNorm.hpp:120)
==972215==    by 0x26B026: gpt::FFFBlock::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:344)
==972215==    by 0x26BE52: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:344)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 9,437,568 bytes in 12 blocks are possibly lost in loss record 238 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x2693A8: LazyAllocateGradient (Parameter.hpp:208)
==972215==    by 0x2693A8: gpt::CausalSelfAttention::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (AttentionLayer.hpp:168)
==972215==    by 0x26B18B: gpt::FFFBlock::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:358)
==972215==    by 0x26BE52: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:344)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 9,437,568 bytes in 12 blocks are possibly lost in loss record 239 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x2693BC: LazyAllocateGradient (Parameter.hpp:208)
==972215==    by 0x2693BC: gpt::CausalSelfAttention::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (AttentionLayer.hpp:169)
==972215==    by 0x26B18B: gpt::FFFBlock::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:358)
==972215==    by 0x26BE52: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:344)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 9,437,568 bytes in 12 blocks are possibly lost in loss record 240 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x2693D0: LazyAllocateGradient (Parameter.hpp:208)
==972215==    by 0x2693D0: gpt::CausalSelfAttention::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (AttentionLayer.hpp:170)
==972215==    by 0x26B18B: gpt::FFFBlock::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:358)
==972215==    by 0x26BE52: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:344)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 9,437,568 bytes in 12 blocks are possibly lost in loss record 241 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x2693E4: LazyAllocateGradient (Parameter.hpp:208)
==972215==    by 0x2693E4: gpt::CausalSelfAttention::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (AttentionLayer.hpp:171)
==972215==    by 0x26B18B: gpt::FFFBlock::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:358)
==972215==    by 0x26BE52: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:344)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 9,437,568 bytes in 12 blocks are possibly lost in loss record 242 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x2693F8: LazyAllocateGradient (Parameter.hpp:208)
==972215==    by 0x2693F8: gpt::CausalSelfAttention::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (AttentionLayer.hpp:172)
==972215==    by 0x26B18B: gpt::FFFBlock::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:358)
==972215==    by 0x26BE52: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:344)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 9,437,568 bytes in 12 blocks are possibly lost in loss record 243 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x26940C: LazyAllocateGradient (Parameter.hpp:208)
==972215==    by 0x26940C: gpt::CausalSelfAttention::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (AttentionLayer.hpp:173)
==972215==    by 0x26B18B: gpt::FFFBlock::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:358)
==972215==    by 0x26BE52: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:344)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 9,437,568 bytes in 12 blocks are possibly lost in loss record 244 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x269420: LazyAllocateGradient (Parameter.hpp:208)
==972215==    by 0x269420: gpt::CausalSelfAttention::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (AttentionLayer.hpp:174)
==972215==    by 0x26B18B: gpt::FFFBlock::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:358)
==972215==    by 0x26BE52: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:344)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 9,437,568 bytes in 12 blocks are possibly lost in loss record 245 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x1B0384: nn::LayerNorm::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) (LayerNorm.hpp:119)
==972215==    by 0x26BE52: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:344)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 9,437,568 bytes in 12 blocks are possibly lost in loss record 246 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x1B0394: nn::LayerNorm::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) (LayerNorm.hpp:120)
==972215==    by 0x26BE52: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:344)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 9,437,568 bytes in 12 blocks are possibly lost in loss record 247 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x2651AD: LazyAllocateGradient (fastfeedforward.hpp:195)
==972215==    by 0x2651AD: gpt::LeafNetwork::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) [clone .isra.0] (fastfeedforward.hpp:185)
==972215==    by 0x266BA8: gpt::FastFeedforwardNetwork::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) (fastfeedforward.hpp:675)
==972215==    by 0x26AF6C: gpt::FFFBlock::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:336)
==972215==    by 0x26BE52: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:344)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 9,437,568 bytes in 12 blocks are possibly lost in loss record 248 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x2651A3: LazyAllocateGradient (fastfeedforward.hpp:195)
==972215==    by 0x2651A3: gpt::LeafNetwork::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) [clone .isra.0] (fastfeedforward.hpp:186)
==972215==    by 0x266BA8: gpt::FastFeedforwardNetwork::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) (fastfeedforward.hpp:675)
==972215==    by 0x26AF6C: gpt::FFFBlock::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:336)
==972215==    by 0x26BE52: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:344)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 9,437,568 bytes in 12 blocks are possibly lost in loss record 249 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x265199: LazyAllocateGradient (fastfeedforward.hpp:195)
==972215==    by 0x265199: gpt::LeafNetwork::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) [clone .isra.0] (fastfeedforward.hpp:187)
==972215==    by 0x266BA8: gpt::FastFeedforwardNetwork::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) (fastfeedforward.hpp:675)
==972215==    by 0x26AF6C: gpt::FFFBlock::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:336)
==972215==    by 0x26BE52: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:344)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 28,311,936 bytes in 12 blocks are possibly lost in loss record 250 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EEB6: nn::Parameter::LazyAllocate(int) [clone .constprop.0] (Parameter.hpp:200)
==972215==    by 0x18006A: Parameter (Parameter.hpp:183)
==972215==    by 0x18006A: make_unique<nn::Parameter, nn::DataType&, int> (unique_ptr.h:1070)
==972215==    by 0x18006A: nn::Linear::Linear(int, int, bool) (Linear.hpp:21)
==972215==    by 0x1803B7: make_unique<nn::Linear, int&, int&> (unique_ptr.h:1070)
==972215==    by 0x1803B7: gpt::CausalSelfAttention::CausalSelfAttention(int, int, int) (AttentionLayer.hpp:34)
==972215==    by 0x191BE6: make_unique<gpt::CausalSelfAttention, int&, int&, int&> (unique_ptr.h:1070)
==972215==    by 0x191BE6: gpt::FFFBlock::FFFBlock(int, int, int) (Block.hpp:206)
==972215==    by 0x1927ED: make_unique<gpt::FFFBlock, int&, int&, int&> (unique_ptr.h:1070)
==972215==    by 0x1927ED: gpt::GPT::GPT(int, int, int, int, int, int) (gpt.hpp:38)
==972215==    by 0x1935D6: make_unique<gpt::GPT, int const&, int const&, int const&, int const&, int const&, int const&> (unique_ptr.h:1070)
==972215==    by 0x1935D6: gpt2::GPT2::InitializeFromScratch(gpt2::GPT2Config const&) (gpt2.hpp:87)
==972215==    by 0x11AAF9: main (train_gpt2.cpp:369)
==972215== 
==972215== 28,311,936 bytes in 12 blocks are possibly lost in loss record 251 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x26CD38: gpt::CausalSelfAttention::Forward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (AttentionLayer.hpp:67)
==972215==    by 0x26EDDC: gpt::FFFBlock::Forward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:269)
==972215==    by 0x26FC6C: gpt::GPT::__Forward(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:112)
==972215==    by 0x270162: gpt::GPT::ForwardCPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>, float*) (gpt.hpp:214)
==972215==    by 0x11BFC2: main (train_gpt2.cpp:439)
==972215== 
==972215== 28,311,936 bytes in 12 blocks are possibly lost in loss record 252 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x269394: LazyAllocateGradient (TensorEvaluator.h:580)
==972215==    by 0x269394: gpt::CausalSelfAttention::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (AttentionLayer.hpp:167)
==972215==    by 0x26B18B: gpt::FFFBlock::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:358)
==972215==    by 0x26BE52: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:344)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 28,311,936 bytes in 12 blocks are possibly lost in loss record 253 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x264294: LazyAllocateGradient (TensorAssign.h:146)
==972215==    by 0x264294: nn::Linear::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) (Linear.hpp:63)
==972215==    by 0x268F90: gpt::CausalSelfAttention::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (AttentionLayer.hpp:188)
==972215==    by 0x26B18B: gpt::FFFBlock::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:358)
==972215==    by 0x26BE52: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:344)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 28,311,936 bytes in 12 blocks are possibly lost in loss record 254 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x264294: LazyAllocateGradient (TensorAssign.h:146)
==972215==    by 0x264294: nn::Linear::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) (Linear.hpp:63)
==972215==    by 0x264E49: gpt::LeafNetwork::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) [clone .isra.0] (fastfeedforward.hpp:205)
==972215==    by 0x266BA8: gpt::FastFeedforwardNetwork::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) (fastfeedforward.hpp:675)
==972215==    by 0x26AF6C: gpt::FFFBlock::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:336)
==972215==    by 0x26BE52: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:344)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 28,311,936 bytes in 12 blocks are possibly lost in loss record 255 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x264294: LazyAllocateGradient (TensorAssign.h:146)
==972215==    by 0x264294: nn::Linear::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) (Linear.hpp:63)
==972215==    by 0x265020: gpt::LeafNetwork::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) [clone .isra.0] (fastfeedforward.hpp:216)
==972215==    by 0x266BA8: gpt::FastFeedforwardNetwork::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) (fastfeedforward.hpp:675)
==972215==    by 0x26AF6C: gpt::FFFBlock::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:336)
==972215==    by 0x26BE52: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:344)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 37,749,120 bytes in 12 blocks are possibly lost in loss record 256 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x2261C9: gpt::FastFeedforwardNetwork::TrainingForward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>, bool) (fastfeedforward.hpp:428)
==972215==    by 0x26F05C: Forward (fastfeedforward.hpp:293)
==972215==    by 0x26F05C: gpt::FFFBlock::Forward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:288)
==972215==    by 0x26FC6C: gpt::GPT::__Forward(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:112)
==972215==    by 0x270162: gpt::GPT::ForwardCPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>, float*) (gpt.hpp:214)
==972215==    by 0x11BFC2: main (train_gpt2.cpp:439)
==972215== 
==972215== 37,749,120 bytes in 12 blocks are possibly lost in loss record 257 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x265E8A: LazyAllocateGradient (fastfeedforward.hpp:746)
==972215==    by 0x265E8A: gpt::FastFeedforwardNetwork::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) (fastfeedforward.hpp:623)
==972215==    by 0x26AF6C: gpt::FFFBlock::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:336)
==972215==    by 0x26BE52: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:344)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 50,332,032 bytes in 12 blocks are possibly lost in loss record 258 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EEB6: nn::Parameter::LazyAllocate(int) [clone .constprop.0] (Parameter.hpp:200)
==972215==    by 0x18076B: Parameter (Parameter.hpp:183)
==972215==    by 0x18076B: make_unique<nn::Parameter, nn::DataType&, int> (unique_ptr.h:1070)
==972215==    by 0x18076B: gpt::CausalSelfAttention::CausalSelfAttention(int, int, int) (AttentionLayer.hpp:38)
==972215==    by 0x191BE6: make_unique<gpt::CausalSelfAttention, int&, int&, int&> (unique_ptr.h:1070)
==972215==    by 0x191BE6: gpt::FFFBlock::FFFBlock(int, int, int) (Block.hpp:206)
==972215==    by 0x1927ED: make_unique<gpt::FFFBlock, int&, int&, int&> (unique_ptr.h:1070)
==972215==    by 0x1927ED: gpt::GPT::GPT(int, int, int, int, int, int) (gpt.hpp:38)
==972215==    by 0x1935D6: make_unique<gpt::GPT, int const&, int const&, int const&, int const&, int const&, int const&> (unique_ptr.h:1070)
==972215==    by 0x1935D6: gpt2::GPT2::InitializeFromScratch(gpt2::GPT2Config const&) (gpt2.hpp:87)
==972215==    by 0x11AAF9: main (train_gpt2.cpp:369)
==972215== 
==972215== 51,463,200 bytes in 1 blocks are possibly lost in loss record 261 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EEB6: nn::Parameter::LazyAllocate(int) [clone .constprop.0] (Parameter.hpp:200)
==972215==    by 0x11BE6E: Parameter (Parameter.hpp:183)
==972215==    by 0x11BE6E: main (train_gpt2.cpp:413)
==972215== 
==972215== 51,463,200 bytes in 1 blocks are possibly lost in loss record 262 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x27025C: SoftmaxForwardCPU (gpt.hpp:155)
==972215==    by 0x27025C: gpt::GPT::ForwardCPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>, float*) (gpt.hpp:227)
==972215==    by 0x11BFC2: main (train_gpt2.cpp:439)
==972215== 
==972215== 51,463,200 bytes in 1 blocks are possibly lost in loss record 263 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x173FA9: nn::Parameter::LazyAllocate(int) (Parameter.hpp:200)
==972215==    by 0x26C731: SoftmaxBackwardCPU (gpt.hpp:264)
==972215==    by 0x26C731: gpt::GPT::BackwardCPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:276)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 84,935,040 bytes in 12 blocks are possibly lost in loss record 264 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EEB6: nn::Parameter::LazyAllocate(int) [clone .constprop.0] (Parameter.hpp:200)
==972215==    by 0x18006A: Parameter (Parameter.hpp:183)
==972215==    by 0x18006A: make_unique<nn::Parameter, nn::DataType&, int> (unique_ptr.h:1070)
==972215==    by 0x18006A: nn::Linear::Linear(int, int, bool) (Linear.hpp:21)
==972215==    by 0x180363: make_unique<nn::Linear, int&, int> (unique_ptr.h:1070)
==972215==    by 0x180363: gpt::CausalSelfAttention::CausalSelfAttention(int, int, int) (AttentionLayer.hpp:31)
==972215==    by 0x191BE6: make_unique<gpt::CausalSelfAttention, int&, int&, int&> (unique_ptr.h:1070)
==972215==    by 0x191BE6: gpt::FFFBlock::FFFBlock(int, int, int) (Block.hpp:206)
==972215==    by 0x1927ED: make_unique<gpt::FFFBlock, int&, int&, int&> (unique_ptr.h:1070)
==972215==    by 0x1927ED: gpt::GPT::GPT(int, int, int, int, int, int) (gpt.hpp:38)
==972215==    by 0x1935D6: make_unique<gpt::GPT, int const&, int const&, int const&, int const&, int const&, int const&> (unique_ptr.h:1070)
==972215==    by 0x1935D6: gpt2::GPT2::InitializeFromScratch(gpt2::GPT2Config const&) (gpt2.hpp:87)
==972215==    by 0x11AAF9: main (train_gpt2.cpp:369)
==972215== 
==972215== 84,935,040 bytes in 12 blocks are possibly lost in loss record 265 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x264294: LazyAllocateGradient (TensorAssign.h:146)
==972215==    by 0x264294: nn::Linear::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>) (Linear.hpp:63)
==972215==    by 0x26B18B: gpt::FFFBlock::Backward(Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float const, 3, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<float, 3, 1, long>, 16, Eigen::MakePointer>) (Block.hpp:358)
==972215==    by 0x26BE52: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:344)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 113,247,744 bytes in 48 blocks are possibly lost in loss record 266 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EEB6: nn::Parameter::LazyAllocate(int) [clone .constprop.0] (Parameter.hpp:200)
==972215==    by 0x19112D: Parameter (Parameter.hpp:183)
==972215==    by 0x19112D: make_unique<nn::Parameter, nn::DataType&, int> (unique_ptr.h:1070)
==972215==    by 0x19112D: Linear (Linear.hpp:21)
==972215==    by 0x19112D: make_unique<nn::Linear, int&, int&> (unique_ptr.h:1070)
==972215==    by 0x19112D: LeafNetwork (fastfeedforward.hpp:119)
==972215==    by 0x19112D: make_unique<gpt::LeafNetwork, int&, int&, int&, int&> (unique_ptr.h:1070)
==972215==    by 0x19112D: gpt::FastFeedforwardNetwork::FastFeedforwardNetwork(int, int, int, int, bool, float) (fastfeedforward.hpp:274)
==972215==    by 0x191F63: make_unique<gpt::FastFeedforwardNetwork, int&, int&, int&, int&> (unique_ptr.h:1070)
==972215==    by 0x191F63: gpt::FFFBlock::FFFBlock(int, int, int) (Block.hpp:222)
==972215==    by 0x1927ED: make_unique<gpt::FFFBlock, int&, int&, int&> (unique_ptr.h:1070)
==972215==    by 0x1927ED: gpt::GPT::GPT(int, int, int, int, int, int) (gpt.hpp:38)
==972215==    by 0x1935D6: make_unique<gpt::GPT, int const&, int const&, int const&, int const&, int const&, int const&> (unique_ptr.h:1070)
==972215==    by 0x1935D6: gpt2::GPT2::InitializeFromScratch(gpt2::GPT2Config const&) (gpt2.hpp:87)
==972215==    by 0x11AAF9: main (train_gpt2.cpp:369)
==972215== 
==972215== 113,247,744 bytes in 48 blocks are possibly lost in loss record 267 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EEB6: nn::Parameter::LazyAllocate(int) [clone .constprop.0] (Parameter.hpp:200)
==972215==    by 0x1910FD: Parameter (Parameter.hpp:183)
==972215==    by 0x1910FD: make_unique<nn::Parameter, nn::DataType&, int> (unique_ptr.h:1070)
==972215==    by 0x1910FD: Linear (Linear.hpp:21)
==972215==    by 0x1910FD: make_unique<nn::Linear, int&, int&> (unique_ptr.h:1070)
==972215==    by 0x1910FD: LeafNetwork (fastfeedforward.hpp:120)
==972215==    by 0x1910FD: make_unique<gpt::LeafNetwork, int&, int&, int&, int&> (unique_ptr.h:1070)
==972215==    by 0x1910FD: gpt::FastFeedforwardNetwork::FastFeedforwardNetwork(int, int, int, int, bool, float) (fastfeedforward.hpp:274)
==972215==    by 0x191F63: make_unique<gpt::FastFeedforwardNetwork, int&, int&, int&, int&> (unique_ptr.h:1070)
==972215==    by 0x191F63: gpt::FFFBlock::FFFBlock(int, int, int) (Block.hpp:222)
==972215==    by 0x1927ED: make_unique<gpt::FFFBlock, int&, int&, int&> (unique_ptr.h:1070)
==972215==    by 0x1927ED: gpt::GPT::GPT(int, int, int, int, int, int) (gpt.hpp:38)
==972215==    by 0x1935D6: make_unique<gpt::GPT, int const&, int const&, int const&, int const&, int const&, int const&> (unique_ptr.h:1070)
==972215==    by 0x1935D6: gpt2::GPT2::InitializeFromScratch(gpt2::GPT2Config const&) (gpt2.hpp:87)
==972215==    by 0x11AAF9: main (train_gpt2.cpp:369)
==972215== 
==972215== 154,389,536 bytes in 1 blocks are possibly lost in loss record 268 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EEB6: nn::Parameter::LazyAllocate(int) [clone .constprop.0] (Parameter.hpp:200)
==972215==    by 0x18006A: Parameter (Parameter.hpp:183)
==972215==    by 0x18006A: make_unique<nn::Parameter, nn::DataType&, int> (unique_ptr.h:1070)
==972215==    by 0x18006A: nn::Linear::Linear(int, int, bool) (Linear.hpp:21)
==972215==    by 0x192EF3: make_unique<nn::Linear, int&, int&> (unique_ptr.h:1070)
==972215==    by 0x192EF3: gpt::GPT::GPT(int, int, int, int, int, int) (gpt.hpp:42)
==972215==    by 0x1935D6: make_unique<gpt::GPT, int const&, int const&, int const&, int const&, int const&, int const&> (unique_ptr.h:1070)
==972215==    by 0x1935D6: gpt2::GPT2::InitializeFromScratch(gpt2::GPT2Config const&) (gpt2.hpp:87)
==972215==    by 0x11AAF9: main (train_gpt2.cpp:369)
==972215== 
==972215== 154,533,920 bytes in 1 blocks are possibly lost in loss record 269 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EEB6: nn::Parameter::LazyAllocate(int) [clone .constprop.0] (Parameter.hpp:200)
==972215==    by 0x19325A: Parameter (Parameter.hpp:183)
==972215==    by 0x19325A: make_unique<nn::Parameter, nn::DataType, int> (unique_ptr.h:1070)
==972215==    by 0x19325A: Embedding (Embedding.hpp:17)
==972215==    by 0x19325A: make_unique<nn::Embedding, int&, int&> (unique_ptr.h:1070)
==972215==    by 0x19325A: gpt::GPT::GPT(int, int, int, int, int, int) (gpt.hpp:35)
==972215==    by 0x1935D6: make_unique<gpt::GPT, int const&, int const&, int const&, int const&, int const&, int const&> (unique_ptr.h:1070)
==972215==    by 0x1935D6: gpt2::GPT2::InitializeFromScratch(gpt2::GPT2Config const&) (gpt2.hpp:87)
==972215==    by 0x11AAF9: main (train_gpt2.cpp:369)
==972215== 
==972215== 154,533,920 bytes in 1 blocks are possibly lost in loss record 270 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EE23: Allocate (Parameter.hpp:361)
==972215==    by 0x12EE23: nn::Parameter::LazyAllocateGradient() [clone .part.0] (Parameter.hpp:210)
==972215==    by 0x26B864: LazyAllocateGradient (gpt.hpp:291)
==972215==    by 0x26B864: gpt::GPT::BackwardGPU(Eigen::TensorMap<Eigen::Tensor<int const, 2, 1, long>, 16, Eigen::MakePointer>) (gpt.hpp:289)
==972215==    by 0x11B1B8: main (train_gpt2.cpp:606)
==972215== 
==972215== 498,136,592 bytes in 364 blocks are possibly lost in loss record 271 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EEB6: nn::Parameter::LazyAllocate(int) [clone .constprop.0] (Parameter.hpp:200)
==972215==    by 0x1816D7: Parameter (Parameter.hpp:183)
==972215==    by 0x1816D7: make_unique<nn::Parameter, nn::DataType, long int> (unique_ptr.h:1070)
==972215==    by 0x1816D7: optim::AdamW::AdamW(std::vector<nn::Parameter*, std::allocator<nn::Parameter*> >, float, float, float, float, float) (optim.hpp:42)
==972215==    by 0x11AFC7: main (train_gpt2.cpp:417)
==972215== 
==972215== 498,136,592 bytes in 364 blocks are possibly lost in loss record 272 of 272
==972215==    at 0x4846828: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==972215==    by 0x12E9F4: handmade_aligned_malloc (Memory.h:105)
==972215==    by 0x12E9F4: aligned_malloc (Memory.h:188)
==972215==    by 0x12E9F4: Eigen::ThreadPoolDevice::allocate(unsigned long) const [clone .isra.0] (TensorDeviceThreadPool.h:60)
==972215==    by 0x12EEB6: nn::Parameter::LazyAllocate(int) [clone .constprop.0] (Parameter.hpp:200)
==972215==    by 0x1816EA: Parameter (Parameter.hpp:183)
==972215==    by 0x1816EA: make_unique<nn::Parameter, nn::DataType, long int> (unique_ptr.h:1070)
==972215==    by 0x1816EA: optim::AdamW::AdamW(std::vector<nn::Parameter*, std::allocator<nn::Parameter*> >, float, float, float, float, float) (optim.hpp:44)
==972215==    by 0x11AFC7: main (train_gpt2.cpp:417)
==972215== 
==972215== LEAK SUMMARY:
==972215==    definitely lost: 0 bytes in 0 blocks
==972215==    indirectly lost: 0 bytes in 0 blocks
==972215==      possibly lost: 2,661,369,692 bytes in 2,144 blocks
==972215==    still reachable: 113,994,727 bytes in 203,996 blocks
==972215==         suppressed: 0 bytes in 0 blocks
==972215== Reachable blocks (those to which a pointer was found) are not shown.
==972215== To see them, rerun with: --leak-check=full --show-leak-kinds=all
==972215== 
==972215== For lists of detected and suppressed errors, rerun with: -s
==972215== ERROR SUMMARY: 123 errors from 123 contexts (suppressed: 0 from 0)
