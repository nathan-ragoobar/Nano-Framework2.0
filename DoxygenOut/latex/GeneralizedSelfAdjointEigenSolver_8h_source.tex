\doxysection{Generalized\+Self\+Adjoint\+Eigen\+Solver.\+h}
\hypertarget{GeneralizedSelfAdjointEigenSolver_8h_source}{}\label{GeneralizedSelfAdjointEigenSolver_8h_source}\index{eigen/Eigen/src/Eigenvalues/GeneralizedSelfAdjointEigenSolver.h@{eigen/Eigen/src/Eigenvalues/GeneralizedSelfAdjointEigenSolver.h}}
\mbox{\hyperlink{GeneralizedSelfAdjointEigenSolver_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ This\ file\ is\ part\ of\ Eigen,\ a\ lightweight\ C++\ template\ library}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ for\ linear\ algebra.}}
\DoxyCodeLine{00003\ \textcolor{comment}{//}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ Copyright\ (C)\ 2008-\/2010\ Gael\ Guennebaud\ <gael.guennebaud@inria.fr>}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ Copyright\ (C)\ 2010\ Jitse\ Niesen\ <jitse@maths.leeds.ac.uk>}}
\DoxyCodeLine{00006\ \textcolor{comment}{//}}
\DoxyCodeLine{00007\ \textcolor{comment}{//\ This\ Source\ Code\ Form\ is\ subject\ to\ the\ terms\ of\ the\ Mozilla}}
\DoxyCodeLine{00008\ \textcolor{comment}{//\ Public\ License\ v.\ 2.0.\ If\ a\ copy\ of\ the\ MPL\ was\ not\ distributed}}
\DoxyCodeLine{00009\ \textcolor{comment}{//\ with\ this\ file,\ You\ can\ obtain\ one\ at\ http://mozilla.org/MPL/2.0/.}}
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#ifndef\ EIGEN\_GENERALIZEDSELFADJOINTEIGENSOLVER\_H}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#define\ EIGEN\_GENERALIZEDSELFADJOINTEIGENSOLVER\_H}}
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{Tridiagonalization_8h}{./Tridiagonalization.h}}"{}}}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceEigen}{Eigen}}\ \{\ }
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00047\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ \_MatrixType>}
\DoxyCodeLine{00048\ \textcolor{keyword}{class\ }GeneralizedSelfAdjointEigenSolver\ :\ \textcolor{keyword}{public}\ SelfAdjointEigenSolver<\_MatrixType>}
\DoxyCodeLine{00049\ \{}
\DoxyCodeLine{00050\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{classEigen_1_1SelfAdjointEigenSolver_af3466b3809be4a7738d84493d80d4737}{SelfAdjointEigenSolver<\_MatrixType>}}\ Base;}
\DoxyCodeLine{00051\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00053\ \ \ \ \ \textcolor{keyword}{typedef}\ \_MatrixType\ \mbox{\hyperlink{classEigen_1_1GeneralizedSelfAdjointEigenSolver_a9d262998f06f66f0847a0e3b58d6fcd4}{MatrixType}};}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00062\ \ \ \ \ \mbox{\hyperlink{classEigen_1_1GeneralizedSelfAdjointEigenSolver_a501effdbf722c0609ea05ff3fd4cc721}{GeneralizedSelfAdjointEigenSolver}}()\ :\ \mbox{\hyperlink{classEigen_1_1SelfAdjointEigenSolver}{Base}}()\ \{\}}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00076\ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{classEigen_1_1GeneralizedSelfAdjointEigenSolver_aac849f01a8c6148c645acd10bd3a9b0e}{GeneralizedSelfAdjointEigenSolver}}(\mbox{\hyperlink{classEigen_1_1SelfAdjointEigenSolver_a6a953addf8102a1dc35476cdb10afbf2}{Index}}\ \mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2low__level__alloc_8cc_aad9b71a31372d5c0ab9c23163efe9544}{size}})}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{classEigen_1_1SelfAdjointEigenSolver}{Base}}(\mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2low__level__alloc_8cc_aad9b71a31372d5c0ab9c23163efe9544}{size}})}
\DoxyCodeLine{00078\ \ \ \ \ \{\}}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00106\ \ \ \ \ \mbox{\hyperlink{classEigen_1_1GeneralizedSelfAdjointEigenSolver_addc0409c9cb1a5ac9cbbd00efe68908e}{GeneralizedSelfAdjointEigenSolver}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1GeneralizedSelfAdjointEigenSolver_a9d262998f06f66f0847a0e3b58d6fcd4}{MatrixType}}\&\ matA,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1GeneralizedSelfAdjointEigenSolver_a9d262998f06f66f0847a0e3b58d6fcd4}{MatrixType}}\&\ matB,}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ options\ =\ \mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a7f7d17fba3c9bb92158e346d5979d0f4}{ComputeEigenvectors}}|\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a5eb11a88a4bd445f58f1b24598d3848f}{Ax\_lBx}})}
\DoxyCodeLine{00108\ \ \ \ \ \ \ :\ \mbox{\hyperlink{classEigen_1_1SelfAdjointEigenSolver}{Base}}(matA.cols())}
\DoxyCodeLine{00109\ \ \ \ \ \{}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \mbox{\hyperlink{classEigen_1_1GeneralizedSelfAdjointEigenSolver_a724764fe196612b752042692156ed023}{compute}}(matA,\ matB,\ options);}
\DoxyCodeLine{00111\ \ \ \ \ \}}
\DoxyCodeLine{00112\ }
\DoxyCodeLine{00153\ \ \ \ \ \mbox{\hyperlink{classEigen_1_1GeneralizedSelfAdjointEigenSolver}{GeneralizedSelfAdjointEigenSolver}}\&\ \mbox{\hyperlink{classEigen_1_1GeneralizedSelfAdjointEigenSolver_a724764fe196612b752042692156ed023}{compute}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1GeneralizedSelfAdjointEigenSolver_a9d262998f06f66f0847a0e3b58d6fcd4}{MatrixType}}\&\ matA,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1GeneralizedSelfAdjointEigenSolver_a9d262998f06f66f0847a0e3b58d6fcd4}{MatrixType}}\&\ matB,}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ options\ =\ \mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a7f7d17fba3c9bb92158e346d5979d0f4}{ComputeEigenvectors}}|\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a5eb11a88a4bd445f58f1b24598d3848f}{Ax\_lBx}});}
\DoxyCodeLine{00155\ }
\DoxyCodeLine{00156\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00157\ }
\DoxyCodeLine{00158\ \};}
\DoxyCodeLine{00159\ }
\DoxyCodeLine{00160\ }
\DoxyCodeLine{00161\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00162\ \mbox{\hyperlink{classEigen_1_1GeneralizedSelfAdjointEigenSolver}{GeneralizedSelfAdjointEigenSolver<MatrixType>}}\&\ \mbox{\hyperlink{classEigen_1_1GeneralizedSelfAdjointEigenSolver_a724764fe196612b752042692156ed023}{GeneralizedSelfAdjointEigenSolver<MatrixType>::}}}
\DoxyCodeLine{00163\ \mbox{\hyperlink{classEigen_1_1GeneralizedSelfAdjointEigenSolver_a724764fe196612b752042692156ed023}{compute}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1GeneralizedSelfAdjointEigenSolver_a9d262998f06f66f0847a0e3b58d6fcd4}{MatrixType}}\&\ matA,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1GeneralizedSelfAdjointEigenSolver_a9d262998f06f66f0847a0e3b58d6fcd4}{MatrixType}}\&\ matB,\ \textcolor{keywordtype}{int}\ options)}
\DoxyCodeLine{00164\ \{}
\DoxyCodeLine{00165\ \ \ \mbox{\hyperlink{Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(matA.cols()==matA.rows()\ \&\&\ matB.rows()==matA.rows()\ \&\&\ matB.cols()==matB.rows());}
\DoxyCodeLine{00166\ \ \ \mbox{\hyperlink{Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}((options\&\string~(\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a58b2e52b6b46818217f67d2b38ee90e3}{EigVecMask}}|\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a2cd73a7e08a5f26915a562a7f88c6465}{GenEigMask}}))==0}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ \ \ \&\&\ (options\&\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a58b2e52b6b46818217f67d2b38ee90e3}{EigVecMask}})!=\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a58b2e52b6b46818217f67d2b38ee90e3}{EigVecMask}}}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \ \ \&\&\ ((options\&\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a2cd73a7e08a5f26915a562a7f88c6465}{GenEigMask}})==0\ ||\ (options\&\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a2cd73a7e08a5f26915a562a7f88c6465}{GenEigMask}})==\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a5eb11a88a4bd445f58f1b24598d3848f}{Ax\_lBx}}}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \ \ \ ||\ (options\&\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a2cd73a7e08a5f26915a562a7f88c6465}{GenEigMask}})==\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a9a7d9813cec527e299a36b749b0f7e1e}{ABx\_lx}}\ ||\ (options\&\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a2cd73a7e08a5f26915a562a7f88c6465}{GenEigMask}})==\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a9870817d373c41ba0dc7f6b5ab0895b8}{BAx\_lx}})}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ \ \ \&\&\ \textcolor{stringliteral}{"{}invalid\ option\ parameter"{}});}
\DoxyCodeLine{00171\ }
\DoxyCodeLine{00172\ \ \ \textcolor{keywordtype}{bool}\ computeEigVecs\ =\ ((options\&\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a58b2e52b6b46818217f67d2b38ee90e3}{EigVecMask}})==0)\ ||\ ((options\&\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a58b2e52b6b46818217f67d2b38ee90e3}{EigVecMask}})==\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a7f7d17fba3c9bb92158e346d5979d0f4}{ComputeEigenvectors}});}
\DoxyCodeLine{00173\ }
\DoxyCodeLine{00174\ \ \ \textcolor{comment}{//\ Compute\ the\ cholesky\ decomposition\ of\ matB\ =\ L\ L'\ =\ U'U}}
\DoxyCodeLine{00175\ \ \ \mbox{\hyperlink{classEigen_1_1LLT}{LLT<MatrixType>}}\ cholB(matB);}
\DoxyCodeLine{00176\ }
\DoxyCodeLine{00177\ \ \ \textcolor{keywordtype}{int}\ type\ =\ (options\&\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a2cd73a7e08a5f26915a562a7f88c6465}{GenEigMask}});}
\DoxyCodeLine{00178\ \ \ \textcolor{keywordflow}{if}(type==0)}
\DoxyCodeLine{00179\ \ \ \ \ type\ =\ \mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a5eb11a88a4bd445f58f1b24598d3848f}{Ax\_lBx}};}
\DoxyCodeLine{00180\ }
\DoxyCodeLine{00181\ \ \ \textcolor{keywordflow}{if}(type==\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a5eb11a88a4bd445f58f1b24598d3848f}{Ax\_lBx}})}
\DoxyCodeLine{00182\ \ \ \{}
\DoxyCodeLine{00183\ \ \ \ \ \textcolor{comment}{//\ compute\ C\ =\ inv(L)\ A\ inv(L')}}
\DoxyCodeLine{00184\ \ \ \ \ \mbox{\hyperlink{classEigen_1_1GeneralizedSelfAdjointEigenSolver_a9d262998f06f66f0847a0e3b58d6fcd4}{MatrixType}}\ matC\ =\ matA.template\ selfadjointView<Lower>();}
\DoxyCodeLine{00185\ \ \ \ \ cholB.\mbox{\hyperlink{classEigen_1_1LLT_a45239508f440b23e64db345137b0eb05}{matrixL}}().template\ solveInPlace<OnTheLeft>(matC);}
\DoxyCodeLine{00186\ \ \ \ \ cholB.\mbox{\hyperlink{classEigen_1_1LLT_a2ab17633f31165ca6bc5e372541c6c05}{matrixU}}().template\ solveInPlace<OnTheRight>(matC);}
\DoxyCodeLine{00187\ }
\DoxyCodeLine{00188\ \ \ \ \ Base::compute(matC,\ computeEigVecs\ ?\ \mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a7f7d17fba3c9bb92158e346d5979d0f4}{ComputeEigenvectors}}\ :\ \mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9afd06633f270207c373875fd7ca03e906}{EigenvaluesOnly}}\ );}
\DoxyCodeLine{00189\ }
\DoxyCodeLine{00190\ \ \ \ \ \textcolor{comment}{//\ transform\ back\ the\ eigen\ vectors:\ evecs\ =\ inv(U)\ *\ evecs}}
\DoxyCodeLine{00191\ \ \ \ \ \textcolor{keywordflow}{if}(computeEigVecs)}
\DoxyCodeLine{00192\ \ \ \ \ \ \ cholB.\mbox{\hyperlink{classEigen_1_1LLT_a2ab17633f31165ca6bc5e372541c6c05}{matrixU}}().solveInPlace(Base::m\_eivec);}
\DoxyCodeLine{00193\ \ \ \}}
\DoxyCodeLine{00194\ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(type==\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a9a7d9813cec527e299a36b749b0f7e1e}{ABx\_lx}})}
\DoxyCodeLine{00195\ \ \ \{}
\DoxyCodeLine{00196\ \ \ \ \ \textcolor{comment}{//\ compute\ C\ =\ L'\ A\ L}}
\DoxyCodeLine{00197\ \ \ \ \ \mbox{\hyperlink{classEigen_1_1GeneralizedSelfAdjointEigenSolver_a9d262998f06f66f0847a0e3b58d6fcd4}{MatrixType}}\ matC\ =\ matA.template\ selfadjointView<Lower>();}
\DoxyCodeLine{00198\ \ \ \ \ matC\ =\ matC\ *\ cholB.\mbox{\hyperlink{classEigen_1_1LLT_a45239508f440b23e64db345137b0eb05}{matrixL}}();}
\DoxyCodeLine{00199\ \ \ \ \ matC\ =\ cholB.\mbox{\hyperlink{classEigen_1_1LLT_a2ab17633f31165ca6bc5e372541c6c05}{matrixU}}()\ *\ matC;}
\DoxyCodeLine{00200\ }
\DoxyCodeLine{00201\ \ \ \ \ Base::compute(matC,\ computeEigVecs\ ?\ \mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a7f7d17fba3c9bb92158e346d5979d0f4}{ComputeEigenvectors}}\ :\ \mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9afd06633f270207c373875fd7ca03e906}{EigenvaluesOnly}});}
\DoxyCodeLine{00202\ }
\DoxyCodeLine{00203\ \ \ \ \ \textcolor{comment}{//\ transform\ back\ the\ eigen\ vectors:\ evecs\ =\ inv(U)\ *\ evecs}}
\DoxyCodeLine{00204\ \ \ \ \ \textcolor{keywordflow}{if}(computeEigVecs)}
\DoxyCodeLine{00205\ \ \ \ \ \ \ cholB.\mbox{\hyperlink{classEigen_1_1LLT_a2ab17633f31165ca6bc5e372541c6c05}{matrixU}}().solveInPlace(Base::m\_eivec);}
\DoxyCodeLine{00206\ \ \ \}}
\DoxyCodeLine{00207\ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(type==\mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a9870817d373c41ba0dc7f6b5ab0895b8}{BAx\_lx}})}
\DoxyCodeLine{00208\ \ \ \{}
\DoxyCodeLine{00209\ \ \ \ \ \textcolor{comment}{//\ compute\ C\ =\ L'\ A\ L}}
\DoxyCodeLine{00210\ \ \ \ \ \mbox{\hyperlink{classEigen_1_1GeneralizedSelfAdjointEigenSolver_a9d262998f06f66f0847a0e3b58d6fcd4}{MatrixType}}\ matC\ =\ matA.template\ selfadjointView<Lower>();}
\DoxyCodeLine{00211\ \ \ \ \ matC\ =\ matC\ *\ cholB.\mbox{\hyperlink{classEigen_1_1LLT_a45239508f440b23e64db345137b0eb05}{matrixL}}();}
\DoxyCodeLine{00212\ \ \ \ \ matC\ =\ cholB.\mbox{\hyperlink{classEigen_1_1LLT_a2ab17633f31165ca6bc5e372541c6c05}{matrixU}}()\ *\ matC;}
\DoxyCodeLine{00213\ }
\DoxyCodeLine{00214\ \ \ \ \ Base::compute(matC,\ computeEigVecs\ ?\ \mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a7f7d17fba3c9bb92158e346d5979d0f4}{ComputeEigenvectors}}\ :\ \mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9afd06633f270207c373875fd7ca03e906}{EigenvaluesOnly}});}
\DoxyCodeLine{00215\ }
\DoxyCodeLine{00216\ \ \ \ \ \textcolor{comment}{//\ transform\ back\ the\ eigen\ vectors:\ evecs\ =\ L\ *\ evecs}}
\DoxyCodeLine{00217\ \ \ \ \ \textcolor{keywordflow}{if}(computeEigVecs)}
\DoxyCodeLine{00218\ \ \ \ \ \ \ Base::m\_eivec\ =\ cholB.\mbox{\hyperlink{classEigen_1_1LLT_a45239508f440b23e64db345137b0eb05}{matrixL}}()\ *\ Base::m\_eivec;}
\DoxyCodeLine{00219\ \ \ \}}
\DoxyCodeLine{00220\ }
\DoxyCodeLine{00221\ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00222\ \}}
\DoxyCodeLine{00223\ }
\DoxyCodeLine{00224\ \}\ \textcolor{comment}{//\ end\ namespace\ Eigen}}
\DoxyCodeLine{00225\ }
\DoxyCodeLine{00226\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ EIGEN\_GENERALIZEDSELFADJOINTEIGENSOLVER\_H}}

\end{DoxyCode}
