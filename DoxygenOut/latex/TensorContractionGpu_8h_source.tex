\doxysection{Tensor\+Contraction\+Gpu.\+h}
\hypertarget{TensorContractionGpu_8h_source}{}\label{TensorContractionGpu_8h_source}\index{eigen/unsupported/Eigen/CXX11/src/Tensor/TensorContractionGpu.h@{eigen/unsupported/Eigen/CXX11/src/Tensor/TensorContractionGpu.h}}
\mbox{\hyperlink{TensorContractionGpu_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ This\ file\ is\ part\ of\ Eigen,\ a\ lightweight\ C++\ template\ library}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ for\ linear\ algebra.}}
\DoxyCodeLine{00003\ \textcolor{comment}{//}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ Copyright\ (C)\ 2014-\/2015\ Benoit\ Steiner\ <benoit.steiner.goog@gmail.com>}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ Copyright\ (C)\ 2015\ Navdeep\ Jaitly\ <ndjaitly@google.com>}}
\DoxyCodeLine{00006\ \textcolor{comment}{//\ Copyright\ (C)\ 2014\ Eric\ Martin\ <eric@ericmart.in>}}
\DoxyCodeLine{00007\ \textcolor{comment}{//}}
\DoxyCodeLine{00008\ \textcolor{comment}{//\ This\ Source\ Code\ Form\ is\ subject\ to\ the\ terms\ of\ the\ Mozilla}}
\DoxyCodeLine{00009\ \textcolor{comment}{//\ Public\ License\ v.\ 2.0.\ If\ a\ copy\ of\ the\ MPL\ was\ not\ distributed}}
\DoxyCodeLine{00010\ \textcolor{comment}{//\ with\ this\ file,\ You\ can\ obtain\ one\ at\ http://mozilla.org/MPL/2.0/.}}
\DoxyCodeLine{00011\ }
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#ifndef\ EIGEN\_CXX11\_TENSOR\_TENSOR\_CONTRACTION\_GPU\_H}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#define\ EIGEN\_CXX11\_TENSOR\_TENSOR\_CONTRACTION\_GPU\_H}}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#if\ defined(EIGEN\_USE\_GPU)\ \&\&\ defined(EIGEN\_GPUCC)}}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00017\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceEigen}{Eigen}}\ \{}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Scalar,\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}},\ \textcolor{keyword}{typename}\ LhsMapper,}
\DoxyCodeLine{00020\ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typename}\ RhsMapper,\ \textcolor{keyword}{typename}\ OutputMapper,\ \textcolor{keywordtype}{bool}\ needs\_edge\_check>}
\DoxyCodeLine{00021\ \_\_device\_\_\ \mbox{\hyperlink{Macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00022\ EigenContractionKernelInternal(\textcolor{keyword}{const}\ LhsMapper\ lhs,\ \textcolor{keyword}{const}\ RhsMapper\ rhs,}
\DoxyCodeLine{00023\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ OutputMapper\ output,\ Scalar*\ lhs\_shmem,\ Scalar*\ rhs\_shmem,}
\DoxyCodeLine{00024\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ m\_size,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ n\_size,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ k\_size)\ \{}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00026\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ m\_block\_idx\ =\ blockIdx.x;}
\DoxyCodeLine{00027\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ n\_block\_idx\ =\ blockIdx.y;}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ base\_m\ =\ 64\ *\ m\_block\_idx;}
\DoxyCodeLine{00030\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ base\_n\ =\ 64\ *\ n\_block\_idx;}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ \ \ \textcolor{comment}{//\ declare\ and\ initialize\ 64\ registers\ for\ output\ 8x8\ block}}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00034\ \ \ \textcolor{comment}{//\ prefetch\ registers}}
\DoxyCodeLine{00035\ \ \ Scalar\ lhs\_pf0;}
\DoxyCodeLine{00036\ \ \ Scalar\ lhs\_pf1;}
\DoxyCodeLine{00037\ \ \ Scalar\ lhs\_pf2;}
\DoxyCodeLine{00038\ \ \ Scalar\ lhs\_pf3;}
\DoxyCodeLine{00039\ \ \ Scalar\ lhs\_pf4;}
\DoxyCodeLine{00040\ \ \ Scalar\ lhs\_pf5;}
\DoxyCodeLine{00041\ \ \ Scalar\ lhs\_pf6;}
\DoxyCodeLine{00042\ \ \ Scalar\ lhs\_pf7;}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ \ \ Scalar\ rhs\_pf0;}
\DoxyCodeLine{00045\ \ \ Scalar\ rhs\_pf1;}
\DoxyCodeLine{00046\ \ \ Scalar\ rhs\_pf2;}
\DoxyCodeLine{00047\ \ \ Scalar\ rhs\_pf3;}
\DoxyCodeLine{00048\ \ \ Scalar\ rhs\_pf4;}
\DoxyCodeLine{00049\ \ \ Scalar\ rhs\_pf5;}
\DoxyCodeLine{00050\ \ \ Scalar\ rhs\_pf6;}
\DoxyCodeLine{00051\ \ \ Scalar\ rhs\_pf7;}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00053\ \ \ \textcolor{comment}{//\ shared\ memory\ is\ formatted}}
\DoxyCodeLine{00054\ \ \ \textcolor{comment}{//\ (contract\ idx\ in\ block,\ nocontract\ idx\ in\ block,\ block\ idx)}}
\DoxyCodeLine{00055\ \ \ \textcolor{comment}{//\ where\ block\ idx\ is\ column\ major.\ This\ transposition\ limits\ the\ number\ of}}
\DoxyCodeLine{00056\ \ \ \textcolor{comment}{//\ bank\ conflicts\ when\ reading\ the\ LHS.\ The\ core\ idea\ is\ that\ since\ the\ contracting}}
\DoxyCodeLine{00057\ \ \ \textcolor{comment}{//\ index\ is\ shared\ by\ both\ sides,\ then\ the\ contracting\ index\ should\ be\ in\ threadIdx.x.}}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00059\ \ \ \textcolor{comment}{//\ On\ the\ LHS,\ we\ pad\ each\ row\ inside\ of\ each\ block\ with\ an\ extra\ element.\ This\ makes}}
\DoxyCodeLine{00060\ \ \ \textcolor{comment}{//\ each\ block\ 8\ rows\ of\ 9\ elements,\ which\ is\ 72\ elements.\ This\ gives\ no\ bank\ conflicts}}
\DoxyCodeLine{00061\ \ \ \textcolor{comment}{//\ on\ writes\ and\ very\ few\ 2-\/way\ conflicts\ on\ reads.\ There\ is\ an\ 8x8\ grid\ of\ these\ blocks.}}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00063\ \ \ \textcolor{comment}{//\ On\ the\ RHS\ we\ just\ add\ 8\ padding\ elements\ to\ the\ end\ of\ each\ block.\ This\ gives\ no\ bank}}
\DoxyCodeLine{00064\ \ \ \textcolor{comment}{//\ conflicts\ on\ writes\ and\ also\ none\ on\ reads.}}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00066\ \ \ \textcolor{comment}{//\ storage\ indices}}
\DoxyCodeLine{00067\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ lhs\_store\_idx\_base\ =\ threadIdx.y\ *\ 72\ +\ threadIdx.x\ *\ 9\ +\ threadIdx.z;}
\DoxyCodeLine{00068\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ rhs\_store\_idx\_base\ =\ threadIdx.y\ *\ 72\ +\ threadIdx.z\ *\ 8\ +\ threadIdx.x;}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00070\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ lhs\_store\_idx\_0\ =\ lhs\_store\_idx\_base\ +\ 576\ *\ 0;}
\DoxyCodeLine{00071\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ lhs\_store\_idx\_1\ =\ lhs\_store\_idx\_base\ +\ 576\ *\ 1;}
\DoxyCodeLine{00072\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ lhs\_store\_idx\_2\ =\ lhs\_store\_idx\_base\ +\ 576\ *\ 2;}
\DoxyCodeLine{00073\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ lhs\_store\_idx\_3\ =\ lhs\_store\_idx\_base\ +\ 576\ *\ 3;}
\DoxyCodeLine{00074\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ lhs\_store\_idx\_4\ =\ lhs\_store\_idx\_base\ +\ 576\ *\ 4;}
\DoxyCodeLine{00075\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ lhs\_store\_idx\_5\ =\ lhs\_store\_idx\_base\ +\ 576\ *\ 5;}
\DoxyCodeLine{00076\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ lhs\_store\_idx\_6\ =\ lhs\_store\_idx\_base\ +\ 576\ *\ 6;}
\DoxyCodeLine{00077\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ lhs\_store\_idx\_7\ =\ lhs\_store\_idx\_base\ +\ 576\ *\ 7;}
\DoxyCodeLine{00078\ }
\DoxyCodeLine{00079\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ rhs\_store\_idx\_0\ =\ rhs\_store\_idx\_base\ +\ 576\ *\ 0;}
\DoxyCodeLine{00080\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ rhs\_store\_idx\_1\ =\ rhs\_store\_idx\_base\ +\ 576\ *\ 1;}
\DoxyCodeLine{00081\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ rhs\_store\_idx\_2\ =\ rhs\_store\_idx\_base\ +\ 576\ *\ 2;}
\DoxyCodeLine{00082\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ rhs\_store\_idx\_3\ =\ rhs\_store\_idx\_base\ +\ 576\ *\ 3;}
\DoxyCodeLine{00083\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ rhs\_store\_idx\_4\ =\ rhs\_store\_idx\_base\ +\ 576\ *\ 4;}
\DoxyCodeLine{00084\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ rhs\_store\_idx\_5\ =\ rhs\_store\_idx\_base\ +\ 576\ *\ 5;}
\DoxyCodeLine{00085\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ rhs\_store\_idx\_6\ =\ rhs\_store\_idx\_base\ +\ 576\ *\ 6;}
\DoxyCodeLine{00086\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ rhs\_store\_idx\_7\ =\ rhs\_store\_idx\_base\ +\ 576\ *\ 7;}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00088\ \ \ \textcolor{comment}{//\ in\ the\ loading\ code,\ the\ following\ variables\ are\ important:}}
\DoxyCodeLine{00089\ \ \ \textcolor{comment}{//\ threadIdx.x:\ the\ vertical\ position\ in\ an\ 8x8\ block}}
\DoxyCodeLine{00090\ \ \ \textcolor{comment}{//\ threadIdx.y:\ the\ vertical\ index\ of\ the\ 8x8\ block\ in\ the\ grid}}
\DoxyCodeLine{00091\ \ \ \textcolor{comment}{//\ threadIdx.z:\ the\ horizontal\ position\ in\ an\ 8x8\ block}}
\DoxyCodeLine{00092\ \ \ \textcolor{comment}{//\ k:\ the\ horizontal\ index\ of\ the\ 8x8\ block\ in\ the\ grid}}
\DoxyCodeLine{00093\ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00094\ \ \ \textcolor{comment}{//\ The\ k\ parameter\ is\ implicit\ (it\ was\ the\ loop\ counter\ for\ a\ loop\ that\ went}}
\DoxyCodeLine{00095\ \ \ \textcolor{comment}{//\ from\ 0\ to\ <8,\ but\ now\ that\ loop\ is\ unrolled\ in\ the\ below\ code.}}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00097\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ load\_idx\_vert\ =\ threadIdx.x\ +\ 8\ *\ threadIdx.y;}
\DoxyCodeLine{00098\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ lhs\_vert\ =\ base\_m\ +\ load\_idx\_vert;}
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00100\ \textcolor{preprocessor}{\#define\ prefetchIntoRegisters(base\_k)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00101\ \textcolor{preprocessor}{\ \ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00102\ \textcolor{preprocessor}{\ \ \ \ lhs\_pf0\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00103\ \textcolor{preprocessor}{\ \ \ \ lhs\_pf1\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00104\ \textcolor{preprocessor}{\ \ \ \ lhs\_pf2\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00105\ \textcolor{preprocessor}{\ \ \ \ lhs\_pf3\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00106\ \textcolor{preprocessor}{\ \ \ \ lhs\_pf4\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00107\ \textcolor{preprocessor}{\ \ \ \ lhs\_pf5\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00108\ \textcolor{preprocessor}{\ \ \ \ lhs\_pf6\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00109\ \textcolor{preprocessor}{\ \ \ \ lhs\_pf7\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00110\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00111\ \textcolor{preprocessor}{\ \ \ \ rhs\_pf0\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00112\ \textcolor{preprocessor}{\ \ \ \ rhs\_pf1\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00113\ \textcolor{preprocessor}{\ \ \ \ rhs\_pf2\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00114\ \textcolor{preprocessor}{\ \ \ \ rhs\_pf3\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00115\ \textcolor{preprocessor}{\ \ \ \ rhs\_pf4\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00116\ \textcolor{preprocessor}{\ \ \ \ rhs\_pf5\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00117\ \textcolor{preprocessor}{\ \ \ \ rhs\_pf6\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00118\ \textcolor{preprocessor}{\ \ \ \ rhs\_pf7\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00119\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00120\ \textcolor{preprocessor}{\ \ \ \ if\ (!needs\_edge\_check\ ||\ lhs\_vert\ <\ m\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00121\ \textcolor{preprocessor}{\ \ \ \ \ \ const\ Index\ lhs\_horiz\_0\ =\ base\_k\ +\ threadIdx.z\ +\ 0\ *\ 8;\ \ \ \(\backslash\)}}
\DoxyCodeLine{00122\ \textcolor{preprocessor}{\ \ \ \ \ \ const\ Index\ lhs\_horiz\_1\ =\ base\_k\ +\ threadIdx.z\ +\ 1\ *\ 8;\ \ \ \(\backslash\)}}
\DoxyCodeLine{00123\ \textcolor{preprocessor}{\ \ \ \ \ \ const\ Index\ lhs\_horiz\_2\ =\ base\_k\ +\ threadIdx.z\ +\ 2\ *\ 8;\ \ \ \(\backslash\)}}
\DoxyCodeLine{00124\ \textcolor{preprocessor}{\ \ \ \ \ \ const\ Index\ lhs\_horiz\_3\ =\ base\_k\ +\ threadIdx.z\ +\ 3\ *\ 8;\ \ \ \(\backslash\)}}
\DoxyCodeLine{00125\ \textcolor{preprocessor}{\ \ \ \ \ \ const\ Index\ lhs\_horiz\_4\ =\ base\_k\ +\ threadIdx.z\ +\ 4\ *\ 8;\ \ \ \(\backslash\)}}
\DoxyCodeLine{00126\ \textcolor{preprocessor}{\ \ \ \ \ \ const\ Index\ lhs\_horiz\_5\ =\ base\_k\ +\ threadIdx.z\ +\ 5\ *\ 8;\ \ \ \(\backslash\)}}
\DoxyCodeLine{00127\ \textcolor{preprocessor}{\ \ \ \ \ \ const\ Index\ lhs\_horiz\_6\ =\ base\_k\ +\ threadIdx.z\ +\ 6\ *\ 8;\ \ \ \(\backslash\)}}
\DoxyCodeLine{00128\ \textcolor{preprocessor}{\ \ \ \ \ \ const\ Index\ lhs\_horiz\_7\ =\ base\_k\ +\ threadIdx.z\ +\ 7\ *\ 8;\ \ \ \(\backslash\)}}
\DoxyCodeLine{00129\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00130\ \textcolor{preprocessor}{\ \ \ \ \ \ if\ (!needs\_edge\_check\ ||\ lhs\_horiz\_7\ <\ k\_size)\ \{\ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00131\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf0\ =\ lhs(lhs\_vert,\ lhs\_horiz\_0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00132\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf1\ =\ lhs(lhs\_vert,\ lhs\_horiz\_1);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00133\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf2\ =\ lhs(lhs\_vert,\ lhs\_horiz\_2);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00134\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf3\ =\ lhs(lhs\_vert,\ lhs\_horiz\_3);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00135\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf4\ =\ lhs(lhs\_vert,\ lhs\_horiz\_4);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00136\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf5\ =\ lhs(lhs\_vert,\ lhs\_horiz\_5);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00137\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf6\ =\ lhs(lhs\_vert,\ lhs\_horiz\_6);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00138\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf7\ =\ lhs(lhs\_vert,\ lhs\_horiz\_7);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00139\ \textcolor{preprocessor}{\ \ \ \ \ \ \}\ else\ if\ (lhs\_horiz\_6\ <\ k\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00140\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf0\ =\ lhs(lhs\_vert,\ lhs\_horiz\_0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00141\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf1\ =\ lhs(lhs\_vert,\ lhs\_horiz\_1);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00142\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf2\ =\ lhs(lhs\_vert,\ lhs\_horiz\_2);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00143\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf3\ =\ lhs(lhs\_vert,\ lhs\_horiz\_3);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00144\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf4\ =\ lhs(lhs\_vert,\ lhs\_horiz\_4);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00145\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf5\ =\ lhs(lhs\_vert,\ lhs\_horiz\_5);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00146\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf6\ =\ lhs(lhs\_vert,\ lhs\_horiz\_6);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00147\ \textcolor{preprocessor}{\ \ \ \ \ \ \}\ else\ if\ (lhs\_horiz\_5\ <\ k\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00148\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf0\ =\ lhs(lhs\_vert,\ lhs\_horiz\_0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00149\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf1\ =\ lhs(lhs\_vert,\ lhs\_horiz\_1);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00150\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf2\ =\ lhs(lhs\_vert,\ lhs\_horiz\_2);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00151\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf3\ =\ lhs(lhs\_vert,\ lhs\_horiz\_3);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00152\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf4\ =\ lhs(lhs\_vert,\ lhs\_horiz\_4);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00153\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf5\ =\ lhs(lhs\_vert,\ lhs\_horiz\_5);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00154\ \textcolor{preprocessor}{\ \ \ \ \ \ \}\ else\ if\ (lhs\_horiz\_4\ <\ k\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00155\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf0\ =\ lhs(lhs\_vert,\ lhs\_horiz\_0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00156\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf1\ =\ lhs(lhs\_vert,\ lhs\_horiz\_1);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00157\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf2\ =\ lhs(lhs\_vert,\ lhs\_horiz\_2);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00158\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf3\ =\ lhs(lhs\_vert,\ lhs\_horiz\_3);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00159\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf4\ =\ lhs(lhs\_vert,\ lhs\_horiz\_4);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00160\ \textcolor{preprocessor}{\ \ \ \ \ \ \}\ else\ if\ (lhs\_horiz\_3\ <\ k\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00161\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf0\ =\ lhs(lhs\_vert,\ lhs\_horiz\_0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00162\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf1\ =\ lhs(lhs\_vert,\ lhs\_horiz\_1);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00163\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf2\ =\ lhs(lhs\_vert,\ lhs\_horiz\_2);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00164\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf3\ =\ lhs(lhs\_vert,\ lhs\_horiz\_3);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00165\ \textcolor{preprocessor}{\ \ \ \ \ \ \}\ else\ if\ (lhs\_horiz\_2\ <\ k\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00166\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf0\ =\ lhs(lhs\_vert,\ lhs\_horiz\_0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00167\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf1\ =\ lhs(lhs\_vert,\ lhs\_horiz\_1);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00168\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf2\ =\ lhs(lhs\_vert,\ lhs\_horiz\_2);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00169\ \textcolor{preprocessor}{\ \ \ \ \ \ \}\ else\ if\ (lhs\_horiz\_1\ <\ k\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00170\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf0\ =\ lhs(lhs\_vert,\ lhs\_horiz\_0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00171\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf1\ =\ lhs(lhs\_vert,\ lhs\_horiz\_1);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00172\ \textcolor{preprocessor}{\ \ \ \ \ \ \}\ else\ if\ (lhs\_horiz\_0\ <\ k\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00173\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ lhs\_pf0\ =\ lhs(lhs\_vert,\ lhs\_horiz\_0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00174\ \textcolor{preprocessor}{\ \ \ \ \ \ \}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00175\ \textcolor{preprocessor}{\ \ \ \ \}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00176\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00177\ \textcolor{preprocessor}{\ \ \ \ const\ Index\ rhs\_vert\ =\ base\_k\ +\ load\_idx\_vert;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00178\ \textcolor{preprocessor}{\ \ \ \ if\ (!needs\_edge\_check\ ||\ rhs\_vert\ <\ k\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00179\ \textcolor{preprocessor}{\ \ \ \ \ \ const\ Index\ rhs\_horiz\_0\ =\ base\_n\ +\ threadIdx.z\ +\ 0\ *\ 8;\ \ \ \(\backslash\)}}
\DoxyCodeLine{00180\ \textcolor{preprocessor}{\ \ \ \ \ \ const\ Index\ rhs\_horiz\_1\ =\ base\_n\ +\ threadIdx.z\ +\ 1\ *\ 8;\ \ \ \(\backslash\)}}
\DoxyCodeLine{00181\ \textcolor{preprocessor}{\ \ \ \ \ \ const\ Index\ rhs\_horiz\_2\ =\ base\_n\ +\ threadIdx.z\ +\ 2\ *\ 8;\ \ \ \(\backslash\)}}
\DoxyCodeLine{00182\ \textcolor{preprocessor}{\ \ \ \ \ \ const\ Index\ rhs\_horiz\_3\ =\ base\_n\ +\ threadIdx.z\ +\ 3\ *\ 8;\ \ \ \(\backslash\)}}
\DoxyCodeLine{00183\ \textcolor{preprocessor}{\ \ \ \ \ \ const\ Index\ rhs\_horiz\_4\ =\ base\_n\ +\ threadIdx.z\ +\ 4\ *\ 8;\ \ \ \(\backslash\)}}
\DoxyCodeLine{00184\ \textcolor{preprocessor}{\ \ \ \ \ \ const\ Index\ rhs\_horiz\_5\ =\ base\_n\ +\ threadIdx.z\ +\ 5\ *\ 8;\ \ \ \(\backslash\)}}
\DoxyCodeLine{00185\ \textcolor{preprocessor}{\ \ \ \ \ \ const\ Index\ rhs\_horiz\_6\ =\ base\_n\ +\ threadIdx.z\ +\ 6\ *\ 8;\ \ \ \(\backslash\)}}
\DoxyCodeLine{00186\ \textcolor{preprocessor}{\ \ \ \ \ \ const\ Index\ rhs\_horiz\_7\ =\ base\_n\ +\ threadIdx.z\ +\ 7\ *\ 8;\ \ \ \(\backslash\)}}
\DoxyCodeLine{00187\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00188\ \textcolor{preprocessor}{\ \ \ \ \ \ if\ (rhs\_horiz\_7\ <\ n\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00189\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf0\ =\ rhs(rhs\_vert,\ rhs\_horiz\_0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00190\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf1\ =\ rhs(rhs\_vert,\ rhs\_horiz\_1);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00191\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf2\ =\ rhs(rhs\_vert,\ rhs\_horiz\_2);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00192\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf3\ =\ rhs(rhs\_vert,\ rhs\_horiz\_3);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00193\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf4\ =\ rhs(rhs\_vert,\ rhs\_horiz\_4);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00194\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf5\ =\ rhs(rhs\_vert,\ rhs\_horiz\_5);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00195\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf6\ =\ rhs(rhs\_vert,\ rhs\_horiz\_6);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00196\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf7\ =\ rhs(rhs\_vert,\ rhs\_horiz\_7);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00197\ \textcolor{preprocessor}{\ \ \ \ \ \ \}\ else\ if\ (rhs\_horiz\_6\ <\ n\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00198\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf0\ =\ rhs(rhs\_vert,\ rhs\_horiz\_0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00199\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf1\ =\ rhs(rhs\_vert,\ rhs\_horiz\_1);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00200\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf2\ =\ rhs(rhs\_vert,\ rhs\_horiz\_2);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00201\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf3\ =\ rhs(rhs\_vert,\ rhs\_horiz\_3);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00202\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf4\ =\ rhs(rhs\_vert,\ rhs\_horiz\_4);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00203\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf5\ =\ rhs(rhs\_vert,\ rhs\_horiz\_5);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00204\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf6\ =\ rhs(rhs\_vert,\ rhs\_horiz\_6);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00205\ \textcolor{preprocessor}{\ \ \ \ \ \ \}\ else\ if\ (rhs\_horiz\_5\ <\ n\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00206\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf0\ =\ rhs(rhs\_vert,\ rhs\_horiz\_0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00207\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf1\ =\ rhs(rhs\_vert,\ rhs\_horiz\_1);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00208\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf2\ =\ rhs(rhs\_vert,\ rhs\_horiz\_2);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00209\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf3\ =\ rhs(rhs\_vert,\ rhs\_horiz\_3);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00210\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf4\ =\ rhs(rhs\_vert,\ rhs\_horiz\_4);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00211\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf5\ =\ rhs(rhs\_vert,\ rhs\_horiz\_5);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00212\ \textcolor{preprocessor}{\ \ \ \ \ \ \}\ else\ if\ (rhs\_horiz\_4\ <\ n\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00213\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf0\ =\ rhs(rhs\_vert,\ rhs\_horiz\_0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00214\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf1\ =\ rhs(rhs\_vert,\ rhs\_horiz\_1);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00215\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf2\ =\ rhs(rhs\_vert,\ rhs\_horiz\_2);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00216\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf3\ =\ rhs(rhs\_vert,\ rhs\_horiz\_3);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00217\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf4\ =\ rhs(rhs\_vert,\ rhs\_horiz\_4);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00218\ \textcolor{preprocessor}{\ \ \ \ \ \ \}\ else\ if\ (rhs\_horiz\_3\ <\ n\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00219\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf0\ =\ rhs(rhs\_vert,\ rhs\_horiz\_0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00220\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf1\ =\ rhs(rhs\_vert,\ rhs\_horiz\_1);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00221\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf2\ =\ rhs(rhs\_vert,\ rhs\_horiz\_2);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00222\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf3\ =\ rhs(rhs\_vert,\ rhs\_horiz\_3);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00223\ \textcolor{preprocessor}{\ \ \ \ \ \ \}\ else\ if\ (rhs\_horiz\_2\ <\ n\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00224\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf0\ =\ rhs(rhs\_vert,\ rhs\_horiz\_0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00225\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf1\ =\ rhs(rhs\_vert,\ rhs\_horiz\_1);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00226\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf2\ =\ rhs(rhs\_vert,\ rhs\_horiz\_2);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00227\ \textcolor{preprocessor}{\ \ \ \ \ \ \}\ else\ if\ (rhs\_horiz\_1\ <\ n\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00228\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf0\ =\ rhs(rhs\_vert,\ rhs\_horiz\_0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00229\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf1\ =\ rhs(rhs\_vert,\ rhs\_horiz\_1);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00230\ \textcolor{preprocessor}{\ \ \ \ \ \ \}\ else\ if\ (rhs\_horiz\_0\ <\ n\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00231\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ rhs\_pf0\ =\ rhs(rhs\_vert,\ rhs\_horiz\_0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00232\ \textcolor{preprocessor}{\ \ \ \ \ \ \}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00233\ \textcolor{preprocessor}{\ \ \ \ \}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00234\ \textcolor{preprocessor}{\ \ \}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00235\ \textcolor{preprocessor}{}}
\DoxyCodeLine{00236\ \textcolor{preprocessor}{\#define\ writeRegToShmem(\_)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00237\ \textcolor{preprocessor}{\ \ lhs\_shmem[lhs\_store\_idx\_0]\ =\ lhs\_pf0;\ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00238\ \textcolor{preprocessor}{\ \ rhs\_shmem[rhs\_store\_idx\_0]\ =\ rhs\_pf0;\ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00239\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00240\ \textcolor{preprocessor}{\ \ lhs\_shmem[lhs\_store\_idx\_1]\ =\ lhs\_pf1;\ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00241\ \textcolor{preprocessor}{\ \ rhs\_shmem[rhs\_store\_idx\_1]\ =\ rhs\_pf1;\ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00242\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00243\ \textcolor{preprocessor}{\ \ lhs\_shmem[lhs\_store\_idx\_2]\ =\ lhs\_pf2;\ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00244\ \textcolor{preprocessor}{\ \ rhs\_shmem[rhs\_store\_idx\_2]\ =\ rhs\_pf2;\ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00245\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00246\ \textcolor{preprocessor}{\ \ lhs\_shmem[lhs\_store\_idx\_3]\ =\ lhs\_pf3;\ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00247\ \textcolor{preprocessor}{\ \ rhs\_shmem[rhs\_store\_idx\_3]\ =\ rhs\_pf3;\ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00248\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00249\ \textcolor{preprocessor}{\ \ lhs\_shmem[lhs\_store\_idx\_4]\ =\ lhs\_pf4;\ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00250\ \textcolor{preprocessor}{\ \ rhs\_shmem[rhs\_store\_idx\_4]\ =\ rhs\_pf4;\ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00251\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00252\ \textcolor{preprocessor}{\ \ lhs\_shmem[lhs\_store\_idx\_5]\ =\ lhs\_pf5;\ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00253\ \textcolor{preprocessor}{\ \ rhs\_shmem[rhs\_store\_idx\_5]\ =\ rhs\_pf5;\ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00254\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00255\ \textcolor{preprocessor}{\ \ lhs\_shmem[lhs\_store\_idx\_6]\ =\ lhs\_pf6;\ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00256\ \textcolor{preprocessor}{\ \ rhs\_shmem[rhs\_store\_idx\_6]\ =\ rhs\_pf6;\ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00257\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00258\ \textcolor{preprocessor}{\ \ lhs\_shmem[lhs\_store\_idx\_7]\ =\ lhs\_pf7;\ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00259\ \textcolor{preprocessor}{\ \ rhs\_shmem[rhs\_store\_idx\_7]\ =\ rhs\_pf7;\ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00260\ \textcolor{preprocessor}{}}
\DoxyCodeLine{00261\ \ \ \textcolor{comment}{//\ declare\ and\ initialize\ result\ array}}
\DoxyCodeLine{00262\ \textcolor{preprocessor}{\#define\ res(i,\ j)\ \_res\_\#\#i\#\#j}}
\DoxyCodeLine{00263\ \textcolor{preprocessor}{\#define\ initResultRow(i)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00264\ \textcolor{preprocessor}{\ \ Scalar\ res(i,\ 0)\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00265\ \textcolor{preprocessor}{\ \ Scalar\ res(i,\ 1)\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00266\ \textcolor{preprocessor}{\ \ Scalar\ res(i,\ 2)\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00267\ \textcolor{preprocessor}{\ \ Scalar\ res(i,\ 3)\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00268\ \textcolor{preprocessor}{\ \ Scalar\ res(i,\ 4)\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00269\ \textcolor{preprocessor}{\ \ Scalar\ res(i,\ 5)\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00270\ \textcolor{preprocessor}{\ \ Scalar\ res(i,\ 6)\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00271\ \textcolor{preprocessor}{\ \ Scalar\ res(i,\ 7)\ =\ conv(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00272\ \textcolor{preprocessor}{}}
\DoxyCodeLine{00273\ \ \ internal::scalar\_cast\_op<int,\ Scalar>\ \mbox{\hyperlink{abseil-cpp_2absl_2strings_2internal_2str__format_2float__conversion_8cc_a972fc786e19cfc18cef3c79ae7b47e1e}{conv}};}
\DoxyCodeLine{00274\ \ \ initResultRow(0);}
\DoxyCodeLine{00275\ \ \ initResultRow(1);}
\DoxyCodeLine{00276\ \ \ initResultRow(2);}
\DoxyCodeLine{00277\ \ \ initResultRow(3);}
\DoxyCodeLine{00278\ \ \ initResultRow(4);}
\DoxyCodeLine{00279\ \ \ initResultRow(5);}
\DoxyCodeLine{00280\ \ \ initResultRow(6);}
\DoxyCodeLine{00281\ \ \ initResultRow(7);}
\DoxyCodeLine{00282\ \textcolor{preprocessor}{\#undef\ initResultRow}}
\DoxyCodeLine{00283\ }
\DoxyCodeLine{00284\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ base\_k\ =\ 0;\ base\_k\ <\ k\_size;\ base\_k\ +=\ 64)\ \{}
\DoxyCodeLine{00285\ \ \ \ \ \textcolor{comment}{//\ wait\ for\ previous\ iteration\ to\ finish\ with\ shmem.\ Despite\ common\ sense,}}
\DoxyCodeLine{00286\ \ \ \ \ \textcolor{comment}{//\ the\ code\ is\ a\ bit\ faster\ with\ this\ here\ then\ at\ bottom\ of\ loop}}
\DoxyCodeLine{00287\ \ \ \ \ \_\_syncthreads();}
\DoxyCodeLine{00288\ }
\DoxyCodeLine{00289\ \ \ \ \ prefetchIntoRegisters(base\_k);}
\DoxyCodeLine{00290\ \ \ \ \ writeRegToShmem();}
\DoxyCodeLine{00291\ }
\DoxyCodeLine{00292\ \textcolor{preprocessor}{\ \ \ \ \#undef\ prefetchIntoRegisters}}
\DoxyCodeLine{00293\ \textcolor{preprocessor}{\ \ \ \ \#undef\ writeRegToShmem}}
\DoxyCodeLine{00294\ }
\DoxyCodeLine{00295\ \ \ \ \ \textcolor{comment}{//\ wait\ for\ shared\ mem\ packing\ to\ be\ done\ before\ starting\ computation}}
\DoxyCodeLine{00296\ \ \ \ \ \_\_syncthreads();}
\DoxyCodeLine{00297\ }
\DoxyCodeLine{00298\ \ \ \ \ \textcolor{comment}{//\ compute\ 8x8\ matrix\ product\ by\ outer\ product.\ This\ involves\ packing\ one\ column}}
\DoxyCodeLine{00299\ \ \ \ \ \textcolor{comment}{//\ of\ LHS\ and\ one\ row\ of\ RHS\ into\ registers\ (takes\ 16\ registers).}}
\DoxyCodeLine{00300\ }
\DoxyCodeLine{00301\ \textcolor{preprocessor}{\#define\ lcol(i)\ \_lcol\#\#i}}
\DoxyCodeLine{00302\ \ \ \ \ Scalar\ lcol(0);}
\DoxyCodeLine{00303\ \ \ \ \ Scalar\ lcol(1);}
\DoxyCodeLine{00304\ \ \ \ \ Scalar\ lcol(2);}
\DoxyCodeLine{00305\ \ \ \ \ Scalar\ lcol(3);}
\DoxyCodeLine{00306\ \ \ \ \ Scalar\ lcol(4);}
\DoxyCodeLine{00307\ \ \ \ \ Scalar\ lcol(5);}
\DoxyCodeLine{00308\ \ \ \ \ Scalar\ lcol(6);}
\DoxyCodeLine{00309\ \ \ \ \ Scalar\ lcol(7);}
\DoxyCodeLine{00310\ }
\DoxyCodeLine{00311\ \textcolor{preprocessor}{\#define\ rrow(j)\ \_rrow\#\#j}}
\DoxyCodeLine{00312\ \ \ \ \ Scalar\ rrow(0);}
\DoxyCodeLine{00313\ \ \ \ \ Scalar\ rrow(1);}
\DoxyCodeLine{00314\ \ \ \ \ Scalar\ rrow(2);}
\DoxyCodeLine{00315\ \ \ \ \ Scalar\ rrow(3);}
\DoxyCodeLine{00316\ \ \ \ \ Scalar\ rrow(4);}
\DoxyCodeLine{00317\ \ \ \ \ Scalar\ rrow(5);}
\DoxyCodeLine{00318\ \ \ \ \ Scalar\ rrow(6);}
\DoxyCodeLine{00319\ \ \ \ \ Scalar\ rrow(7);}
\DoxyCodeLine{00320\ }
\DoxyCodeLine{00321\ \ \ \ \ \textcolor{comment}{//\ Now\ x\ corresponds\ to\ k,\ y\ to\ m,\ and\ z\ to\ n}}
\DoxyCodeLine{00322\ \ \ \ \ \textcolor{keyword}{const}\ Scalar*\ lhs\_block\ =\ \&lhs\_shmem[threadIdx.x\ +\ 9\ *\ threadIdx.y];}
\DoxyCodeLine{00323\ \ \ \ \ \textcolor{keyword}{const}\ Scalar*\ rhs\_block\ =\ \&rhs\_shmem[threadIdx.x\ +\ 8\ *\ threadIdx.z];}
\DoxyCodeLine{00324\ }
\DoxyCodeLine{00325\ \textcolor{preprocessor}{\#define\ lhs\_element(i,\ j)\ lhs\_block[72\ *\ ((i)\ +\ 8\ *\ (j))]}}
\DoxyCodeLine{00326\ \textcolor{preprocessor}{\#define\ rhs\_element(i,\ j)\ rhs\_block[72\ *\ ((i)\ +\ 8\ *\ (j))]}}
\DoxyCodeLine{00327\ }
\DoxyCodeLine{00328\ \textcolor{preprocessor}{\#define\ loadData(i,\ j)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00329\ \textcolor{preprocessor}{\ \ \ \ lcol(0)\ =\ lhs\_element(0,\ j);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00330\ \textcolor{preprocessor}{\ \ \ \ rrow(0)\ =\ rhs\_element(i,\ 0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00331\ \textcolor{preprocessor}{\ \ \ \ lcol(1)\ =\ lhs\_element(1,\ j);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00332\ \textcolor{preprocessor}{\ \ \ \ rrow(1)\ =\ rhs\_element(i,\ 1);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00333\ \textcolor{preprocessor}{\ \ \ \ lcol(2)\ =\ lhs\_element(2,\ j);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00334\ \textcolor{preprocessor}{\ \ \ \ rrow(2)\ =\ rhs\_element(i,\ 2);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00335\ \textcolor{preprocessor}{\ \ \ \ lcol(3)\ =\ lhs\_element(3,\ j);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00336\ \textcolor{preprocessor}{\ \ \ \ rrow(3)\ =\ rhs\_element(i,\ 3);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00337\ \textcolor{preprocessor}{\ \ \ \ lcol(4)\ =\ lhs\_element(4,\ j);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00338\ \textcolor{preprocessor}{\ \ \ \ rrow(4)\ =\ rhs\_element(i,\ 4);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00339\ \textcolor{preprocessor}{\ \ \ \ lcol(5)\ =\ lhs\_element(5,\ j);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00340\ \textcolor{preprocessor}{\ \ \ \ rrow(5)\ =\ rhs\_element(i,\ 5);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00341\ \textcolor{preprocessor}{\ \ \ \ lcol(6)\ =\ lhs\_element(6,\ j);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00342\ \textcolor{preprocessor}{\ \ \ \ rrow(6)\ =\ rhs\_element(i,\ 6);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00343\ \textcolor{preprocessor}{\ \ \ \ lcol(7)\ =\ lhs\_element(7,\ j);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00344\ \textcolor{preprocessor}{\ \ \ \ rrow(7)\ =\ rhs\_element(i,\ 7);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00345\ \textcolor{preprocessor}{}}
\DoxyCodeLine{00346\ \textcolor{preprocessor}{\#define\ computeCol(j)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00347\ \textcolor{preprocessor}{\ \ \ \ res(0,\ j)\ +=\ lcol(0)\ *\ rrow(j);\ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00348\ \textcolor{preprocessor}{\ \ \ \ res(1,\ j)\ +=\ lcol(1)\ *\ rrow(j);\ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00349\ \textcolor{preprocessor}{\ \ \ \ res(2,\ j)\ +=\ lcol(2)\ *\ rrow(j);\ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00350\ \textcolor{preprocessor}{\ \ \ \ res(3,\ j)\ +=\ lcol(3)\ *\ rrow(j);\ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00351\ \textcolor{preprocessor}{\ \ \ \ res(4,\ j)\ +=\ lcol(4)\ *\ rrow(j);\ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00352\ \textcolor{preprocessor}{\ \ \ \ res(5,\ j)\ +=\ lcol(5)\ *\ rrow(j);\ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00353\ \textcolor{preprocessor}{\ \ \ \ res(6,\ j)\ +=\ lcol(6)\ *\ rrow(j);\ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00354\ \textcolor{preprocessor}{\ \ \ \ res(7,\ j)\ +=\ lcol(7)\ *\ rrow(j);\ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00355\ \textcolor{preprocessor}{}}
\DoxyCodeLine{00356\ \textcolor{preprocessor}{\#define\ computePass(i)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00357\ \textcolor{preprocessor}{\ \ \ \ loadData(i,\ i);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00358\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00359\ \textcolor{preprocessor}{\ \ \ \ computeCol(0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00360\ \textcolor{preprocessor}{\ \ \ \ computeCol(1);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00361\ \textcolor{preprocessor}{\ \ \ \ computeCol(2);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00362\ \textcolor{preprocessor}{\ \ \ \ computeCol(3);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00363\ \textcolor{preprocessor}{\ \ \ \ computeCol(4);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00364\ \textcolor{preprocessor}{\ \ \ \ computeCol(5);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00365\ \textcolor{preprocessor}{\ \ \ \ computeCol(6);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00366\ \textcolor{preprocessor}{\ \ \ \ computeCol(7);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00367\ \textcolor{preprocessor}{}}
\DoxyCodeLine{00368\ \ \ \ \ computePass(0);}
\DoxyCodeLine{00369\ \ \ \ \ computePass(1);}
\DoxyCodeLine{00370\ \ \ \ \ computePass(2);}
\DoxyCodeLine{00371\ \ \ \ \ computePass(3);}
\DoxyCodeLine{00372\ \ \ \ \ computePass(4);}
\DoxyCodeLine{00373\ \ \ \ \ computePass(5);}
\DoxyCodeLine{00374\ \ \ \ \ computePass(6);}
\DoxyCodeLine{00375\ \ \ \ \ computePass(7);}
\DoxyCodeLine{00376\ }
\DoxyCodeLine{00377\ \textcolor{preprocessor}{\#undef\ lcol}}
\DoxyCodeLine{00378\ \textcolor{preprocessor}{\#undef\ rrow}}
\DoxyCodeLine{00379\ \textcolor{preprocessor}{\#undef\ lhs\_element}}
\DoxyCodeLine{00380\ \textcolor{preprocessor}{\#undef\ rhs\_element}}
\DoxyCodeLine{00381\ \textcolor{preprocessor}{\#undef\ loadData}}
\DoxyCodeLine{00382\ \textcolor{preprocessor}{\#undef\ computeCol}}
\DoxyCodeLine{00383\ \textcolor{preprocessor}{\#undef\ computePass}}
\DoxyCodeLine{00384\ \ \ \}\ \textcolor{comment}{//\ end\ loop\ over\ k}}
\DoxyCodeLine{00385\ }
\DoxyCodeLine{00386\ \ \ \textcolor{comment}{//\ we've\ now\ iterated\ over\ all\ of\ the\ large\ (ie\ width\ 64)\ k\ blocks\ and}}
\DoxyCodeLine{00387\ \ \ \textcolor{comment}{//\ accumulated\ results\ in\ registers.\ At\ this\ point\ thread\ (x,\ y,\ z)\ contains}}
\DoxyCodeLine{00388\ \ \ \textcolor{comment}{//\ the\ sum\ across\ all\ big\ k\ blocks\ of\ the\ product\ of\ little\ k\ block\ of\ index\ (x,\ y)}}
\DoxyCodeLine{00389\ \ \ \textcolor{comment}{//\ with\ block\ of\ index\ (y,\ z).\ To\ compute\ the\ final\ output,\ we\ need\ to\ reduce}}
\DoxyCodeLine{00390\ \ \ \textcolor{comment}{//\ the\ 8\ threads\ over\ y\ by\ summation.}}
\DoxyCodeLine{00391\ \textcolor{preprocessor}{\#if\ defined(EIGEN\_HIPCC)\ ||\ (defined(EIGEN\_CUDA\_SDK\_VER)\ \&\&\ EIGEN\_CUDA\_SDK\_VER\ <\ 90000)}}
\DoxyCodeLine{00392\ \textcolor{preprocessor}{\#define\ shuffleInc(i,\ j,\ mask)\ res(i,\ j)\ +=\ \_\_shfl\_xor(res(i,\ j),\ mask)}}
\DoxyCodeLine{00393\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00394\ \textcolor{preprocessor}{\#define\ shuffleInc(i,\ j,\ mask)\ res(i,\ j)\ +=\ \_\_shfl\_xor\_sync(0xFFFFFFFF,\ res(i,\ j),\ mask)}}
\DoxyCodeLine{00395\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00396\ }
\DoxyCodeLine{00397\ \textcolor{preprocessor}{\#define\ reduceRow(i,\ mask)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00398\ \textcolor{preprocessor}{\ \ shuffleInc(i,\ 0,\ mask);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00399\ \textcolor{preprocessor}{\ \ shuffleInc(i,\ 1,\ mask);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00400\ \textcolor{preprocessor}{\ \ shuffleInc(i,\ 2,\ mask);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00401\ \textcolor{preprocessor}{\ \ shuffleInc(i,\ 3,\ mask);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00402\ \textcolor{preprocessor}{\ \ shuffleInc(i,\ 4,\ mask);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00403\ \textcolor{preprocessor}{\ \ shuffleInc(i,\ 5,\ mask);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00404\ \textcolor{preprocessor}{\ \ shuffleInc(i,\ 6,\ mask);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00405\ \textcolor{preprocessor}{\ \ shuffleInc(i,\ 7,\ mask);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00406\ \textcolor{preprocessor}{}}
\DoxyCodeLine{00407\ \textcolor{preprocessor}{\#define\ reduceMatrix(mask)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00408\ \textcolor{preprocessor}{\ \ reduceRow(0,\ mask);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00409\ \textcolor{preprocessor}{\ \ reduceRow(1,\ mask);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00410\ \textcolor{preprocessor}{\ \ reduceRow(2,\ mask);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00411\ \textcolor{preprocessor}{\ \ reduceRow(3,\ mask);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00412\ \textcolor{preprocessor}{\ \ reduceRow(4,\ mask);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00413\ \textcolor{preprocessor}{\ \ reduceRow(5,\ mask);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00414\ \textcolor{preprocessor}{\ \ reduceRow(6,\ mask);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00415\ \textcolor{preprocessor}{\ \ reduceRow(7,\ mask);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00416\ \textcolor{preprocessor}{}}
\DoxyCodeLine{00417\ \ \ \textcolor{comment}{//\ actually\ perform\ the\ reduction,\ now\ each\ thread\ of\ index\ (\_,\ y,\ z)}}
\DoxyCodeLine{00418\ \ \ \textcolor{comment}{//\ contains\ the\ correct\ values\ in\ its\ registers\ that\ belong\ in\ the\ output}}
\DoxyCodeLine{00419\ \ \ \textcolor{comment}{//\ block}}
\DoxyCodeLine{00420\ \ \ reduceMatrix(1);}
\DoxyCodeLine{00421\ \ \ reduceMatrix(2);}
\DoxyCodeLine{00422\ \ \ reduceMatrix(4);}
\DoxyCodeLine{00423\ }
\DoxyCodeLine{00424\ \textcolor{preprocessor}{\#undef\ shuffleInc}}
\DoxyCodeLine{00425\ \textcolor{preprocessor}{\#undef\ reduceRow}}
\DoxyCodeLine{00426\ \textcolor{preprocessor}{\#undef\ reduceMatrix}}
\DoxyCodeLine{00427\ }
\DoxyCodeLine{00428\ \ \ \textcolor{comment}{//\ now\ we\ need\ to\ copy\ the\ 64\ values\ into\ main\ memory.\ We\ can't\ split\ work}}
\DoxyCodeLine{00429\ \ \ \textcolor{comment}{//\ among\ threads\ because\ all\ variables\ are\ in\ registers.\ There's\ 2\ ways}}
\DoxyCodeLine{00430\ \ \ \textcolor{comment}{//\ to\ do\ this:}}
\DoxyCodeLine{00431\ \ \ \textcolor{comment}{//\ (1)\ have\ 1\ thread\ do\ 64\ writes\ from\ registers\ into\ global\ memory}}
\DoxyCodeLine{00432\ \ \ \textcolor{comment}{//\ (2)\ have\ 1\ thread\ do\ 64\ writes\ into\ shared\ memory,\ and\ then\ 8\ threads}}
\DoxyCodeLine{00433\ \ \ \textcolor{comment}{//\ \ \ \ \ each\ do\ 8\ writes\ into\ global\ memory.\ We\ can\ just\ overwrite\ the\ shared}}
\DoxyCodeLine{00434\ \ \ \textcolor{comment}{//\ \ \ \ \ memory\ from\ the\ problem\ we\ just\ solved.}}
\DoxyCodeLine{00435\ \ \ \textcolor{comment}{//\ (2)\ is\ slightly\ faster\ than\ (1)\ due\ to\ less\ branching\ and\ more\ ILP}}
\DoxyCodeLine{00436\ }
\DoxyCodeLine{00437\ \ \ \textcolor{comment}{//\ TODO:\ won't\ yield\ much\ gain,\ but\ could\ just\ use\ currently\ unused\ shared\ mem}}
\DoxyCodeLine{00438\ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ and\ then\ we\ won't\ have\ to\ sync}}
\DoxyCodeLine{00439\ \ \ \textcolor{comment}{//\ wait\ for\ shared\ mem\ to\ be\ out\ of\ use}}
\DoxyCodeLine{00440\ \ \ \_\_syncthreads();}
\DoxyCodeLine{00441\ }
\DoxyCodeLine{00442\ \textcolor{preprocessor}{\#define\ writeResultShmem(i,\ j)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00443\ \textcolor{preprocessor}{\ \ lhs\_shmem[i\ +\ 8\ *\ threadIdx.y\ +\ 64\ *\ threadIdx.z\ +\ 512\ *\ j]\ =\ res(i,\ j);\ \(\backslash\)}}
\DoxyCodeLine{00444\ \textcolor{preprocessor}{}}
\DoxyCodeLine{00445\ \textcolor{preprocessor}{\#define\ writeRow(i)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00446\ \textcolor{preprocessor}{\ \ writeResultShmem(i,\ 0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00447\ \textcolor{preprocessor}{\ \ writeResultShmem(i,\ 1);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00448\ \textcolor{preprocessor}{\ \ writeResultShmem(i,\ 2);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00449\ \textcolor{preprocessor}{\ \ writeResultShmem(i,\ 3);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00450\ \textcolor{preprocessor}{\ \ writeResultShmem(i,\ 4);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00451\ \textcolor{preprocessor}{\ \ writeResultShmem(i,\ 5);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00452\ \textcolor{preprocessor}{\ \ writeResultShmem(i,\ 6);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00453\ \textcolor{preprocessor}{\ \ writeResultShmem(i,\ 7);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00454\ \textcolor{preprocessor}{}}
\DoxyCodeLine{00455\ \ \ \textcolor{keywordflow}{if}\ (threadIdx.x\ ==\ 0)\ \{}
\DoxyCodeLine{00456\ \ \ \ \ writeRow(0);}
\DoxyCodeLine{00457\ \ \ \ \ writeRow(1);}
\DoxyCodeLine{00458\ \ \ \ \ writeRow(2);}
\DoxyCodeLine{00459\ \ \ \ \ writeRow(3);}
\DoxyCodeLine{00460\ \ \ \ \ writeRow(4);}
\DoxyCodeLine{00461\ \ \ \ \ writeRow(5);}
\DoxyCodeLine{00462\ \ \ \ \ writeRow(6);}
\DoxyCodeLine{00463\ \ \ \ \ writeRow(7);}
\DoxyCodeLine{00464\ \ \ \}}
\DoxyCodeLine{00465\ \textcolor{preprocessor}{\#undef\ writeResultShmem}}
\DoxyCodeLine{00466\ \textcolor{preprocessor}{\#undef\ writeRow}}
\DoxyCodeLine{00467\ }
\DoxyCodeLine{00468\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ max\_i\_write\ =\ \mbox{\hyperlink{namespaceEigen_1_1numext_ab3b30bf0bcfa1ad91dbec75fabb3bea0}{numext::mini}}((\textcolor{keywordtype}{int})((m\_size\ -\/\ base\_m\ -\/\ threadIdx.y\ +\ 7)\ /\ 8),\ 8);}
\DoxyCodeLine{00469\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ max\_j\_write\ =\ \mbox{\hyperlink{namespaceEigen_1_1numext_ab3b30bf0bcfa1ad91dbec75fabb3bea0}{numext::mini}}((\textcolor{keywordtype}{int})((n\_size\ -\/\ base\_n\ -\/\ threadIdx.z\ +\ 7)\ /\ 8),\ 8);}
\DoxyCodeLine{00470\ }
\DoxyCodeLine{00471\ \ \ \textcolor{keywordflow}{if}\ (threadIdx.x\ <\ max\_i\_write)\ \{}
\DoxyCodeLine{00472\ \ \ \ \ \textcolor{keywordflow}{if}\ (max\_j\_write\ ==\ 8)\ \{}
\DoxyCodeLine{00473\ \ \ \ \ \ \ \textcolor{comment}{//\ TODO:\ can\ i\ trade\ bank\ conflicts\ for\ coalesced\ writes?}}
\DoxyCodeLine{00474\ \ \ \ \ \ \ Scalar\ val0\ =\ lhs\_shmem[threadIdx.x\ +\ 8\ *\ threadIdx.y\ +\ 64\ *\ threadIdx.z\ +\ 512\ *\ 0];}
\DoxyCodeLine{00475\ \ \ \ \ \ \ Scalar\ val1\ =\ lhs\_shmem[threadIdx.x\ +\ 8\ *\ threadIdx.y\ +\ 64\ *\ threadIdx.z\ +\ 512\ *\ 1];}
\DoxyCodeLine{00476\ \ \ \ \ \ \ Scalar\ val2\ =\ lhs\_shmem[threadIdx.x\ +\ 8\ *\ threadIdx.y\ +\ 64\ *\ threadIdx.z\ +\ 512\ *\ 2];}
\DoxyCodeLine{00477\ \ \ \ \ \ \ Scalar\ val3\ =\ lhs\_shmem[threadIdx.x\ +\ 8\ *\ threadIdx.y\ +\ 64\ *\ threadIdx.z\ +\ 512\ *\ 3];}
\DoxyCodeLine{00478\ \ \ \ \ \ \ Scalar\ val4\ =\ lhs\_shmem[threadIdx.x\ +\ 8\ *\ threadIdx.y\ +\ 64\ *\ threadIdx.z\ +\ 512\ *\ 4];}
\DoxyCodeLine{00479\ \ \ \ \ \ \ Scalar\ val5\ =\ lhs\_shmem[threadIdx.x\ +\ 8\ *\ threadIdx.y\ +\ 64\ *\ threadIdx.z\ +\ 512\ *\ 5];}
\DoxyCodeLine{00480\ \ \ \ \ \ \ Scalar\ val6\ =\ lhs\_shmem[threadIdx.x\ +\ 8\ *\ threadIdx.y\ +\ 64\ *\ threadIdx.z\ +\ 512\ *\ 6];}
\DoxyCodeLine{00481\ \ \ \ \ \ \ Scalar\ val7\ =\ lhs\_shmem[threadIdx.x\ +\ 8\ *\ threadIdx.y\ +\ 64\ *\ threadIdx.z\ +\ 512\ *\ 7];}
\DoxyCodeLine{00482\ }
\DoxyCodeLine{00483\ \ \ \ \ \ \ output(base\_m\ +\ threadIdx.y\ +\ 8\ *\ threadIdx.x,\ base\_n\ +\ threadIdx.z\ +\ 8\ *\ 0)\ =\ val0;}
\DoxyCodeLine{00484\ \ \ \ \ \ \ output(base\_m\ +\ threadIdx.y\ +\ 8\ *\ threadIdx.x,\ base\_n\ +\ threadIdx.z\ +\ 8\ *\ 1)\ =\ val1;}
\DoxyCodeLine{00485\ \ \ \ \ \ \ output(base\_m\ +\ threadIdx.y\ +\ 8\ *\ threadIdx.x,\ base\_n\ +\ threadIdx.z\ +\ 8\ *\ 2)\ =\ val2;}
\DoxyCodeLine{00486\ \ \ \ \ \ \ output(base\_m\ +\ threadIdx.y\ +\ 8\ *\ threadIdx.x,\ base\_n\ +\ threadIdx.z\ +\ 8\ *\ 3)\ =\ val3;}
\DoxyCodeLine{00487\ \ \ \ \ \ \ output(base\_m\ +\ threadIdx.y\ +\ 8\ *\ threadIdx.x,\ base\_n\ +\ threadIdx.z\ +\ 8\ *\ 4)\ =\ val4;}
\DoxyCodeLine{00488\ \ \ \ \ \ \ output(base\_m\ +\ threadIdx.y\ +\ 8\ *\ threadIdx.x,\ base\_n\ +\ threadIdx.z\ +\ 8\ *\ 5)\ =\ val5;}
\DoxyCodeLine{00489\ \ \ \ \ \ \ output(base\_m\ +\ threadIdx.y\ +\ 8\ *\ threadIdx.x,\ base\_n\ +\ threadIdx.z\ +\ 8\ *\ 6)\ =\ val6;}
\DoxyCodeLine{00490\ \ \ \ \ \ \ output(base\_m\ +\ threadIdx.y\ +\ 8\ *\ threadIdx.x,\ base\_n\ +\ threadIdx.z\ +\ 8\ *\ 7)\ =\ val7;}
\DoxyCodeLine{00491\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00492\ \textcolor{preprocessor}{\#pragma\ unroll\ 7}}
\DoxyCodeLine{00493\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ \mbox{\hyperlink{namespaceabsl_adb6bd4a9012b471ac01613aff8d4d81ba363b122c528f54df4a0446b6bab05515}{j}}\ <\ max\_j\_write;\ \mbox{\hyperlink{namespaceabsl_adb6bd4a9012b471ac01613aff8d4d81ba363b122c528f54df4a0446b6bab05515}{j}}++)\ \{}
\DoxyCodeLine{00494\ \ \ \ \ \ \ \ \ Scalar\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2internal_2raw__hash__set__test_8cc_aa0ccb5ee6d882ee3605ff47745c6467b}{val}}\ =\ lhs\_shmem[threadIdx.x\ +\ 8\ *\ threadIdx.y\ +\ 64\ *\ threadIdx.z\ +\ 512\ *\ \mbox{\hyperlink{namespaceabsl_adb6bd4a9012b471ac01613aff8d4d81ba363b122c528f54df4a0446b6bab05515}{j}}];}
\DoxyCodeLine{00495\ \ \ \ \ \ \ \ \ output(base\_m\ +\ threadIdx.y\ +\ 8\ *\ threadIdx.x,\ base\_n\ +\ threadIdx.z\ +\ 8\ *\ j)\ =\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2internal_2raw__hash__set__test_8cc_aa0ccb5ee6d882ee3605ff47745c6467b}{val}};}
\DoxyCodeLine{00496\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00497\ \ \ \ \ \}}
\DoxyCodeLine{00498\ \ \ \}}
\DoxyCodeLine{00499\ \textcolor{preprocessor}{\#undef\ res}}
\DoxyCodeLine{00500\ \}}
\DoxyCodeLine{00501\ }
\DoxyCodeLine{00502\ }
\DoxyCodeLine{00503\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Scalar,\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}},\ \textcolor{keyword}{typename}\ LhsMapper,}
\DoxyCodeLine{00504\ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typename}\ RhsMapper,\ \textcolor{keyword}{typename}\ OutputMapper>}
\DoxyCodeLine{00505\ \_\_global\_\_\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00506\ \textcolor{preprocessor}{\#if\ defined(EIGEN\_HIPCC)}}
\DoxyCodeLine{00507\ \_\_launch\_bounds\_\_(512,\ 1)}
\DoxyCodeLine{00508\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00509\ \_\_launch\_bounds\_\_(512)}
\DoxyCodeLine{00510\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00511\ EigenContractionKernel(\textcolor{keyword}{const}\ LhsMapper\ lhs,\ \textcolor{keyword}{const}\ RhsMapper\ rhs,}
\DoxyCodeLine{00512\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ OutputMapper\ output,}
\DoxyCodeLine{00513\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ m\_size,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ n\_size,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ k\_size)\ \{}
\DoxyCodeLine{00514\ \ \ \_\_shared\_\_\ Scalar\ lhs\_shmem[72\ *\ 64];}
\DoxyCodeLine{00515\ \ \ \_\_shared\_\_\ Scalar\ rhs\_shmem[72\ *\ 64];}
\DoxyCodeLine{00516\ }
\DoxyCodeLine{00517\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ m\_block\_idx\ =\ blockIdx.x;}
\DoxyCodeLine{00518\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ n\_block\_idx\ =\ blockIdx.y;}
\DoxyCodeLine{00519\ }
\DoxyCodeLine{00520\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ base\_m\ =\ 64\ *\ m\_block\_idx;}
\DoxyCodeLine{00521\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ base\_n\ =\ 64\ *\ n\_block\_idx;}
\DoxyCodeLine{00522\ }
\DoxyCodeLine{00523\ \ \ \textcolor{keywordflow}{if}\ (base\_m\ +\ 63\ <\ m\_size\ \&\&\ base\_n\ +\ 63\ <\ n\_size)\ \{}
\DoxyCodeLine{00524\ \ \ \ \ EigenContractionKernelInternal<Scalar,\ Index,\ LhsMapper,\ RhsMapper,\ OutputMapper,\ false>(lhs,\ rhs,\ output,\ lhs\_shmem,\ rhs\_shmem,\ m\_size,\ n\_size,\ k\_size);}
\DoxyCodeLine{00525\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00526\ \ \ \ \ EigenContractionKernelInternal<Scalar,\ Index,\ LhsMapper,\ RhsMapper,\ OutputMapper,\ true>(lhs,\ rhs,\ output,\ lhs\_shmem,\ rhs\_shmem,\ m\_size,\ n\_size,\ k\_size);}
\DoxyCodeLine{00527\ \ \ \}}
\DoxyCodeLine{00528\ \}}
\DoxyCodeLine{00529\ }
\DoxyCodeLine{00530\ }
\DoxyCodeLine{00531\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}},\ \textcolor{keyword}{typename}\ LhsMapper,}
\DoxyCodeLine{00532\ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typename}\ RhsMapper,\ \textcolor{keyword}{typename}\ OutputMapper,\ \textcolor{keywordtype}{bool}\ CHECK\_LHS\_BOUNDARY,}
\DoxyCodeLine{00533\ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ CHECK\_RHS\_BOUNDARY>}
\DoxyCodeLine{00534\ \_\_device\_\_\ \_\_forceinline\_\_\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00535\ EigenFloatContractionKernelInternal16x16(\textcolor{keyword}{const}\ LhsMapper\ lhs,\ \textcolor{keyword}{const}\ RhsMapper\ rhs,}
\DoxyCodeLine{00536\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ OutputMapper\ output,\ float2\ lhs\_shmem2[][16],}
\DoxyCodeLine{00537\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ float2\ rhs\_shmem2[][8],\ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ m\_size,}
\DoxyCodeLine{00538\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ n\_size,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ k\_size,}
\DoxyCodeLine{00539\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ base\_m,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ base\_n)\ \{}
\DoxyCodeLine{00540\ }
\DoxyCodeLine{00541\ \ \ \textcolor{comment}{//\ prefetch\ registers}}
\DoxyCodeLine{00542\ \ \ float4\ lhs\_pf0,\ rhs\_pf0;}
\DoxyCodeLine{00543\ }
\DoxyCodeLine{00544\ \ \ float4\ results[4];}
\DoxyCodeLine{00545\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}=0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ 4;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}++)\ \{}
\DoxyCodeLine{00546\ \ \ \ \ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].x\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].y\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].z\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].w\ =\ 0;}
\DoxyCodeLine{00547\ \ \ \}}
\DoxyCodeLine{00548\ }
\DoxyCodeLine{00549\ \textcolor{preprocessor}{\#define\ prefetch\_lhs(reg,\ row,\ col)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00550\ \textcolor{preprocessor}{\ \ \ \ if\ (!CHECK\_LHS\_BOUNDARY)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00551\ \textcolor{preprocessor}{\ \ \ \ \ \ if\ (col\ <\ k\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00552\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ reg\ =lhs.template\ loadPacket<float4,Unaligned>(row,\ col);\ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00553\ \textcolor{preprocessor}{\ \ \ \ \ \ \}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00554\ \textcolor{preprocessor}{\ \ \ \ \}\ else\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00555\ \textcolor{preprocessor}{\ \ \ \ \ \ if\ (col\ <\ k\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00556\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ if\ (row\ +\ 3\ <\ m\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00557\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ reg\ =lhs.template\ loadPacket<float4,Unaligned>(row,\ col);\ \ \ \(\backslash\)}}
\DoxyCodeLine{00558\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \}\ else\ if\ (row\ +\ 2\ <\ m\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00559\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ reg.x\ =lhs(row\ +\ 0,\ col);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00560\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ reg.y\ =lhs(row\ +\ 1,\ col);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00561\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ reg.z\ =lhs(row\ +\ 2,\ col);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00562\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \}\ else\ if\ (row\ +\ 1\ <\ m\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00563\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ reg.x\ =lhs(row\ +\ 0,\ col);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00564\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ reg.y\ =lhs(row\ +\ 1,\ col);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00565\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \}\ else\ if\ (row\ \ <\ m\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00566\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ reg.x\ =lhs(row\ +\ 0,\ col);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00567\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00568\ \textcolor{preprocessor}{\ \ \ \ \ \ \}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00569\ \textcolor{preprocessor}{\ \ \ \ \}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00570\ \textcolor{preprocessor}{}}
\DoxyCodeLine{00571\ \ \ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ lhs\_vert\ =\ base\_m+threadIdx.x*4;}
\DoxyCodeLine{00572\ }
\DoxyCodeLine{00573\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ k\ =\ 0;\ k\ <\ k\_size;\ k\ +=\ 16)\ \{}
\DoxyCodeLine{00574\ }
\DoxyCodeLine{00575\ \ \ \ \ lhs\_pf0\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_afa6f9a9f3c905b28cc29841935e44fdb}{internal::pset1<float4>}}(0);}
\DoxyCodeLine{00576\ \ \ \ \ rhs\_pf0\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_afa6f9a9f3c905b28cc29841935e44fdb}{internal::pset1<float4>}}(0);}
\DoxyCodeLine{00577\ }
\DoxyCodeLine{00578\ \ \ \ \ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ lhs\_horiz\ =\ threadIdx.y+k;}
\DoxyCodeLine{00579\ \ \ \ \ prefetch\_lhs(lhs\_pf0,\ lhs\_vert,\ lhs\_horiz)}
\DoxyCodeLine{00580\ }
\DoxyCodeLine{00581\ \ \ \ \ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ rhs\_vert\ =\ k+(threadIdx.x\%4)*4;}
\DoxyCodeLine{00582\ \ \ \ \ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ rhs\_horiz0\ =\ (threadIdx.x>>2)+threadIdx.y*4+base\_n;}
\DoxyCodeLine{00583\ }
\DoxyCodeLine{00584\ \ \ \ \ \textcolor{keywordflow}{if}\ (!CHECK\_RHS\_BOUNDARY)\ \{}
\DoxyCodeLine{00585\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((rhs\_vert\ +\ 3)\ <\ k\_size)\ \{}
\DoxyCodeLine{00586\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ just\ CHECK\_RHS\_BOUNDARY}}
\DoxyCodeLine{00587\ \ \ \ \ \ \ \ \ rhs\_pf0\ =\ rhs.template\ loadPacket<float4,Unaligned>(rhs\_vert,\ rhs\_horiz0);}
\DoxyCodeLine{00588\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (rhs\_vert\ +\ 2\ <\ k\_size)\ \{}
\DoxyCodeLine{00589\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ just\ CHECK\_RHS\_BOUNDARY}}
\DoxyCodeLine{00590\ \ \ \ \ \ \ \ \ rhs\_pf0.x\ =\ rhs(rhs\_vert,\ rhs\_horiz0);}
\DoxyCodeLine{00591\ \ \ \ \ \ \ \ \ rhs\_pf0.y\ =\ rhs(rhs\_vert\ +\ 1,\ rhs\_horiz0);}
\DoxyCodeLine{00592\ \ \ \ \ \ \ \ \ rhs\_pf0.z\ =\ rhs(rhs\_vert\ +\ 2,\ rhs\_horiz0);}
\DoxyCodeLine{00593\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (rhs\_vert\ +\ 1\ <\ k\_size)\ \{}
\DoxyCodeLine{00594\ \ \ \ \ \ \ \ \ rhs\_pf0.x\ =\ rhs(rhs\_vert,\ rhs\_horiz0);}
\DoxyCodeLine{00595\ \ \ \ \ \ \ \ \ rhs\_pf0.y\ =\ rhs(rhs\_vert\ +\ 1,\ rhs\_horiz0);}
\DoxyCodeLine{00596\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (rhs\_vert\ \ <\ k\_size)\ \{}
\DoxyCodeLine{00597\ \ \ \ \ \ \ \ \ rhs\_pf0.x\ =\ rhs(rhs\_vert,\ rhs\_horiz0);}
\DoxyCodeLine{00598\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00599\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00600\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (rhs\_horiz0\ <\ n\_size)\ \{}
\DoxyCodeLine{00601\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((rhs\_vert\ +\ 3)\ <\ k\_size)\ \{}
\DoxyCodeLine{00602\ \ \ \ \ \ \ \ \ \ \ rhs\_pf0\ =\ rhs.template\ loadPacket<float4,Unaligned>(rhs\_vert,\ rhs\_horiz0);}
\DoxyCodeLine{00603\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((rhs\_vert\ +\ 2)\ <\ k\_size)\ \{}
\DoxyCodeLine{00604\ \ \ \ \ \ \ \ \ \ \ rhs\_pf0.x\ =\ rhs(rhs\_vert,\ rhs\_horiz0);}
\DoxyCodeLine{00605\ \ \ \ \ \ \ \ \ \ \ rhs\_pf0.y\ =\ rhs(rhs\_vert\ +\ 1,\ rhs\_horiz0);}
\DoxyCodeLine{00606\ \ \ \ \ \ \ \ \ \ \ rhs\_pf0.z\ =\ rhs(rhs\_vert\ +\ 2,\ rhs\_horiz0);}
\DoxyCodeLine{00607\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((rhs\_vert\ +\ 1)\ <\ k\_size)\ \{}
\DoxyCodeLine{00608\ \ \ \ \ \ \ \ \ \ \ rhs\_pf0.x\ =\ rhs(rhs\_vert,\ rhs\_horiz0);}
\DoxyCodeLine{00609\ \ \ \ \ \ \ \ \ \ \ rhs\_pf0.y\ =\ rhs(rhs\_vert\ +\ 1,\ rhs\_horiz0);}
\DoxyCodeLine{00610\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (rhs\_vert\ \ <\ k\_size)\ \{}
\DoxyCodeLine{00611\ \ \ \ \ \ \ \ \ \ \ rhs\_pf0.x\ =\ rhs(rhs\_vert,\ rhs\_horiz0);}
\DoxyCodeLine{00612\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00613\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00614\ \ \ \ \ \}}
\DoxyCodeLine{00615\ \ \ \ \ \textcolor{keywordtype}{float}\ x1,\ x2\ ;}
\DoxyCodeLine{00616\ \ \ \ \ \textcolor{comment}{//\ the\ following\ can\ be\ a\ bitwise\ operation.....\ some\ day.}}
\DoxyCodeLine{00617\ \ \ \ \ \textcolor{keywordflow}{if}((threadIdx.x\%8)\ <\ 4)\ \{}
\DoxyCodeLine{00618\ \ \ \ \ \ \ x1\ =\ rhs\_pf0.y;}
\DoxyCodeLine{00619\ \ \ \ \ \ \ x2\ =\ rhs\_pf0.w;}
\DoxyCodeLine{00620\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00621\ \ \ \ \ \ \ x1\ =\ rhs\_pf0.x;}
\DoxyCodeLine{00622\ \ \ \ \ \ \ x2\ =\ rhs\_pf0.z;}
\DoxyCodeLine{00623\ \ \ \ \ \}}
\DoxyCodeLine{00624\ \textcolor{preprocessor}{\ \ \ \ \#if\ defined(EIGEN\_HIPCC)\ ||\ (defined(EIGEN\_CUDA\_SDK\_VER)\ \&\&\ EIGEN\_CUDA\_SDK\_VER\ <\ 90000)}}
\DoxyCodeLine{00625\ \ \ \ \ x1\ =\ \_\_shfl\_xor(x1,\ 4);}
\DoxyCodeLine{00626\ \ \ \ \ x2\ =\ \_\_shfl\_xor(x2,\ 4);}
\DoxyCodeLine{00627\ \textcolor{preprocessor}{\ \ \ \ \#else}}
\DoxyCodeLine{00628\ \ \ \ \ x1\ =\ \_\_shfl\_xor\_sync(0xFFFFFFFF,\ x1,\ 4);}
\DoxyCodeLine{00629\ \ \ \ \ x2\ =\ \_\_shfl\_xor\_sync(0xFFFFFFFF,\ x2,\ 4);}
\DoxyCodeLine{00630\ \textcolor{preprocessor}{\ \ \ \ \#endif}}
\DoxyCodeLine{00631\ \ \ \ \ \textcolor{keywordflow}{if}((threadIdx.x\%8)\ <\ 4)\ \{}
\DoxyCodeLine{00632\ \ \ \ \ \ \ rhs\_pf0.y\ =\ x1;}
\DoxyCodeLine{00633\ \ \ \ \ \ \ rhs\_pf0.w\ =\ x2;}
\DoxyCodeLine{00634\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00635\ \ \ \ \ \ \ rhs\_pf0.x\ =\ x1;}
\DoxyCodeLine{00636\ \ \ \ \ \ \ rhs\_pf0.z\ =\ x2;}
\DoxyCodeLine{00637\ \ \ \ \ \}}
\DoxyCodeLine{00638\ }
\DoxyCodeLine{00639\ \ \ \ \ \textcolor{comment}{//\ We\ have\ 64\ features.}}
\DoxyCodeLine{00640\ \ \ \ \ \textcolor{comment}{//\ Row\ 0\ -\/>\ times\ (0,\ 4,\ 8,\ 12,\ 1,\ 5,\ 9,\ 13)\ for\ features\ 0,\ 1.}}
\DoxyCodeLine{00641\ \ \ \ \ \textcolor{comment}{//\ Row\ 1\ -\/>\ times\ (0,\ 4,\ 8,\ 12,\ 1,\ 5,\ 9,\ 13)\ for\ features\ 2,\ 3.}}
\DoxyCodeLine{00642\ \ \ \ \ \textcolor{comment}{//\ ...}}
\DoxyCodeLine{00643\ \ \ \ \ \textcolor{comment}{//\ Row\ 31\ -\/>\ times\ (0,\ 4,\ 8,\ 12,\ 1,\ 5,\ 9,\ 13)\ for\ features\ 62,\ 63}}
\DoxyCodeLine{00644\ \ \ \ \ \textcolor{comment}{//\ Row\ 32\ -\/>\ times\ (2,\ 6,\ 10,\ 14,\ 3,\ 7,\ 11,\ 15)\ for\ features\ 0,\ 1}}
\DoxyCodeLine{00645\ \ \ \ \ \textcolor{comment}{//\ ...}}
\DoxyCodeLine{00646\ \ \ \ \ rhs\_shmem2[(threadIdx.x>>3)+\ threadIdx.y*2][threadIdx.x\%8]\ =\ make\_float2(rhs\_pf0.x,\ rhs\_pf0.y);}
\DoxyCodeLine{00647\ \ \ \ \ rhs\_shmem2[(threadIdx.x>>3)+\ threadIdx.y*2+32][threadIdx.x\%8]\ =\ make\_float2(rhs\_pf0.z,\ rhs\_pf0.w);}
\DoxyCodeLine{00648\ }
\DoxyCodeLine{00649\ \ \ \ \ \textcolor{comment}{//\ Row\ 0\ (time\ 0)\ -\/>\ features\ (0,\ 1),\ (4,\ 5),\ ..\ (28,\ 29),\ (32,\ 33),\ ..\ \ (60,\ 61)}}
\DoxyCodeLine{00650\ \ \ \ \ \textcolor{comment}{//\ Row\ 1\ (time\ 1)\ -\/>\ features\ (0,\ 1),\ (4,\ 5),\ ..\ (28,\ 29),\ (32,\ 33),\ ..\ \ (60,\ 61)}}
\DoxyCodeLine{00651\ \ \ \ \ \textcolor{comment}{//\ ...}}
\DoxyCodeLine{00652\ \ \ \ \ \textcolor{comment}{//\ Row\ 15\ (time\ 15)\ -\/>\ features\ (0,\ 1),\ (4,\ 5),\ ..\ (28,\ 29),\ (32,\ 33),\ ..\ \ (60,\ 61)}}
\DoxyCodeLine{00653\ \ \ \ \ \textcolor{comment}{//\ Row\ 16\ (time\ 0)\ -\/>\ features\ (2,\ 3),\ (6,\ 7),\ ..\ (30,\ 31),\ (34,\ 35),\ ..\ \ (62,\ 63)}}
\DoxyCodeLine{00654\ \ \ \ \ \textcolor{comment}{//\ ...}}
\DoxyCodeLine{00655\ }
\DoxyCodeLine{00656\ \ \ \ \ lhs\_shmem2[threadIdx.y][threadIdx.x]\ =\ make\_float2(lhs\_pf0.x,\ lhs\_pf0.y);}
\DoxyCodeLine{00657\ \ \ \ \ lhs\_shmem2[threadIdx.y+16][threadIdx.x]\ =\ make\_float2(lhs\_pf0.z,\ lhs\_pf0.w);}
\DoxyCodeLine{00658\ }
\DoxyCodeLine{00659\ }
\DoxyCodeLine{00660\ \textcolor{preprocessor}{\#define\ add\_vals(fl1,\ fl2,\ fr1,\ fr2)\(\backslash\)}}
\DoxyCodeLine{00661\ \textcolor{preprocessor}{\ \ \ \ results[0].x\ +=\ fl1.x\ *\ fr1.x;\(\backslash\)}}
\DoxyCodeLine{00662\ \textcolor{preprocessor}{\ \ \ \ results[0].y\ +=\ fl1.y\ *\ fr1.x;\(\backslash\)}}
\DoxyCodeLine{00663\ \textcolor{preprocessor}{\ \ \ \ results[0].z\ +=\ fl2.x\ *\ fr1.x;\(\backslash\)}}
\DoxyCodeLine{00664\ \textcolor{preprocessor}{\ \ \ \ results[0].w\ +=\ fl2.y\ *\ fr1.x;\(\backslash\)}}
\DoxyCodeLine{00665\ \textcolor{preprocessor}{\(\backslash\)}}
\DoxyCodeLine{00666\ \textcolor{preprocessor}{\ \ \ \ results[1].x\ +=\ fl1.x\ *\ fr1.y;\(\backslash\)}}
\DoxyCodeLine{00667\ \textcolor{preprocessor}{\ \ \ \ results[1].y\ +=\ fl1.y\ *\ fr1.y;\(\backslash\)}}
\DoxyCodeLine{00668\ \textcolor{preprocessor}{\ \ \ \ results[1].z\ +=\ fl2.x\ *\ fr1.y;\(\backslash\)}}
\DoxyCodeLine{00669\ \textcolor{preprocessor}{\ \ \ \ results[1].w\ +=\ fl2.y\ *\ fr1.y;\(\backslash\)}}
\DoxyCodeLine{00670\ \textcolor{preprocessor}{\(\backslash\)}}
\DoxyCodeLine{00671\ \textcolor{preprocessor}{\ \ \ \ results[2].x\ +=\ fl1.x\ *\ fr2.x;\(\backslash\)}}
\DoxyCodeLine{00672\ \textcolor{preprocessor}{\ \ \ \ results[2].y\ +=\ fl1.y\ *\ fr2.x;\(\backslash\)}}
\DoxyCodeLine{00673\ \textcolor{preprocessor}{\ \ \ \ results[2].z\ +=\ fl2.x\ *\ fr2.x;\(\backslash\)}}
\DoxyCodeLine{00674\ \textcolor{preprocessor}{\ \ \ \ results[2].w\ +=\ fl2.y\ *\ fr2.x;\(\backslash\)}}
\DoxyCodeLine{00675\ \textcolor{preprocessor}{\(\backslash\)}}
\DoxyCodeLine{00676\ \textcolor{preprocessor}{\ \ \ \ results[3].x\ +=\ fl1.x\ *\ fr2.y;\(\backslash\)}}
\DoxyCodeLine{00677\ \textcolor{preprocessor}{\ \ \ \ results[3].y\ +=\ fl1.y\ *\ fr2.y;\(\backslash\)}}
\DoxyCodeLine{00678\ \textcolor{preprocessor}{\ \ \ \ results[3].z\ +=\ fl2.x\ *\ fr2.y;\(\backslash\)}}
\DoxyCodeLine{00679\ \textcolor{preprocessor}{\ \ \ \ results[3].w\ +=\ fl2.y\ *\ fr2.y;\(\backslash\)}}
\DoxyCodeLine{00680\ \textcolor{preprocessor}{}}
\DoxyCodeLine{00681\ \ \ \ \ \_\_syncthreads();}
\DoxyCodeLine{00682\ }
\DoxyCodeLine{00683\ \ \ \ \ \textcolor{comment}{//\ Do\ the\ multiplies.}}
\DoxyCodeLine{00684\ \textcolor{preprocessor}{\ \ \ \ \#pragma\ unroll}}
\DoxyCodeLine{00685\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ koff\ =\ 0;\ koff\ <\ 16;\ koff\ ++)\ \{}
\DoxyCodeLine{00686\ \ \ \ \ \ \ \textcolor{comment}{//\ 32\ x\ threads.}}
\DoxyCodeLine{00687\ \ \ \ \ \ \ float2\ fl1\ =\ lhs\_shmem2[koff][threadIdx.x];}
\DoxyCodeLine{00688\ \ \ \ \ \ \ float2\ fl2\ =\ lhs\_shmem2[koff\ +\ 16][threadIdx.x];}
\DoxyCodeLine{00689\ }
\DoxyCodeLine{00690\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ start\_feature\ =\ threadIdx.y\ *\ 4;}
\DoxyCodeLine{00691\ \ \ \ \ \ \ float2\ fr1\ =\ rhs\_shmem2[(start\_feature>>1)\ +\ 32*((koff\%4)/2)][koff/4\ +\ (koff\%2)*4];}
\DoxyCodeLine{00692\ \ \ \ \ \ \ float2\ fr2\ =\ rhs\_shmem2[(start\_feature>>1)\ +\ 1\ +\ 32*((koff\%4)/2)][koff/4\ +\ (koff\%2)*4];}
\DoxyCodeLine{00693\ }
\DoxyCodeLine{00694\ \ \ \ \ \ \ add\_vals(fl1,\ fl2,\ fr1,\ fr2)}
\DoxyCodeLine{00695\ \ \ \ \ \}}
\DoxyCodeLine{00696\ \ \ \ \ \_\_syncthreads();}
\DoxyCodeLine{00697\ \ \ \}}
\DoxyCodeLine{00698\ }
\DoxyCodeLine{00699\ \textcolor{preprocessor}{\#undef\ prefetch\_lhs}}
\DoxyCodeLine{00700\ \textcolor{preprocessor}{\#undef\ add\_vals}}
\DoxyCodeLine{00701\ }
\DoxyCodeLine{00702\ \ \ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ horiz\_base\ =\ threadIdx.y*4+base\_n;}
\DoxyCodeLine{00703\ \ \ \textcolor{keywordflow}{if}\ (!CHECK\_LHS\_BOUNDARY\ \&\&\ !CHECK\_RHS\_BOUNDARY)\ \{}
\DoxyCodeLine{00704\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ 4;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}++)\ \{}
\DoxyCodeLine{00705\ \ \ \ \ \ \ output(lhs\_vert,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].x;}
\DoxyCodeLine{00706\ \ \ \ \ \ \ output(lhs\_vert\ +\ 1,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].y;}
\DoxyCodeLine{00707\ \ \ \ \ \ \ output(lhs\_vert\ +\ 2,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].z;}
\DoxyCodeLine{00708\ \ \ \ \ \ \ output(lhs\_vert\ +\ 3,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].w;}
\DoxyCodeLine{00709\ \ \ \ \ \}}
\DoxyCodeLine{00710\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (!CHECK\_RHS\_BOUNDARY)\ \{}
\DoxyCodeLine{00711\ \ \ \ \ \textcolor{comment}{//\ CHECK\ LHS}}
\DoxyCodeLine{00712\ \ \ \ \ \textcolor{keywordflow}{if}\ (lhs\_vert\ +\ 3\ <\ m\_size)\ \{}
\DoxyCodeLine{00713\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ 4;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}++)\ \{}
\DoxyCodeLine{00714\ \ \ \ \ \ \ \ \ output(lhs\_vert,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].x;}
\DoxyCodeLine{00715\ \ \ \ \ \ \ \ \ output(lhs\_vert\ +\ 1,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].y;}
\DoxyCodeLine{00716\ \ \ \ \ \ \ \ \ output(lhs\_vert\ +\ 2,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].z;}
\DoxyCodeLine{00717\ \ \ \ \ \ \ \ \ output(lhs\_vert\ +\ 3,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].w;}
\DoxyCodeLine{00718\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00719\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (lhs\_vert\ +\ 2\ <\ m\_size)\ \{}
\DoxyCodeLine{00720\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ 4;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}++)\ \{}
\DoxyCodeLine{00721\ \ \ \ \ \ \ \ \ output(lhs\_vert,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].x;}
\DoxyCodeLine{00722\ \ \ \ \ \ \ \ \ output(lhs\_vert\ +\ 1,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].y;}
\DoxyCodeLine{00723\ \ \ \ \ \ \ \ \ output(lhs\_vert\ +\ 2,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].z;}
\DoxyCodeLine{00724\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00725\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (lhs\_vert\ +\ 1\ <\ m\_size)\ \{}
\DoxyCodeLine{00726\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ 4;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}++)\ \{}
\DoxyCodeLine{00727\ \ \ \ \ \ \ \ \ output(lhs\_vert,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].x;}
\DoxyCodeLine{00728\ \ \ \ \ \ \ \ \ output(lhs\_vert\ +\ 1,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].y;}
\DoxyCodeLine{00729\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00730\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (lhs\_vert\ \ <\ m\_size)\ \{}
\DoxyCodeLine{00731\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ 4;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}++)\ \{}
\DoxyCodeLine{00732\ \ \ \ \ \ \ \ \ output(lhs\_vert,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].x;}
\DoxyCodeLine{00733\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00734\ \ \ \ \ \}}
\DoxyCodeLine{00735\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (!CHECK\_LHS\_BOUNDARY)\ \{}
\DoxyCodeLine{00736\ \ \ \ \ \textcolor{comment}{//\ CHECK\ RHS}}
\DoxyCodeLine{00737\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00738\ \textcolor{comment}{\ \ \ \ int\ ncols\_rem\ =\ fminf(n\_size-\/\ horiz\_base,\ 4);}}
\DoxyCodeLine{00739\ \textcolor{comment}{\ \ \ \ for\ (int\ i\ =\ 0;\ i\ <\ ncols\_rem;\ i++)\ \{}}
\DoxyCodeLine{00740\ \textcolor{comment}{\ \ \ \ \ \ output(lhs\_vert,\ horiz\_base\ +\ i)\ =\ results[i].x;}}
\DoxyCodeLine{00741\ \textcolor{comment}{\ \ \ \ \ \ output(lhs\_vert\ +\ 1,\ horiz\_base\ +\ i)\ =\ results[i].y;}}
\DoxyCodeLine{00742\ \textcolor{comment}{\ \ \ \ \ \ output(lhs\_vert\ +\ 2,\ horiz\_base\ +\ i)\ =\ results[i].z;}}
\DoxyCodeLine{00743\ \textcolor{comment}{\ \ \ \ \ \ output(lhs\_vert\ +\ 3,\ horiz\_base\ +\ i)\ =\ results[i].w;}}
\DoxyCodeLine{00744\ \textcolor{comment}{\ \ \ \ \}*/}}
\DoxyCodeLine{00745\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ 4;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}++)\ \{}
\DoxyCodeLine{00746\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (horiz\_base+\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ n\_size)\ \{}
\DoxyCodeLine{00747\ \ \ \ \ \ \ \ \ output(lhs\_vert,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].x;}
\DoxyCodeLine{00748\ \ \ \ \ \ \ \ \ output(lhs\_vert\ +\ 1,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].y;}
\DoxyCodeLine{00749\ \ \ \ \ \ \ \ \ output(lhs\_vert\ +\ 2,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].z;}
\DoxyCodeLine{00750\ \ \ \ \ \ \ \ \ output(lhs\_vert\ +\ 3,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].w;}
\DoxyCodeLine{00751\ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00752\ \ \ \ \ \}}
\DoxyCodeLine{00753\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00754\ \ \ \ \ \textcolor{comment}{//\ CHECK\ both\ boundaries.}}
\DoxyCodeLine{00755\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ 4;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}++)\ \{}
\DoxyCodeLine{00756\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (horiz\_base+\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ n\_size)\ \{}
\DoxyCodeLine{00757\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (lhs\_vert\ <\ m\_size)}
\DoxyCodeLine{00758\ \ \ \ \ \ \ \ \ \ \ output(lhs\_vert,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].x;}
\DoxyCodeLine{00759\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (lhs\_vert\ +\ 1\ <\ m\_size)}
\DoxyCodeLine{00760\ \ \ \ \ \ \ \ \ \ \ output(lhs\_vert\ +\ 1,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].y;}
\DoxyCodeLine{00761\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (lhs\_vert\ +\ 2\ <\ m\_size)}
\DoxyCodeLine{00762\ \ \ \ \ \ \ \ \ \ \ output(lhs\_vert\ +\ 2,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].z;}
\DoxyCodeLine{00763\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (lhs\_vert\ +\ 3\ <\ m\_size)}
\DoxyCodeLine{00764\ \ \ \ \ \ \ \ \ \ \ output(lhs\_vert\ +\ 3,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].w;}
\DoxyCodeLine{00765\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00766\ \ \ \ \ \}}
\DoxyCodeLine{00767\ \ \ \}}
\DoxyCodeLine{00768\ \}}
\DoxyCodeLine{00769\ }
\DoxyCodeLine{00770\ }
\DoxyCodeLine{00771\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}},\ \textcolor{keyword}{typename}\ LhsMapper,}
\DoxyCodeLine{00772\ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typename}\ RhsMapper,\ \textcolor{keyword}{typename}\ OutputMapper,\ \textcolor{keywordtype}{bool}\ CHECK\_LHS\_BOUNDARY,}
\DoxyCodeLine{00773\ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ CHECK\_RHS\_BOUNDARY>}
\DoxyCodeLine{00774\ \_\_device\_\_\ \_\_forceinline\_\_\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00775\ EigenFloatContractionKernelInternal(\textcolor{keyword}{const}\ LhsMapper\ lhs,\ \textcolor{keyword}{const}\ RhsMapper\ rhs,}
\DoxyCodeLine{00776\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ OutputMapper\ output,\ float2\ lhs\_shmem2[][32],}
\DoxyCodeLine{00777\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ float2\ rhs\_shmem2[][8],\ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ m\_size,}
\DoxyCodeLine{00778\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ n\_size,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ k\_size,}
\DoxyCodeLine{00779\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ base\_m,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ base\_n)\ \{}
\DoxyCodeLine{00780\ }
\DoxyCodeLine{00781\ \ \ \textcolor{comment}{//\ prefetch\ registers}}
\DoxyCodeLine{00782\ \ \ float4\ lhs\_pf0,\ lhs\_pf1,\ lhs\_pf2,\ lhs\_pf3;}
\DoxyCodeLine{00783\ \ \ float4\ rhs\_pf0,\ rhs\_pf1;}
\DoxyCodeLine{00784\ }
\DoxyCodeLine{00785\ \ \ float4\ results[8];}
\DoxyCodeLine{00786\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}=0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ 8;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}++)\ \{}
\DoxyCodeLine{00787\ \ \ \ \ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].x\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].y\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].z\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].w\ =\ 0;}
\DoxyCodeLine{00788\ \ \ \}}
\DoxyCodeLine{00789\ }
\DoxyCodeLine{00790\ \ \ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ lhs\_vert\ =\ base\_m+threadIdx.x*4+(threadIdx.y\%4)*32;}
\DoxyCodeLine{00791\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ k\ =\ 0;\ k\ <\ k\_size;\ k\ +=\ 32)\ \{}
\DoxyCodeLine{00792\ \ \ \ \ lhs\_pf0\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_afa6f9a9f3c905b28cc29841935e44fdb}{internal::pset1<float4>}}(0);}
\DoxyCodeLine{00793\ \ \ \ \ lhs\_pf1\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_afa6f9a9f3c905b28cc29841935e44fdb}{internal::pset1<float4>}}(0);}
\DoxyCodeLine{00794\ \ \ \ \ lhs\_pf2\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_afa6f9a9f3c905b28cc29841935e44fdb}{internal::pset1<float4>}}(0);}
\DoxyCodeLine{00795\ \ \ \ \ lhs\_pf3\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_afa6f9a9f3c905b28cc29841935e44fdb}{internal::pset1<float4>}}(0);}
\DoxyCodeLine{00796\ }
\DoxyCodeLine{00797\ \ \ \ \ rhs\_pf0\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_afa6f9a9f3c905b28cc29841935e44fdb}{internal::pset1<float4>}}(0);}
\DoxyCodeLine{00798\ \ \ \ \ rhs\_pf1\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_afa6f9a9f3c905b28cc29841935e44fdb}{internal::pset1<float4>}}(0);}
\DoxyCodeLine{00799\ }
\DoxyCodeLine{00800\ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!CHECK\_LHS\_BOUNDARY)\ \{}
\DoxyCodeLine{00801\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((threadIdx.y/4+k+24)\ <\ k\_size)\ \{}
\DoxyCodeLine{00802\ \ \ \ \ \ \ \ \ lhs\_pf0\ =lhs.template\ loadPacket<float4,Unaligned>(lhs\_vert,\ (threadIdx.y/4+k));}
\DoxyCodeLine{00803\ \ \ \ \ \ \ \ \ lhs\_pf1\ =lhs.template\ loadPacket<float4,Unaligned>(lhs\_vert,\ (threadIdx.y/4+k+8));}
\DoxyCodeLine{00804\ \ \ \ \ \ \ \ \ lhs\_pf2\ =lhs.template\ loadPacket<float4,Unaligned>(lhs\_vert,\ (threadIdx.y/4+k+16));}
\DoxyCodeLine{00805\ \ \ \ \ \ \ \ \ lhs\_pf3\ =lhs.template\ loadPacket<float4,Unaligned>(lhs\_vert,\ (threadIdx.y/4+k+24));}
\DoxyCodeLine{00806\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((threadIdx.y/4+k+16)\ <\ k\_size)\ \{}
\DoxyCodeLine{00807\ \ \ \ \ \ \ \ \ lhs\_pf0\ =lhs.template\ loadPacket<float4,Unaligned>(lhs\_vert,\ (threadIdx.y/4+k));}
\DoxyCodeLine{00808\ \ \ \ \ \ \ \ \ lhs\_pf1\ =lhs.template\ loadPacket<float4,Unaligned>(lhs\_vert,\ (threadIdx.y/4+k+8));}
\DoxyCodeLine{00809\ \ \ \ \ \ \ \ \ lhs\_pf2\ =lhs.template\ loadPacket<float4,Unaligned>(lhs\_vert,\ (threadIdx.y/4+k+16));}
\DoxyCodeLine{00810\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((threadIdx.y/4+k+8)\ <\ k\_size)\ \{}
\DoxyCodeLine{00811\ \ \ \ \ \ \ \ \ lhs\_pf0\ =lhs.template\ loadPacket<float4,Unaligned>(lhs\_vert,\ (threadIdx.y/4+k));}
\DoxyCodeLine{00812\ \ \ \ \ \ \ \ \ lhs\_pf1\ =lhs.template\ loadPacket<float4,Unaligned>(lhs\_vert,\ (threadIdx.y/4+k+8));}
\DoxyCodeLine{00813\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((threadIdx.y/4+k)\ <\ k\_size)\ \{}
\DoxyCodeLine{00814\ \ \ \ \ \ \ \ \ lhs\_pf0\ =lhs.template\ loadPacket<float4,Unaligned>(lhs\_vert,\ (threadIdx.y/4+k));}
\DoxyCodeLine{00815\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00816\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00817\ \ \ \ \ \ \ \textcolor{comment}{//\ just\ CHECK\_LHS\_BOUNDARY}}
\DoxyCodeLine{00818\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (lhs\_vert\ +\ 3\ <\ m\_size)\ \{}
\DoxyCodeLine{00819\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((threadIdx.y/4+k+24)\ <\ k\_size)\ \{}
\DoxyCodeLine{00820\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0\ =lhs.template\ loadPacket<float4,Unaligned>(lhs\_vert,\ (threadIdx.y/4+k));}
\DoxyCodeLine{00821\ \ \ \ \ \ \ \ \ \ \ lhs\_pf1\ =lhs.template\ loadPacket<float4,Unaligned>(lhs\_vert,\ (threadIdx.y/4+k+8));}
\DoxyCodeLine{00822\ \ \ \ \ \ \ \ \ \ \ lhs\_pf2\ =lhs.template\ loadPacket<float4,Unaligned>(lhs\_vert,\ (threadIdx.y/4+k+16));}
\DoxyCodeLine{00823\ \ \ \ \ \ \ \ \ \ \ lhs\_pf3\ =lhs.template\ loadPacket<float4,Unaligned>(lhs\_vert,\ (threadIdx.y/4+k+24));}
\DoxyCodeLine{00824\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((threadIdx.y/4+k+16)\ <\ k\_size)\ \{}
\DoxyCodeLine{00825\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0\ =lhs.template\ loadPacket<float4,Unaligned>(lhs\_vert,\ (threadIdx.y/4+k));}
\DoxyCodeLine{00826\ \ \ \ \ \ \ \ \ \ \ lhs\_pf1\ =lhs.template\ loadPacket<float4,Unaligned>(lhs\_vert,\ (threadIdx.y/4+k+8));}
\DoxyCodeLine{00827\ \ \ \ \ \ \ \ \ \ \ lhs\_pf2\ =lhs.template\ loadPacket<float4,Unaligned>(lhs\_vert,\ (threadIdx.y/4+k+16));}
\DoxyCodeLine{00828\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((threadIdx.y/4+k+8)\ <\ k\_size)\ \{}
\DoxyCodeLine{00829\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0\ =lhs.template\ loadPacket<float4,Unaligned>(lhs\_vert,\ (threadIdx.y/4+k));}
\DoxyCodeLine{00830\ \ \ \ \ \ \ \ \ \ \ lhs\_pf1\ =lhs.template\ loadPacket<float4,Unaligned>(lhs\_vert,\ (threadIdx.y/4+k+8));}
\DoxyCodeLine{00831\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((threadIdx.y/4+k)\ <\ k\_size)\ \{}
\DoxyCodeLine{00832\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0\ =lhs.template\ loadPacket<float4,Unaligned>(lhs\_vert,\ (threadIdx.y/4+k));}
\DoxyCodeLine{00833\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00834\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (lhs\_vert\ +\ 2\ <\ m\_size)\ \{}
\DoxyCodeLine{00835\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((threadIdx.y/4+k+24)\ <\ k\_size)\ \{}
\DoxyCodeLine{00836\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.x\ =lhs(lhs\_vert\ +\ 0,\ (threadIdx.y/4+k));}
\DoxyCodeLine{00837\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.y\ =lhs(lhs\_vert\ +\ 1,\ (threadIdx.y/4+k));}
\DoxyCodeLine{00838\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.z\ =lhs(lhs\_vert\ +\ 2,\ (threadIdx.y/4+k));}
\DoxyCodeLine{00839\ \ \ \ \ \ \ \ \ \ \ lhs\_pf1.x\ =lhs(lhs\_vert\ +\ 0,\ (threadIdx.y/4+k+8));}
\DoxyCodeLine{00840\ \ \ \ \ \ \ \ \ \ \ lhs\_pf1.y\ =lhs(lhs\_vert\ +\ 1,\ (threadIdx.y/4+k+8));}
\DoxyCodeLine{00841\ \ \ \ \ \ \ \ \ \ \ lhs\_pf1.z\ =lhs(lhs\_vert\ +\ 2,\ (threadIdx.y/4+k+8));}
\DoxyCodeLine{00842\ \ \ \ \ \ \ \ \ \ \ lhs\_pf2.x\ =lhs(lhs\_vert\ +\ 0,\ (threadIdx.y/4+k+16));}
\DoxyCodeLine{00843\ \ \ \ \ \ \ \ \ \ \ lhs\_pf2.y\ =lhs(lhs\_vert\ +\ 1,\ (threadIdx.y/4+k+16));}
\DoxyCodeLine{00844\ \ \ \ \ \ \ \ \ \ \ lhs\_pf2.z\ =lhs(lhs\_vert\ +\ 2,\ (threadIdx.y/4+k+16));}
\DoxyCodeLine{00845\ \ \ \ \ \ \ \ \ \ \ lhs\_pf3.x\ =lhs(lhs\_vert\ +\ 0,\ (threadIdx.y/4+k+24));}
\DoxyCodeLine{00846\ \ \ \ \ \ \ \ \ \ \ lhs\_pf3.y\ =lhs(lhs\_vert\ +\ 1,\ (threadIdx.y/4+k+24));}
\DoxyCodeLine{00847\ \ \ \ \ \ \ \ \ \ \ lhs\_pf3.z\ =lhs(lhs\_vert\ +\ 2,\ (threadIdx.y/4+k+24));}
\DoxyCodeLine{00848\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((threadIdx.y/4+k+16)\ <\ k\_size)\ \{}
\DoxyCodeLine{00849\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.x\ =lhs(lhs\_vert\ +\ 0,\ (threadIdx.y/4+k));}
\DoxyCodeLine{00850\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.y\ =lhs(lhs\_vert\ +\ 1,\ (threadIdx.y/4+k));}
\DoxyCodeLine{00851\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.z\ =lhs(lhs\_vert\ +\ 2,\ (threadIdx.y/4+k));}
\DoxyCodeLine{00852\ \ \ \ \ \ \ \ \ \ \ lhs\_pf1.x\ =lhs(lhs\_vert\ +\ 0,\ (threadIdx.y/4+k+8));}
\DoxyCodeLine{00853\ \ \ \ \ \ \ \ \ \ \ lhs\_pf1.y\ =lhs(lhs\_vert\ +\ 1,\ (threadIdx.y/4+k+8));}
\DoxyCodeLine{00854\ \ \ \ \ \ \ \ \ \ \ lhs\_pf1.z\ =lhs(lhs\_vert\ +\ 2,\ (threadIdx.y/4+k+8));}
\DoxyCodeLine{00855\ \ \ \ \ \ \ \ \ \ \ lhs\_pf2.x\ =lhs(lhs\_vert\ +\ 0,\ (threadIdx.y/4+k+16));}
\DoxyCodeLine{00856\ \ \ \ \ \ \ \ \ \ \ lhs\_pf2.y\ =lhs(lhs\_vert\ +\ 1,\ (threadIdx.y/4+k+16));}
\DoxyCodeLine{00857\ \ \ \ \ \ \ \ \ \ \ lhs\_pf2.z\ =lhs(lhs\_vert\ +\ 2,\ (threadIdx.y/4+k+16));}
\DoxyCodeLine{00858\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((threadIdx.y/4+k+8)\ <\ k\_size)\ \{}
\DoxyCodeLine{00859\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.x\ =lhs(lhs\_vert\ +\ 0,\ (threadIdx.y/4+k));}
\DoxyCodeLine{00860\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.y\ =lhs(lhs\_vert\ +\ 1,\ (threadIdx.y/4+k));}
\DoxyCodeLine{00861\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.z\ =lhs(lhs\_vert\ +\ 2,\ (threadIdx.y/4+k));}
\DoxyCodeLine{00862\ \ \ \ \ \ \ \ \ \ \ lhs\_pf1.x\ =lhs(lhs\_vert\ +\ 0,\ (threadIdx.y/4+k+8));}
\DoxyCodeLine{00863\ \ \ \ \ \ \ \ \ \ \ lhs\_pf1.y\ =lhs(lhs\_vert\ +\ 1,\ (threadIdx.y/4+k+8));}
\DoxyCodeLine{00864\ \ \ \ \ \ \ \ \ \ \ lhs\_pf1.z\ =lhs(lhs\_vert\ +\ 2,\ (threadIdx.y/4+k+8));}
\DoxyCodeLine{00865\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((threadIdx.y/4+k)\ <\ k\_size)\ \{}
\DoxyCodeLine{00866\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.x\ =lhs(lhs\_vert\ +\ 0,\ (threadIdx.y/4+k));}
\DoxyCodeLine{00867\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.y\ =lhs(lhs\_vert\ +\ 1,\ (threadIdx.y/4+k));}
\DoxyCodeLine{00868\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.z\ =lhs(lhs\_vert\ +\ 2,\ (threadIdx.y/4+k));}
\DoxyCodeLine{00869\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00870\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (lhs\_vert\ +\ 1\ <\ m\_size)\ \{}
\DoxyCodeLine{00871\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((threadIdx.y/4+k+24)\ <\ k\_size)\ \{}
\DoxyCodeLine{00872\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.x\ =lhs(lhs\_vert\ +\ 0,\ (threadIdx.y/4+k));}
\DoxyCodeLine{00873\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.y\ =lhs(lhs\_vert\ +\ 1,\ (threadIdx.y/4+k));}
\DoxyCodeLine{00874\ \ \ \ \ \ \ \ \ \ \ lhs\_pf1.x\ =lhs(lhs\_vert\ +\ 0,\ (threadIdx.y/4+k+8));}
\DoxyCodeLine{00875\ \ \ \ \ \ \ \ \ \ \ lhs\_pf1.y\ =lhs(lhs\_vert\ +\ 1,\ (threadIdx.y/4+k+8));}
\DoxyCodeLine{00876\ \ \ \ \ \ \ \ \ \ \ lhs\_pf2.x\ =lhs(lhs\_vert\ +\ 0,\ (threadIdx.y/4+k+16));}
\DoxyCodeLine{00877\ \ \ \ \ \ \ \ \ \ \ lhs\_pf2.y\ =lhs(lhs\_vert\ +\ 1,\ (threadIdx.y/4+k+16));}
\DoxyCodeLine{00878\ \ \ \ \ \ \ \ \ \ \ lhs\_pf3.x\ =lhs(lhs\_vert\ +\ 0,\ (threadIdx.y/4+k+24));}
\DoxyCodeLine{00879\ \ \ \ \ \ \ \ \ \ \ lhs\_pf3.y\ =lhs(lhs\_vert\ +\ 1,\ (threadIdx.y/4+k+24));}
\DoxyCodeLine{00880\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((threadIdx.y/4+k+16)\ <\ k\_size)\ \{}
\DoxyCodeLine{00881\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.x\ =lhs(lhs\_vert\ +\ 0,\ (threadIdx.y/4+k));}
\DoxyCodeLine{00882\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.y\ =lhs(lhs\_vert\ +\ 1,\ (threadIdx.y/4+k));}
\DoxyCodeLine{00883\ \ \ \ \ \ \ \ \ \ \ lhs\_pf1.x\ =lhs(lhs\_vert\ +\ 0,\ (threadIdx.y/4+k+8));}
\DoxyCodeLine{00884\ \ \ \ \ \ \ \ \ \ \ lhs\_pf1.y\ =lhs(lhs\_vert\ +\ 1,\ (threadIdx.y/4+k+8));}
\DoxyCodeLine{00885\ \ \ \ \ \ \ \ \ \ \ lhs\_pf2.x\ =lhs(lhs\_vert\ +\ 0,\ (threadIdx.y/4+k+16));}
\DoxyCodeLine{00886\ \ \ \ \ \ \ \ \ \ \ lhs\_pf2.y\ =lhs(lhs\_vert\ +\ 1,\ (threadIdx.y/4+k+16));}
\DoxyCodeLine{00887\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((threadIdx.y/4+k+8)\ <\ k\_size)\ \{}
\DoxyCodeLine{00888\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.x\ =lhs(lhs\_vert\ +\ 0,\ (threadIdx.y/4+k));}
\DoxyCodeLine{00889\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.y\ =lhs(lhs\_vert\ +\ 1,\ (threadIdx.y/4+k));}
\DoxyCodeLine{00890\ \ \ \ \ \ \ \ \ \ \ lhs\_pf1.x\ =lhs(lhs\_vert\ +\ 0,\ (threadIdx.y/4+k+8));}
\DoxyCodeLine{00891\ \ \ \ \ \ \ \ \ \ \ lhs\_pf1.y\ =lhs(lhs\_vert\ +\ 1,\ (threadIdx.y/4+k+8));}
\DoxyCodeLine{00892\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((threadIdx.y/4+k)\ <\ k\_size)\ \{}
\DoxyCodeLine{00893\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.x\ =lhs(lhs\_vert\ +\ 0,\ (threadIdx.y/4+k));}
\DoxyCodeLine{00894\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.y\ =lhs(lhs\_vert\ +\ 1,\ (threadIdx.y/4+k));}
\DoxyCodeLine{00895\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00896\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (lhs\_vert\ <\ m\_size)\ \{}
\DoxyCodeLine{00897\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((threadIdx.y/4+k+24)\ <\ k\_size)\ \{}
\DoxyCodeLine{00898\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.x\ =lhs(lhs\_vert\ +\ 0,\ (threadIdx.y/4+k));}
\DoxyCodeLine{00899\ \ \ \ \ \ \ \ \ \ \ lhs\_pf1.x\ =lhs(lhs\_vert\ +\ 0,\ (threadIdx.y/4+k+8));}
\DoxyCodeLine{00900\ \ \ \ \ \ \ \ \ \ \ lhs\_pf2.x\ =lhs(lhs\_vert\ +\ 0,\ (threadIdx.y/4+k+16));}
\DoxyCodeLine{00901\ \ \ \ \ \ \ \ \ \ \ lhs\_pf3.x\ =lhs(lhs\_vert\ +\ 0,\ (threadIdx.y/4+k+24));}
\DoxyCodeLine{00902\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((threadIdx.y/4+k+16)\ <\ k\_size)\ \{}
\DoxyCodeLine{00903\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.x\ =lhs(lhs\_vert\ +\ 0,\ (threadIdx.y/4+k));}
\DoxyCodeLine{00904\ \ \ \ \ \ \ \ \ \ \ lhs\_pf1.x\ =lhs(lhs\_vert\ +\ 0,\ (threadIdx.y/4+k+8));}
\DoxyCodeLine{00905\ \ \ \ \ \ \ \ \ \ \ lhs\_pf2.x\ =lhs(lhs\_vert\ +\ 0,\ (threadIdx.y/4+k+16));}
\DoxyCodeLine{00906\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((threadIdx.y/4+k+8)\ <\ k\_size)\ \{}
\DoxyCodeLine{00907\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.x\ =lhs(lhs\_vert\ +\ 0,\ (threadIdx.y/4+k));}
\DoxyCodeLine{00908\ \ \ \ \ \ \ \ \ \ \ lhs\_pf1.x\ =lhs(lhs\_vert\ +\ 0,\ (threadIdx.y/4+k+8));}
\DoxyCodeLine{00909\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((threadIdx.y/4+k)\ <\ k\_size)\ \{}
\DoxyCodeLine{00910\ \ \ \ \ \ \ \ \ \ \ lhs\_pf0.x\ =lhs(lhs\_vert\ +\ 0,\ (threadIdx.y/4+k));}
\DoxyCodeLine{00911\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00912\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00913\ \ \ \ \ \}}
\DoxyCodeLine{00914\ \ \ \ \ \_\_syncthreads();}
\DoxyCodeLine{00915\ \ \ \ \ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ rhs\_vert\ =\ k+threadIdx.x*4;}
\DoxyCodeLine{00916\ \ \ \ \ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ rhs\_horiz0\ =\ threadIdx.y*2+base\_n;}
\DoxyCodeLine{00917\ \ \ \ \ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ rhs\_horiz1\ =\ threadIdx.y*2+1+base\_n;}
\DoxyCodeLine{00918\ \ \ \ \ \textcolor{keywordflow}{if}\ (!CHECK\_RHS\_BOUNDARY)\ \{}
\DoxyCodeLine{00919\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((rhs\_vert\ +\ 3)\ <\ k\_size)\ \{}
\DoxyCodeLine{00920\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ just\ CHECK\_RHS\_BOUNDARY}}
\DoxyCodeLine{00921\ \ \ \ \ \ \ \ \ rhs\_pf0\ =\ rhs.template\ loadPacket<float4,Unaligned>(rhs\_vert,\ rhs\_horiz0);}
\DoxyCodeLine{00922\ \ \ \ \ \ \ \ \ rhs\_pf1\ =\ rhs.template\ loadPacket<float4,Unaligned>(rhs\_vert,\ rhs\_horiz1);}
\DoxyCodeLine{00923\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (rhs\_vert\ +\ 2\ <\ k\_size)\ \{}
\DoxyCodeLine{00924\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ just\ CHECK\_RHS\_BOUNDARY}}
\DoxyCodeLine{00925\ \ \ \ \ \ \ \ \ rhs\_pf0.x\ =\ rhs(rhs\_vert,\ rhs\_horiz0);}
\DoxyCodeLine{00926\ \ \ \ \ \ \ \ \ rhs\_pf0.y\ =\ rhs(rhs\_vert\ +\ 1,\ rhs\_horiz0);}
\DoxyCodeLine{00927\ \ \ \ \ \ \ \ \ rhs\_pf0.z\ =\ rhs(rhs\_vert\ +\ 2,\ rhs\_horiz0);}
\DoxyCodeLine{00928\ \ \ \ \ \ \ \ \ rhs\_pf1.x\ =\ rhs(rhs\_vert,\ rhs\_horiz1);}
\DoxyCodeLine{00929\ \ \ \ \ \ \ \ \ rhs\_pf1.y\ =\ rhs(rhs\_vert\ +\ 1,\ rhs\_horiz1);}
\DoxyCodeLine{00930\ \ \ \ \ \ \ \ \ rhs\_pf1.z\ =\ rhs(rhs\_vert\ +\ 2,\ rhs\_horiz1);}
\DoxyCodeLine{00931\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (rhs\_vert\ +\ 1\ <\ k\_size)\ \{}
\DoxyCodeLine{00932\ \ \ \ \ \ \ \ \ rhs\_pf0.x\ =\ rhs(rhs\_vert,\ rhs\_horiz0);}
\DoxyCodeLine{00933\ \ \ \ \ \ \ \ \ rhs\_pf0.y\ =\ rhs(rhs\_vert\ +\ 1,\ rhs\_horiz0);}
\DoxyCodeLine{00934\ \ \ \ \ \ \ \ \ rhs\_pf1.x\ =\ rhs(rhs\_vert,\ rhs\_horiz1);}
\DoxyCodeLine{00935\ \ \ \ \ \ \ \ \ rhs\_pf1.y\ =\ rhs(rhs\_vert\ +\ 1,\ rhs\_horiz1);}
\DoxyCodeLine{00936\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (rhs\_vert\ \ <\ k\_size)\ \{}
\DoxyCodeLine{00937\ \ \ \ \ \ \ \ \ rhs\_pf0.x\ =\ rhs(rhs\_vert,\ rhs\_horiz0);}
\DoxyCodeLine{00938\ \ \ \ \ \ \ \ \ rhs\_pf1.x\ =\ rhs(rhs\_vert,\ rhs\_horiz1);}
\DoxyCodeLine{00939\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00940\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00941\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (rhs\_horiz1\ <\ n\_size)\ \{}
\DoxyCodeLine{00942\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((rhs\_vert\ +\ 3)\ <\ k\_size)\ \{}
\DoxyCodeLine{00943\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ just\ CHECK\_RHS\_BOUNDARY}}
\DoxyCodeLine{00944\ \ \ \ \ \ \ \ \ \ \ rhs\_pf0\ =\ rhs.template\ loadPacket<float4,Unaligned>(rhs\_vert,\ rhs\_horiz0);}
\DoxyCodeLine{00945\ \ \ \ \ \ \ \ \ \ \ rhs\_pf1\ =\ rhs.template\ loadPacket<float4,Unaligned>(rhs\_vert,\ rhs\_horiz1);}
\DoxyCodeLine{00946\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (rhs\_vert\ +\ 2\ <\ k\_size)\ \{}
\DoxyCodeLine{00947\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ just\ CHECK\_RHS\_BOUNDARY}}
\DoxyCodeLine{00948\ \ \ \ \ \ \ \ \ \ \ rhs\_pf0.x\ =\ rhs(rhs\_vert,\ rhs\_horiz0);}
\DoxyCodeLine{00949\ \ \ \ \ \ \ \ \ \ \ rhs\_pf0.y\ =\ rhs(rhs\_vert\ +\ 1,\ rhs\_horiz0);}
\DoxyCodeLine{00950\ \ \ \ \ \ \ \ \ \ \ rhs\_pf0.z\ =\ rhs(rhs\_vert\ +\ 2,\ rhs\_horiz0);}
\DoxyCodeLine{00951\ \ \ \ \ \ \ \ \ \ \ rhs\_pf1.x\ =\ rhs(rhs\_vert,\ rhs\_horiz1);}
\DoxyCodeLine{00952\ \ \ \ \ \ \ \ \ \ \ rhs\_pf1.y\ =\ rhs(rhs\_vert\ +\ 1,\ rhs\_horiz1);}
\DoxyCodeLine{00953\ \ \ \ \ \ \ \ \ \ \ rhs\_pf1.z\ =\ rhs(rhs\_vert\ +\ 2,\ rhs\_horiz1);}
\DoxyCodeLine{00954\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (k+threadIdx.x*4\ +\ 1\ <\ k\_size)\ \{}
\DoxyCodeLine{00955\ \ \ \ \ \ \ \ \ \ \ rhs\_pf0.x\ =\ rhs(rhs\_vert,\ rhs\_horiz0);}
\DoxyCodeLine{00956\ \ \ \ \ \ \ \ \ \ \ rhs\_pf0.y\ =\ rhs(rhs\_vert\ +\ 1,\ rhs\_horiz0);}
\DoxyCodeLine{00957\ \ \ \ \ \ \ \ \ \ \ rhs\_pf1.x\ =\ rhs(rhs\_vert,\ rhs\_horiz1);}
\DoxyCodeLine{00958\ \ \ \ \ \ \ \ \ \ \ rhs\_pf1.y\ =\ rhs(rhs\_vert\ +\ 1,\ rhs\_horiz1);}
\DoxyCodeLine{00959\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (k+threadIdx.x*4\ \ <\ k\_size)\ \{}
\DoxyCodeLine{00960\ \ \ \ \ \ \ \ \ \ \ rhs\_pf0.x\ =\ rhs(rhs\_vert,\ rhs\_horiz0);}
\DoxyCodeLine{00961\ \ \ \ \ \ \ \ \ \ \ rhs\_pf1.x\ =\ rhs(rhs\_vert,\ rhs\_horiz1);}
\DoxyCodeLine{00962\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00963\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (rhs\_horiz0\ <\ n\_size)\ \{}
\DoxyCodeLine{00964\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((rhs\_vert\ +\ 3)\ <\ k\_size)\ \{}
\DoxyCodeLine{00965\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ just\ CHECK\_RHS\_BOUNDARY}}
\DoxyCodeLine{00966\ \ \ \ \ \ \ \ \ \ \ rhs\_pf0\ =\ rhs.template\ loadPacket<float4,Unaligned>(rhs\_vert,\ rhs\_horiz0);}
\DoxyCodeLine{00967\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((rhs\_vert\ +\ 2)\ <\ k\_size)\ \{}
\DoxyCodeLine{00968\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ just\ CHECK\_RHS\_BOUNDARY}}
\DoxyCodeLine{00969\ \ \ \ \ \ \ \ \ \ \ rhs\_pf0.x\ =\ rhs(rhs\_vert,\ rhs\_horiz0);}
\DoxyCodeLine{00970\ \ \ \ \ \ \ \ \ \ \ rhs\_pf0.y\ =\ rhs(rhs\_vert\ +\ 1,\ rhs\_horiz0);}
\DoxyCodeLine{00971\ \ \ \ \ \ \ \ \ \ \ rhs\_pf0.z\ =\ rhs(rhs\_vert\ +\ 2,\ rhs\_horiz0);}
\DoxyCodeLine{00972\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((rhs\_vert\ +\ 1)\ <\ k\_size)\ \{}
\DoxyCodeLine{00973\ \ \ \ \ \ \ \ \ \ \ rhs\_pf0.x\ =\ rhs(rhs\_vert,\ rhs\_horiz0);}
\DoxyCodeLine{00974\ \ \ \ \ \ \ \ \ \ \ rhs\_pf0.y\ =\ rhs(rhs\_vert\ +\ 1,\ rhs\_horiz0);}
\DoxyCodeLine{00975\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (rhs\_vert\ \ <\ k\_size)\ \{}
\DoxyCodeLine{00976\ \ \ \ \ \ \ \ \ \ \ rhs\_pf0.x\ =\ rhs(rhs\_vert,\ rhs\_horiz0);}
\DoxyCodeLine{00977\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00978\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00979\ \ \ \ \ \}}
\DoxyCodeLine{00980\ \ \ \ \ \_\_syncthreads();}
\DoxyCodeLine{00981\ \ \ \ \ \textcolor{comment}{//\ Loaded.\ Do\ computation}}
\DoxyCodeLine{00982\ \ \ \ \ \textcolor{comment}{//\ Row\ 0\ -\/>\ times\ (0,\ 4,\ 8,\ ..\ 28)\ for\ features\ 0,\ 1.}}
\DoxyCodeLine{00983\ \ \ \ \ \textcolor{comment}{//\ Row\ 1\ -\/>\ times\ (0,\ 4,\ 8,\ ..\ 28)\ for\ features\ 2,\ 3.}}
\DoxyCodeLine{00984\ \ \ \ \ \textcolor{comment}{//\ ..}}
\DoxyCodeLine{00985\ \ \ \ \ \textcolor{comment}{//\ Row\ 31\ -\/>\ times\ (0,\ 4,\ 8,\ ..\ 28)\ for\ features\ 62,\ 63}}
\DoxyCodeLine{00986\ \ \ \ \ rhs\_shmem2[threadIdx.y][threadIdx.x]\ =\ make\_float2(rhs\_pf0.x,\ rhs\_pf1.x);}
\DoxyCodeLine{00987\ \ \ \ \ \textcolor{comment}{//\ Row\ 32\ -\/>\ times\ (1,\ 5,\ 9,\ ..\ 29)\ for\ features\ 0,\ 1.}}
\DoxyCodeLine{00988\ \ \ \ \ \textcolor{comment}{//\ Row\ 33\ -\/>\ times\ (1,\ 5,\ 9,\ ..\ 29)\ for\ features\ 2,\ 3.}}
\DoxyCodeLine{00989\ \ \ \ \ \textcolor{comment}{//\ ..}}
\DoxyCodeLine{00990\ \ \ \ \ rhs\_shmem2[threadIdx.y+32][threadIdx.x]\ =\ make\_float2(rhs\_pf0.y,\ rhs\_pf1.y);}
\DoxyCodeLine{00991\ \ \ \ \ \textcolor{comment}{//\ Row\ 64\ -\/>\ times\ (2,\ 6,\ 10,\ ..\ 30)\ for\ features\ 0,\ 1.}}
\DoxyCodeLine{00992\ \ \ \ \ \textcolor{comment}{//\ Row\ 65\ -\/>\ times\ (2,\ 6,\ 10,\ ..\ 30)\ for\ features\ 2,\ 3.}}
\DoxyCodeLine{00993\ \ \ \ \ rhs\_shmem2[threadIdx.y+64][threadIdx.x]\ =\ make\_float2(rhs\_pf0.z,\ rhs\_pf1.z);}
\DoxyCodeLine{00994\ \ \ \ \ \textcolor{comment}{//\ Row\ 96\ -\/>\ times\ (3,\ 7,\ 11,\ ..\ 31)\ for\ features\ 0,\ 1.}}
\DoxyCodeLine{00995\ \ \ \ \ \textcolor{comment}{//\ Row\ 97\ -\/>\ times\ (3,\ 7,\ 11,\ ..\ 31)\ for\ features\ 2,\ 3.}}
\DoxyCodeLine{00996\ \ \ \ \ rhs\_shmem2[threadIdx.y+96][threadIdx.x]\ =\ make\_float2(rhs\_pf0.w,\ rhs\_pf1.w);}
\DoxyCodeLine{00997\ }
\DoxyCodeLine{00998\ \ \ \ \ \textcolor{comment}{//\ LHS.}}
\DoxyCodeLine{00999\ \ \ \ \ \textcolor{comment}{//\ Row\ 0\ (time\ 0)\ -\/>\ features\ (0,\ 1),\ (4,\ 5),\ ..\ (28,\ 29),\ (32,\ 33),\ ..\ \ (60,\ 61)\ ..\ (124,\ 125)}}
\DoxyCodeLine{01000\ \ \ \ \ \textcolor{comment}{//\ Row\ 1\ (time\ 1)\ -\/>\ features\ (0,\ 1),\ (4,\ 5),\ ..\ (28,\ 29),\ (32,\ 33),\ ..\ \ (60,\ 61)\ ..\ (124,\ 125)}}
\DoxyCodeLine{01001\ \ \ \ \ \textcolor{comment}{//\ ...}}
\DoxyCodeLine{01002\ \ \ \ \ \textcolor{comment}{//\ Row\ 8\ (time\ 0)\ -\/>\ features\ (2,\ 3),\ (6,\ 7),\ ..\ (30,\ 31),\ (34,\ 35),\ ..\ \ (62,\ 63)\ ..\ (126,\ 127)}}
\DoxyCodeLine{01003\ \ \ \ \ \textcolor{comment}{//\ Row\ 15\ (time\ 7)\ -\/>\ features\ (2,\ 3),\ (6,\ 7),\ ..\ (30,\ 31),\ (34,\ 35),\ ..\ \ (62,\ 63)\ ..\ (126,\ 127)}}
\DoxyCodeLine{01004\ }
\DoxyCodeLine{01005\ }
\DoxyCodeLine{01006\ \textcolor{preprocessor}{\#define\ add\_vals(a\_feat1,\ a\_feat2,\ f1,\ f2,\ f3,\ f4)\(\backslash\)}}
\DoxyCodeLine{01007\ \textcolor{preprocessor}{\ \ \ \ \ \ results[0].x\ +=\ a\_feat1.x\ *\ f1.x;\(\backslash\)}}
\DoxyCodeLine{01008\ \textcolor{preprocessor}{\ \ \ \ \ \ results[1].x\ +=\ a\_feat1.x\ *\ f1.y;\(\backslash\)}}
\DoxyCodeLine{01009\ \textcolor{preprocessor}{\ \ \ \ \ \ results[2].x\ +=\ a\_feat1.x\ *\ f2.x;\(\backslash\)}}
\DoxyCodeLine{01010\ \textcolor{preprocessor}{\ \ \ \ \ \ results[3].x\ +=\ a\_feat1.x\ *\ f2.y;\(\backslash\)}}
\DoxyCodeLine{01011\ \textcolor{preprocessor}{\ \ \ \ \ \ results[4].x\ +=\ a\_feat1.x\ *\ f3.x;\(\backslash\)}}
\DoxyCodeLine{01012\ \textcolor{preprocessor}{\ \ \ \ \ \ results[5].x\ +=\ a\_feat1.x\ *\ f3.y;\(\backslash\)}}
\DoxyCodeLine{01013\ \textcolor{preprocessor}{\ \ \ \ \ \ results[6].x\ +=\ a\_feat1.x\ *\ f4.x;\(\backslash\)}}
\DoxyCodeLine{01014\ \textcolor{preprocessor}{\ \ \ \ \ \ results[7].x\ +=\ a\_feat1.x\ *\ f4.y;\(\backslash\)}}
\DoxyCodeLine{01015\ \textcolor{preprocessor}{\(\backslash\)}}
\DoxyCodeLine{01016\ \textcolor{preprocessor}{\ \ \ \ \ \ results[0].y\ +=\ a\_feat1.y\ *\ f1.x;\(\backslash\)}}
\DoxyCodeLine{01017\ \textcolor{preprocessor}{\ \ \ \ \ \ results[1].y\ +=\ a\_feat1.y\ *\ f1.y;\(\backslash\)}}
\DoxyCodeLine{01018\ \textcolor{preprocessor}{\ \ \ \ \ \ results[2].y\ +=\ a\_feat1.y\ *\ f2.x;\(\backslash\)}}
\DoxyCodeLine{01019\ \textcolor{preprocessor}{\ \ \ \ \ \ results[3].y\ +=\ a\_feat1.y\ *\ f2.y;\(\backslash\)}}
\DoxyCodeLine{01020\ \textcolor{preprocessor}{\ \ \ \ \ \ results[4].y\ +=\ a\_feat1.y\ *\ f3.x;\(\backslash\)}}
\DoxyCodeLine{01021\ \textcolor{preprocessor}{\ \ \ \ \ \ results[5].y\ +=\ a\_feat1.y\ *\ f3.y;\(\backslash\)}}
\DoxyCodeLine{01022\ \textcolor{preprocessor}{\ \ \ \ \ \ results[6].y\ +=\ a\_feat1.y\ *\ f4.x;\(\backslash\)}}
\DoxyCodeLine{01023\ \textcolor{preprocessor}{\ \ \ \ \ \ results[7].y\ +=\ a\_feat1.y\ *\ f4.y;\(\backslash\)}}
\DoxyCodeLine{01024\ \textcolor{preprocessor}{\(\backslash\)}}
\DoxyCodeLine{01025\ \textcolor{preprocessor}{\ \ \ \ \ \ results[0].z\ +=\ a\_feat2.x\ *\ f1.x;\(\backslash\)}}
\DoxyCodeLine{01026\ \textcolor{preprocessor}{\ \ \ \ \ \ results[1].z\ +=\ a\_feat2.x\ *\ f1.y;\(\backslash\)}}
\DoxyCodeLine{01027\ \textcolor{preprocessor}{\ \ \ \ \ \ results[2].z\ +=\ a\_feat2.x\ *\ f2.x;\(\backslash\)}}
\DoxyCodeLine{01028\ \textcolor{preprocessor}{\ \ \ \ \ \ results[3].z\ +=\ a\_feat2.x\ *\ f2.y;\(\backslash\)}}
\DoxyCodeLine{01029\ \textcolor{preprocessor}{\ \ \ \ \ \ results[4].z\ +=\ a\_feat2.x\ *\ f3.x;\(\backslash\)}}
\DoxyCodeLine{01030\ \textcolor{preprocessor}{\ \ \ \ \ \ results[5].z\ +=\ a\_feat2.x\ *\ f3.y;\(\backslash\)}}
\DoxyCodeLine{01031\ \textcolor{preprocessor}{\ \ \ \ \ \ results[6].z\ +=\ a\_feat2.x\ *\ f4.x;\(\backslash\)}}
\DoxyCodeLine{01032\ \textcolor{preprocessor}{\ \ \ \ \ \ results[7].z\ +=\ a\_feat2.x\ *\ f4.y;\(\backslash\)}}
\DoxyCodeLine{01033\ \textcolor{preprocessor}{\(\backslash\)}}
\DoxyCodeLine{01034\ \textcolor{preprocessor}{\ \ \ \ \ \ results[0].w\ +=\ a\_feat2.y\ *\ f1.x;\(\backslash\)}}
\DoxyCodeLine{01035\ \textcolor{preprocessor}{\ \ \ \ \ \ results[1].w\ +=\ a\_feat2.y\ *\ f1.y;\(\backslash\)}}
\DoxyCodeLine{01036\ \textcolor{preprocessor}{\ \ \ \ \ \ results[2].w\ +=\ a\_feat2.y\ *\ f2.x;\(\backslash\)}}
\DoxyCodeLine{01037\ \textcolor{preprocessor}{\ \ \ \ \ \ results[3].w\ +=\ a\_feat2.y\ *\ f2.y;\(\backslash\)}}
\DoxyCodeLine{01038\ \textcolor{preprocessor}{\ \ \ \ \ \ results[4].w\ +=\ a\_feat2.y\ *\ f3.x;\(\backslash\)}}
\DoxyCodeLine{01039\ \textcolor{preprocessor}{\ \ \ \ \ \ results[5].w\ +=\ a\_feat2.y\ *\ f3.y;\(\backslash\)}}
\DoxyCodeLine{01040\ \textcolor{preprocessor}{\ \ \ \ \ \ results[6].w\ +=\ a\_feat2.y\ *\ f4.x;\(\backslash\)}}
\DoxyCodeLine{01041\ \textcolor{preprocessor}{\ \ \ \ \ \ results[7].w\ +=\ a\_feat2.y\ *\ f4.y;\(\backslash\)}}
\DoxyCodeLine{01042\ \textcolor{preprocessor}{}}
\DoxyCodeLine{01043\ \ \ \ \ lhs\_shmem2[threadIdx.y/4][threadIdx.x+(threadIdx.y\%4)*8]\ =\ make\_float2(lhs\_pf0.x,\ lhs\_pf0.y);}
\DoxyCodeLine{01044\ \ \ \ \ lhs\_shmem2[threadIdx.y/4+8][threadIdx.x+(threadIdx.y\%4)*8]\ =\ make\_float2(lhs\_pf1.x,\ lhs\_pf1.y);}
\DoxyCodeLine{01045\ \ \ \ \ lhs\_shmem2[threadIdx.y/4+16][threadIdx.x+(threadIdx.y\%4)*8]\ =\ make\_float2(lhs\_pf2.x,\ lhs\_pf2.y);}
\DoxyCodeLine{01046\ \ \ \ \ lhs\_shmem2[threadIdx.y/4+24][threadIdx.x+(threadIdx.y\%4)*8]\ =\ make\_float2(lhs\_pf3.x,\ lhs\_pf3.y);}
\DoxyCodeLine{01047\ }
\DoxyCodeLine{01048\ \ \ \ \ lhs\_shmem2[threadIdx.y/4\ +\ 32][threadIdx.x+(threadIdx.y\%4)*8]\ =\ make\_float2(lhs\_pf0.z,\ lhs\_pf0.w);}
\DoxyCodeLine{01049\ \ \ \ \ lhs\_shmem2[threadIdx.y/4\ +\ 40][threadIdx.x+(threadIdx.y\%4)*8]\ =\ make\_float2(lhs\_pf1.z,\ lhs\_pf1.w);}
\DoxyCodeLine{01050\ \ \ \ \ lhs\_shmem2[threadIdx.y/4\ +\ 48][threadIdx.x+(threadIdx.y\%4)*8]\ =\ make\_float2(lhs\_pf2.z,\ lhs\_pf2.w);}
\DoxyCodeLine{01051\ \ \ \ \ lhs\_shmem2[threadIdx.y/4\ +\ 56][threadIdx.x+(threadIdx.y\%4)*8]\ =\ make\_float2(lhs\_pf3.z,\ lhs\_pf3.w);}
\DoxyCodeLine{01052\ }
\DoxyCodeLine{01053\ \ \ \ \ \_\_syncthreads();}
\DoxyCodeLine{01054\ }
\DoxyCodeLine{01055\ \ \ \ \ \textcolor{comment}{//\ Do\ the\ multiplies.}}
\DoxyCodeLine{01056\ \textcolor{preprocessor}{\ \ \ \ \#pragma\ unroll}}
\DoxyCodeLine{01057\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ koff\ =\ 0;\ koff\ <\ 32;\ koff\ ++)\ \{}
\DoxyCodeLine{01058\ \ \ \ \ \ \ float2\ a3\ =\ lhs\_shmem2[koff][threadIdx.x\ +\ (threadIdx.y\ \%\ 4)\ *\ 8];}
\DoxyCodeLine{01059\ \ \ \ \ \ \ float2\ a4\ =\ lhs\_shmem2[koff\ +\ 32][threadIdx.x\ +\ (threadIdx.y\ \%\ 4)\ *\ 8];}
\DoxyCodeLine{01060\ }
\DoxyCodeLine{01061\ \ \ \ \ \ \ \textcolor{comment}{//\ first\ feature\ is\ at\ (threadIdx.y/4)\ *\ 8\ last\ is\ at\ start\ +\ 8.}}
\DoxyCodeLine{01062\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ start\_feature\ =\ (threadIdx.y\ /\ 4)\ *\ 8;}
\DoxyCodeLine{01063\ }
\DoxyCodeLine{01064\ \ \ \ \ \ \ float2\ br1\ =\ rhs\_shmem2[start\_feature/2\ +\ \ \ \ \ (koff\ \%\ 4)\ *\ 32][koff/4];}
\DoxyCodeLine{01065\ \ \ \ \ \ \ float2\ br2\ =\ rhs\_shmem2[start\_feature/2\ +\ 1\ +\ (koff\ \%\ 4)\ *\ 32][koff/4];}
\DoxyCodeLine{01066\ \ \ \ \ \ \ float2\ br3\ =\ rhs\_shmem2[start\_feature/2\ +\ 2\ +\ (koff\ \%\ 4)\ *\ 32][koff/4];}
\DoxyCodeLine{01067\ \ \ \ \ \ \ float2\ br4\ =\ rhs\_shmem2[start\_feature/2\ +\ 3\ +\ (koff\ \%\ 4)\ *\ 32][koff/4];}
\DoxyCodeLine{01068\ }
\DoxyCodeLine{01069\ \ \ \ \ \ \ add\_vals(a3,\ a4,\ br1,\ br2,\ br3,\ br4)}
\DoxyCodeLine{01070\ \ \ \ \ \}}
\DoxyCodeLine{01071\ \ \ \ \ \_\_syncthreads();}
\DoxyCodeLine{01072\ \ \ \}\ \textcolor{comment}{//\ end\ loop\ over\ k}}
\DoxyCodeLine{01073\ }
\DoxyCodeLine{01074\ \ \ \_\_syncthreads();}
\DoxyCodeLine{01075\ \ \ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ horiz\_base\ =\ (threadIdx.y/4)*8+base\_n;}
\DoxyCodeLine{01076\ \ \ \textcolor{keywordflow}{if}\ (!CHECK\_LHS\_BOUNDARY\ \&\&\ !CHECK\_RHS\_BOUNDARY)\ \{}
\DoxyCodeLine{01077\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ 8;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}++)\ \{}
\DoxyCodeLine{01078\ \ \ \ \ \ \ output(lhs\_vert,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].x;}
\DoxyCodeLine{01079\ \ \ \ \ \ \ output(lhs\_vert\ +\ 1,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].y;}
\DoxyCodeLine{01080\ \ \ \ \ \ \ output(lhs\_vert\ +\ 2,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].z;}
\DoxyCodeLine{01081\ \ \ \ \ \ \ output(lhs\_vert\ +\ 3,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].w;}
\DoxyCodeLine{01082\ \ \ \ \ \}}
\DoxyCodeLine{01083\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (!CHECK\_RHS\_BOUNDARY)\ \{}
\DoxyCodeLine{01084\ \ \ \ \ \textcolor{keywordflow}{if}\ (lhs\_vert\ +\ 3\ <\ m\_size)\ \{}
\DoxyCodeLine{01085\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ 8;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}++)\ \{}
\DoxyCodeLine{01086\ \ \ \ \ \ \ \ \ output(lhs\_vert,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].x;}
\DoxyCodeLine{01087\ \ \ \ \ \ \ \ \ output(lhs\_vert\ +\ 1,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].y;}
\DoxyCodeLine{01088\ \ \ \ \ \ \ \ \ output(lhs\_vert\ +\ 2,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].z;}
\DoxyCodeLine{01089\ \ \ \ \ \ \ \ \ output(lhs\_vert\ +\ 3,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].w;}
\DoxyCodeLine{01090\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01091\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (lhs\_vert\ +\ 2\ <\ m\_size)\ \{}
\DoxyCodeLine{01092\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ 8;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}++)\ \{}
\DoxyCodeLine{01093\ \ \ \ \ \ \ \ \ output(lhs\_vert,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].x;}
\DoxyCodeLine{01094\ \ \ \ \ \ \ \ \ output(lhs\_vert\ +\ 1,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].y;}
\DoxyCodeLine{01095\ \ \ \ \ \ \ \ \ output(lhs\_vert\ +\ 2,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].z;}
\DoxyCodeLine{01096\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01097\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (lhs\_vert\ +\ 1\ <\ m\_size)\ \{}
\DoxyCodeLine{01098\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ 8;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}++)\ \{}
\DoxyCodeLine{01099\ \ \ \ \ \ \ \ \ output(lhs\_vert,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].x;}
\DoxyCodeLine{01100\ \ \ \ \ \ \ \ \ output(lhs\_vert\ +\ 1,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].y;}
\DoxyCodeLine{01101\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01102\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (lhs\_vert\ \ <\ m\_size)\ \{}
\DoxyCodeLine{01103\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ 8;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}++)\ \{}
\DoxyCodeLine{01104\ \ \ \ \ \ \ \ \ output(lhs\_vert,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].x;}
\DoxyCodeLine{01105\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01106\ \ \ \ \ \}}
\DoxyCodeLine{01107\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (!CHECK\_LHS\_BOUNDARY)\ \{}
\DoxyCodeLine{01108\ \ \ \ \ \textcolor{comment}{//\ CHECK\ BOUNDARY\_B}}
\DoxyCodeLine{01109\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ 8;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}++)\ \{}
\DoxyCodeLine{01110\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ n\_size)\ \{}
\DoxyCodeLine{01111\ \ \ \ \ \ \ \ \ output(lhs\_vert,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].x;}
\DoxyCodeLine{01112\ \ \ \ \ \ \ \ \ output(lhs\_vert\ +\ 1,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].y;}
\DoxyCodeLine{01113\ \ \ \ \ \ \ \ \ output(lhs\_vert\ +\ 2,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].z;}
\DoxyCodeLine{01114\ \ \ \ \ \ \ \ \ output(lhs\_vert\ +\ 3,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].w;}
\DoxyCodeLine{01115\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01116\ \ \ \ \ \}}
\DoxyCodeLine{01117\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01118\ \ \ \ \ \textcolor{comment}{//\ CHECK\ both\ boundaries.}}
\DoxyCodeLine{01119\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ 8;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}++)\ \{}
\DoxyCodeLine{01120\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ n\_size)\ \{}
\DoxyCodeLine{01121\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (lhs\_vert\ <\ m\_size)}
\DoxyCodeLine{01122\ \ \ \ \ \ \ \ \ \ \ output(lhs\_vert,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].x;}
\DoxyCodeLine{01123\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (lhs\_vert\ +\ 1\ <\ m\_size)}
\DoxyCodeLine{01124\ \ \ \ \ \ \ \ \ \ \ output(lhs\_vert\ +\ 1,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].y;}
\DoxyCodeLine{01125\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (lhs\_vert\ +\ 2\ <\ m\_size)}
\DoxyCodeLine{01126\ \ \ \ \ \ \ \ \ \ \ output(lhs\_vert\ +\ 2,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].z;}
\DoxyCodeLine{01127\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (lhs\_vert\ +\ 3\ <\ m\_size)}
\DoxyCodeLine{01128\ \ \ \ \ \ \ \ \ \ \ output(lhs\_vert\ +\ 3,\ horiz\_base\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ results[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].w;}
\DoxyCodeLine{01129\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01130\ \ \ \ \ \}}
\DoxyCodeLine{01131\ \ \ \}}
\DoxyCodeLine{01132\ \}}
\DoxyCodeLine{01133\ }
\DoxyCodeLine{01134\ }
\DoxyCodeLine{01135\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}},\ \textcolor{keyword}{typename}\ LhsMapper,}
\DoxyCodeLine{01136\ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typename}\ RhsMapper,\ \textcolor{keyword}{typename}\ OutputMapper>}
\DoxyCodeLine{01137\ \_\_global\_\_\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{01138\ \textcolor{preprocessor}{\#if\ defined(EIGEN\_HIPCC)}}
\DoxyCodeLine{01139\ \_\_launch\_bounds\_\_(256,\ 1)}
\DoxyCodeLine{01140\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{01141\ \_\_launch\_bounds\_\_(256)}
\DoxyCodeLine{01142\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01143\ EigenFloatContractionKernel(\textcolor{keyword}{const}\ LhsMapper\ lhs,\ \textcolor{keyword}{const}\ RhsMapper\ rhs,}
\DoxyCodeLine{01144\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ OutputMapper\ output,}
\DoxyCodeLine{01145\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ m\_size,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ n\_size,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ k\_size)\ \{}
\DoxyCodeLine{01146\ \ \ \_\_shared\_\_\ float2\ lhs\_shmem[64*32];}
\DoxyCodeLine{01147\ \ \ \_\_shared\_\_\ float2\ rhs\_shmem[128*8];}
\DoxyCodeLine{01148\ }
\DoxyCodeLine{01149\ \ \ \textcolor{keyword}{typedef}\ float2\ LHS\_MEM[64][32];}
\DoxyCodeLine{01150\ \ \ \textcolor{keyword}{typedef}\ float2\ RHS\_MEM[128][8];}
\DoxyCodeLine{01151\ }
\DoxyCodeLine{01152\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ m\_block\_idx\ =\ blockIdx.x;}
\DoxyCodeLine{01153\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ n\_block\_idx\ =\ blockIdx.y;}
\DoxyCodeLine{01154\ }
\DoxyCodeLine{01155\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ base\_m\ =\ 128\ *\ m\_block\_idx;}
\DoxyCodeLine{01156\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ base\_n\ =\ 64\ *\ n\_block\_idx;}
\DoxyCodeLine{01157\ }
\DoxyCodeLine{01158\ \ \ \textcolor{keywordtype}{bool}\ check\_rhs\ =\ (base\_n\ +\ 63)\ >=\ n\_size;}
\DoxyCodeLine{01159\ \ \ \textcolor{keywordtype}{bool}\ check\_lhs128\ =\ (base\_m\ +\ 127)\ >=\ m\_size;}
\DoxyCodeLine{01160\ }
\DoxyCodeLine{01161\ \ \ \textcolor{keywordflow}{if}\ (!check\_rhs)\ \{}
\DoxyCodeLine{01162\ \ \ \ \ \textcolor{keywordflow}{if}\ (!check\_lhs128)\ \{}
\DoxyCodeLine{01163\ \ \ \ \ \ \ \textcolor{comment}{//\ >=\ 128\ rows\ left}}
\DoxyCodeLine{01164\ \ \ \ \ \ \ EigenFloatContractionKernelInternal<Index,\ LhsMapper,\ RhsMapper,\ OutputMapper,\ false,\ false>(}
\DoxyCodeLine{01165\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lhs,\ rhs,\ output,\ *((LHS\_MEM\ *)\ lhs\_shmem),\ *((RHS\_MEM\ *)\ rhs\_shmem),\ m\_size,\ n\_size,\ k\_size,\ base\_m,\ base\_n);}
\DoxyCodeLine{01166\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01167\ \ \ \ \ \ \ EigenFloatContractionKernelInternal<Index,\ LhsMapper,\ RhsMapper,\ OutputMapper,\ true,\ false>(}
\DoxyCodeLine{01168\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lhs,\ rhs,\ output,\ *((LHS\_MEM\ *)\ lhs\_shmem),\ *((RHS\_MEM\ *)\ rhs\_shmem),\ m\_size,\ n\_size,\ k\_size,\ base\_m,\ base\_n);}
\DoxyCodeLine{01169\ \ \ \ \ \}}
\DoxyCodeLine{01170\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01171\ \ \ \ \ \textcolor{keywordflow}{if}\ (!check\_lhs128)\ \{}
\DoxyCodeLine{01172\ \ \ \ \ \ \ \textcolor{comment}{//\ >=\ 128\ rows\ left}}
\DoxyCodeLine{01173\ \ \ \ \ \ \ EigenFloatContractionKernelInternal<Index,\ LhsMapper,\ RhsMapper,\ OutputMapper,\ false,\ true>(}
\DoxyCodeLine{01174\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lhs,\ rhs,\ output,\ *((LHS\_MEM\ *)\ lhs\_shmem),\ *((RHS\_MEM\ *)\ rhs\_shmem),\ m\_size,\ n\_size,\ k\_size,\ base\_m,\ base\_n);}
\DoxyCodeLine{01175\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01176\ \ \ \ \ \ \ EigenFloatContractionKernelInternal<Index,\ LhsMapper,\ RhsMapper,\ OutputMapper,\ true,\ true>(}
\DoxyCodeLine{01177\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lhs,\ rhs,\ output,\ *((LHS\_MEM\ *)\ lhs\_shmem),\ *((RHS\_MEM\ *)\ rhs\_shmem),\ m\_size,\ n\_size,\ k\_size,\ base\_m,\ base\_n);}
\DoxyCodeLine{01178\ \ \ \ \ \}}
\DoxyCodeLine{01179\ \ \ \}}
\DoxyCodeLine{01180\ \}}
\DoxyCodeLine{01181\ }
\DoxyCodeLine{01182\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}},\ \textcolor{keyword}{typename}\ LhsMapper,}
\DoxyCodeLine{01183\ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typename}\ RhsMapper,\ \textcolor{keyword}{typename}\ OutputMapper>}
\DoxyCodeLine{01184\ \_\_global\_\_\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{01185\ \textcolor{preprocessor}{\#if\ defined(EIGEN\_HIPCC)}}
\DoxyCodeLine{01186\ \_\_launch\_bounds\_\_(256,\ 1)}
\DoxyCodeLine{01187\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{01188\ \_\_launch\_bounds\_\_(256)}
\DoxyCodeLine{01189\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01190\ EigenFloatContractionKernel16x16(\textcolor{keyword}{const}\ LhsMapper\ lhs,\ \textcolor{keyword}{const}\ RhsMapper\ rhs,}
\DoxyCodeLine{01191\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ OutputMapper\ output,}
\DoxyCodeLine{01192\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ m\_size,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ n\_size,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ k\_size)\ \{}
\DoxyCodeLine{01193\ \ \ \_\_shared\_\_\ float2\ lhs\_shmem[32][16];}
\DoxyCodeLine{01194\ \ \ \_\_shared\_\_\ float2\ rhs\_shmem[64][8];}
\DoxyCodeLine{01195\ }
\DoxyCodeLine{01196\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ m\_block\_idx\ =\ blockIdx.x;}
\DoxyCodeLine{01197\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ n\_block\_idx\ =\ blockIdx.y;}
\DoxyCodeLine{01198\ }
\DoxyCodeLine{01199\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ base\_m\ =\ 64\ *\ m\_block\_idx;}
\DoxyCodeLine{01200\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ base\_n\ =\ 64\ *\ n\_block\_idx;}
\DoxyCodeLine{01201\ }
\DoxyCodeLine{01202\ \ \ \textcolor{keywordflow}{if}\ (base\_m\ +\ 63\ <\ m\_size)\ \{}
\DoxyCodeLine{01203\ \ \ \ \ \textcolor{keywordflow}{if}\ (base\_n\ +\ 63\ <\ n\_size)\ \{}
\DoxyCodeLine{01204\ \ \ \ \ \ \ EigenFloatContractionKernelInternal16x16<Index,\ LhsMapper,\ RhsMapper,\ OutputMapper,\ false,\ false>(lhs,\ rhs,\ output,\ lhs\_shmem,\ rhs\_shmem,\ m\_size,\ n\_size,\ k\_size,\ base\_m,\ base\_n);}
\DoxyCodeLine{01205\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01206\ \ \ \ \ \ \ EigenFloatContractionKernelInternal16x16<Index,\ LhsMapper,\ RhsMapper,\ OutputMapper,\ false,\ true>(lhs,\ rhs,\ output,\ lhs\_shmem,\ rhs\_shmem,\ m\_size,\ n\_size,\ k\_size,\ base\_m,\ base\_n);}
\DoxyCodeLine{01207\ \ \ \ \ \}}
\DoxyCodeLine{01208\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01209\ \ \ \ \ \textcolor{keywordflow}{if}\ (base\_n\ +\ 63\ <\ n\_size)\ \{}
\DoxyCodeLine{01210\ \ \ \ \ \ \ EigenFloatContractionKernelInternal16x16<Index,\ LhsMapper,\ RhsMapper,\ OutputMapper,\ true,\ false>(lhs,\ rhs,\ output,\ lhs\_shmem,\ rhs\_shmem,\ m\_size,\ n\_size,\ k\_size,\ base\_m,\ base\_n);}
\DoxyCodeLine{01211\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01212\ \ \ \ \ \ \ EigenFloatContractionKernelInternal16x16<Index,\ LhsMapper,\ RhsMapper,\ OutputMapper,\ true,\ true>(lhs,\ rhs,\ output,\ lhs\_shmem,\ rhs\_shmem,\ m\_size,\ n\_size,\ k\_size,\ base\_m,\ base\_n);}
\DoxyCodeLine{01213\ \ \ \ \ \}}
\DoxyCodeLine{01214\ \ \ \}}
\DoxyCodeLine{01215\ \}}
\DoxyCodeLine{01216\ }
\DoxyCodeLine{01217\ }
\DoxyCodeLine{01218\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Indices,\ \textcolor{keyword}{typename}\ LeftArgType,\ \textcolor{keyword}{typename}\ RightArgType,\ \textcolor{keyword}{typename}\ OutputKernelType>}
\DoxyCodeLine{01219\ \textcolor{keyword}{struct\ }TensorEvaluator<const\ TensorContractionOp<Indices,\ LeftArgType,\ RightArgType,\ OutputKernelType>,\ GpuDevice>\ :}
\DoxyCodeLine{01220\ \ \ \ \ \textcolor{keyword}{public}\ TensorContractionEvaluatorBase<TensorEvaluator<const\ TensorContractionOp<Indices,\ LeftArgType,\ RightArgType,\ OutputKernelType>,\ GpuDevice>\ >\ \{}
\DoxyCodeLine{01221\ }
\DoxyCodeLine{01222\ \ \ \textcolor{keyword}{typedef}\ GpuDevice\ Device;}
\DoxyCodeLine{01223\ }
\DoxyCodeLine{01224\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_a1f3e017095b2d83138929129ec8546e7}{TensorEvaluator<const\ TensorContractionOp<Indices,\ LeftArgType,\ RightArgType,\ OutputKernelType>}},\ Device>\ Self;}
\DoxyCodeLine{01225\ \ \ \textcolor{keyword}{typedef}\ TensorContractionEvaluatorBase<Self>\ Base;}
\DoxyCodeLine{01226\ }
\DoxyCodeLine{01227\ \ \ \textcolor{keyword}{typedef}\ TensorContractionOp<Indices,\ LeftArgType,\ RightArgType,\ OutputKernelType>\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_a3c538ce6336ab633e4b4ea9acf00fef2}{XprType}};}
\DoxyCodeLine{01228\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{structEigen_1_1internal_1_1remove__const_ac5a3a624f6f266abd1b25b1dcf1e08be}{internal::remove\_const<typename\ XprType::Scalar>::type}}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_aeb27d9f39037993ed07dd4338312b172}{Scalar}};}
\DoxyCodeLine{01229\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ XprType::Index\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_ab03361de0cb621f807b20cdeb621b807}{Index}};}
\DoxyCodeLine{01230\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ XprType::CoeffReturnType\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_ab9f94deb25a2d2b52dd0e827ef49ce3c}{CoeffReturnType}};}
\DoxyCodeLine{01231\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{structEigen_1_1PacketType_aef48fcc1b8cc8df3b7c667a52a792869}{PacketType<CoeffReturnType,\ GpuDevice>::type}}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_a54f8127161abe33ad05c5ce46ebf3c0a}{PacketReturnType}};}
\DoxyCodeLine{01232\ }
\DoxyCodeLine{01233\ \ \ \textcolor{keyword}{enum}\ \{}
\DoxyCodeLine{01234\ \ \ \ \ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_ab7b4f74f4aa0536b0cf94e72acd3d7bfaaea01fe7598d6c1941853b693ec9f162}{Layout}}\ =\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_ab7b4f74f4aa0536b0cf94e72acd3d7bfaaea01fe7598d6c1941853b693ec9f162}{TensorEvaluator<LeftArgType,\ Device>::Layout}},}
\DoxyCodeLine{01235\ \ \ \};}
\DoxyCodeLine{01236\ }
\DoxyCodeLine{01237\ \ \ \textcolor{comment}{//\ Most\ of\ the\ code\ is\ assuming\ that\ both\ input\ tensors\ are\ ColMajor.\ If\ the}}
\DoxyCodeLine{01238\ \ \ \textcolor{comment}{//\ inputs\ are\ RowMajor,\ we\ will\ "{}cheat"{}\ by\ swapping\ the\ LHS\ and\ RHS:}}
\DoxyCodeLine{01239\ \ \ \textcolor{comment}{//\ If\ we\ want\ to\ compute\ A\ *\ B\ =\ C,\ where\ A\ is\ LHS\ and\ B\ is\ RHS,\ the\ code}}
\DoxyCodeLine{01240\ \ \ \textcolor{comment}{//\ will\ pretend\ B\ is\ LHS\ and\ A\ is\ RHS.}}
\DoxyCodeLine{01241\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ internal::conditional<}
\DoxyCodeLine{01242\ \ \ \ \ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(\mbox{\hyperlink{structEigen_1_1TensorEvaluator_ab7b4f74f4aa0536b0cf94e72acd3d7bfaaea01fe7598d6c1941853b693ec9f162}{Layout}})\ ==\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(\mbox{\hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13a0103672ae41005ab03b4176c765afd62}{ColMajor}}),\ LeftArgType,\ RightArgType>::type\ EvalLeftArgType;}
\DoxyCodeLine{01243\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ internal::conditional<}
\DoxyCodeLine{01244\ \ \ \ \ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(\mbox{\hyperlink{structEigen_1_1TensorEvaluator_ab7b4f74f4aa0536b0cf94e72acd3d7bfaaea01fe7598d6c1941853b693ec9f162}{Layout}})\ ==\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(\mbox{\hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13a0103672ae41005ab03b4176c765afd62}{ColMajor}}),\ RightArgType,\ LeftArgType>::type\ EvalRightArgType;}
\DoxyCodeLine{01245\ }
\DoxyCodeLine{01246\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ LDims\ =}
\DoxyCodeLine{01247\ \ \ \ \ \ \ internal::array\_size<typename\ TensorEvaluator<EvalLeftArgType,\ Device>::Dimensions>\mbox{\hyperlink{abseil-cpp_2absl_2container_2flat__hash__map__test_8cc_a54c2bae0f8aeed048a397b0618037252}{::value}};}
\DoxyCodeLine{01248\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ RDims\ =}
\DoxyCodeLine{01249\ \ \ \ \ \ \ internal::array\_size<typename\ TensorEvaluator<EvalRightArgType,\ Device>::Dimensions>\mbox{\hyperlink{abseil-cpp_2absl_2container_2flat__hash__map__test_8cc_a54c2bae0f8aeed048a397b0618037252}{::value}};}
\DoxyCodeLine{01250\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ ContractDims\ =\ \mbox{\hyperlink{structEigen_1_1internal_1_1array__size_a8040f330cd7748248101bdf65ec46dc4a0a833694bd0641dc89f958470e9f1238}{internal::array\_size<Indices>::value}};}
\DoxyCodeLine{01251\ }
\DoxyCodeLine{01252\ \ \ \textcolor{keyword}{typedef}\ array<Index,\ LDims>\ left\_dim\_mapper\_t;}
\DoxyCodeLine{01253\ \ \ \textcolor{keyword}{typedef}\ array<Index,\ RDims>\ right\_dim\_mapper\_t;}
\DoxyCodeLine{01254\ }
\DoxyCodeLine{01255\ \ \ \textcolor{keyword}{typedef}\ array<Index,\ ContractDims>\ contract\_t;}
\DoxyCodeLine{01256\ \ \ \textcolor{keyword}{typedef}\ array<\mbox{\hyperlink{structEigen_1_1TensorEvaluator_ab03361de0cb621f807b20cdeb621b807}{Index}},\ LDims\ -\/\ ContractDims>\ left\_nocontract\_t;}
\DoxyCodeLine{01257\ \ \ \textcolor{keyword}{typedef}\ array<\mbox{\hyperlink{structEigen_1_1TensorEvaluator_ab03361de0cb621f807b20cdeb621b807}{Index}},\ RDims\ -\/\ ContractDims>\ right\_nocontract\_t;}
\DoxyCodeLine{01258\ }
\DoxyCodeLine{01259\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ NumDims\ =\ LDims\ +\ RDims\ -\/\ 2\ *\ ContractDims;}
\DoxyCodeLine{01260\ }
\DoxyCodeLine{01261\ \ \ \textcolor{keyword}{typedef}\ DSizes<Index,\ NumDims>\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_aa1d848f55dbb96ee9c789c995624a2cb}{Dimensions}};}
\DoxyCodeLine{01262\ }
\DoxyCodeLine{01263\ \ \ \textcolor{comment}{//\ typedefs\ needed\ in\ evalTo}}
\DoxyCodeLine{01264\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{structEigen_1_1internal_1_1remove__const_ac5a3a624f6f266abd1b25b1dcf1e08be}{internal::remove\_const<typename\ EvalLeftArgType::Scalar>::type}}\ LhsScalar;}
\DoxyCodeLine{01265\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{structEigen_1_1internal_1_1remove__const_ac5a3a624f6f266abd1b25b1dcf1e08be}{internal::remove\_const<typename\ EvalRightArgType::Scalar>::type}}\ RhsScalar;}
\DoxyCodeLine{01266\ }
\DoxyCodeLine{01267\ \ \ \textcolor{keyword}{typedef}\ TensorEvaluator<EvalLeftArgType,\ Device>\ LeftEvaluator;}
\DoxyCodeLine{01268\ \ \ \textcolor{keyword}{typedef}\ TensorEvaluator<EvalRightArgType,\ Device>\ RightEvaluator;}
\DoxyCodeLine{01269\ }
\DoxyCodeLine{01270\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ LeftEvaluator::Dimensions\ LeftDimensions;}
\DoxyCodeLine{01271\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ RightEvaluator::Dimensions\ RightDimensions;}
\DoxyCodeLine{01272\ }
\DoxyCodeLine{01273\ \ \ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_a1f3e017095b2d83138929129ec8546e7}{TensorEvaluator}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_a3c538ce6336ab633e4b4ea9acf00fef2}{XprType}}\&\ op,\ \textcolor{keyword}{const}\ Device\&\ device)\ :}
\DoxyCodeLine{01274\ \ \ \ \ \ \ Base(op,\ device)}
\DoxyCodeLine{01275\ \ \ \{}
\DoxyCodeLine{01276\ \ \ \ \ \mbox{\hyperlink{StaticAssert_8h_ac95cf960f4a8395b28af90edfda755f0}{EIGEN\_STATIC\_ASSERT}}(\ (\mbox{\hyperlink{structEigen_1_1internal_1_1is__same_a8fa0f921d1ad770160fe91916e363aaca5989163e8cfc8db2aa0f60d16e735921}{internal::is\_same<OutputKernelType,\ const\ NoOpOutputKernel>::value}}),}
\DoxyCodeLine{01277\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ GPU\_TENSOR\_CONTRACTION\_DOES\_NOT\_SUPPORT\_OUTPUT\_KERNELS);}
\DoxyCodeLine{01278\ \ \ \}}
\DoxyCodeLine{01279\ }
\DoxyCodeLine{01280\ \ \ \textcolor{comment}{//\ We\ need\ to\ redefine\ this\ method\ to\ make\ nvcc\ happy}}
\DoxyCodeLine{01281\ \ \ \mbox{\hyperlink{Macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_a0fcd215ee81860d68da5c5c14e2d5b94}{evalSubExprsIfNeeded}}(\mbox{\hyperlink{structEigen_1_1TensorEvaluator_aeb27d9f39037993ed07dd4338312b172}{Scalar}}*\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_a61c77b3f2d2a7b97a9bcf04f25e5018f}{data}})\ \{}
\DoxyCodeLine{01282\ \ \ \ \ this-\/>m\_leftImpl.evalSubExprsIfNeeded(NULL);}
\DoxyCodeLine{01283\ \ \ \ \ this-\/>m\_rightImpl.evalSubExprsIfNeeded(NULL);}
\DoxyCodeLine{01284\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structEigen_1_1TensorEvaluator_a61c77b3f2d2a7b97a9bcf04f25e5018f}{data}})\ \{}
\DoxyCodeLine{01285\ \ \ \ \ \ \ evalTo(\mbox{\hyperlink{structEigen_1_1TensorEvaluator_a61c77b3f2d2a7b97a9bcf04f25e5018f}{data}});}
\DoxyCodeLine{01286\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01287\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01288\ \ \ \ \ \ \ this-\/>m\_result\ =\ \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{structEigen_1_1TensorEvaluator_aeb27d9f39037993ed07dd4338312b172}{Scalar}}\ *\textcolor{keyword}{>}(this-\/>\mbox{\hyperlink{structEigen_1_1TensorEvaluator_a28c329f710d33ba7243b5d194bdcdfca}{m\_device}}.allocate(this-\/>\mbox{\hyperlink{structEigen_1_1TensorEvaluator_a4b49b2c40bcb2220fb240083cd1833c6}{dimensions}}().TotalSize()\ *\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structEigen_1_1TensorEvaluator_aeb27d9f39037993ed07dd4338312b172}{Scalar}})));}
\DoxyCodeLine{01289\ \ \ \ \ \ \ evalTo(this-\/>m\_result);}
\DoxyCodeLine{01290\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01291\ \ \ \ \ \}}
\DoxyCodeLine{01292\ \ \ \}}
\DoxyCodeLine{01293\ }
\DoxyCodeLine{01294\ \ \ \textcolor{keywordtype}{void}\ evalTo(\mbox{\hyperlink{structEigen_1_1TensorEvaluator_aeb27d9f39037993ed07dd4338312b172}{Scalar}}*\ buffer)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01295\ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>m\_lhs\_inner\_dim\_contiguous)\ \{}
\DoxyCodeLine{01296\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>m\_rhs\_inner\_dim\_contiguous)\ \{}
\DoxyCodeLine{01297\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>m\_rhs\_inner\_dim\_reordered)\ \{}
\DoxyCodeLine{01298\ \ \ \ \ \ \ \ \ \ \ evalTyped<true,\ true,\ true,\ Unaligned>(buffer);}
\DoxyCodeLine{01299\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01300\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01301\ \ \ \ \ \ \ \ \ \ \ evalTyped<true,\ true,\ false,\ Unaligned>(buffer);}
\DoxyCodeLine{01302\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01303\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01304\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01305\ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>m\_rhs\_inner\_dim\_reordered)\ \{}
\DoxyCodeLine{01306\ \ \ \ \ \ \ \ \ \ \ evalTyped<true,\ false,\ true,\ Unaligned>(buffer);}
\DoxyCodeLine{01307\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01308\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01309\ \ \ \ \ \ \ \ \ \ \ evalTyped<true,\ false,\ false,\ Unaligned>(buffer);}
\DoxyCodeLine{01310\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01311\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01312\ \ \ \ \ \}}
\DoxyCodeLine{01313\ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01314\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>m\_rhs\_inner\_dim\_contiguous)\ \{}
\DoxyCodeLine{01315\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>m\_rhs\_inner\_dim\_reordered)\ \{}
\DoxyCodeLine{01316\ \ \ \ \ \ \ \ \ \ \ evalTyped<false,\ true,\ true,\ Unaligned>(buffer);}
\DoxyCodeLine{01317\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01318\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01319\ \ \ \ \ \ \ \ \ \ \ evalTyped<false,\ true,\ false,\ Unaligned>(buffer);}
\DoxyCodeLine{01320\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01321\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01322\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01323\ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>m\_rhs\_inner\_dim\_reordered)\ \{}
\DoxyCodeLine{01324\ \ \ \ \ \ \ \ \ \ \ evalTyped<false,\ false,\ true,\ Unaligned>(buffer);}
\DoxyCodeLine{01325\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01326\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01327\ \ \ \ \ \ \ \ \ \ \ evalTyped<false,\ false,\ false,\ Unaligned>(buffer);}
\DoxyCodeLine{01328\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01329\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01330\ \ \ \ \ \}}
\DoxyCodeLine{01331\ \ \ \}}
\DoxyCodeLine{01332\ }
\DoxyCodeLine{01333\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ LhsScalar,\ \textcolor{keyword}{typename}\ RhsScalar,\ \textcolor{keyword}{typename}\ Index,\ \textcolor{keyword}{typename}\ LhsMapper,\ \textcolor{keyword}{typename}\ RhsMapper,\ \textcolor{keyword}{typename}\ OutputMapper>\ \textcolor{keyword}{struct\ }LaunchKernels\ \{}
\DoxyCodeLine{01334\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ Run(\textcolor{keyword}{const}\ LhsMapper\&\ lhs,\ \textcolor{keyword}{const}\ RhsMapper\&\ rhs,\ \textcolor{keyword}{const}\ OutputMapper\&\ output,\ Index\ m,\ Index\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__test_8cc_a76f11d9a0a47b94f72c2d0e77fb32240}{n}},\ Index\ k,\ \textcolor{keyword}{const}\ GpuDevice\&\ device)\ \{}
\DoxyCodeLine{01335\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ m\_blocks\ =\ (m\ +\ 63)\ /\ 64;}
\DoxyCodeLine{01336\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ n\_blocks\ =\ (\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__test_8cc_a76f11d9a0a47b94f72c2d0e77fb32240}{n}}\ +\ 63)\ /\ 64;}
\DoxyCodeLine{01337\ \ \ \ \ \textcolor{keyword}{const}\ dim3\ num\_blocks(m\_blocks,\ n\_blocks,\ 1);}
\DoxyCodeLine{01338\ \ \ \ \ \textcolor{keyword}{const}\ dim3\ block\_size(8,\ 8,\ 8);}
\DoxyCodeLine{01339\ \ \ \ \ LAUNCH\_GPU\_KERNEL((EigenContractionKernel<Scalar,\ Index,\ LhsMapper,\ RhsMapper,\ OutputMapper>),\ num\_blocks,\ block\_size,\ 0,\ device,\ lhs,\ rhs,\ output,\ m,\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__test_8cc_a76f11d9a0a47b94f72c2d0e77fb32240}{n}},\ k);}
\DoxyCodeLine{01340\ \ \ \ \ \}}
\DoxyCodeLine{01341\ \ \ \};}
\DoxyCodeLine{01342\ }
\DoxyCodeLine{01343\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Index,\ \textcolor{keyword}{typename}\ LhsMapper,\ \textcolor{keyword}{typename}\ RhsMapper,\ \textcolor{keyword}{typename}\ OutputMapper>\ \textcolor{keyword}{struct\ }LaunchKernels<float,\ float,\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_ab03361de0cb621f807b20cdeb621b807}{Index}},\ LhsMapper,\ RhsMapper,\ OutputMapper>\ \{}
\DoxyCodeLine{01344\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ Run(\textcolor{keyword}{const}\ LhsMapper\&\ lhs,\ \textcolor{keyword}{const}\ RhsMapper\&\ rhs,\ \textcolor{keyword}{const}\ OutputMapper\&\ output,\ Index\ m,\ Index\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__test_8cc_a76f11d9a0a47b94f72c2d0e77fb32240}{n}},\ Index\ k,\ \textcolor{keyword}{const}\ GpuDevice\&\ device)\ \{}
\DoxyCodeLine{01345\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (m\ <\ 768\ ||\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__test_8cc_a76f11d9a0a47b94f72c2d0e77fb32240}{n}}\ <\ 768)\ \{}
\DoxyCodeLine{01346\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ m\_blocks\ =\ (m\ +\ 63)\ /\ 64;}
\DoxyCodeLine{01347\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ n\_blocks\ =\ (\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__test_8cc_a76f11d9a0a47b94f72c2d0e77fb32240}{n}}\ +\ 63)\ /\ 64;}
\DoxyCodeLine{01348\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ dim3\ num\_blocks(m\_blocks,\ n\_blocks,\ 1);}
\DoxyCodeLine{01349\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ dim3\ block\_size(16,\ 16,\ 1);}
\DoxyCodeLine{01350\ \ \ \ \ \ \ \ \ LAUNCH\_GPU\_KERNEL((EigenFloatContractionKernel16x16<Index,\ LhsMapper,\ RhsMapper,\ OutputMapper>),\ num\_blocks,\ block\_size,\ 0,\ device,\ lhs,\ rhs,\ output,\ m,\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__test_8cc_a76f11d9a0a47b94f72c2d0e77fb32240}{n}},\ k);}
\DoxyCodeLine{01351\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01352\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ m\_blocks\ =\ (m\ +\ 127)\ /\ 128;}
\DoxyCodeLine{01353\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ n\_blocks\ =\ (\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__test_8cc_a76f11d9a0a47b94f72c2d0e77fb32240}{n}}\ +\ 63)\ /\ 64;}
\DoxyCodeLine{01354\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ dim3\ num\_blocks(m\_blocks,\ n\_blocks,\ 1);}
\DoxyCodeLine{01355\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ dim3\ block\_size(8,\ 32,\ 1);}
\DoxyCodeLine{01356\ \ \ \ \ \ \ \ \ LAUNCH\_GPU\_KERNEL((EigenFloatContractionKernel<Index,\ LhsMapper,\ RhsMapper,\ OutputMapper>),\ num\_blocks,\ block\_size,\ 0,\ device,\ lhs,\ rhs,\ output,\ m,\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__test_8cc_a76f11d9a0a47b94f72c2d0e77fb32240}{n}},\ k);}
\DoxyCodeLine{01357\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01358\ \ \ \ \ \}}
\DoxyCodeLine{01359\ \ \ \};}
\DoxyCodeLine{01360\ }
\DoxyCodeLine{01361\ \ \ \textcolor{keyword}{template}\ <\textcolor{keywordtype}{bool}\ lhs\_inner\_dim\_contiguous,\ \textcolor{keywordtype}{bool}\ rhs\_inner\_dim\_contiguous,\ \textcolor{keywordtype}{bool}\ rhs\_inner\_dim\_reordered,\ \textcolor{keywordtype}{int}\ Alignment>}
\DoxyCodeLine{01362\ \ \ \textcolor{keywordtype}{void}\ evalTyped(\mbox{\hyperlink{structEigen_1_1TensorEvaluator_aeb27d9f39037993ed07dd4338312b172}{Scalar}}*\ buffer)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01363\ \ \ \ \ \textcolor{comment}{//\ columns\ in\ left\ side,\ rows\ in\ right\ side}}
\DoxyCodeLine{01364\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_ab03361de0cb621f807b20cdeb621b807}{Index}}\ k\ =\ this-\/>m\_k\_size;}
\DoxyCodeLine{01365\ \ \ \ \ \mbox{\hyperlink{Macros_8h_a7cf6d5b460def34dc4e6acf42889b6a9}{EIGEN\_UNUSED\_VARIABLE}}(k)}
\DoxyCodeLine{01366\ }
\DoxyCodeLine{01367\ \ \ \ \ \textcolor{comment}{//\ rows\ in\ left\ side}}
\DoxyCodeLine{01368\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_ab03361de0cb621f807b20cdeb621b807}{Index}}\ m\ =\ this-\/>m\_i\_size;}
\DoxyCodeLine{01369\ }
\DoxyCodeLine{01370\ \ \ \ \ \textcolor{comment}{//\ columns\ in\ right\ side}}
\DoxyCodeLine{01371\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_ab03361de0cb621f807b20cdeb621b807}{Index}}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__test_8cc_a76f11d9a0a47b94f72c2d0e77fb32240}{n}}\ =\ this-\/>m\_j\_size;}
\DoxyCodeLine{01372\ }
\DoxyCodeLine{01373\ \ \ \ \ \textcolor{comment}{//\ zero\ out\ the\ result\ buffer\ (which\ must\ be\ of\ size\ at\ least\ m\ *\ n\ *\ sizeof(Scalar)}}
\DoxyCodeLine{01374\ \ \ \ \ this-\/>\mbox{\hyperlink{structEigen_1_1TensorEvaluator_a28c329f710d33ba7243b5d194bdcdfca}{m\_device}}.memset(buffer,\ 0,\ m\ *\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__test_8cc_a76f11d9a0a47b94f72c2d0e77fb32240}{n}}\ *\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structEigen_1_1TensorEvaluator_aeb27d9f39037993ed07dd4338312b172}{Scalar}}));}
\DoxyCodeLine{01375\ }
\DoxyCodeLine{01376\ \ \ \ \ \textcolor{keyword}{typedef}\ internal::TensorContractionInputMapper<LhsScalar,\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_ab03361de0cb621f807b20cdeb621b807}{Index}},\ \mbox{\hyperlink{namespaceEigen_1_1internal_aab428dd46398111876d6a898035cb587a1a7f4ccbeaf23168b50a83680f8f35fb}{internal::Lhs}},}
\DoxyCodeLine{01377\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ LeftEvaluator,\ left\_nocontract\_t,}
\DoxyCodeLine{01378\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ contract\_t,\ 4,}
\DoxyCodeLine{01379\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lhs\_inner\_dim\_contiguous,}
\DoxyCodeLine{01380\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{false},\ \mbox{\hyperlink{group__enums_gga45fe06e29902b7a2773de05ba27b47a1a4e19dd09d5ff42295ba1d72d12a46686}{Unaligned}}>\ LhsMapper;}
\DoxyCodeLine{01381\ }
\DoxyCodeLine{01382\ \ \ \ \ \textcolor{keyword}{typedef}\ internal::TensorContractionInputMapper<RhsScalar,\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_ab03361de0cb621f807b20cdeb621b807}{Index}},\ \mbox{\hyperlink{namespaceEigen_1_1internal_aab428dd46398111876d6a898035cb587a6c8de80f9984c6a6da22b7c288fee57d}{internal::Rhs}},}
\DoxyCodeLine{01383\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ RightEvaluator,\ right\_nocontract\_t,}
\DoxyCodeLine{01384\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ contract\_t,\ 4,}
\DoxyCodeLine{01385\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rhs\_inner\_dim\_contiguous,}
\DoxyCodeLine{01386\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rhs\_inner\_dim\_reordered,\ \mbox{\hyperlink{group__enums_gga45fe06e29902b7a2773de05ba27b47a1a4e19dd09d5ff42295ba1d72d12a46686}{Unaligned}}>\ RhsMapper;}
\DoxyCodeLine{01387\ }
\DoxyCodeLine{01388\ \ \ \ \ \textcolor{keyword}{typedef}\ internal::blas\_data\_mapper<Scalar,\ Index,\ ColMajor>\ OutputMapper;}
\DoxyCodeLine{01389\ }
\DoxyCodeLine{01390\ }
\DoxyCodeLine{01391\ \ \ \ \ \textcolor{comment}{//\ initialize\ data\ mappers}}
\DoxyCodeLine{01392\ \ \ \ \ LhsMapper\ lhs(this-\/>m\_leftImpl,\ this-\/>m\_left\_nocontract\_strides,\ this-\/>m\_i\_strides,}
\DoxyCodeLine{01393\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>m\_left\_contracting\_strides,\ this-\/>m\_k\_strides);}
\DoxyCodeLine{01394\ }
\DoxyCodeLine{01395\ \ \ \ \ RhsMapper\ rhs(this-\/>m\_rightImpl,\ this-\/>m\_right\_nocontract\_strides,\ this-\/>m\_j\_strides,}
\DoxyCodeLine{01396\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>m\_right\_contracting\_strides,\ this-\/>m\_k\_strides);}
\DoxyCodeLine{01397\ }
\DoxyCodeLine{01398\ \ \ \ \ OutputMapper\ output(buffer,\ m);}
\DoxyCodeLine{01399\ }
\DoxyCodeLine{01400\ \textcolor{preprocessor}{\#if\ defined(EIGEN\_USE\_HIP)}}
\DoxyCodeLine{01401\ \ \ \ \ setGpuSharedMemConfig(hipSharedMemBankSizeEightByte);}
\DoxyCodeLine{01402\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{01403\ \ \ \ \ setGpuSharedMemConfig(cudaSharedMemBankSizeEightByte);}
\DoxyCodeLine{01404\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01405\ }
\DoxyCodeLine{01406\ \ \ \ \ LaunchKernels<LhsScalar,\ RhsScalar,\ Index,\ LhsMapper,\ RhsMapper,\ OutputMapper>::Run(lhs,\ rhs,\ output,\ \ m,\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__test_8cc_a76f11d9a0a47b94f72c2d0e77fb32240}{n}},\ k,\ this-\/>\mbox{\hyperlink{structEigen_1_1TensorEvaluator_a28c329f710d33ba7243b5d194bdcdfca}{m\_device}});}
\DoxyCodeLine{01407\ \ \ \}}
\DoxyCodeLine{01408\ \};}
\DoxyCodeLine{01409\ }
\DoxyCodeLine{01410\ \}\ \textcolor{comment}{//\ end\ namespace\ Eigen}}
\DoxyCodeLine{01411\ }
\DoxyCodeLine{01412\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ EIGEN\_USE\_GPU\ and\ EIGEN\_GPUCC}}
\DoxyCodeLine{01413\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ EIGEN\_CXX11\_TENSOR\_TENSOR\_CONTRACTION\_GPU\_H}}

\end{DoxyCode}
