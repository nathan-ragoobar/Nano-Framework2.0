\doxysection{Tensor\+Executor.\+h}
\hypertarget{eigen_2unsupported_2Eigen_2CXX11_2src_2Tensor_2TensorExecutor_8h_source}{}\label{eigen_2unsupported_2Eigen_2CXX11_2src_2Tensor_2TensorExecutor_8h_source}\index{eigen/unsupported/Eigen/CXX11/src/Tensor/TensorExecutor.h@{eigen/unsupported/Eigen/CXX11/src/Tensor/TensorExecutor.h}}
\mbox{\hyperlink{eigen_2unsupported_2Eigen_2CXX11_2src_2Tensor_2TensorExecutor_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ This\ file\ is\ part\ of\ Eigen,\ a\ lightweight\ C++\ template\ library}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ for\ linear\ algebra.}}
\DoxyCodeLine{00003\ \textcolor{comment}{//}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ Copyright\ (C)\ 2014\ Benoit\ Steiner\ <benoit.steiner.goog@gmail.com>}}
\DoxyCodeLine{00005\ \textcolor{comment}{//}}
\DoxyCodeLine{00006\ \textcolor{comment}{//\ This\ Source\ Code\ Form\ is\ subject\ to\ the\ terms\ of\ the\ Mozilla}}
\DoxyCodeLine{00007\ \textcolor{comment}{//\ Public\ License\ v.\ 2.0.\ If\ a\ copy\ of\ the\ MPL\ was\ not\ distributed}}
\DoxyCodeLine{00008\ \textcolor{comment}{//\ with\ this\ file,\ You\ can\ obtain\ one\ at\ http://mozilla.org/MPL/2.0/.}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#ifndef\ EIGEN\_CXX11\_TENSOR\_TENSOR\_EXECUTOR\_H}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#define\ EIGEN\_CXX11\_TENSOR\_TENSOR\_EXECUTOR\_H}}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceEigen}{Eigen}}\ \{}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00029\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceinternal}{internal}}\ \{}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00039\ \textcolor{comment}{//\ TODO(ezhulenev):\ Add\ specializations\ for\ all\ other\ types\ of\ Tensor\ ops.}}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Expression>}
\DoxyCodeLine{00042\ \textcolor{keyword}{struct\ }ExpressionHasTensorBroadcastingOp\ \{}
\DoxyCodeLine{00043\ \ \ \textcolor{keyword}{enum}\ \{\ \mbox{\hyperlink{structEigen_1_1internal_1_1ExpressionHasTensorBroadcastingOp_a15c3bf016177558ac6bdcdf17bee5e8baa65fb0860eefe4de0603a40578dfda9d}{value}}\ =\ \textcolor{keyword}{false}\ \};}
\DoxyCodeLine{00044\ \};}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ LhsXprType,\ \textcolor{keyword}{typename}\ RhsXprType>}
\DoxyCodeLine{00047\ \textcolor{keyword}{struct\ }ExpressionHasTensorBroadcastingOp<}
\DoxyCodeLine{00048\ \ \ \ \ const\ \mbox{\hyperlink{classEigen_1_1TensorAssignOp}{TensorAssignOp}}<LhsXprType,\ RhsXprType>\ >\ \{}
\DoxyCodeLine{00049\ \ \ \textcolor{keyword}{enum}\ \{\ \mbox{\hyperlink{structEigen_1_1internal_1_1ExpressionHasTensorBroadcastingOp_a15c3bf016177558ac6bdcdf17bee5e8baa65fb0860eefe4de0603a40578dfda9d}{value}}\ =\ \mbox{\hyperlink{structEigen_1_1internal_1_1ExpressionHasTensorBroadcastingOp}{ExpressionHasTensorBroadcastingOp<RhsXprType>::value}}\ \};}
\DoxyCodeLine{00050\ \};}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00052\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ UnaryOp,\ \textcolor{keyword}{typename}\ XprType>}
\DoxyCodeLine{00053\ \textcolor{keyword}{struct\ }ExpressionHasTensorBroadcastingOp<}
\DoxyCodeLine{00054\ \ \ \ \ const\ \mbox{\hyperlink{classEigen_1_1TensorCwiseUnaryOp}{TensorCwiseUnaryOp}}<UnaryOp,\ XprType>\ >\ \{}
\DoxyCodeLine{00055\ \ \ \textcolor{keyword}{enum}\ \{\ \mbox{\hyperlink{structEigen_1_1internal_1_1ExpressionHasTensorBroadcastingOp_a15c3bf016177558ac6bdcdf17bee5e8baa65fb0860eefe4de0603a40578dfda9d}{value}}\ =\ \mbox{\hyperlink{structEigen_1_1internal_1_1ExpressionHasTensorBroadcastingOp}{ExpressionHasTensorBroadcastingOp<XprType>::value}}\ \};}
\DoxyCodeLine{00056\ \};}
\DoxyCodeLine{00057\ }
\DoxyCodeLine{00058\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ BinaryOp,\ \textcolor{keyword}{typename}\ LhsXprType,\ \textcolor{keyword}{typename}\ RhsXprType>}
\DoxyCodeLine{00059\ \textcolor{keyword}{struct\ }ExpressionHasTensorBroadcastingOp<}
\DoxyCodeLine{00060\ \ \ \ \ const\ \mbox{\hyperlink{classEigen_1_1TensorCwiseBinaryOp}{TensorCwiseBinaryOp}}<BinaryOp,\ LhsXprType,\ RhsXprType>\ >\ \{}
\DoxyCodeLine{00061\ \ \ \textcolor{keyword}{enum}\ \{}
\DoxyCodeLine{00062\ \ \ \ \ \mbox{\hyperlink{structEigen_1_1internal_1_1ExpressionHasTensorBroadcastingOp_a15c3bf016177558ac6bdcdf17bee5e8baa65fb0860eefe4de0603a40578dfda9d}{value}}\ =\ \mbox{\hyperlink{structEigen_1_1internal_1_1ExpressionHasTensorBroadcastingOp_a15c3bf016177558ac6bdcdf17bee5e8baa65fb0860eefe4de0603a40578dfda9d}{ExpressionHasTensorBroadcastingOp<LhsXprType>::value}}\ ||}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structEigen_1_1internal_1_1ExpressionHasTensorBroadcastingOp_a15c3bf016177558ac6bdcdf17bee5e8baa65fb0860eefe4de0603a40578dfda9d}{ExpressionHasTensorBroadcastingOp<RhsXprType>::value}}}
\DoxyCodeLine{00064\ \ \ \};}
\DoxyCodeLine{00065\ \};}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00067\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Broadcast,\ \textcolor{keyword}{typename}\ XprType>}
\DoxyCodeLine{00068\ \textcolor{keyword}{struct\ }ExpressionHasTensorBroadcastingOp<}
\DoxyCodeLine{00069\ \ \ \ \ const\ \mbox{\hyperlink{classEigen_1_1TensorBroadcastingOp}{TensorBroadcastingOp}}<Broadcast,\ XprType>\ >\ \{}
\DoxyCodeLine{00070\ \ \ \textcolor{keyword}{enum}\ \{\ \mbox{\hyperlink{structEigen_1_1internal_1_1ExpressionHasTensorBroadcastingOp_a15c3bf016177558ac6bdcdf17bee5e8baa65fb0860eefe4de0603a40578dfda9d}{value}}\ =\ \textcolor{keyword}{true}\ \};}
\DoxyCodeLine{00071\ \};}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ //}}
\DoxyCodeLine{00074\ }
\DoxyCodeLine{00079\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Expression,\ \textcolor{keyword}{typename}\ Device,\ \textcolor{keywordtype}{bool}\ Vectorizable,}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceEigen_1_1internal_a131ba611978f02e7ac1c6a0faae2a250}{TiledEvaluation}}\ Tiling>}
\DoxyCodeLine{00081\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classTensorExecutor}{TensorExecutor}}\ \{}
\DoxyCodeLine{00082\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00083\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ Expression::Index\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorExecutor_a60e50f31d7022a5a96847d341d0153f4}{StorageIndex}};}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00085\ \ \ \textcolor{comment}{//\ Including\ \`{}unsupported/Eigen/CXX11/Tensor`\ in\ different\ translation\ units}}
\DoxyCodeLine{00086\ \ \ \textcolor{comment}{//\ with/without\ \`{}EIGEN\_USE\_THREADS`\ or\ \`{}EIGEN\_USE\_GPU`\ is\ a\ potential\ ODR}}
\DoxyCodeLine{00087\ \ \ \textcolor{comment}{//\ violation.\ If\ this\ template\ is\ instantiated\ with\ a\ non-\/default\ device,\ it}}
\DoxyCodeLine{00088\ \ \ \textcolor{comment}{//\ means\ that\ this\ header\ file\ was\ included\ without\ defining}}
\DoxyCodeLine{00089\ \ \ \textcolor{comment}{//\ \`{}EIGEN\_USE\_THREADS`,\ \`{}EIGEN\_USE\_GPU`\ or\ \`{}EIGEN\_USE\_SYCL`.}}
\DoxyCodeLine{00090\ \ \ \textcolor{keyword}{static\_assert}(std::is\_same<Device,\ DefaultDevice>::value,}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Default\ executor\ instantiated\ with\ non-\/default\ device.\ "{}}}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}You\ must\ \#define\ EIGEN\_USE\_THREADS,\ EIGEN\_USE\_GPU\ or\ "{}}}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}EIGEN\_USE\_SYCL\ before\ including\ Eigen\ headers."{}});}
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00095\ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}}
\DoxyCodeLine{00096\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorExecutor_a50325b41f927e2c29141c7ac671efdec}{run}}(\textcolor{keyword}{const}\ Expression\&\ expr,}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Device\&\ device\ =\ Device())\ \{}
\DoxyCodeLine{00098\ \ \ \ \ \mbox{\hyperlink{structEigen_1_1TensorEvaluator}{TensorEvaluator<Expression,\ Device>}}\ \mbox{\hyperlink{structEigen_1_1internal_1_1evaluator}{evaluator}}(expr,\ device);}
\DoxyCodeLine{00099\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ needs\_assign\ =\ \mbox{\hyperlink{structEigen_1_1internal_1_1evaluator}{evaluator}}.evalSubExprsIfNeeded(NULL);}
\DoxyCodeLine{00100\ \ \ \ \ \textcolor{keywordflow}{if}\ (needs\_assign)\ \{}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorExecutor_a60e50f31d7022a5a96847d341d0153f4}{StorageIndex}}\ \mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2low__level__alloc_8cc_aad9b71a31372d5c0ab9c23163efe9544}{size}}\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_a3b99e338d92a91c8b3f89d32d0ca2c39}{array\_prod}}(\mbox{\hyperlink{structEigen_1_1internal_1_1evaluator}{evaluator}}.dimensions());}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{classEigen_1_1internal_1_1TensorExecutor_a60e50f31d7022a5a96847d341d0153f4}{StorageIndex}}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ \mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2low__level__alloc_8cc_aad9b71a31372d5c0ab9c23163efe9544}{size}};\ ++\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ \{}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structEigen_1_1internal_1_1evaluator}{evaluator}}.evalScalar(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}});}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00105\ \ \ \ \ \}}
\DoxyCodeLine{00106\ \ \ \ \ \mbox{\hyperlink{structEigen_1_1internal_1_1evaluator}{evaluator}}.cleanup();}
\DoxyCodeLine{00107\ \ \ \}}
\DoxyCodeLine{00108\ \};}
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00114\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Expression,\ \textcolor{keyword}{typename}\ Device,\ \textcolor{keyword}{typename}\ DoneCallback,}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ Vectorizable,\ \mbox{\hyperlink{namespaceEigen_1_1internal_a131ba611978f02e7ac1c6a0faae2a250}{TiledEvaluation}}\ Tiling>}
\DoxyCodeLine{00116\ \textcolor{keyword}{class\ }TensorAsyncExecutor\ \{\};}
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00121\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Expression>}
\DoxyCodeLine{00122\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classTensorExecutor}{TensorExecutor}}<Expression,\ DefaultDevice,\ \textcolor{comment}{/*Vectorizable=*/}true,}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*Tiling=*/}\mbox{\hyperlink{namespaceEigen_1_1internal_a131ba611978f02e7ac1c6a0faae2a250}{TiledEvaluation}}::\mbox{\hyperlink{namespaceEigen_1_1internal_a131ba611978f02e7ac1c6a0faae2a250aef667961c2fff2db95ac003b6b034be9}{Off}}>\ \{}
\DoxyCodeLine{00124\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00125\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ Expression::Index\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorExecutor_3_01Expression_00_01DefaultDevice_00_01true_00_01TiledEvaluation_1_1Off_01_4_adead548744640a70c598698ecff91865}{StorageIndex}};}
\DoxyCodeLine{00126\ }
\DoxyCodeLine{00127\ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}}
\DoxyCodeLine{00128\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorExecutor_3_01Expression_00_01DefaultDevice_00_01true_00_01TiledEvaluation_1_1Off_01_4_a4501013109e914f7d31ee3f821a298fb}{run}}(}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \textcolor{keyword}{const}\ Expression\&\ expr,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1DefaultDevice}{DefaultDevice}}\&\ device\ =\ \mbox{\hyperlink{structEigen_1_1DefaultDevice}{DefaultDevice}}())\ \{}
\DoxyCodeLine{00130\ \ \ \ \ \mbox{\hyperlink{structEigen_1_1TensorEvaluator}{TensorEvaluator<Expression,\ DefaultDevice>}}\ \mbox{\hyperlink{structEigen_1_1internal_1_1evaluator}{evaluator}}(expr,\ device);}
\DoxyCodeLine{00131\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ needs\_assign\ =\ \mbox{\hyperlink{structEigen_1_1internal_1_1evaluator}{evaluator}}.evalSubExprsIfNeeded(NULL);}
\DoxyCodeLine{00132\ \ \ \ \ \textcolor{keywordflow}{if}\ (needs\_assign)\ \{}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorExecutor_3_01Expression_00_01DefaultDevice_00_01true_00_01TiledEvaluation_1_1Off_01_4_adead548744640a70c598698ecff91865}{StorageIndex}}\ \mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2low__level__alloc_8cc_aad9b71a31372d5c0ab9c23163efe9544}{size}}\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_a3b99e338d92a91c8b3f89d32d0ca2c39}{array\_prod}}(\mbox{\hyperlink{structEigen_1_1internal_1_1evaluator}{evaluator}}.dimensions());}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ PacketSize\ =\ \mbox{\hyperlink{structEigen_1_1internal_1_1unpacket__traits}{unpacket\_traits}}<\textcolor{keyword}{typename}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator}{TensorEvaluator}}<}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \ \ Expression,\ \mbox{\hyperlink{structEigen_1_1DefaultDevice}{DefaultDevice}}>::PacketReturnType>\mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2low__level__alloc_8cc_aad9b71a31372d5c0ab9c23163efe9544}{::size}};}
\DoxyCodeLine{00136\ }
\DoxyCodeLine{00137\ \ \ \ \ \ \ \textcolor{comment}{//\ Give\ compiler\ a\ strong\ possibility\ to\ unroll\ the\ loop.\ But\ don't\ insist}}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \textcolor{comment}{//\ on\ unrolling,\ because\ if\ the\ function\ is\ expensive\ compiler\ should\ not}}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \textcolor{comment}{//\ unroll\ the\ loop\ at\ the\ expense\ of\ inlining.}}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorExecutor_3_01Expression_00_01DefaultDevice_00_01true_00_01TiledEvaluation_1_1Off_01_4_adead548744640a70c598698ecff91865}{StorageIndex}}\ UnrolledSize\ =}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \ \ (\mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2low__level__alloc_8cc_aad9b71a31372d5c0ab9c23163efe9544}{size}}\ /\ (4\ *\ PacketSize))\ *\ 4\ *\ PacketSize;}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{classEigen_1_1internal_1_1TensorExecutor_3_01Expression_00_01DefaultDevice_00_01true_00_01TiledEvaluation_1_1Off_01_4_adead548744640a70c598698ecff91865}{StorageIndex}}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ UnrolledSize;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +=\ 4\ *\ PacketSize)\ \{}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{classEigen_1_1internal_1_1TensorExecutor_3_01Expression_00_01DefaultDevice_00_01true_00_01TiledEvaluation_1_1Off_01_4_adead548744640a70c598698ecff91865}{StorageIndex}}\ j\ =\ 0;\ j\ <\ 4;\ j++)\ \{}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structEigen_1_1internal_1_1evaluator}{evaluator}}.evalPacket(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +\ j\ *\ PacketSize);}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorExecutor_3_01Expression_00_01DefaultDevice_00_01true_00_01TiledEvaluation_1_1Off_01_4_adead548744640a70c598698ecff91865}{StorageIndex}}\ VectorizedSize\ =\ (\mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2low__level__alloc_8cc_aad9b71a31372d5c0ab9c23163efe9544}{size}}\ /\ PacketSize)\ *\ PacketSize;}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{classEigen_1_1internal_1_1TensorExecutor_3_01Expression_00_01DefaultDevice_00_01true_00_01TiledEvaluation_1_1Off_01_4_adead548744640a70c598698ecff91865}{StorageIndex}}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ UnrolledSize;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ VectorizedSize;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +=\ PacketSize)\ \{}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structEigen_1_1internal_1_1evaluator}{evaluator}}.evalPacket(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}});}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{classEigen_1_1internal_1_1TensorExecutor_3_01Expression_00_01DefaultDevice_00_01true_00_01TiledEvaluation_1_1Off_01_4_adead548744640a70c598698ecff91865}{StorageIndex}}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ VectorizedSize;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ \mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2low__level__alloc_8cc_aad9b71a31372d5c0ab9c23163efe9544}{size}};\ ++\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ \{}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structEigen_1_1internal_1_1evaluator}{evaluator}}.evalScalar(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}});}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00154\ \ \ \ \ \}}
\DoxyCodeLine{00155\ \ \ \ \ \mbox{\hyperlink{structEigen_1_1internal_1_1evaluator}{evaluator}}.cleanup();}
\DoxyCodeLine{00156\ \ \ \}}
\DoxyCodeLine{00157\ \};}
\DoxyCodeLine{00158\ }
\DoxyCodeLine{00163\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Expression,\ \textcolor{keywordtype}{bool}\ Vectorizable>}
\DoxyCodeLine{00164\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classTensorExecutor}{TensorExecutor}}<Expression,\ \mbox{\hyperlink{structEigen_1_1DefaultDevice}{DefaultDevice}},\ Vectorizable,}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*Tiling=*/}\mbox{\hyperlink{namespaceEigen_1_1internal_a131ba611978f02e7ac1c6a0faae2a250}{TiledEvaluation}}::\mbox{\hyperlink{namespaceEigen_1_1internal_a131ba611978f02e7ac1c6a0faae2a250aeef1561c4bf6d0efc2470b89c1a815c6}{On}}>\ \{}
\DoxyCodeLine{00166\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00167\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits<Expression>::Scalar}}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorExecutor_3_01Expression_00_01DefaultDevice_00_01Vectorizable_00_01TiledEvaluation_1_1On_01_4_ab7a5daaa2ea18aa614f57fdcd3e8420d}{Scalar}};}
\DoxyCodeLine{00168\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{structEigen_1_1internal_1_1remove__const_afe3dbb0bdee2ec8eed4416723d75bc90}{remove\_const<Scalar>::type}}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorExecutor_3_01Expression_00_01DefaultDevice_00_01Vectorizable_00_01TiledEvaluation_1_1On_01_4_af6b44bd8ca35966ca1f221046378876b}{ScalarNoConst}};}
\DoxyCodeLine{00169\ }
\DoxyCodeLine{00170\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator}{TensorEvaluator<Expression,\ DefaultDevice>}}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorExecutor_3_01Expression_00_01DefaultDevice_00_01Vectorizable_00_01TiledEvaluation_1_1On_01_4_aa4053d2482c47058ba2a16e9c4d513ec}{Evaluator}};}
\DoxyCodeLine{00171\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits<Expression>::Index}}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorExecutor_3_01Expression_00_01DefaultDevice_00_01Vectorizable_00_01TiledEvaluation_1_1On_01_4_a45a1dac8b7fd23e0f22c4fa7ed468c43}{StorageIndex}};}
\DoxyCodeLine{00172\ }
\DoxyCodeLine{00173\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ NumDims\ =\ \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits<Expression>::NumDimensions}};}
\DoxyCodeLine{00174\ }
\DoxyCodeLine{00175\ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}}
\DoxyCodeLine{00176\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorExecutor_3_01Expression_00_01DefaultDevice_00_01Vectorizable_00_01TiledEvaluation_1_1On_01_4_ac89ffa3368288a1b401d4532bc5ee9af}{run}}(\textcolor{keyword}{const}\ Expression\&\ expr,}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1DefaultDevice}{DefaultDevice}}\&\ device\ =\ \mbox{\hyperlink{structEigen_1_1DefaultDevice}{DefaultDevice}}())\ \{}
\DoxyCodeLine{00178\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockMapper}{TensorBlockMapper<NumDims,\ Evaluator::Layout,\ StorageIndex>}}}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockMapper}{TensorBlockMapper}};}
\DoxyCodeLine{00180\ }
\DoxyCodeLine{00181\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor}{internal::TensorBlockDescriptor<NumDims,\ StorageIndex>}}}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ TensorBlockDesc;}
\DoxyCodeLine{00183\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockScratchAllocator}{internal::TensorBlockScratchAllocator<DefaultDevice>}}}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ TensorBlockScratch;}
\DoxyCodeLine{00185\ }
\DoxyCodeLine{00186\ \ \ \ \ \mbox{\hyperlink{structEigen_1_1TensorEvaluator}{Evaluator}}\ \mbox{\hyperlink{structEigen_1_1internal_1_1evaluator}{evaluator}}(expr,\ device);}
\DoxyCodeLine{00187\ }
\DoxyCodeLine{00188\ \ \ \ \ \textcolor{comment}{//\ TODO(ezhulenev):\ Do\ not\ use\ tiling\ for\ small\ tensors?}}
\DoxyCodeLine{00189\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ needs\_assign\ =\ \mbox{\hyperlink{structEigen_1_1internal_1_1evaluator}{evaluator}}.evalSubExprsIfNeeded(NULL);}
\DoxyCodeLine{00190\ }
\DoxyCodeLine{00191\ \ \ \ \ \textcolor{keywordflow}{if}\ (needs\_assign)\ \{}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \textcolor{comment}{//\ Query\ expression\ tree\ for\ desired\ block\ size/shape.}}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements}{TensorBlockResourceRequirements}}\ requirements\ =}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structEigen_1_1internal_1_1evaluator}{evaluator}}.getResourceRequirements();}
\DoxyCodeLine{00195\ }
\DoxyCodeLine{00196\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockMapper}{TensorBlockMapper}}\ block\_mapper(}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typename}\ TensorBlockDesc::Dimensions(\mbox{\hyperlink{structEigen_1_1internal_1_1evaluator}{evaluator}}.dimensions()),}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ \ \ requirements);}
\DoxyCodeLine{00199\ }
\DoxyCodeLine{00200\ \ \ \ \ \ \ \textcolor{comment}{//\ Share\ scratch\ memory\ allocator\ between\ all\ blocks.}}
\DoxyCodeLine{00201\ \ \ \ \ \ \ TensorBlockScratch\ scratch(device);}
\DoxyCodeLine{00202\ }
\DoxyCodeLine{00203\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorExecutor_3_01Expression_00_01DefaultDevice_00_01Vectorizable_00_01TiledEvaluation_1_1On_01_4_a45a1dac8b7fd23e0f22c4fa7ed468c43}{StorageIndex}}\ total\_block\_count\ =\ block\_mapper.\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockMapper_a55d59205aa759a6a09d983d0da972415}{blockCount}}();}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{classEigen_1_1internal_1_1TensorExecutor_3_01Expression_00_01DefaultDevice_00_01Vectorizable_00_01TiledEvaluation_1_1On_01_4_a45a1dac8b7fd23e0f22c4fa7ed468c43}{StorageIndex}}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ total\_block\_count;\ ++\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ \{}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ TensorBlockDesc\ desc\ =\ block\_mapper.\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockMapper_afd53a52193236e8096f9f2e912a9807a}{blockDescriptor}}(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}});}
\DoxyCodeLine{00206\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structEigen_1_1internal_1_1evaluator}{evaluator}}.evalBlock(desc,\ scratch);}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \ \ scratch.reset();}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00209\ \ \ \ \ \}}
\DoxyCodeLine{00210\ \ \ \ \ \mbox{\hyperlink{structEigen_1_1internal_1_1evaluator}{evaluator}}.cleanup();}
\DoxyCodeLine{00211\ \ \ \}}
\DoxyCodeLine{00212\ \};}
\DoxyCodeLine{00213\ }
\DoxyCodeLine{00225\ \textcolor{preprocessor}{\#ifdef\ EIGEN\_USE\_THREADS}}
\DoxyCodeLine{00226\ }
\DoxyCodeLine{00227\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ TensorBlockMapper>}
\DoxyCodeLine{00228\ \textcolor{keyword}{struct\ }TensorExecutorTilingContext\ \{}
\DoxyCodeLine{00229\ \ \ TensorExecutorTilingContext()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00230\ \ \ TensorExecutorTilingContext(\textcolor{keyword}{const}\ TensorBlockMapper\&\ b\_mapper,}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1TensorOpCost}{TensorOpCost}}\&\ b\_cost,\ \textcolor{keywordtype}{size\_t}\ b\_aligned\_size)}
\DoxyCodeLine{00232\ \ \ \ \ \ \ :\ block\_mapper(b\_mapper),}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ cost(b\_cost),}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ aligned\_blocksize(b\_aligned\_size)\ \{\}}
\DoxyCodeLine{00235\ }
\DoxyCodeLine{00236\ \ \ TensorBlockMapper\ block\_mapper;\ \ \textcolor{comment}{//\ navigate\ through\ blocks}}
\DoxyCodeLine{00237\ \ \ TensorOpCost\ cost;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ cost\ of\ computing\ a\ single\ block}}
\DoxyCodeLine{00238\ \ \ \textcolor{keywordtype}{size\_t}\ aligned\_blocksize;\ \ \ \ \ \ \ \ \textcolor{comment}{//\ block\ size\ after\ memory\ alignment}}
\DoxyCodeLine{00239\ \};}
\DoxyCodeLine{00240\ }
\DoxyCodeLine{00241\ \textcolor{comment}{//\ Computes\ a\ block\ evaluation\ parameters,\ and\ allocates\ temporary\ memory\ buffer}}
\DoxyCodeLine{00242\ \textcolor{comment}{//\ for\ blocks.\ See\ TensorExecutor/TensorAsyncExecutor\ (Tiling=On)\ below.}}
\DoxyCodeLine{00243\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Evaluator,\ \textcolor{keyword}{typename}\ TensorBlockMapper,\ \textcolor{keywordtype}{bool}\ Vectorizable>}
\DoxyCodeLine{00244\ TensorExecutorTilingContext<TensorBlockMapper>\ GetTensorExecutorTilingContext(}
\DoxyCodeLine{00245\ \ \ \ \ \textcolor{keyword}{const}\ Evaluator\&\ evaluator)\ \{}
\DoxyCodeLine{00246\ \ \ \textcolor{comment}{//\ Query\ expression\ tree\ for\ desired\ block\ size/shape.}}
\DoxyCodeLine{00247\ \ \ TensorBlockResourceRequirements\ requirements\ =}
\DoxyCodeLine{00248\ \ \ \ \ \ \ evaluator.getResourceRequirements();}
\DoxyCodeLine{00249\ }
\DoxyCodeLine{00250\ \ \ \textcolor{comment}{//\ Update\ target\ block\ size\ based\ on\ cost\ model.}}
\DoxyCodeLine{00251\ \ \ \textcolor{keywordtype}{double}\ taskSize\ =\ \mbox{\hyperlink{classEigen_1_1TensorCostModel_aaae32b6af60750622e87ac1f34766c1b}{TensorCostModel<ThreadPoolDevice>::taskSize}}(}
\DoxyCodeLine{00252\ \ \ \ \ \ \ 1,\ requirements.cost\_per\_coeff);}
\DoxyCodeLine{00253\ \ \ requirements.size\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{size\_t}\textcolor{keyword}{>}(1.0\ /\ taskSize);}
\DoxyCodeLine{00254\ }
\DoxyCodeLine{00255\ \ \ TensorBlockMapper\ block\_mapper(}
\DoxyCodeLine{00256\ \ \ \ \ \ \ \textcolor{keyword}{typename}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockMapper_ae50b21cf0c501ee48ad6f09996511b6c}{TensorBlockMapper::Dimensions}}(evaluator.dimensions()),}
\DoxyCodeLine{00257\ \ \ \ \ \ \ requirements);}
\DoxyCodeLine{00258\ }
\DoxyCodeLine{00259\ \ \ \textcolor{keywordtype}{size\_t}\ block\_size\ =\ block\_mapper.blockTotalSize();}
\DoxyCodeLine{00260\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{namespaceabsl_1_1time__internal_1_1cctz_1_1detail_a5452c0ee9119ae747404cca045283e79}{align}}\ =\ \mbox{\hyperlink{namespaceEigen_1_1numext_a29d502349f2ec9897c808e65e0f96eb4}{numext::maxi}}(\mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2ConfigureVectorization_8h_aabf37293a258a90b1aa96a5d5ec04bfb}{EIGEN\_MAX\_ALIGN\_BYTES}},\ 1);}
\DoxyCodeLine{00261\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ aligned\_blocksize\ =}
\DoxyCodeLine{00262\ \ \ \ \ \ \ \mbox{\hyperlink{namespaceabsl_1_1time__internal_1_1cctz_1_1detail_a5452c0ee9119ae747404cca045283e79}{align}}\ *}
\DoxyCodeLine{00263\ \ \ \ \ \ \ \mbox{\hyperlink{namespaceEigen_a13ec9832931270b80961236d30f6d2e3}{divup<size\_t>}}(block\_size\ *\ \textcolor{keyword}{sizeof}(\textcolor{keyword}{typename}\ Evaluator::Scalar),\ align);}
\DoxyCodeLine{00264\ }
\DoxyCodeLine{00265\ \ \ \textcolor{keywordflow}{return}\ \{block\_mapper,\ requirements.cost\_per\_coeff\ *\ block\_size,}
\DoxyCodeLine{00266\ \ \ \ \ \ \ \ \ \ \ aligned\_blocksize\};}
\DoxyCodeLine{00267\ \}}
\DoxyCodeLine{00268\ }
\DoxyCodeLine{00269\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Evaluator,\ \textcolor{keyword}{typename}\ StorageIndex,\ \textcolor{keywordtype}{bool}\ Vectorizable>}
\DoxyCodeLine{00270\ \textcolor{keyword}{struct\ }EvalRange\ \{}
\DoxyCodeLine{00271\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ run(Evaluator*\ evaluator\_in,\ \textcolor{keyword}{const}\ StorageIndex\ firstIdx,}
\DoxyCodeLine{00272\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ StorageIndex\ lastIdx)\ \{}
\DoxyCodeLine{00273\ \ \ \ \ Evaluator\ evaluator\ =\ *evaluator\_in;}
\DoxyCodeLine{00274\ \ \ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(lastIdx\ >=\ firstIdx);}
\DoxyCodeLine{00275\ \ \ \ \ \textcolor{keywordflow}{for}\ (StorageIndex\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ firstIdx;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ lastIdx;\ ++\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ \{}
\DoxyCodeLine{00276\ \ \ \ \ \ \ evaluator.evalScalar(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}});}
\DoxyCodeLine{00277\ \ \ \ \ \}}
\DoxyCodeLine{00278\ \ \ \}}
\DoxyCodeLine{00279\ }
\DoxyCodeLine{00280\ \ \ \textcolor{keyword}{static}\ StorageIndex\ alignBlockSize(StorageIndex\ \mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2low__level__alloc_8cc_aad9b71a31372d5c0ab9c23163efe9544}{size}})\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2low__level__alloc_8cc_aad9b71a31372d5c0ab9c23163efe9544}{size}};\ \}}
\DoxyCodeLine{00281\ \};}
\DoxyCodeLine{00282\ }
\DoxyCodeLine{00283\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Evaluator,\ \textcolor{keyword}{typename}\ StorageIndex>}
\DoxyCodeLine{00284\ \textcolor{keyword}{struct\ }EvalRange<Evaluator,\ StorageIndex,\ \textcolor{comment}{/*Vectorizable*/}\ true>\ \{}
\DoxyCodeLine{00285\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ PacketSize\ =}
\DoxyCodeLine{00286\ \ \ \ \ \ \ unpacket\_traits<typename\ Evaluator::PacketReturnType>::size;}
\DoxyCodeLine{00287\ }
\DoxyCodeLine{00288\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ run(Evaluator*\ evaluator\_in,\ \textcolor{keyword}{const}\ StorageIndex\ firstIdx,}
\DoxyCodeLine{00289\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ StorageIndex\ lastIdx)\ \{}
\DoxyCodeLine{00290\ \ \ \ \ Evaluator\ evaluator\ =\ *evaluator\_in;}
\DoxyCodeLine{00291\ \ \ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(lastIdx\ >=\ firstIdx);}
\DoxyCodeLine{00292\ \ \ \ \ StorageIndex\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ firstIdx;}
\DoxyCodeLine{00293\ \ \ \ \ \textcolor{keywordflow}{if}\ (lastIdx\ -\/\ firstIdx\ >=\ PacketSize)\ \{}
\DoxyCodeLine{00294\ \ \ \ \ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(firstIdx\ \%\ PacketSize\ ==\ 0);}
\DoxyCodeLine{00295\ \ \ \ \ \ \ StorageIndex\ last\_chunk\_offset\ =\ lastIdx\ -\/\ 4\ *\ PacketSize;}
\DoxyCodeLine{00296\ \ \ \ \ \ \ \textcolor{comment}{//\ Give\ compiler\ a\ strong\ possibility\ to\ unroll\ the\ loop.\ But\ don't\ insist}}
\DoxyCodeLine{00297\ \ \ \ \ \ \ \textcolor{comment}{//\ on\ unrolling,\ because\ if\ the\ function\ is\ expensive\ compiler\ should\ not}}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \textcolor{comment}{//\ unroll\ the\ loop\ at\ the\ expense\ of\ inlining.}}
\DoxyCodeLine{00299\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <=\ last\_chunk\_offset;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +=\ 4\ *\ PacketSize)\ \{}
\DoxyCodeLine{00300\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (StorageIndex\ j\ =\ 0;\ \mbox{\hyperlink{namespaceabsl_adb6bd4a9012b471ac01613aff8d4d81ba363b122c528f54df4a0446b6bab05515}{j}}\ <\ 4;\ \mbox{\hyperlink{namespaceabsl_adb6bd4a9012b471ac01613aff8d4d81ba363b122c528f54df4a0446b6bab05515}{j}}++)\ \{}
\DoxyCodeLine{00301\ \ \ \ \ \ \ \ \ \ \ evaluator.evalPacket(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +\ j\ *\ PacketSize);}
\DoxyCodeLine{00302\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00303\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00304\ \ \ \ \ \ \ last\_chunk\_offset\ =\ lastIdx\ -\/\ PacketSize;}
\DoxyCodeLine{00305\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <=\ last\_chunk\_offset;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +=\ PacketSize)\ \{}
\DoxyCodeLine{00306\ \ \ \ \ \ \ \ \ evaluator.evalPacket(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}});}
\DoxyCodeLine{00307\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00308\ \ \ \ \ \}}
\DoxyCodeLine{00309\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ lastIdx;\ ++\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ \{}
\DoxyCodeLine{00310\ \ \ \ \ \ \ evaluator.evalScalar(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}});}
\DoxyCodeLine{00311\ \ \ \ \ \}}
\DoxyCodeLine{00312\ \ \ \}}
\DoxyCodeLine{00313\ }
\DoxyCodeLine{00314\ \ \ \textcolor{keyword}{static}\ StorageIndex\ alignBlockSize(StorageIndex\ \mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2low__level__alloc_8cc_aad9b71a31372d5c0ab9c23163efe9544}{size}})\ \{}
\DoxyCodeLine{00315\ \ \ \ \ \textcolor{comment}{//\ Align\ block\ size\ to\ packet\ size\ and\ account\ for\ unrolling\ in\ run\ above.}}
\DoxyCodeLine{00316\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2low__level__alloc_8cc_aad9b71a31372d5c0ab9c23163efe9544}{size}}\ >=\ 16\ *\ PacketSize)\ \{}
\DoxyCodeLine{00317\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2low__level__alloc_8cc_aad9b71a31372d5c0ab9c23163efe9544}{size}}\ +\ 4\ *\ PacketSize\ -\/\ 1)\ \&\ \string~(4\ *\ PacketSize\ -\/\ 1);}
\DoxyCodeLine{00318\ \ \ \ \ \}}
\DoxyCodeLine{00319\ \ \ \ \ \textcolor{comment}{//\ Aligning\ to\ 4\ *\ PacketSize\ would\ increase\ block\ size\ by\ more\ than\ 25\%.}}
\DoxyCodeLine{00320\ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2low__level__alloc_8cc_aad9b71a31372d5c0ab9c23163efe9544}{size}}\ +\ PacketSize\ -\/\ 1)\ \&\ \string~(PacketSize\ -\/\ 1);}
\DoxyCodeLine{00321\ \ \ \}}
\DoxyCodeLine{00322\ \};}
\DoxyCodeLine{00323\ }
\DoxyCodeLine{00324\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Expression,\ \textcolor{keywordtype}{bool}\ Vectorizable,\ TiledEvaluation\ Tiling>}
\DoxyCodeLine{00325\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classTensorExecutor}{TensorExecutor}}<Expression,\ ThreadPoolDevice,\ Vectorizable,\ Tiling>\ \{}
\DoxyCodeLine{00326\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00327\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ Expression::Index\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorExecutor_a60e50f31d7022a5a96847d341d0153f4}{StorageIndex}};}
\DoxyCodeLine{00328\ }
\DoxyCodeLine{00329\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorExecutor_a50325b41f927e2c29141c7ac671efdec}{run}}(\textcolor{keyword}{const}\ Expression\&\ expr,}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ ThreadPoolDevice\&\ device)\ \{}
\DoxyCodeLine{00331\ \ \ \ \ \textcolor{keyword}{typedef}\ TensorEvaluator<Expression,\ ThreadPoolDevice>\ Evaluator;}
\DoxyCodeLine{00332\ \ \ \ \ \textcolor{keyword}{typedef}\ EvalRange<Evaluator,\ StorageIndex,\ Vectorizable>\ EvalRange;}
\DoxyCodeLine{00333\ }
\DoxyCodeLine{00334\ \ \ \ \ Evaluator\ evaluator(expr,\ device);}
\DoxyCodeLine{00335\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ needs\_assign\ =\ evaluator.evalSubExprsIfNeeded(\textcolor{keyword}{nullptr});}
\DoxyCodeLine{00336\ \ \ \ \ \textcolor{keywordflow}{if}\ (needs\_assign)\ \{}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorExecutor_a60e50f31d7022a5a96847d341d0153f4}{StorageIndex}}\ \mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2low__level__alloc_8cc_aad9b71a31372d5c0ab9c23163efe9544}{size}}\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_a3b99e338d92a91c8b3f89d32d0ca2c39}{array\_prod}}(evaluator.dimensions());}
\DoxyCodeLine{00338\ \ \ \ \ \ \ device.parallelFor(\mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2low__level__alloc_8cc_aad9b71a31372d5c0ab9c23163efe9544}{size}},\ evaluator.costPerCoeff(Vectorizable),}
\DoxyCodeLine{00339\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ EvalRange::alignBlockSize,}
\DoxyCodeLine{00340\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\&evaluator](\mbox{\hyperlink{classEigen_1_1internal_1_1TensorExecutor_a60e50f31d7022a5a96847d341d0153f4}{StorageIndex}}\ firstIdx,\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorExecutor_a60e50f31d7022a5a96847d341d0153f4}{StorageIndex}}\ lastIdx)\ \{}
\DoxyCodeLine{00341\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ EvalRange::run(\&evaluator,\ firstIdx,\ lastIdx);}
\DoxyCodeLine{00342\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00343\ \ \ \ \ \}}
\DoxyCodeLine{00344\ \ \ \ \ evaluator.cleanup();}
\DoxyCodeLine{00345\ \ \ \}}
\DoxyCodeLine{00346\ \};}
\DoxyCodeLine{00347\ }
\DoxyCodeLine{00348\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Expression,\ \textcolor{keywordtype}{bool}\ Vectorizable>}
\DoxyCodeLine{00349\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classTensorExecutor}{TensorExecutor}}<Expression,\ ThreadPoolDevice,\ Vectorizable,}
\DoxyCodeLine{00350\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*Tiling=*/}\mbox{\hyperlink{namespaceEigen_1_1internal_a131ba611978f02e7ac1c6a0faae2a250}{TiledEvaluation}}::\mbox{\hyperlink{namespaceEigen_1_1internal_a131ba611978f02e7ac1c6a0faae2a250aeef1561c4bf6d0efc2470b89c1a815c6}{On}}>\ \{}
\DoxyCodeLine{00351\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00352\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ traits<Expression>::Index\ IndexType;}
\DoxyCodeLine{00353\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ traits<Expression>::Scalar\ Scalar;}
\DoxyCodeLine{00354\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{structEigen_1_1internal_1_1remove__const_afe3dbb0bdee2ec8eed4416723d75bc90}{remove\_const<Scalar>::type}}\ ScalarNoConst;}
\DoxyCodeLine{00355\ }
\DoxyCodeLine{00356\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ NumDims\ =\ traits<Expression>::NumDimensions;}
\DoxyCodeLine{00357\ }
\DoxyCodeLine{00358\ \ \ \textcolor{keyword}{typedef}\ TensorEvaluator<Expression,\ ThreadPoolDevice>\ Evaluator;}
\DoxyCodeLine{00359\ \ \ \textcolor{keyword}{typedef}\ TensorBlockMapper<NumDims,\ Evaluator::Layout,\ IndexType>\ BlockMapper;}
\DoxyCodeLine{00360\ \ \ \textcolor{keyword}{typedef}\ TensorExecutorTilingContext<BlockMapper>\ TilingContext;}
\DoxyCodeLine{00361\ }
\DoxyCodeLine{00362\ \ \ \textcolor{keyword}{typedef}\ internal::TensorBlockDescriptor<NumDims,\ IndexType>}
\DoxyCodeLine{00363\ \ \ \ \ \ \ TensorBlockDesc;}
\DoxyCodeLine{00364\ \ \ \textcolor{keyword}{typedef}\ internal::TensorBlockScratchAllocator<ThreadPoolDevice>}
\DoxyCodeLine{00365\ \ \ \ \ \ \ TensorBlockScratch;}
\DoxyCodeLine{00366\ }
\DoxyCodeLine{00367\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorExecutor_a50325b41f927e2c29141c7ac671efdec}{run}}(\textcolor{keyword}{const}\ Expression\&\ expr,}
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ ThreadPoolDevice\&\ device)\ \{}
\DoxyCodeLine{00369\ \ \ \ \ Evaluator\ evaluator(expr,\ device);}
\DoxyCodeLine{00370\ }
\DoxyCodeLine{00371\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ needs\_assign\ =\ evaluator.evalSubExprsIfNeeded(\textcolor{keyword}{nullptr});}
\DoxyCodeLine{00372\ \ \ \ \ \textcolor{keywordflow}{if}\ (needs\_assign)\ \{}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \textcolor{keyword}{const}\ TilingContext\ tiling\ =}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \ \ \ \ internal::GetTensorExecutorTilingContext<Evaluator,\ BlockMapper,}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Vectorizable>(evaluator);}
\DoxyCodeLine{00376\ }
\DoxyCodeLine{00377\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ eval\_block\ =\ [\&device,\ \&evaluator,\ \&tiling](IndexType\ firstBlockIdx,}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ IndexType\ lastBlockIdx)\ \{}
\DoxyCodeLine{00379\ \ \ \ \ \ \ \ \ TensorBlockScratch\ scratch(device);}
\DoxyCodeLine{00380\ }
\DoxyCodeLine{00381\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (IndexType\ block\_idx\ =\ firstBlockIdx;\ block\_idx\ <\ lastBlockIdx;}
\DoxyCodeLine{00382\ \ \ \ \ \ \ \ \ \ \ \ \ \ ++block\_idx)\ \{}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \ \ \ \ TensorBlockDesc\ desc\ =\ tiling.block\_mapper.blockDescriptor(block\_idx);}
\DoxyCodeLine{00384\ \ \ \ \ \ \ \ \ \ \ evaluator.evalBlock(desc,\ scratch);}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ \ \ scratch.reset();}
\DoxyCodeLine{00386\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00387\ \ \ \ \ \ \ \};}
\DoxyCodeLine{00388\ }
\DoxyCodeLine{00389\ \ \ \ \ \ \ \textcolor{comment}{//\ Evaluate\ small\ expressions\ directly\ as\ a\ single\ block.}}
\DoxyCodeLine{00390\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (tiling.block\_mapper.blockCount()\ ==\ 1)\ \{}
\DoxyCodeLine{00391\ \ \ \ \ \ \ \ \ TensorBlockScratch\ scratch(device);}
\DoxyCodeLine{00392\ \ \ \ \ \ \ \ \ TensorBlockDesc\ desc(0,\ tiling.block\_mapper.blockDimensions());}
\DoxyCodeLine{00393\ \ \ \ \ \ \ \ \ evaluator.evalBlock(desc,\ scratch);}
\DoxyCodeLine{00394\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00395\ \ \ \ \ \ \ \ \ device.parallelFor(tiling.block\_mapper.blockCount(),\ tiling.cost,}
\DoxyCodeLine{00396\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ eval\_block);}
\DoxyCodeLine{00397\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00398\ \ \ \ \ \}}
\DoxyCodeLine{00399\ \ \ \ \ evaluator.cleanup();}
\DoxyCodeLine{00400\ \ \ \}}
\DoxyCodeLine{00401\ \};}
\DoxyCodeLine{00402\ }
\DoxyCodeLine{00403\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Expression,\ \textcolor{keyword}{typename}\ DoneCallback,\ \textcolor{keywordtype}{bool}\ Vectorizable,}
\DoxyCodeLine{00404\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceEigen_1_1internal_a131ba611978f02e7ac1c6a0faae2a250}{TiledEvaluation}}\ Tiling>}
\DoxyCodeLine{00405\ \textcolor{keyword}{class\ }TensorAsyncExecutor<Expression,\ ThreadPoolDevice,\ DoneCallback,}
\DoxyCodeLine{00406\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Vectorizable,\ Tiling>\ \{}
\DoxyCodeLine{00407\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00408\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ Expression::Index\ StorageIndex;}
\DoxyCodeLine{00409\ \ \ \textcolor{keyword}{typedef}\ TensorEvaluator<Expression,\ ThreadPoolDevice>\ Evaluator;}
\DoxyCodeLine{00410\ }
\DoxyCodeLine{00411\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keywordtype}{void}\ runAsync(\textcolor{keyword}{const}\ Expression\&\ expr,}
\DoxyCodeLine{00412\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ ThreadPoolDevice\&\ device,}
\DoxyCodeLine{00413\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ DoneCallback\ done)\ \{}
\DoxyCodeLine{00414\ \ \ \ \ TensorAsyncExecutorContext*\ \textcolor{keyword}{const}\ ctx\ =}
\DoxyCodeLine{00415\ \ \ \ \ \ \ \ \ \textcolor{keyword}{new}\ TensorAsyncExecutorContext(expr,\ device,\ std::move(done));}
\DoxyCodeLine{00416\ }
\DoxyCodeLine{00417\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ on\_eval\_subexprs\ =\ [ctx,\ \&device](\textcolor{keywordtype}{bool}\ need\_assign)\ -\/>\ \textcolor{keywordtype}{void}\ \{}
\DoxyCodeLine{00418\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!need\_assign)\ \{}
\DoxyCodeLine{00419\ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ ctx;}
\DoxyCodeLine{00420\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00421\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00422\ }
\DoxyCodeLine{00423\ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ EvalRange<Evaluator,\ StorageIndex,\ Vectorizable>\ EvalRange;}
\DoxyCodeLine{00424\ \ \ \ \ \ \ \textcolor{keyword}{const}\ StorageIndex\ \mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2low__level__alloc_8cc_aad9b71a31372d5c0ab9c23163efe9544}{size}}\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_a3b99e338d92a91c8b3f89d32d0ca2c39}{array\_prod}}(ctx-\/>evaluator.dimensions());}
\DoxyCodeLine{00425\ \ \ \ \ \ \ device.parallelForAsync(}
\DoxyCodeLine{00426\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2low__level__alloc_8cc_aad9b71a31372d5c0ab9c23163efe9544}{size}},\ ctx-\/>evaluator.costPerCoeff(Vectorizable),}
\DoxyCodeLine{00427\ \ \ \ \ \ \ \ \ \ \ EvalRange::alignBlockSize,}
\DoxyCodeLine{00428\ \ \ \ \ \ \ \ \ \ \ [ctx](StorageIndex\ firstIdx,\ StorageIndex\ lastIdx)\ \{}
\DoxyCodeLine{00429\ \ \ \ \ \ \ \ \ \ \ \ \ EvalRange::run(\&ctx-\/>evaluator,\ firstIdx,\ lastIdx);}
\DoxyCodeLine{00430\ \ \ \ \ \ \ \ \ \ \ \},}
\DoxyCodeLine{00431\ \ \ \ \ \ \ \ \ \ \ [ctx]()\ \{\ delete\ ctx;\ \});}
\DoxyCodeLine{00432\ \ \ \ \ \};}
\DoxyCodeLine{00433\ }
\DoxyCodeLine{00434\ \ \ \ \ ctx-\/>evaluator.evalSubExprsIfNeededAsync(\textcolor{keyword}{nullptr},\ on\_eval\_subexprs);}
\DoxyCodeLine{00435\ \ \ \}}
\DoxyCodeLine{00436\ }
\DoxyCodeLine{00437\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00438\ \ \ \textcolor{keyword}{struct\ }TensorAsyncExecutorContext\ \{}
\DoxyCodeLine{00439\ \ \ \ \ TensorAsyncExecutorContext(\textcolor{keyword}{const}\ Expression\&\ expr,}
\DoxyCodeLine{00440\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ ThreadPoolDevice\&\ thread\_pool,}
\DoxyCodeLine{00441\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ DoneCallback\ done)}
\DoxyCodeLine{00442\ \ \ \ \ \ \ \ \ :\ evaluator(expr,\ thread\_pool),\ on\_done(\mbox{\hyperlink{namespacestd}{std}}::move(done))\ \{\}}
\DoxyCodeLine{00443\ }
\DoxyCodeLine{00444\ \ \ \ \ \string~TensorAsyncExecutorContext()\ \{}
\DoxyCodeLine{00445\ \ \ \ \ \ \ evaluator.cleanup();}
\DoxyCodeLine{00446\ \ \ \ \ \ \ on\_done();}
\DoxyCodeLine{00447\ \ \ \ \ \}}
\DoxyCodeLine{00448\ }
\DoxyCodeLine{00449\ \ \ \ \ Evaluator\ evaluator;}
\DoxyCodeLine{00450\ }
\DoxyCodeLine{00451\ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00452\ \ \ \ \ DoneCallback\ on\_done;}
\DoxyCodeLine{00453\ \ \ \};}
\DoxyCodeLine{00454\ \};}
\DoxyCodeLine{00455\ }
\DoxyCodeLine{00456\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Expression,\ \textcolor{keyword}{typename}\ DoneCallback,\ \textcolor{keywordtype}{bool}\ Vectorizable>}
\DoxyCodeLine{00457\ \textcolor{keyword}{class\ }TensorAsyncExecutor<Expression,\ ThreadPoolDevice,\ DoneCallback,}
\DoxyCodeLine{00458\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Vectorizable,\ \textcolor{comment}{/*Tileable*/}\ \mbox{\hyperlink{namespaceEigen_1_1internal_a131ba611978f02e7ac1c6a0faae2a250}{TiledEvaluation}}::\mbox{\hyperlink{namespaceEigen_1_1internal_a131ba611978f02e7ac1c6a0faae2a250aeef1561c4bf6d0efc2470b89c1a815c6}{On}}>\ \{}
\DoxyCodeLine{00459\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00460\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ traits<Expression>::Index\ IndexType;}
\DoxyCodeLine{00461\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ traits<Expression>::Scalar\ Scalar;}
\DoxyCodeLine{00462\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{structEigen_1_1internal_1_1remove__const_afe3dbb0bdee2ec8eed4416723d75bc90}{remove\_const<Scalar>::type}}\ ScalarNoConst;}
\DoxyCodeLine{00463\ }
\DoxyCodeLine{00464\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ NumDims\ =\ traits<Expression>::NumDimensions;}
\DoxyCodeLine{00465\ }
\DoxyCodeLine{00466\ \ \ \textcolor{keyword}{typedef}\ TensorEvaluator<Expression,\ ThreadPoolDevice>\ Evaluator;}
\DoxyCodeLine{00467\ \ \ \textcolor{keyword}{typedef}\ TensorBlockMapper<NumDims,\ Evaluator::Layout,\ IndexType>\ BlockMapper;}
\DoxyCodeLine{00468\ \ \ \textcolor{keyword}{typedef}\ TensorExecutorTilingContext<BlockMapper>\ TilingContext;}
\DoxyCodeLine{00469\ }
\DoxyCodeLine{00470\ \ \ \textcolor{keyword}{typedef}\ internal::TensorBlockDescriptor<NumDims,\ IndexType>\ TensorBlockDesc;}
\DoxyCodeLine{00471\ \ \ \textcolor{keyword}{typedef}\ internal::TensorBlockScratchAllocator<ThreadPoolDevice>}
\DoxyCodeLine{00472\ \ \ \ \ \ \ TensorBlockScratch;}
\DoxyCodeLine{00473\ }
\DoxyCodeLine{00474\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keywordtype}{void}\ runAsync(\textcolor{keyword}{const}\ Expression\&\ expr,}
\DoxyCodeLine{00475\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ ThreadPoolDevice\&\ device,}
\DoxyCodeLine{00476\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ DoneCallback\ done)\ \{}
\DoxyCodeLine{00477\ }
\DoxyCodeLine{00478\ \ \ \ \ TensorAsyncExecutorContext*\ \textcolor{keyword}{const}\ ctx\ =}
\DoxyCodeLine{00479\ \ \ \ \ \ \ \ \ \textcolor{keyword}{new}\ TensorAsyncExecutorContext(expr,\ device,\ std::move(done));}
\DoxyCodeLine{00480\ }
\DoxyCodeLine{00481\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ on\_eval\_subexprs\ =\ [ctx](\textcolor{keywordtype}{bool}\ need\_assign)\ -\/>\ \textcolor{keywordtype}{void}\ \{}
\DoxyCodeLine{00482\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!need\_assign)\ \{}
\DoxyCodeLine{00483\ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ ctx;}
\DoxyCodeLine{00484\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00485\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00486\ }
\DoxyCodeLine{00487\ \ \ \ \ \ \ ctx-\/>tiling\ =\ internal::GetTensorExecutorTilingContext<}
\DoxyCodeLine{00488\ \ \ \ \ \ \ \ \ \ \ Evaluator,\ BlockMapper,\ Vectorizable>(ctx-\/>evaluator);}
\DoxyCodeLine{00489\ }
\DoxyCodeLine{00490\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ eval\_block\ =\ [ctx](IndexType\ firstBlockIdx,\ IndexType\ lastBlockIdx)\ \{}
\DoxyCodeLine{00491\ \ \ \ \ \ \ \ \ TensorBlockScratch\ scratch(ctx-\/>device);}
\DoxyCodeLine{00492\ }
\DoxyCodeLine{00493\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (IndexType\ block\_idx\ =\ firstBlockIdx;\ block\_idx\ <\ lastBlockIdx;}
\DoxyCodeLine{00494\ \ \ \ \ \ \ \ \ \ \ \ \ \ ++block\_idx)\ \{}
\DoxyCodeLine{00495\ \ \ \ \ \ \ \ \ \ \ TensorBlockDesc\ desc\ =}
\DoxyCodeLine{00496\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ctx-\/>tiling.block\_mapper.blockDescriptor(block\_idx);}
\DoxyCodeLine{00497\ \ \ \ \ \ \ \ \ \ \ ctx-\/>evaluator.evalBlock(desc,\ scratch);}
\DoxyCodeLine{00498\ \ \ \ \ \ \ \ \ \ \ scratch.reset();}
\DoxyCodeLine{00499\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00500\ \ \ \ \ \ \ \};}
\DoxyCodeLine{00501\ }
\DoxyCodeLine{00502\ \ \ \ \ \ \ \textcolor{comment}{//\ Evaluate\ small\ expressions\ directly\ as\ a\ single\ block.}}
\DoxyCodeLine{00503\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ctx-\/>tiling.block\_mapper.blockCount()\ ==\ 1)\ \{}
\DoxyCodeLine{00504\ \ \ \ \ \ \ \ \ TensorBlockScratch\ scratch(ctx-\/>device);}
\DoxyCodeLine{00505\ \ \ \ \ \ \ \ \ TensorBlockDesc\ desc(0,\ ctx-\/>tiling.block\_mapper.blockDimensions());}
\DoxyCodeLine{00506\ \ \ \ \ \ \ \ \ ctx-\/>evaluator.evalBlock(desc,\ scratch);}
\DoxyCodeLine{00507\ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ ctx;}
\DoxyCodeLine{00508\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00509\ \ \ \ \ \ \ \ \ ctx-\/>device.parallelForAsync(ctx-\/>tiling.block\_mapper.blockCount(),}
\DoxyCodeLine{00510\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ctx-\/>tiling.cost,\ eval\_block,}
\DoxyCodeLine{00511\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [ctx]()\ \{\ delete\ ctx;\ \});}
\DoxyCodeLine{00512\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00513\ \ \ \ \ \};}
\DoxyCodeLine{00514\ }
\DoxyCodeLine{00515\ \ \ \ \ ctx-\/>evaluator.evalSubExprsIfNeededAsync(\textcolor{keyword}{nullptr},\ on\_eval\_subexprs);}
\DoxyCodeLine{00516\ \ \ \}}
\DoxyCodeLine{00517\ }
\DoxyCodeLine{00518\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00519\ \ \ \textcolor{keyword}{struct\ }TensorAsyncExecutorContext\ \{}
\DoxyCodeLine{00520\ \ \ \ \ TensorAsyncExecutorContext(\textcolor{keyword}{const}\ Expression\&\ expr,}
\DoxyCodeLine{00521\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ ThreadPoolDevice\&\ thread\_pool,}
\DoxyCodeLine{00522\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ DoneCallback\ done)}
\DoxyCodeLine{00523\ \ \ \ \ \ \ \ \ :\ device(thread\_pool),}
\DoxyCodeLine{00524\ \ \ \ \ \ \ \ \ \ \ evaluator(expr,\ thread\_pool),}
\DoxyCodeLine{00525\ \ \ \ \ \ \ \ \ \ \ on\_done(\mbox{\hyperlink{namespacestd}{std}}::move(done))\ \{\}}
\DoxyCodeLine{00526\ }
\DoxyCodeLine{00527\ \ \ \ \ \string~TensorAsyncExecutorContext()\ \{}
\DoxyCodeLine{00528\ \ \ \ \ \ \ evaluator.cleanup();}
\DoxyCodeLine{00529\ \ \ \ \ \ \ on\_done();}
\DoxyCodeLine{00530\ \ \ \ \ \}}
\DoxyCodeLine{00531\ }
\DoxyCodeLine{00532\ \ \ \ \ \textcolor{keyword}{const}\ ThreadPoolDevice\&\ device;}
\DoxyCodeLine{00533\ \ \ \ \ Evaluator\ evaluator;}
\DoxyCodeLine{00534\ \ \ \ \ TilingContext\ tiling;}
\DoxyCodeLine{00535\ }
\DoxyCodeLine{00536\ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00537\ \ \ \ \ DoneCallback\ on\_done;}
\DoxyCodeLine{00538\ \ \ \};}
\DoxyCodeLine{00539\ \};}
\DoxyCodeLine{00540\ }
\DoxyCodeLine{00541\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ EIGEN\_USE\_THREADS}}
\DoxyCodeLine{00542\ }
\DoxyCodeLine{00543\ \textcolor{comment}{//\ GPU:\ the\ evaluation\ of\ the\ expression\ is\ offloaded\ to\ a\ GPU.}}
\DoxyCodeLine{00544\ \textcolor{preprocessor}{\#if\ defined(EIGEN\_USE\_GPU)}}
\DoxyCodeLine{00545\ }
\DoxyCodeLine{00546\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Expression,\ \textcolor{keywordtype}{bool}\ Vectorizable,\ TiledEvaluation\ Tiling>}
\DoxyCodeLine{00547\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classTensorExecutor}{TensorExecutor}}<Expression,\ GpuDevice,\ Vectorizable,\ Tiling>\ \{}
\DoxyCodeLine{00548\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00549\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ Expression::Index\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorExecutor_a60e50f31d7022a5a96847d341d0153f4}{StorageIndex}};}
\DoxyCodeLine{00550\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorExecutor_a50325b41f927e2c29141c7ac671efdec}{run}}(\textcolor{keyword}{const}\ Expression\&\ expr,\ \textcolor{keyword}{const}\ GpuDevice\&\ device);}
\DoxyCodeLine{00551\ \};}
\DoxyCodeLine{00552\ }
\DoxyCodeLine{00553\ \textcolor{preprocessor}{\#if\ defined(EIGEN\_GPUCC)}}
\DoxyCodeLine{00554\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Evaluator,\ \textcolor{keyword}{typename}\ StorageIndex,\ \textcolor{keywordtype}{bool}\ Vectorizable>}
\DoxyCodeLine{00555\ \textcolor{keyword}{struct\ }EigenMetaKernelEval\ \{}
\DoxyCodeLine{00556\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}\ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_a1fdc6f94f20527c7275768d82b2eb9ce}{EIGEN\_ALWAYS\_INLINE}}}
\DoxyCodeLine{00557\ \ \ \textcolor{keywordtype}{void}\ run(Evaluator\&\ eval,\ StorageIndex\ firstIdx,\ StorageIndex\ lastIdx,\ StorageIndex\ step\_size)\ \{}
\DoxyCodeLine{00558\ \ \ \ \ \textcolor{keywordflow}{for}\ (StorageIndex\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ firstIdx;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ lastIdx;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +=\ step\_size)\ \{}
\DoxyCodeLine{00559\ \ \ \ \ \ \ eval.evalScalar(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}});}
\DoxyCodeLine{00560\ \ \ \ \ \}}
\DoxyCodeLine{00561\ \ \ \}}
\DoxyCodeLine{00562\ \};}
\DoxyCodeLine{00563\ }
\DoxyCodeLine{00564\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Evaluator,\ \textcolor{keyword}{typename}\ StorageIndex>}
\DoxyCodeLine{00565\ \textcolor{keyword}{struct\ }EigenMetaKernelEval<Evaluator,\ StorageIndex,\ true>\ \{}
\DoxyCodeLine{00566\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}\ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_a1fdc6f94f20527c7275768d82b2eb9ce}{EIGEN\_ALWAYS\_INLINE}}}
\DoxyCodeLine{00567\ \ \ \textcolor{keywordtype}{void}\ run(Evaluator\&\ eval,\ StorageIndex\ firstIdx,\ StorageIndex\ lastIdx,\ StorageIndex\ step\_size)\ \{}
\DoxyCodeLine{00568\ \ \ \ \ \textcolor{keyword}{const}\ StorageIndex\ PacketSize\ =\ unpacket\_traits<typename\ Evaluator::PacketReturnType>::size;}
\DoxyCodeLine{00569\ \ \ \ \ \textcolor{keyword}{const}\ StorageIndex\ vectorized\_size\ =\ (lastIdx\ /\ PacketSize)\ *\ PacketSize;}
\DoxyCodeLine{00570\ \ \ \ \ \textcolor{keyword}{const}\ StorageIndex\ vectorized\_step\_size\ =\ step\_size\ *\ PacketSize;}
\DoxyCodeLine{00571\ }
\DoxyCodeLine{00572\ \ \ \ \ \textcolor{comment}{//\ Use\ the\ vector\ path}}
\DoxyCodeLine{00573\ \ \ \ \ \textcolor{keywordflow}{for}\ (StorageIndex\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ firstIdx\ *\ PacketSize;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ vectorized\_size;}
\DoxyCodeLine{00574\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +=\ vectorized\_step\_size)\ \{}
\DoxyCodeLine{00575\ \ \ \ \ \ \ eval.evalPacket(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}});}
\DoxyCodeLine{00576\ \ \ \ \ \}}
\DoxyCodeLine{00577\ \ \ \ \ \textcolor{keywordflow}{for}\ (StorageIndex\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ vectorized\_size\ +\ firstIdx;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ lastIdx;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +=\ step\_size)\ \{}
\DoxyCodeLine{00578\ \ \ \ \ \ \ eval.evalScalar(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}});}
\DoxyCodeLine{00579\ \ \ \ \ \}}
\DoxyCodeLine{00580\ \ \ \}}
\DoxyCodeLine{00581\ \};}
\DoxyCodeLine{00582\ }
\DoxyCodeLine{00583\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Evaluator,\ \textcolor{keyword}{typename}\ StorageIndex>}
\DoxyCodeLine{00584\ \_\_global\_\_\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00585\ \_\_launch\_bounds\_\_(1024)}
\DoxyCodeLine{00586\ EigenMetaKernel(Evaluator\ eval,\ StorageIndex\ \mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2low__level__alloc_8cc_aad9b71a31372d5c0ab9c23163efe9544}{size}})\ \{}
\DoxyCodeLine{00587\ }
\DoxyCodeLine{00588\ \ \ \textcolor{keyword}{const}\ StorageIndex\ first\_index\ =\ blockIdx.x\ *\ blockDim.x\ +\ threadIdx.x;}
\DoxyCodeLine{00589\ \ \ \textcolor{keyword}{const}\ StorageIndex\ step\_size\ =\ blockDim.x\ *\ gridDim.x;}
\DoxyCodeLine{00590\ }
\DoxyCodeLine{00591\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ vectorizable\ =\ Evaluator::PacketAccess\ \&\ Evaluator::IsAligned;}
\DoxyCodeLine{00592\ \ \ EigenMetaKernelEval<Evaluator,\ StorageIndex,\ vectorizable>::run(eval,\ first\_index,\ \mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2low__level__alloc_8cc_aad9b71a31372d5c0ab9c23163efe9544}{size}},\ step\_size);}
\DoxyCodeLine{00593\ \}}
\DoxyCodeLine{00594\ }
\DoxyCodeLine{00595\ \textcolor{comment}{/*static*/}}
\DoxyCodeLine{00596\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Expression,\ \textcolor{keywordtype}{bool}\ Vectorizable,\ TiledEvaluation\ Tiling>}
\DoxyCodeLine{00597\ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorExecutor_a50325b41f927e2c29141c7ac671efdec}{TensorExecutor<Expression,\ GpuDevice,\ Vectorizable,\ Tiling>::run}}(}
\DoxyCodeLine{00598\ \ \ \ \ \textcolor{keyword}{const}\ Expression\&\ expr,\ \textcolor{keyword}{const}\ GpuDevice\&\ device)\ \{}
\DoxyCodeLine{00599\ \ \ TensorEvaluator<Expression,\ GpuDevice>\ evaluator(expr,\ device);}
\DoxyCodeLine{00600\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ needs\_assign\ =\ evaluator.evalSubExprsIfNeeded(\textcolor{keyword}{nullptr});}
\DoxyCodeLine{00601\ \ \ \textcolor{keywordflow}{if}\ (needs\_assign)\ \{}
\DoxyCodeLine{00602\ }
\DoxyCodeLine{00603\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ block\_size\ =\ device.maxGpuThreadsPerBlock();}
\DoxyCodeLine{00604\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ max\_blocks\ =\ device.getNumGpuMultiProcessors()\ *}
\DoxyCodeLine{00605\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ device.maxGpuThreadsPerMultiProcessor()\ /\ block\_size;}
\DoxyCodeLine{00606\ \ \ \ \ \textcolor{keyword}{const}\ StorageIndex\ \mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2low__level__alloc_8cc_aad9b71a31372d5c0ab9c23163efe9544}{size}}\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_a3b99e338d92a91c8b3f89d32d0ca2c39}{array\_prod}}(evaluator.dimensions());}
\DoxyCodeLine{00607\ \ \ \ \ \textcolor{comment}{//\ Create\ a\ least\ one\ block\ to\ ensure\ we\ won't\ crash\ when\ tensorflow\ calls\ with\ tensors\ of\ size\ 0.}}
\DoxyCodeLine{00608\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ num\_blocks\ =\ \mbox{\hyperlink{namespaceEigen_1_1numext_a29d502349f2ec9897c808e65e0f96eb4}{numext::maxi<int>}}(\mbox{\hyperlink{namespaceEigen_1_1numext_ab3b30bf0bcfa1ad91dbec75fabb3bea0}{numext::mini<int>}}(max\_blocks,\ \mbox{\hyperlink{namespaceEigen_a13ec9832931270b80961236d30f6d2e3}{divup<int>}}(\mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2low__level__alloc_8cc_aad9b71a31372d5c0ab9c23163efe9544}{size}},\ block\_size)),\ 1);}
\DoxyCodeLine{00609\ }
\DoxyCodeLine{00610\ \ \ \ \ LAUNCH\_GPU\_KERNEL(}
\DoxyCodeLine{00611\ \ \ \ \ \ \ \ \ (EigenMetaKernel<TensorEvaluator<Expression,\ GpuDevice>,\ StorageIndex>),}
\DoxyCodeLine{00612\ \ \ \ \ \ \ \ \ num\_blocks,\ block\_size,\ 0,\ device,\ evaluator,\ \mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2low__level__alloc_8cc_aad9b71a31372d5c0ab9c23163efe9544}{size}});}
\DoxyCodeLine{00613\ \ \ \}}
\DoxyCodeLine{00614\ \ \ evaluator.cleanup();}
\DoxyCodeLine{00615\ \}}
\DoxyCodeLine{00616\ }
\DoxyCodeLine{00617\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ EIGEN\_GPUCC}}
\DoxyCodeLine{00618\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ EIGEN\_USE\_GPU}}
\DoxyCodeLine{00619\ }
\DoxyCodeLine{00620\ \textcolor{comment}{//\ SYCL\ Executor\ policy}}
\DoxyCodeLine{00621\ \textcolor{preprocessor}{\#ifdef\ EIGEN\_USE\_SYCL}}
\DoxyCodeLine{00622\ }
\DoxyCodeLine{00623\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Evaluator>}
\DoxyCodeLine{00624\ \textcolor{keyword}{struct\ }ExecExprFunctorKernel\ \{}
\DoxyCodeLine{00625\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ Evaluator::Index\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}};}
\DoxyCodeLine{00626\ \ \ Evaluator\ evaluator;}
\DoxyCodeLine{00627\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ range;}
\DoxyCodeLine{00628\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Scratch>}
\DoxyCodeLine{00629\ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}\ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_a1fdc6f94f20527c7275768d82b2eb9ce}{EIGEN\_ALWAYS\_INLINE}}\ ExecExprFunctorKernel(}
\DoxyCodeLine{00630\ \ \ \ \ \ \ \textcolor{keyword}{const}\ Scratch,\ Evaluator\ evaluator\_,\ \textcolor{keyword}{const}\ Index\ range\_)}
\DoxyCodeLine{00631\ \ \ \ \ \ \ :\ evaluator(evaluator\_),\ range(range\_)\ \{\}}
\DoxyCodeLine{00632\ }
\DoxyCodeLine{00633\ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}\ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_a1fdc6f94f20527c7275768d82b2eb9ce}{EIGEN\_ALWAYS\_INLINE}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{eigen_2Eigen_2src_2plugins_2IndexedViewMethods_8h_a745b5bbf26fefb72e16675ef6ccd9057}{operator()}}(}
\DoxyCodeLine{00634\ \ \ \ \ \ \ cl::sycl::nd\_item<1>\ itemID)\ \{}
\DoxyCodeLine{00635\ \ \ \ \ compute(itemID);}
\DoxyCodeLine{00636\ \ \ \}}
\DoxyCodeLine{00637\ \ \ \textcolor{keyword}{template}\ <\textcolor{keywordtype}{bool}\ is\_vec\ =\ Evaluator::PacketAccess>}
\DoxyCodeLine{00638\ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}\ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_a1fdc6f94f20527c7275768d82b2eb9ce}{EIGEN\_ALWAYS\_INLINE}}\ \textcolor{keyword}{typename}\ std::enable\_if<!is\_vec>::type}
\DoxyCodeLine{00639\ \ \ compute(\textcolor{keyword}{const}\ cl::sycl::nd\_item<1>\&\ itemID)\ \{}
\DoxyCodeLine{00640\ \ \ \ \ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ gId\ =\ \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\textcolor{keyword}{>}(itemID.get\_global\_linear\_id());}
\DoxyCodeLine{00641\ \ \ \ \ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ total\_threads\ =\ itemID.get\_global\_range(0);}
\DoxyCodeLine{00642\ }
\DoxyCodeLine{00643\ \ \ \ \ \textcolor{keywordflow}{for}\ (Index\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ gId;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ range;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +=\ total\_threads)\ \{}
\DoxyCodeLine{00644\ \ \ \ \ \ \ evaluator.evalScalar(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}});}
\DoxyCodeLine{00645\ \ \ \ \ \}}
\DoxyCodeLine{00646\ \ \ \}}
\DoxyCodeLine{00647\ \ \ \textcolor{keyword}{template}\ <\textcolor{keywordtype}{bool}\ is\_vec\ =\ Evaluator::PacketAccess>}
\DoxyCodeLine{00648\ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}\ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_a1fdc6f94f20527c7275768d82b2eb9ce}{EIGEN\_ALWAYS\_INLINE}}\ \textcolor{keyword}{typename}\ std::enable\_if<is\_vec>::type}
\DoxyCodeLine{00649\ \ \ compute(\textcolor{keyword}{const}\ cl::sycl::nd\_item<1>\&\ itemID)\ \{}
\DoxyCodeLine{00650\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ vectorizedRange\ =}
\DoxyCodeLine{00651\ \ \ \ \ \ \ \ \ (range\ /\ Evaluator::PacketSize)\ *\ Evaluator::PacketSize;}
\DoxyCodeLine{00652\ \ \ \ \ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ gId\ =\ \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\textcolor{keyword}{>}(itemID.get\_global\_linear\_id());}
\DoxyCodeLine{00653\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ \mbox{\hyperlink{namespaceabsl_1_1time__internal_1_1cctz_1_1detail_a0db0aec625a5f8f8f294104b08dd99fa}{step}}\ =\ Evaluator::PacketSize\ *\ itemID.get\_global\_range(0);}
\DoxyCodeLine{00654\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ start\ =\ Evaluator::PacketSize\ *\ gId;}
\DoxyCodeLine{00655\ \ \ \ \ \textcolor{keywordflow}{for}\ (Index\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ start;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ vectorizedRange;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +=\ \mbox{\hyperlink{namespaceabsl_1_1time__internal_1_1cctz_1_1detail_a0db0aec625a5f8f8f294104b08dd99fa}{step}})\ \{}
\DoxyCodeLine{00656\ \ \ \ \ \ \ evaluator.evalPacket(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}});}
\DoxyCodeLine{00657\ \ \ \ \ \}}
\DoxyCodeLine{00658\ \ \ \ \ gId\ +=\ vectorizedRange;}
\DoxyCodeLine{00659\ \ \ \ \ \textcolor{keywordflow}{for}\ (Index\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ gId;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ range;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +=\ itemID.get\_global\_range(0))\ \{}
\DoxyCodeLine{00660\ \ \ \ \ \ \ evaluator.evalScalar(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}});}
\DoxyCodeLine{00661\ \ \ \ \ \}}
\DoxyCodeLine{00662\ \ \ \}}
\DoxyCodeLine{00663\ \};}
\DoxyCodeLine{00664\ }
\DoxyCodeLine{00665\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Expression,\ \textcolor{keywordtype}{bool}\ Vectorizable,\ TiledEvaluation\ Tiling>}
\DoxyCodeLine{00666\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classTensorExecutor}{TensorExecutor}}<Expression,\ \mbox{\hyperlink{namespaceEigen}{Eigen}}::SyclDevice,\ Vectorizable,\ Tiling>\ \{}
\DoxyCodeLine{00667\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00668\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ Expression::Index\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}};}
\DoxyCodeLine{00669\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorExecutor_a50325b41f927e2c29141c7ac671efdec}{run}}(\textcolor{keyword}{const}\ Expression\&\ expr,}
\DoxyCodeLine{00670\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Eigen::SyclDevice\&\ dev)\ \{}
\DoxyCodeLine{00671\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator}{Eigen::TensorEvaluator<Expression,\ Eigen::SyclDevice>}}\ Evaluator;}
\DoxyCodeLine{00672\ \ \ \ \ Evaluator\ evaluator(expr,\ dev);}
\DoxyCodeLine{00673\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ needs\_assign\ =\ evaluator.evalSubExprsIfNeeded(NULL);}
\DoxyCodeLine{00674\ \ \ \ \ \textcolor{keywordflow}{if}\ (needs\_assign)\ \{}
\DoxyCodeLine{00675\ \ \ \ \ \ \ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ range,\ GRange,\ tileSize;}
\DoxyCodeLine{00676\ \ \ \ \ \ \ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ total\_size\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_a3b99e338d92a91c8b3f89d32d0ca2c39}{::Eigen::internal::array\_prod}}(evaluator.dimensions());}
\DoxyCodeLine{00677\ \ \ \ \ \ \ total\_size\ =\ (total\_size\ ==\ 0)\ ?\ 1\ :\ total\_size;}
\DoxyCodeLine{00678\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ PacketSize\ =}
\DoxyCodeLine{00679\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structEigen_1_1PacketType}{Eigen::PacketType}}<\textcolor{keyword}{typename}\ Evaluator::CoeffReturnType,}
\DoxyCodeLine{00680\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Eigen::SyclDevice>\mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2low__level__alloc_8cc_aad9b71a31372d5c0ab9c23163efe9544}{::size}};}
\DoxyCodeLine{00681\ \ \ \ \ \ \ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ vectorizable\_threads\ =\ \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\textcolor{keyword}{>}(total\_size\ /\ PacketSize);}
\DoxyCodeLine{00682\ \ \ \ \ \ \ dev.parallel\_for\_setup(vectorizable\_threads,\ tileSize,\ range,\ GRange);}
\DoxyCodeLine{00683\ \ \ \ \ \ \ range\ =\ total\_size;}
\DoxyCodeLine{00684\ }
\DoxyCodeLine{00685\ \ \ \ \ \ \ dev.template\ nullary\_kernel\_launcher<}
\DoxyCodeLine{00686\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typename}\ Evaluator::CoeffReturnType,}
\DoxyCodeLine{00687\ \ \ \ \ \ \ \ \ \ \ ExecExprFunctorKernel<Evaluator>\ >(}
\DoxyCodeLine{00688\ \ \ \ \ \ \ \ \ \ \ evaluator,}
\DoxyCodeLine{00689\ \ \ \ \ \ \ \ \ \ \ cl::sycl::nd\_range<1>(cl::sycl::range<1>(GRange),}
\DoxyCodeLine{00690\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cl::sycl::range<1>(tileSize)),}
\DoxyCodeLine{00691\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}(1),\ range);}
\DoxyCodeLine{00692\ \ \ \ \ \}}
\DoxyCodeLine{00693\ \ \ \ \ evaluator.cleanup();}
\DoxyCodeLine{00694\ \ \ \}}
\DoxyCodeLine{00695\ \};}
\DoxyCodeLine{00696\ }
\DoxyCodeLine{00697\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00698\ }
\DoxyCodeLine{00699\ \}\ \textcolor{comment}{//\ end\ namespace\ internal}}
\DoxyCodeLine{00700\ }
\DoxyCodeLine{00701\ \}\ \textcolor{comment}{//\ end\ namespace\ Eigen}}
\DoxyCodeLine{00702\ }
\DoxyCodeLine{00703\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ EIGEN\_CXX11\_TENSOR\_TENSOR\_EXECUTOR\_H}}

\end{DoxyCode}
