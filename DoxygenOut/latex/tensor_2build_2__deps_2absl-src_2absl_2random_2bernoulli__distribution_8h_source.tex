\doxysection{bernoulli\+\_\+distribution.\+h}
\hypertarget{tensor_2build_2__deps_2absl-src_2absl_2random_2bernoulli__distribution_8h_source}{}\label{tensor_2build_2__deps_2absl-src_2absl_2random_2bernoulli__distribution_8h_source}\index{tensor/build/\_deps/absl-\/src/absl/random/bernoulli\_distribution.h@{tensor/build/\_deps/absl-\/src/absl/random/bernoulli\_distribution.h}}
\mbox{\hyperlink{tensor_2build_2__deps_2absl-src_2absl_2random_2bernoulli__distribution_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Copyright\ 2017\ The\ Abseil\ Authors.}}
\DoxyCodeLine{00002\ \textcolor{comment}{//}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ Licensed\ under\ the\ Apache\ License,\ Version\ 2.0\ (the\ "{}License"{});}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ you\ may\ not\ use\ this\ file\ except\ in\ compliance\ with\ the\ License.}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ You\ may\ obtain\ a\ copy\ of\ the\ License\ at}}
\DoxyCodeLine{00006\ \textcolor{comment}{//}}
\DoxyCodeLine{00007\ \textcolor{comment}{//\ \ \ \ \ \ https://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{00008\ \textcolor{comment}{//}}
\DoxyCodeLine{00009\ \textcolor{comment}{//\ Unless\ required\ by\ applicable\ law\ or\ agreed\ to\ in\ writing,\ software}}
\DoxyCodeLine{00010\ \textcolor{comment}{//\ distributed\ under\ the\ License\ is\ distributed\ on\ an\ "{}AS\ IS"{}\ BASIS,}}
\DoxyCodeLine{00011\ \textcolor{comment}{//\ WITHOUT\ WARRANTIES\ OR\ CONDITIONS\ OF\ ANY\ KIND,\ either\ express\ or\ implied.}}
\DoxyCodeLine{00012\ \textcolor{comment}{//\ See\ the\ License\ for\ the\ specific\ language\ governing\ permissions\ and}}
\DoxyCodeLine{00013\ \textcolor{comment}{//\ limitations\ under\ the\ License.}}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#ifndef\ ABSL\_RANDOM\_BERNOULLI\_DISTRIBUTION\_H\_}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#define\ ABSL\_RANDOM\_BERNOULLI\_DISTRIBUTION\_H\_}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ <cassert>}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ <cstdint>}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ <istream>}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ <ostream>}}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ "{}absl/base/config.h"{}}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ "{}absl/base/optimization.h"{}}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ "{}absl/random/internal/fast\_uniform\_bits.h"{}}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#include\ "{}absl/random/internal/iostream\_state\_saver.h"{}}}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00028\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceabsl}{absl}}\ \{}
\DoxyCodeLine{00029\ \mbox{\hyperlink{abseil-cpp_2absl_2base_2config_8h_a1426209ed359f780778edc8975b23f07}{ABSL\_NAMESPACE\_BEGIN}}}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00031\ \textcolor{comment}{//\ absl::bernoulli\_distribution\ is\ a\ drop\ in\ replacement\ for}}
\DoxyCodeLine{00032\ \textcolor{comment}{//\ std::bernoulli\_distribution.\ It\ guarantees\ that\ (given\ a\ perfect}}
\DoxyCodeLine{00033\ \textcolor{comment}{//\ UniformRandomBitGenerator)\ the\ acceptance\ probability\ is\ *exactly*\ equal\ to}}
\DoxyCodeLine{00034\ \textcolor{comment}{//\ the\ given\ double.}}
\DoxyCodeLine{00035\ \textcolor{comment}{//}}
\DoxyCodeLine{00036\ \textcolor{comment}{//\ The\ implementation\ assumes\ that\ double\ is\ IEEE754}}
\DoxyCodeLine{00037\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classabsl_1_1bernoulli__distribution}{bernoulli\_distribution}}\ \{}
\DoxyCodeLine{00038\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00039\ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{classabsl_1_1bernoulli__distribution_ac7ef8c5f5b8465208216fe90e0c5008b}{result\_type}}\ =\ bool;}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ \ \ \textcolor{keyword}{class\ }\mbox{\hyperlink{classabsl_1_1bernoulli__distribution_1_1param__type}{param\_type}}\ \{}
\DoxyCodeLine{00042\ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00043\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{classabsl_1_1bernoulli__distribution}{distribution\_type}}\ =\ \mbox{\hyperlink{classabsl_1_1bernoulli__distribution_add509b1cebf65c5b9cdefad7752aa6de}{bernoulli\_distribution}};}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{classabsl_1_1bernoulli__distribution_1_1param__type_a8262391bb7213548d2b850ee550dee50}{param\_type}}(\textcolor{keywordtype}{double}\ \mbox{\hyperlink{classabsl_1_1bernoulli__distribution_1_1param__type_a31b2022ec488b01a0a94811a1c589245}{p}}\ =\ 0.5)\ :\ prob\_(\mbox{\hyperlink{classabsl_1_1bernoulli__distribution_1_1param__type_a31b2022ec488b01a0a94811a1c589245}{p}})\ \{}
\DoxyCodeLine{00046\ \ \ \ \ \ \ assert(\mbox{\hyperlink{classabsl_1_1bernoulli__distribution_1_1param__type_a31b2022ec488b01a0a94811a1c589245}{p}}\ >=\ 0.0\ \&\&\ \mbox{\hyperlink{classabsl_1_1bernoulli__distribution_1_1param__type_a31b2022ec488b01a0a94811a1c589245}{p}}\ <=\ 1.0);}
\DoxyCodeLine{00047\ \ \ \ \ \}}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00049\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{classabsl_1_1bernoulli__distribution_1_1param__type_a31b2022ec488b01a0a94811a1c589245}{p}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ prob\_;\ \}}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classabsl_1_1bernoulli__distribution_1_1param__type_a52b025bcd298841079fb39d533978443}{operator==}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classabsl_1_1bernoulli__distribution_1_1param__type}{param\_type}}\&\ p1,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classabsl_1_1bernoulli__distribution_1_1param__type}{param\_type}}\&\ p2)\ \{}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ p1.\mbox{\hyperlink{classabsl_1_1bernoulli__distribution_1_1param__type_a31b2022ec488b01a0a94811a1c589245}{p}}()\ ==\ p2.\mbox{\hyperlink{classabsl_1_1bernoulli__distribution_1_1param__type_a31b2022ec488b01a0a94811a1c589245}{p}}();}
\DoxyCodeLine{00053\ \ \ \ \ \}}
\DoxyCodeLine{00054\ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classabsl_1_1bernoulli__distribution_1_1param__type_ad962b6a31949034db887505f9c001a00}{operator!=}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classabsl_1_1bernoulli__distribution_1_1param__type}{param\_type}}\&\ p1,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classabsl_1_1bernoulli__distribution_1_1param__type}{param\_type}}\&\ p2)\ \{}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ p1.\mbox{\hyperlink{classabsl_1_1bernoulli__distribution_1_1param__type_a31b2022ec488b01a0a94811a1c589245}{p}}()\ !=\ p2.\mbox{\hyperlink{classabsl_1_1bernoulli__distribution_1_1param__type_a31b2022ec488b01a0a94811a1c589245}{p}}();}
\DoxyCodeLine{00056\ \ \ \ \ \}}
\DoxyCodeLine{00057\ }
\DoxyCodeLine{00058\ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00059\ \ \ \ \ \textcolor{keywordtype}{double}\ prob\_;}
\DoxyCodeLine{00060\ \ \ \};}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ \ \ \mbox{\hyperlink{classabsl_1_1bernoulli__distribution_add509b1cebf65c5b9cdefad7752aa6de}{bernoulli\_distribution}}()\ :\ \mbox{\hyperlink{classabsl_1_1bernoulli__distribution}{bernoulli\_distribution}}(0.5)\ \{\}}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00064\ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{classabsl_1_1bernoulli__distribution_a5fc9136ed628479da8c194b8901c94e2}{bernoulli\_distribution}}(\textcolor{keywordtype}{double}\ \mbox{\hyperlink{classabsl_1_1bernoulli__distribution_adf2eef045a0f158788831b776f9ad694}{p}})\ :\ param\_(\mbox{\hyperlink{classabsl_1_1bernoulli__distribution_adf2eef045a0f158788831b776f9ad694}{p}})\ \{\}}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00066\ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{classabsl_1_1bernoulli__distribution_af87468386c50f5887eed6f5d789ee526}{bernoulli\_distribution}}(\mbox{\hyperlink{classabsl_1_1bernoulli__distribution_1_1param__type}{param\_type}}\ \mbox{\hyperlink{classabsl_1_1bernoulli__distribution_adf2eef045a0f158788831b776f9ad694}{p}})\ :\ param\_(\mbox{\hyperlink{classabsl_1_1bernoulli__distribution_adf2eef045a0f158788831b776f9ad694}{p}})\ \{\}}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00068\ \ \ \textcolor{comment}{//\ no-\/op}}
\DoxyCodeLine{00069\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classabsl_1_1bernoulli__distribution_a2ab61e1795ae631e6a0d598b3b450a08}{reset}}()\ \{\}}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00071\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ URBG>}
\DoxyCodeLine{00072\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classabsl_1_1bernoulli__distribution_a8fb27770fd9847f2af150bbdfb698fff}{operator()}}(URBG\&\ \mbox{\hyperlink{namespaceabsl_a828e0f13fb3947cdf6406b7a4feec8acab2f5ff47436671b6e533d8dc3614845d}{g}})\ \{\ \ \textcolor{comment}{//\ NOLINT(runtime/references)}}
\DoxyCodeLine{00073\ \ \ \ \ \textcolor{keywordflow}{return}\ Generate(param\_.\mbox{\hyperlink{classabsl_1_1bernoulli__distribution_1_1param__type_a31b2022ec488b01a0a94811a1c589245}{p}}(),\ \mbox{\hyperlink{namespaceabsl_a828e0f13fb3947cdf6406b7a4feec8acab2f5ff47436671b6e533d8dc3614845d}{g}});}
\DoxyCodeLine{00074\ \ \ \}}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00076\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ URBG>}
\DoxyCodeLine{00077\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classabsl_1_1bernoulli__distribution_a8272460e9b98e3cc8755bb987dde33fe}{operator()}}(URBG\&\ \mbox{\hyperlink{namespaceabsl_a828e0f13fb3947cdf6406b7a4feec8acab2f5ff47436671b6e533d8dc3614845d}{g}},\ \ \textcolor{comment}{//\ NOLINT(runtime/references)}}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classabsl_1_1bernoulli__distribution_1_1param__type}{param\_type}}\&\ \mbox{\hyperlink{classabsl_1_1bernoulli__distribution_ab227843822f47a950d5cee18889110ad}{param}})\ \{}
\DoxyCodeLine{00079\ \ \ \ \ \textcolor{keywordflow}{return}\ Generate(\mbox{\hyperlink{classabsl_1_1bernoulli__distribution_ab227843822f47a950d5cee18889110ad}{param}}.\mbox{\hyperlink{classabsl_1_1bernoulli__distribution_1_1param__type_a31b2022ec488b01a0a94811a1c589245}{p}}(),\ \mbox{\hyperlink{namespaceabsl_a828e0f13fb3947cdf6406b7a4feec8acab2f5ff47436671b6e533d8dc3614845d}{g}});}
\DoxyCodeLine{00080\ \ \ \}}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00082\ \ \ \mbox{\hyperlink{classabsl_1_1bernoulli__distribution_1_1param__type}{param\_type}}\ \mbox{\hyperlink{classabsl_1_1bernoulli__distribution_ab227843822f47a950d5cee18889110ad}{param}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ param\_;\ \}}
\DoxyCodeLine{00083\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classabsl_1_1bernoulli__distribution_a43976fc37c9341083f4498ede9dbecb9}{param}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classabsl_1_1bernoulli__distribution_1_1param__type}{param\_type}}\&\ \mbox{\hyperlink{classabsl_1_1bernoulli__distribution_ab227843822f47a950d5cee18889110ad}{param}})\ \{\ param\_\ =\ \mbox{\hyperlink{classabsl_1_1bernoulli__distribution_a43976fc37c9341083f4498ede9dbecb9}{param}};\ \}}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00085\ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{classabsl_1_1bernoulli__distribution_adf2eef045a0f158788831b776f9ad694}{p}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ param\_.\mbox{\hyperlink{classabsl_1_1bernoulli__distribution_1_1param__type_a31b2022ec488b01a0a94811a1c589245}{p}}();\ \}}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ \ \ \mbox{\hyperlink{classabsl_1_1bernoulli__distribution_ac7ef8c5f5b8465208216fe90e0c5008b}{result\_type}}(\mbox{\hyperlink{classabsl_1_1bernoulli__distribution_a87cb342f0fe316ee6e3d1f0bf487805e}{min}})()\ \textcolor{keyword}{const}\ \{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};\ \}}
\DoxyCodeLine{00088\ \ \ \mbox{\hyperlink{classabsl_1_1bernoulli__distribution_ac7ef8c5f5b8465208216fe90e0c5008b}{result\_type}}(\mbox{\hyperlink{classabsl_1_1bernoulli__distribution_aee176a6a5c8474d0c6dee9951f58d54a}{max}})()\ \textcolor{keyword}{const}\ \{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};\ \}}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00090\ \ \ \textcolor{keyword}{friend}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classabsl_1_1bernoulli__distribution_ac78d5808e29daa3425d5ef8b32334dfa}{operator==}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classabsl_1_1bernoulli__distribution}{bernoulli\_distribution}}\&\ d1,}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classabsl_1_1bernoulli__distribution}{bernoulli\_distribution}}\&\ d2)\ \{}
\DoxyCodeLine{00092\ \ \ \ \ \textcolor{keywordflow}{return}\ d1.param\_\ ==\ d2.param\_;}
\DoxyCodeLine{00093\ \ \ \}}
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00095\ \ \ \textcolor{keyword}{friend}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classabsl_1_1bernoulli__distribution_ab5b98344870417c7ef515e03c08d9b61}{operator!=}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classabsl_1_1bernoulli__distribution}{bernoulli\_distribution}}\&\ d1,}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classabsl_1_1bernoulli__distribution}{bernoulli\_distribution}}\&\ d2)\ \{}
\DoxyCodeLine{00097\ \ \ \ \ \textcolor{keywordflow}{return}\ d1.param\_\ !=\ d2.param\_;}
\DoxyCodeLine{00098\ \ \ \}}
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00100\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00101\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ uint64\_t\ kP32\ =\ \textcolor{keyword}{static\_cast<}uint64\_t\textcolor{keyword}{>}(1)\ <<\ 32;}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00103\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ URBG>}
\DoxyCodeLine{00104\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ Generate(\textcolor{keywordtype}{double}\ \mbox{\hyperlink{classabsl_1_1bernoulli__distribution_adf2eef045a0f158788831b776f9ad694}{p}},\ URBG\&\ \mbox{\hyperlink{namespaceabsl_a828e0f13fb3947cdf6406b7a4feec8acab2f5ff47436671b6e533d8dc3614845d}{g}});\ \ \textcolor{comment}{//\ NOLINT(runtime/references)}}
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00106\ \ \ param\_type\ param\_;}
\DoxyCodeLine{00107\ \};}
\DoxyCodeLine{00108\ }
\DoxyCodeLine{00109\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ CharT,\ \textcolor{keyword}{typename}\ Traits>}
\DoxyCodeLine{00110\ std::basic\_ostream<CharT,\ Traits>\&\ \mbox{\hyperlink{namespaceabsl_a28a291a3fe339195acfaae93e38b9573}{operator<<}}(}
\DoxyCodeLine{00111\ \ \ \ \ std::basic\_ostream<CharT,\ Traits>\&\ os,\ \ \textcolor{comment}{//\ NOLINT(runtime/references)}}
\DoxyCodeLine{00112\ \ \ \ \ \textcolor{keyword}{const}\ bernoulli\_distribution\&\ \mbox{\hyperlink{namespaceabsl_a828e0f13fb3947cdf6406b7a4feec8aca9dd4e461268c8034f5c8564e155c67a6}{x}})\ \{}
\DoxyCodeLine{00113\ \ \ \textcolor{keyword}{auto}\ saver\ =\ \mbox{\hyperlink{namespaceabsl_1_1random__internal_a04da1d5318d386d8186b77635581772e}{random\_internal::make\_ostream\_state\_saver}}(os);}
\DoxyCodeLine{00114\ \ \ os.precision(\mbox{\hyperlink{structabsl_1_1random__internal_1_1stream__precision__helper_3_01double_01_4_ac766dc243d5fbe3dbd196b833387874e}{random\_internal::stream\_precision\_helper<double>::kPrecision}});}
\DoxyCodeLine{00115\ \ \ os\ <<\ \mbox{\hyperlink{namespaceabsl_a828e0f13fb3947cdf6406b7a4feec8aca9dd4e461268c8034f5c8564e155c67a6}{x}}.p();}
\DoxyCodeLine{00116\ \ \ \textcolor{keywordflow}{return}\ os;}
\DoxyCodeLine{00117\ \}}
\DoxyCodeLine{00118\ }
\DoxyCodeLine{00119\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ CharT,\ \textcolor{keyword}{typename}\ Traits>}
\DoxyCodeLine{00120\ std::basic\_istream<CharT,\ Traits>\&\ \mbox{\hyperlink{namespaceabsl_ad018445b58659d6c0839df223a2ac3a5}{operator>>}}(}
\DoxyCodeLine{00121\ \ \ \ \ std::basic\_istream<CharT,\ Traits>\&\ is,\ \ \textcolor{comment}{//\ NOLINT(runtime/references)}}
\DoxyCodeLine{00122\ \ \ \ \ bernoulli\_distribution\&\ \mbox{\hyperlink{namespaceabsl_a828e0f13fb3947cdf6406b7a4feec8aca9dd4e461268c8034f5c8564e155c67a6}{x}})\ \{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOLINT(runtime/references)}}
\DoxyCodeLine{00123\ \ \ \textcolor{keyword}{auto}\ saver\ =\ \mbox{\hyperlink{namespaceabsl_1_1random__internal_a8cbee2e68d48599a1d2fe727d31a4cc7}{random\_internal::make\_istream\_state\_saver}}(is);}
\DoxyCodeLine{00124\ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{namespaceabsl_a828e0f13fb3947cdf6406b7a4feec8aca83878c91171338902e0fe0fb97a8c47a}{p}}\ =\ \mbox{\hyperlink{namespaceabsl_1_1random__internal_a59f357f5be30c3730184c7336dc65bb2}{random\_internal::read\_floating\_point<double>}}(is);}
\DoxyCodeLine{00125\ \ \ \textcolor{keywordflow}{if}\ (!is.fail())\ \{}
\DoxyCodeLine{00126\ \ \ \ \ \mbox{\hyperlink{namespaceabsl_a828e0f13fb3947cdf6406b7a4feec8aca9dd4e461268c8034f5c8564e155c67a6}{x}}.param(bernoulli\_distribution::param\_type(\mbox{\hyperlink{namespaceabsl_a828e0f13fb3947cdf6406b7a4feec8aca83878c91171338902e0fe0fb97a8c47a}{p}}));}
\DoxyCodeLine{00127\ \ \ \}}
\DoxyCodeLine{00128\ \ \ \textcolor{keywordflow}{return}\ is;}
\DoxyCodeLine{00129\ \}}
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00131\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ URBG>}
\DoxyCodeLine{00132\ \textcolor{keywordtype}{bool}\ bernoulli\_distribution::Generate(\textcolor{keywordtype}{double}\ \mbox{\hyperlink{namespaceabsl_a828e0f13fb3947cdf6406b7a4feec8aca83878c91171338902e0fe0fb97a8c47a}{p}},}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ URBG\&\ \mbox{\hyperlink{namespaceabsl_a828e0f13fb3947cdf6406b7a4feec8acab2f5ff47436671b6e533d8dc3614845d}{g}})\ \{\ \ \textcolor{comment}{//\ NOLINT(runtime/references)}}
\DoxyCodeLine{00134\ \ \ random\_internal::FastUniformBits<uint32\_t>\ fast\_u32;}
\DoxyCodeLine{00135\ }
\DoxyCodeLine{00136\ \ \ \textcolor{keywordflow}{while}\ (\textcolor{keyword}{true})\ \{}
\DoxyCodeLine{00137\ \ \ \ \ \textcolor{comment}{//\ There\ are\ two\ aspects\ of\ the\ definition\ of\ \`{}c`\ below\ that\ are\ worth}}
\DoxyCodeLine{00138\ \ \ \ \ \textcolor{comment}{//\ commenting\ on.\ \ First,\ because\ \`{}p`\ is\ in\ the\ range\ [0,\ 1],\ \`{}c`\ is\ in\ the}}
\DoxyCodeLine{00139\ \ \ \ \ \textcolor{comment}{//\ range\ [0,\ 2\string^32]\ which\ does\ not\ fit\ in\ a\ uint32\_t\ and\ therefore\ requires}}
\DoxyCodeLine{00140\ \ \ \ \ \textcolor{comment}{//\ 64\ bits.}}
\DoxyCodeLine{00141\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00142\ \ \ \ \ \textcolor{comment}{//\ Second,\ \`{}c`\ is\ constructed\ by\ first\ casting\ explicitly\ to\ a\ signed}}
\DoxyCodeLine{00143\ \ \ \ \ \textcolor{comment}{//\ integer\ and\ then\ casting\ explicitly\ to\ an\ unsigned\ integer\ of\ the\ same}}
\DoxyCodeLine{00144\ \ \ \ \ \textcolor{comment}{//\ size.\ \ This\ is\ done\ because\ the\ hardware\ conversion\ instructions\ produce}}
\DoxyCodeLine{00145\ \ \ \ \ \textcolor{comment}{//\ signed\ integers\ from\ double;\ if\ taken\ as\ a\ uint64\_t\ the\ conversion\ would}}
\DoxyCodeLine{00146\ \ \ \ \ \textcolor{comment}{//\ be\ wrong\ for\ doubles\ greater\ than\ 2\string^63\ (not\ relevant\ in\ this\ use-\/case).}}
\DoxyCodeLine{00147\ \ \ \ \ \textcolor{comment}{//\ If\ converted\ directly\ to\ an\ unsigned\ integer,\ the\ compiler\ would\ end\ up}}
\DoxyCodeLine{00148\ \ \ \ \ \textcolor{comment}{//\ emitting\ code\ to\ handle\ such\ large\ values\ that\ are\ not\ relevant\ due\ to}}
\DoxyCodeLine{00149\ \ \ \ \ \textcolor{comment}{//\ the\ known\ bounds\ on\ \`{}c`.\ \ To\ avoid\ these\ extra\ instructions\ this}}
\DoxyCodeLine{00150\ \ \ \ \ \textcolor{comment}{//\ implementation\ converts\ first\ to\ the\ signed\ type\ and\ then\ convert\ to}}
\DoxyCodeLine{00151\ \ \ \ \ \textcolor{comment}{//\ unsigned\ (which\ is\ a\ no-\/op).}}
\DoxyCodeLine{00152\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_1_1numext_a0259c31cd34e096be5056e9d88ae0500}{uint64\_t}}\ \mbox{\hyperlink{namespaceabsl_a828e0f13fb3947cdf6406b7a4feec8aca4a8a08f09d37b73795649038408b5f33}{c}}\ =\ \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{namespaceEigen_1_1numext_a0259c31cd34e096be5056e9d88ae0500}{uint64\_t}}\textcolor{keyword}{>}(\textcolor{keyword}{static\_cast<}\mbox{\hyperlink{namespaceEigen_1_1numext_a518baced025fde474407c95f9a84d6e1}{int64\_t}}\textcolor{keyword}{>}(\mbox{\hyperlink{classabsl_1_1bernoulli__distribution_adf2eef045a0f158788831b776f9ad694}{p}}\ *\ kP32));}
\DoxyCodeLine{00153\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_1_1numext_a1fe47e4c63c51696c544a7f24f33b05c}{uint32\_t}}\ \mbox{\hyperlink{namespaceabsl_a828e0f13fb3947cdf6406b7a4feec8aca9e3669d19b675bd57058fd4664205d2a}{v}}\ =\ fast\_u32(\mbox{\hyperlink{namespaceabsl_a828e0f13fb3947cdf6406b7a4feec8acab2f5ff47436671b6e533d8dc3614845d}{g}});}
\DoxyCodeLine{00154\ \ \ \ \ \textcolor{comment}{//\ FAST\ PATH:\ this\ path\ fails\ with\ probability\ 1/2\string^32.\ \ Note\ that\ simply}}
\DoxyCodeLine{00155\ \ \ \ \ \textcolor{comment}{//\ returning\ v\ <=\ c\ would\ approximate\ P\ very\ well\ (up\ to\ an\ absolute\ error}}
\DoxyCodeLine{00156\ \ \ \ \ \textcolor{comment}{//\ of\ 1/2\string^32);\ the\ slow\ path\ (taken\ in\ that\ range\ of\ possible\ error,\ in\ the}}
\DoxyCodeLine{00157\ \ \ \ \ \textcolor{comment}{//\ case\ of\ equality)\ eliminates\ the\ remaining\ error.}}
\DoxyCodeLine{00158\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{abseil-cpp_2absl_2base_2optimization_8h_ae4445fb0c40ea7cc8e1c30647069d1a5}{ABSL\_PREDICT\_TRUE}}(\mbox{\hyperlink{namespaceabsl_a828e0f13fb3947cdf6406b7a4feec8aca9e3669d19b675bd57058fd4664205d2a}{v}}\ !=\ \mbox{\hyperlink{namespaceabsl_a828e0f13fb3947cdf6406b7a4feec8aca4a8a08f09d37b73795649038408b5f33}{c}}))\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespaceabsl_a828e0f13fb3947cdf6406b7a4feec8aca9e3669d19b675bd57058fd4664205d2a}{v}}\ <\ \mbox{\hyperlink{namespaceabsl_a828e0f13fb3947cdf6406b7a4feec8aca4a8a08f09d37b73795649038408b5f33}{c}};}
\DoxyCodeLine{00159\ }
\DoxyCodeLine{00160\ \ \ \ \ \textcolor{comment}{//\ It\ is\ guaranteed\ that\ \`{}q`\ is\ strictly\ less\ than\ 1,\ because\ if\ \`{}q`\ were}}
\DoxyCodeLine{00161\ \ \ \ \ \textcolor{comment}{//\ greater\ than\ or\ equal\ to\ 1,\ the\ same\ would\ be\ true\ for\ \`{}p`.\ Certainly\ \`{}p`}}
\DoxyCodeLine{00162\ \ \ \ \ \textcolor{comment}{//\ cannot\ be\ greater\ than\ 1,\ and\ if\ \`{}p\ ==\ 1`,\ then\ the\ fast\ path\ would}}
\DoxyCodeLine{00163\ \ \ \ \ \textcolor{comment}{//\ necessary\ have\ been\ taken\ already.}}
\DoxyCodeLine{00164\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{namespaceabsl_adb6bd4a9012b471ac01613aff8d4d81ba7694f4a66316e53c8cdd9d9954bd611d}{q}}\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(\mbox{\hyperlink{namespaceabsl_a828e0f13fb3947cdf6406b7a4feec8aca4a8a08f09d37b73795649038408b5f33}{c}})\ /\ kP32;}
\DoxyCodeLine{00165\ }
\DoxyCodeLine{00166\ \ \ \ \ \textcolor{comment}{//\ The\ probability\ of\ acceptance\ on\ the\ fast\ path\ is\ \`{}q`\ and\ so\ the}}
\DoxyCodeLine{00167\ \ \ \ \ \textcolor{comment}{//\ probability\ of\ acceptance\ here\ should\ be\ \`{}p\ -\/\ q`.}}
\DoxyCodeLine{00168\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00169\ \ \ \ \ \textcolor{comment}{//\ Note\ that\ \`{}q`\ is\ obtained\ from\ \`{}p`\ via\ some\ shifts\ and\ conversions,\ the}}
\DoxyCodeLine{00170\ \ \ \ \ \textcolor{comment}{//\ upshot\ of\ which\ is\ that\ \`{}q`\ is\ simply\ \`{}p`\ with\ some\ of\ the}}
\DoxyCodeLine{00171\ \ \ \ \ \textcolor{comment}{//\ least-\/significant\ bits\ of\ its\ mantissa\ set\ to\ zero.\ This\ means\ that\ the}}
\DoxyCodeLine{00172\ \ \ \ \ \textcolor{comment}{//\ difference\ \`{}p\ -\/\ q`\ will\ not\ have\ any\ rounding\ errors.\ To\ see\ why,\ pretend}}
\DoxyCodeLine{00173\ \ \ \ \ \textcolor{comment}{//\ that\ double\ has\ 10\ bits\ of\ resolution\ and\ q\ is\ obtained\ from\ \`{}p`\ in\ such}}
\DoxyCodeLine{00174\ \ \ \ \ \textcolor{comment}{//\ a\ way\ that\ the\ 4\ least-\/significant\ bits\ of\ its\ mantissa\ are\ set\ to\ zero.}}
\DoxyCodeLine{00175\ \ \ \ \ \textcolor{comment}{//\ For\ example:}}
\DoxyCodeLine{00176\ \ \ \ \ \textcolor{comment}{//\ \ \ p\ \ \ =\ 1.1100111011\ *\ 2\string^-\/1}}
\DoxyCodeLine{00177\ \ \ \ \ \textcolor{comment}{//\ \ \ q\ \ \ =\ 1.1100110000\ *\ 2\string^-\/1}}
\DoxyCodeLine{00178\ \ \ \ \ \textcolor{comment}{//\ p\ -\/\ q\ =\ 1.011\ \ \ \ \ \ \ \ *\ 2\string^-\/8}}
\DoxyCodeLine{00179\ \ \ \ \ \textcolor{comment}{//\ The\ difference\ \`{}p\ -\/\ q`\ has\ exactly\ the\ nonzero\ mantissa\ bits\ that\ were}}
\DoxyCodeLine{00180\ \ \ \ \ \textcolor{comment}{//\ "{}lost"{}\ in\ \`{}q`\ producing\ a\ number\ which\ is\ certainly\ representable\ in\ a}}
\DoxyCodeLine{00181\ \ \ \ \ \textcolor{comment}{//\ double.}}
\DoxyCodeLine{00182\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ left\ =\ \mbox{\hyperlink{classabsl_1_1bernoulli__distribution_adf2eef045a0f158788831b776f9ad694}{p}}\ -\/\ \mbox{\hyperlink{namespaceabsl_adb6bd4a9012b471ac01613aff8d4d81ba7694f4a66316e53c8cdd9d9954bd611d}{q}};}
\DoxyCodeLine{00183\ }
\DoxyCodeLine{00184\ \ \ \ \ \textcolor{comment}{//\ By\ construction,\ the\ probability\ of\ being\ on\ this\ slow\ path\ is\ 1/2\string^32,\ so}}
\DoxyCodeLine{00185\ \ \ \ \ \textcolor{comment}{//\ P(accept\ in\ slow\ path)\ =\ P(accept|\ in\ slow\ path)\ *\ P(slow\ path),}}
\DoxyCodeLine{00186\ \ \ \ \ \textcolor{comment}{//\ which\ means\ the\ probability\ of\ acceptance\ here\ is\ \`{}1\ /\ (left\ *\ kP32)`:}}
\DoxyCodeLine{00187\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ here\ =\ left\ *\ kP32;}
\DoxyCodeLine{00188\ }
\DoxyCodeLine{00189\ \ \ \ \ \textcolor{comment}{//\ The\ simplest\ way\ to\ compute\ the\ result\ of\ this\ trial\ is\ to\ repeat\ the}}
\DoxyCodeLine{00190\ \ \ \ \ \textcolor{comment}{//\ whole\ algorithm\ with\ the\ new\ probability.\ This\ terminates\ because\ even}}
\DoxyCodeLine{00191\ \ \ \ \ \textcolor{comment}{//\ given\ \ arbitrarily\ unfriendly\ "{}random"{}\ bits,\ each\ iteration\ either}}
\DoxyCodeLine{00192\ \ \ \ \ \textcolor{comment}{//\ multiplies\ a\ tiny\ probability\ by\ 2\string^32\ (if\ c\ ==\ 0)\ or\ strips\ off\ some}}
\DoxyCodeLine{00193\ \ \ \ \ \textcolor{comment}{//\ number\ of\ nonzero\ mantissa\ bits.\ That\ process\ is\ bounded.}}
\DoxyCodeLine{00194\ \ \ \ \ \textcolor{keywordflow}{if}\ (here\ ==\ 0)\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00195\ \ \ \ \ \mbox{\hyperlink{classabsl_1_1bernoulli__distribution_adf2eef045a0f158788831b776f9ad694}{p}}\ =\ here;}
\DoxyCodeLine{00196\ \ \ \}}
\DoxyCodeLine{00197\ \}}
\DoxyCodeLine{00198\ }
\DoxyCodeLine{00199\ \mbox{\hyperlink{abseil-cpp_2absl_2base_2config_8h_a49c6cd9be2b7205d48557c9fa90ec5a6}{ABSL\_NAMESPACE\_END}}}
\DoxyCodeLine{00200\ \}\ \ \textcolor{comment}{//\ namespace\ absl}}
\DoxyCodeLine{00201\ }
\DoxyCodeLine{00202\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ ABSL\_RANDOM\_BERNOULLI\_DISTRIBUTION\_H\_}}

\end{DoxyCode}
