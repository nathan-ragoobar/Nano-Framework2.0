\doxysection{fineweb Namespace Reference}
\hypertarget{namespacefineweb}{}\label{namespacefineweb}\index{fineweb@{fineweb}}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacefineweb_a85be9ecb0eff4df96b7a76d5f0053146}{tokenize}} (doc)
\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacefineweb_ab39e490ac444bdeab944a509d067d6a0}{parser}} = argparse.\+Argument\+Parser(description="{}Fine\+Web and Edu-\/Fine\+Web dataset preprocessing"{})
\item 
\mbox{\hyperlink{namespacefineweb_a8695301745cad3a63cfe73f8f67ebf3d}{type}}
\item 
\mbox{\hyperlink{namespacefineweb_a641a62d871754cc0f0114a0f593a4067}{str}}
\item 
\mbox{\hyperlink{namespacefineweb_a02b851e8170cb51371f2d4eea163f52f}{default}}
\item 
\mbox{\hyperlink{namespacefineweb_a47d0b73d52216d9b6a3ac0aafdb85e52}{help}}
\item 
\mbox{\hyperlink{namespacefineweb_a7ab32de24971f7d1f91cd2edca351e06}{int}}
\item 
\mbox{\hyperlink{namespacefineweb_a183a236775a42ffdbd795bc1ab4e3fb0}{args}} = parser.\+parse\+\_\+args()
\item 
dict \mbox{\hyperlink{namespacefineweb_aec1e7478fdf6230fb8c292a42024c023}{directories}}
\item 
\mbox{\hyperlink{namespacefineweb_a2bc1c869bf94cc6002e259c6998ebe8a}{local\+\_\+dir}}
\item 
\mbox{\hyperlink{namespacefineweb_a96a50f5affd5404c61f0daa5ad598ff1}{remote\+\_\+name}}
\item 
\mbox{\hyperlink{namespacefineweb_ad5c96bdb4271460be294e7b808ac29a3}{DATA\+\_\+\+CACHE\+\_\+\+DIR}} = os.\+path.\+join(os.\+path.\+dirname(\+\_\+\+\_\+file\+\_\+\+\_\+), \mbox{\hyperlink{namespacefineweb_a2bc1c869bf94cc6002e259c6998ebe8a}{local\+\_\+dir}})
\item 
\mbox{\hyperlink{namespacefineweb_ad83e0ff4d80c2479bc19763626d18e25}{exist\+\_\+ok}}
\item 
\mbox{\hyperlink{namespacefineweb_a61b88d5d615c1bd53b2e48f0f11c648d}{fw}} = load\+\_\+dataset("{}Hugging\+Face\+FW/fineweb"{}, \mbox{\hyperlink{namespacefineweb_aa9045f811c2524713d25e6a5b4df5a4f}{name}}=\mbox{\hyperlink{namespacefineweb_a96a50f5affd5404c61f0daa5ad598ff1}{remote\+\_\+name}}, \mbox{\hyperlink{namespacefineweb_aacd9391d453a7bf8d2679fcd8f93c215}{split}}="{}train"{})
\item 
\mbox{\hyperlink{namespacefineweb_a641a62d871754cc0f0114a0f593a4067}{str}} \mbox{\hyperlink{namespacefineweb_aa9045f811c2524713d25e6a5b4df5a4f}{name}} = "{}fineweb"{}
\item 
\mbox{\hyperlink{namespacefineweb_a1448adb389381ea84a83a27eedbd9c2a}{enc}} = tiktoken.\+get\+\_\+encoding("{}gpt2"{})
\item 
\mbox{\hyperlink{namespacefineweb_a6cb2abe44b2bce317a4fbd674bba5bb7}{eot}} = enc.\+\_\+special\+\_\+tokens\mbox{[}\textquotesingle{}$<$\texorpdfstring{$\vert$}{|}endoftext\texorpdfstring{$\vert$}{|}$>$\textquotesingle{}\mbox{]}
\item 
\mbox{\hyperlink{namespacefineweb_a5d586f097e8ee4045495146bfe1cb525}{nprocs}} = max(1, os.\+cpu\+\_\+count() -\/ 2)
\item 
\mbox{\hyperlink{namespacefineweb_a7ab32de24971f7d1f91cd2edca351e06}{int}} \mbox{\hyperlink{namespacefineweb_acd467118201c5209eaa7f82fd9e5c8d5}{shard\+\_\+index}} = 0
\item 
\mbox{\hyperlink{namespacefineweb_a1ab4a3e075ad3255427fe33007551d75}{all\+\_\+tokens\+\_\+np}} = np.\+empty((args.\+shard\+\_\+size,), dtype=np.\+uint16)
\item 
\mbox{\hyperlink{namespacefineweb_a7ab32de24971f7d1f91cd2edca351e06}{int}} \mbox{\hyperlink{namespacefineweb_a4e0e087c4b9fa0ad4983175a5d0d9352}{token\+\_\+count}} = 0
\item 
\mbox{\hyperlink{namespacefineweb_a8ff4280fb2bccda6965950132119ba7c}{progress\+\_\+bar}} = None
\item 
\mbox{\hyperlink{namespacefineweb_a1eacbbe2efbefcdc23f69684a139a52a}{tokenize}}
\item 
\mbox{\hyperlink{namespacefineweb_a54abfa7e0e4b514c17ca8a54d54251cf}{chunksize}}
\item 
\mbox{\hyperlink{namespacefineweb_a641a62d871754cc0f0114a0f593a4067}{str}} \mbox{\hyperlink{namespacefineweb_aacd9391d453a7bf8d2679fcd8f93c215}{split}} = 0 else "{}train"{}
\item 
\mbox{\hyperlink{namespacefineweb_a576a4806d0d72795f91ebdec45b58a8e}{filename}} = os.\+path.\+join(\mbox{\hyperlink{namespacefineweb_ad5c96bdb4271460be294e7b808ac29a3}{DATA\+\_\+\+CACHE\+\_\+\+DIR}}, f"{}\{\mbox{\hyperlink{namespacefineweb_aa9045f811c2524713d25e6a5b4df5a4f}{name}}\}\+\_\+\{\mbox{\hyperlink{namespacefineweb_aacd9391d453a7bf8d2679fcd8f93c215}{split}}\}\+\_\+\{shard\+\_\+index\+:06d\}.bin"{})
\item 
\mbox{\hyperlink{namespacefineweb_a7ab32de24971f7d1f91cd2edca351e06}{int}} \mbox{\hyperlink{namespacefineweb_a49045498be7d6ea0e9cfe0fcbca83e17}{remainder}} = args.\+shard\+\_\+size -\/ \mbox{\hyperlink{namespacefineweb_a4e0e087c4b9fa0ad4983175a5d0d9352}{token\+\_\+count}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\begin{DoxyVerb}FineWeb dataset (for srs pretraining)
https://huggingface.co/datasets/HuggingFaceFW/fineweb

example doc to highlight the structure of the dataset:
{
  "text": "Posted by mattsmith on 20th April 2012\nStraight from...",
  "id": "<urn:uuid:d853d453-196e-4488-a411-efc2b26c40d2>",
  "dump": "CC-MAIN-2013-20",
  "url": "http://nleastchatter.com/philliesphandom/tag/freddy-galvis/",
  "date": "2013-05-18T07:24:47Z",
  "file_path": "s3://commoncrawl/long.../path.../file.gz",
  "language": "en",
  "language_score": 0.9185474514961243,
  "token_count": 594
}

Example of downloading the 100B dataset of FineWebEDU, from root directory:
python dev/data/fineweb.py -t edu -v 100B
100B runs for small few hours, depending on your internet and computer.
\end{DoxyVerb}
 

\doxysubsection{Function Documentation}
\Hypertarget{namespacefineweb_a85be9ecb0eff4df96b7a76d5f0053146}\index{fineweb@{fineweb}!tokenize@{tokenize}}
\index{tokenize@{tokenize}!fineweb@{fineweb}}
\doxysubsubsection{\texorpdfstring{tokenize()}{tokenize()}}
{\footnotesize\ttfamily \label{namespacefineweb_a85be9ecb0eff4df96b7a76d5f0053146} 
fineweb.\+tokenize (\begin{DoxyParamCaption}\item[{}]{doc}{}\end{DoxyParamCaption})}



\doxysubsection{Variable Documentation}
\Hypertarget{namespacefineweb_a1ab4a3e075ad3255427fe33007551d75}\index{fineweb@{fineweb}!all\_tokens\_np@{all\_tokens\_np}}
\index{all\_tokens\_np@{all\_tokens\_np}!fineweb@{fineweb}}
\doxysubsubsection{\texorpdfstring{all\_tokens\_np}{all\_tokens\_np}}
{\footnotesize\ttfamily \label{namespacefineweb_a1ab4a3e075ad3255427fe33007551d75} 
fineweb.\+all\+\_\+tokens\+\_\+np = np.\+empty((args.\+shard\+\_\+size,), dtype=np.\+uint16)}

\Hypertarget{namespacefineweb_a183a236775a42ffdbd795bc1ab4e3fb0}\index{fineweb@{fineweb}!args@{args}}
\index{args@{args}!fineweb@{fineweb}}
\doxysubsubsection{\texorpdfstring{args}{args}}
{\footnotesize\ttfamily \label{namespacefineweb_a183a236775a42ffdbd795bc1ab4e3fb0} 
fineweb.\+args = parser.\+parse\+\_\+args()}

\Hypertarget{namespacefineweb_a54abfa7e0e4b514c17ca8a54d54251cf}\index{fineweb@{fineweb}!chunksize@{chunksize}}
\index{chunksize@{chunksize}!fineweb@{fineweb}}
\doxysubsubsection{\texorpdfstring{chunksize}{chunksize}}
{\footnotesize\ttfamily \label{namespacefineweb_a54abfa7e0e4b514c17ca8a54d54251cf} 
fineweb.\+chunksize}

\Hypertarget{namespacefineweb_ad5c96bdb4271460be294e7b808ac29a3}\index{fineweb@{fineweb}!DATA\_CACHE\_DIR@{DATA\_CACHE\_DIR}}
\index{DATA\_CACHE\_DIR@{DATA\_CACHE\_DIR}!fineweb@{fineweb}}
\doxysubsubsection{\texorpdfstring{DATA\_CACHE\_DIR}{DATA\_CACHE\_DIR}}
{\footnotesize\ttfamily \label{namespacefineweb_ad5c96bdb4271460be294e7b808ac29a3} 
fineweb.\+DATA\+\_\+\+CACHE\+\_\+\+DIR = os.\+path.\+join(os.\+path.\+dirname(\+\_\+\+\_\+file\+\_\+\+\_\+), \mbox{\hyperlink{namespacefineweb_a2bc1c869bf94cc6002e259c6998ebe8a}{local\+\_\+dir}})}

\Hypertarget{namespacefineweb_a02b851e8170cb51371f2d4eea163f52f}\index{fineweb@{fineweb}!default@{default}}
\index{default@{default}!fineweb@{fineweb}}
\doxysubsubsection{\texorpdfstring{default}{default}}
{\footnotesize\ttfamily \label{namespacefineweb_a02b851e8170cb51371f2d4eea163f52f} 
fineweb.\+default}

\Hypertarget{namespacefineweb_aec1e7478fdf6230fb8c292a42024c023}\index{fineweb@{fineweb}!directories@{directories}}
\index{directories@{directories}!fineweb@{fineweb}}
\doxysubsubsection{\texorpdfstring{directories}{directories}}
{\footnotesize\ttfamily \label{namespacefineweb_aec1e7478fdf6230fb8c292a42024c023} 
dict fineweb.\+directories}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ =\ \ \{}
\DoxyCodeLine{00002\ \ \ \ \ (\textcolor{stringliteral}{"{}classic"{}},\ \textcolor{stringliteral}{"{}10B"{}}):\ (\textcolor{stringliteral}{"{}fineweb10B"{}},\ \textcolor{stringliteral}{"{}sample-\/10BT"{}}),}
\DoxyCodeLine{00003\ \ \ \ \ (\textcolor{stringliteral}{"{}classic"{}},\ \textcolor{stringliteral}{"{}100B"{}}):\ (\textcolor{stringliteral}{"{}fineweb100B"{}},\ \textcolor{stringliteral}{"{}sample-\/100BT"{}}),}
\DoxyCodeLine{00004\ \ \ \ \ (\textcolor{stringliteral}{"{}edu"{}},\ \textcolor{stringliteral}{"{}10B"{}}):\ (\textcolor{stringliteral}{"{}edu\_fineweb10B"{}},\ \textcolor{stringliteral}{"{}sample-\/10BT"{}}),}
\DoxyCodeLine{00005\ \ \ \ \ (\textcolor{stringliteral}{"{}edu"{}},\ \textcolor{stringliteral}{"{}100B"{}}):\ (\textcolor{stringliteral}{"{}edu\_fineweb100B"{}},\ \textcolor{stringliteral}{"{}sample-\/100BT"{}})}
\DoxyCodeLine{00006\ \}}

\end{DoxyCode}
\Hypertarget{namespacefineweb_a1448adb389381ea84a83a27eedbd9c2a}\index{fineweb@{fineweb}!enc@{enc}}
\index{enc@{enc}!fineweb@{fineweb}}
\doxysubsubsection{\texorpdfstring{enc}{enc}}
{\footnotesize\ttfamily \label{namespacefineweb_a1448adb389381ea84a83a27eedbd9c2a} 
fineweb.\+enc = tiktoken.\+get\+\_\+encoding("{}gpt2"{})}

\Hypertarget{namespacefineweb_a6cb2abe44b2bce317a4fbd674bba5bb7}\index{fineweb@{fineweb}!eot@{eot}}
\index{eot@{eot}!fineweb@{fineweb}}
\doxysubsubsection{\texorpdfstring{eot}{eot}}
{\footnotesize\ttfamily \label{namespacefineweb_a6cb2abe44b2bce317a4fbd674bba5bb7} 
fineweb.\+eot = enc.\+\_\+special\+\_\+tokens\mbox{[}\textquotesingle{}$<$\texorpdfstring{$\vert$}{|}endoftext\texorpdfstring{$\vert$}{|}$>$\textquotesingle{}\mbox{]}}

\Hypertarget{namespacefineweb_ad83e0ff4d80c2479bc19763626d18e25}\index{fineweb@{fineweb}!exist\_ok@{exist\_ok}}
\index{exist\_ok@{exist\_ok}!fineweb@{fineweb}}
\doxysubsubsection{\texorpdfstring{exist\_ok}{exist\_ok}}
{\footnotesize\ttfamily \label{namespacefineweb_ad83e0ff4d80c2479bc19763626d18e25} 
fineweb.\+exist\+\_\+ok}

\Hypertarget{namespacefineweb_a576a4806d0d72795f91ebdec45b58a8e}\index{fineweb@{fineweb}!filename@{filename}}
\index{filename@{filename}!fineweb@{fineweb}}
\doxysubsubsection{\texorpdfstring{filename}{filename}}
{\footnotesize\ttfamily \label{namespacefineweb_a576a4806d0d72795f91ebdec45b58a8e} 
fineweb.\+filename = os.\+path.\+join(\mbox{\hyperlink{namespacefineweb_ad5c96bdb4271460be294e7b808ac29a3}{DATA\+\_\+\+CACHE\+\_\+\+DIR}}, f"{}\{\mbox{\hyperlink{namespacefineweb_aa9045f811c2524713d25e6a5b4df5a4f}{name}}\}\+\_\+\{\mbox{\hyperlink{namespacefineweb_aacd9391d453a7bf8d2679fcd8f93c215}{split}}\}\+\_\+\{shard\+\_\+index\+:06d\}.bin"{})}

\Hypertarget{namespacefineweb_a61b88d5d615c1bd53b2e48f0f11c648d}\index{fineweb@{fineweb}!fw@{fw}}
\index{fw@{fw}!fineweb@{fineweb}}
\doxysubsubsection{\texorpdfstring{fw}{fw}}
{\footnotesize\ttfamily \label{namespacefineweb_a61b88d5d615c1bd53b2e48f0f11c648d} 
fineweb.\+fw = load\+\_\+dataset("{}Hugging\+Face\+FW/fineweb"{}, \mbox{\hyperlink{namespacefineweb_aa9045f811c2524713d25e6a5b4df5a4f}{name}}=\mbox{\hyperlink{namespacefineweb_a96a50f5affd5404c61f0daa5ad598ff1}{remote\+\_\+name}}, \mbox{\hyperlink{namespacefineweb_aacd9391d453a7bf8d2679fcd8f93c215}{split}}="{}train"{})}

\Hypertarget{namespacefineweb_a47d0b73d52216d9b6a3ac0aafdb85e52}\index{fineweb@{fineweb}!help@{help}}
\index{help@{help}!fineweb@{fineweb}}
\doxysubsubsection{\texorpdfstring{help}{help}}
{\footnotesize\ttfamily \label{namespacefineweb_a47d0b73d52216d9b6a3ac0aafdb85e52} 
fineweb.\+help}

\Hypertarget{namespacefineweb_a7ab32de24971f7d1f91cd2edca351e06}\index{fineweb@{fineweb}!int@{int}}
\index{int@{int}!fineweb@{fineweb}}
\doxysubsubsection{\texorpdfstring{int}{int}}
{\footnotesize\ttfamily \label{namespacefineweb_a7ab32de24971f7d1f91cd2edca351e06} 
fineweb.\+int}

\Hypertarget{namespacefineweb_a2bc1c869bf94cc6002e259c6998ebe8a}\index{fineweb@{fineweb}!local\_dir@{local\_dir}}
\index{local\_dir@{local\_dir}!fineweb@{fineweb}}
\doxysubsubsection{\texorpdfstring{local\_dir}{local\_dir}}
{\footnotesize\ttfamily \label{namespacefineweb_a2bc1c869bf94cc6002e259c6998ebe8a} 
fineweb.\+local\+\_\+dir}

\Hypertarget{namespacefineweb_aa9045f811c2524713d25e6a5b4df5a4f}\index{fineweb@{fineweb}!name@{name}}
\index{name@{name}!fineweb@{fineweb}}
\doxysubsubsection{\texorpdfstring{name}{name}}
{\footnotesize\ttfamily \label{namespacefineweb_aa9045f811c2524713d25e6a5b4df5a4f} 
\mbox{\hyperlink{namespacefineweb_a641a62d871754cc0f0114a0f593a4067}{str}} fineweb.\+name = "{}fineweb"{}}

\Hypertarget{namespacefineweb_a5d586f097e8ee4045495146bfe1cb525}\index{fineweb@{fineweb}!nprocs@{nprocs}}
\index{nprocs@{nprocs}!fineweb@{fineweb}}
\doxysubsubsection{\texorpdfstring{nprocs}{nprocs}}
{\footnotesize\ttfamily \label{namespacefineweb_a5d586f097e8ee4045495146bfe1cb525} 
fineweb.\+nprocs = max(1, os.\+cpu\+\_\+count() -\/ 2)}

\Hypertarget{namespacefineweb_ab39e490ac444bdeab944a509d067d6a0}\index{fineweb@{fineweb}!parser@{parser}}
\index{parser@{parser}!fineweb@{fineweb}}
\doxysubsubsection{\texorpdfstring{parser}{parser}}
{\footnotesize\ttfamily \label{namespacefineweb_ab39e490ac444bdeab944a509d067d6a0} 
fineweb.\+parser = argparse.\+Argument\+Parser(description="{}Fine\+Web and Edu-\/Fine\+Web dataset preprocessing"{})}

\Hypertarget{namespacefineweb_a8ff4280fb2bccda6965950132119ba7c}\index{fineweb@{fineweb}!progress\_bar@{progress\_bar}}
\index{progress\_bar@{progress\_bar}!fineweb@{fineweb}}
\doxysubsubsection{\texorpdfstring{progress\_bar}{progress\_bar}}
{\footnotesize\ttfamily \label{namespacefineweb_a8ff4280fb2bccda6965950132119ba7c} 
fineweb.\+progress\+\_\+bar = None}

\Hypertarget{namespacefineweb_a49045498be7d6ea0e9cfe0fcbca83e17}\index{fineweb@{fineweb}!remainder@{remainder}}
\index{remainder@{remainder}!fineweb@{fineweb}}
\doxysubsubsection{\texorpdfstring{remainder}{remainder}}
{\footnotesize\ttfamily \label{namespacefineweb_a49045498be7d6ea0e9cfe0fcbca83e17} 
\mbox{\hyperlink{namespacefineweb_a7ab32de24971f7d1f91cd2edca351e06}{int}} fineweb.\+remainder = args.\+shard\+\_\+size -\/ \mbox{\hyperlink{namespacefineweb_a4e0e087c4b9fa0ad4983175a5d0d9352}{token\+\_\+count}}}

\Hypertarget{namespacefineweb_a96a50f5affd5404c61f0daa5ad598ff1}\index{fineweb@{fineweb}!remote\_name@{remote\_name}}
\index{remote\_name@{remote\_name}!fineweb@{fineweb}}
\doxysubsubsection{\texorpdfstring{remote\_name}{remote\_name}}
{\footnotesize\ttfamily \label{namespacefineweb_a96a50f5affd5404c61f0daa5ad598ff1} 
fineweb.\+remote\+\_\+name}

\Hypertarget{namespacefineweb_acd467118201c5209eaa7f82fd9e5c8d5}\index{fineweb@{fineweb}!shard\_index@{shard\_index}}
\index{shard\_index@{shard\_index}!fineweb@{fineweb}}
\doxysubsubsection{\texorpdfstring{shard\_index}{shard\_index}}
{\footnotesize\ttfamily \label{namespacefineweb_acd467118201c5209eaa7f82fd9e5c8d5} 
\mbox{\hyperlink{namespacefineweb_a7ab32de24971f7d1f91cd2edca351e06}{int}} fineweb.\+shard\+\_\+index = 0}

\Hypertarget{namespacefineweb_aacd9391d453a7bf8d2679fcd8f93c215}\index{fineweb@{fineweb}!split@{split}}
\index{split@{split}!fineweb@{fineweb}}
\doxysubsubsection{\texorpdfstring{split}{split}}
{\footnotesize\ttfamily \label{namespacefineweb_aacd9391d453a7bf8d2679fcd8f93c215} 
\mbox{\hyperlink{namespacefineweb_a641a62d871754cc0f0114a0f593a4067}{str}} fineweb.\+split = 0 else "{}train"{}}

\Hypertarget{namespacefineweb_a641a62d871754cc0f0114a0f593a4067}\index{fineweb@{fineweb}!str@{str}}
\index{str@{str}!fineweb@{fineweb}}
\doxysubsubsection{\texorpdfstring{str}{str}}
{\footnotesize\ttfamily \label{namespacefineweb_a641a62d871754cc0f0114a0f593a4067} 
fineweb.\+str}

\Hypertarget{namespacefineweb_a4e0e087c4b9fa0ad4983175a5d0d9352}\index{fineweb@{fineweb}!token\_count@{token\_count}}
\index{token\_count@{token\_count}!fineweb@{fineweb}}
\doxysubsubsection{\texorpdfstring{token\_count}{token\_count}}
{\footnotesize\ttfamily \label{namespacefineweb_a4e0e087c4b9fa0ad4983175a5d0d9352} 
\mbox{\hyperlink{namespacefineweb_a7ab32de24971f7d1f91cd2edca351e06}{int}} fineweb.\+token\+\_\+count = 0}

\Hypertarget{namespacefineweb_a1eacbbe2efbefcdc23f69684a139a52a}\index{fineweb@{fineweb}!tokenize@{tokenize}}
\index{tokenize@{tokenize}!fineweb@{fineweb}}
\doxysubsubsection{\texorpdfstring{tokenize}{tokenize}}
{\footnotesize\ttfamily \label{namespacefineweb_a1eacbbe2efbefcdc23f69684a139a52a} 
fineweb.\+tokenize}

\Hypertarget{namespacefineweb_a8695301745cad3a63cfe73f8f67ebf3d}\index{fineweb@{fineweb}!type@{type}}
\index{type@{type}!fineweb@{fineweb}}
\doxysubsubsection{\texorpdfstring{type}{type}}
{\footnotesize\ttfamily \label{namespacefineweb_a8695301745cad3a63cfe73f8f67ebf3d} 
fineweb.\+type}

