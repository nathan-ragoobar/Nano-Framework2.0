\doxysection{hellaswag Namespace Reference}
\hypertarget{namespacehellaswag}{}\label{namespacehellaswag}\index{hellaswag@{hellaswag}}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacehellaswag_ae7aa4ae607495413610cf95ebb780af4}{download}} (split)
\item 
\mbox{\hyperlink{namespacehellaswag_a0bbecf7e93a680f05ba02ad38c028b90}{render\+\_\+example}} (example)
\item 
\mbox{\hyperlink{namespacehellaswag_a7e4c735deaa2a62dc039c27bae0c308a}{iterate\+\_\+examples}} (split)
\item 
\mbox{\hyperlink{namespacehellaswag_a90c8bf725534d7e6b85b2bbe9a367e98}{evaluate}} (model\+\_\+type, device)
\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacehellaswag_a3c473d5d19911b34e604a6301c10469b}{DATA\+\_\+\+CACHE\+\_\+\+DIR}} = os.\+path.\+join(os.\+path.\+dirname(\+\_\+\+\_\+file\+\_\+\+\_\+), "{}hellaswag"{})
\item 
dict \mbox{\hyperlink{namespacehellaswag_ab9661ab26493651f8ba90bece12dbef8}{hellaswags}}
\item 
\mbox{\hyperlink{namespacehellaswag_a5086bc93df9ea71189bfe9857509f320}{enc}} = tiktoken.\+get\+\_\+encoding("{}gpt2"{})
\item 
\mbox{\hyperlink{namespacehellaswag_aac09ebe031df4be9c9af4b76492ed478}{parser}} = argparse.\+Argument\+Parser()
\item 
\mbox{\hyperlink{namespacehellaswag_a9801be94dfbd6c9bfa4470f87bbdd956}{type}}
\item 
\mbox{\hyperlink{namespacehellaswag_a1c70bc8be9b2caddfa7b196fef5827da}{str}}
\item 
\mbox{\hyperlink{namespacehellaswag_a0df0ca12a3f527bfeb4060f36682ee89}{default}}
\item 
\mbox{\hyperlink{namespacehellaswag_a664d4e5d58531d7120737b76fec2a6e0}{help}}
\item 
\mbox{\hyperlink{namespacehellaswag_a3c973c8cc7202d9f4b3883d67541bd43}{args}} = parser.\+parse\+\_\+args()
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\begin{DoxyVerb}Downloads and evaluates HellaSwag in Python.
This then acts as the reference file for llm.c
Also writes the data (tokens, labels) to .bin files for parallel evaluation in C.
https://github.com/rowanz/hellaswag

Example HellaSwag json item:

{"ind": 24, "activity_label": "Roof shingle removal", "ctx_a": "A man is sitting on a roof.", "ctx_b": "he", "ctx": "A man is sitting on a roof. he", "split": "val", "split_type": "indomain", "label": 3, "endings": ["is using wrap to wrap a pair of skis.", "is ripping level tiles off.", "is holding a rubik's cube.", "starts pulling up roofing on a roof."], "source_id": "activitynet~v_-JhWjGDPHMY"}

ind: dataset ID
activity_label: The ActivityNet or WikiHow label for this example
context: There are two formats. The full context is in ctx. When the context ends in an (incomplete) noun phrase, like for ActivityNet, this incomplete noun phrase is in ctx_b, and the context up until then is in ctx_a. This can be useful for models such as BERT that need the last sentence to be complete. However, it's never required. If ctx_b is nonempty, then ctx is the same thing as ctx_a, followed by a space, then ctx_b.
endings: a list of 4 endings. The correct index is given by label (0,1,2, or 3)
split: train, val, or test.
split_type: indomain if the activity label is seen during training, else zeroshot
source_id: Which video or WikiHow article this example came from

gpt2 (124M)
- eleuther harness reports acc 28.92%, acc_norm 31.14% (multiple choice style)
- this script: 10042 acc: 0.2859 acc_norm: 0.2955 (completion style)

gpt2-xl (1558M)
- eleuther harness reports acc 40.04%, acc_norm 50.89% (multiple choice style)
- this script: 10042 acc: 0.3842 acc_norm: 0.4893 (completion style)

The validation set of HellaSwag has a total of 10,042 examples.
\end{DoxyVerb}
 

\doxysubsection{Function Documentation}
\Hypertarget{namespacehellaswag_ae7aa4ae607495413610cf95ebb780af4}\index{hellaswag@{hellaswag}!download@{download}}
\index{download@{download}!hellaswag@{hellaswag}}
\doxysubsubsection{\texorpdfstring{download()}{download()}}
{\footnotesize\ttfamily \label{namespacehellaswag_ae7aa4ae607495413610cf95ebb780af4} 
hellaswag.\+download (\begin{DoxyParamCaption}\item[{}]{split}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Downloads HellaSwag DATA_CACHE_DIR\end{DoxyVerb}
 \Hypertarget{namespacehellaswag_a90c8bf725534d7e6b85b2bbe9a367e98}\index{hellaswag@{hellaswag}!evaluate@{evaluate}}
\index{evaluate@{evaluate}!hellaswag@{hellaswag}}
\doxysubsubsection{\texorpdfstring{evaluate()}{evaluate()}}
{\footnotesize\ttfamily \label{namespacehellaswag_a90c8bf725534d7e6b85b2bbe9a367e98} 
hellaswag.\+evaluate (\begin{DoxyParamCaption}\item[{}]{model\+\_\+type}{, }\item[{}]{device}{}\end{DoxyParamCaption})}

\Hypertarget{namespacehellaswag_a7e4c735deaa2a62dc039c27bae0c308a}\index{hellaswag@{hellaswag}!iterate\_examples@{iterate\_examples}}
\index{iterate\_examples@{iterate\_examples}!hellaswag@{hellaswag}}
\doxysubsubsection{\texorpdfstring{iterate\_examples()}{iterate\_examples()}}
{\footnotesize\ttfamily \label{namespacehellaswag_a7e4c735deaa2a62dc039c27bae0c308a} 
hellaswag.\+iterate\+\_\+examples (\begin{DoxyParamCaption}\item[{}]{split}{}\end{DoxyParamCaption})}

\Hypertarget{namespacehellaswag_a0bbecf7e93a680f05ba02ad38c028b90}\index{hellaswag@{hellaswag}!render\_example@{render\_example}}
\index{render\_example@{render\_example}!hellaswag@{hellaswag}}
\doxysubsubsection{\texorpdfstring{render\_example()}{render\_example()}}
{\footnotesize\ttfamily \label{namespacehellaswag_a0bbecf7e93a680f05ba02ad38c028b90} 
hellaswag.\+render\+\_\+example (\begin{DoxyParamCaption}\item[{}]{example}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Given the example as a dictionary, render it as three torch tensors:
- tokens (the tokens of context + completion, of size 4xN, as there are always 4 candidates)
- mask (is 1 in the region of the candidate completion, where we evaluate likelihoods)
- label (the index of the correct completion, which we hope has the highest likelihood)
\end{DoxyVerb}
 

\doxysubsection{Variable Documentation}
\Hypertarget{namespacehellaswag_a3c973c8cc7202d9f4b3883d67541bd43}\index{hellaswag@{hellaswag}!args@{args}}
\index{args@{args}!hellaswag@{hellaswag}}
\doxysubsubsection{\texorpdfstring{args}{args}}
{\footnotesize\ttfamily \label{namespacehellaswag_a3c973c8cc7202d9f4b3883d67541bd43} 
hellaswag.\+args = parser.\+parse\+\_\+args()}

\Hypertarget{namespacehellaswag_a3c473d5d19911b34e604a6301c10469b}\index{hellaswag@{hellaswag}!DATA\_CACHE\_DIR@{DATA\_CACHE\_DIR}}
\index{DATA\_CACHE\_DIR@{DATA\_CACHE\_DIR}!hellaswag@{hellaswag}}
\doxysubsubsection{\texorpdfstring{DATA\_CACHE\_DIR}{DATA\_CACHE\_DIR}}
{\footnotesize\ttfamily \label{namespacehellaswag_a3c473d5d19911b34e604a6301c10469b} 
hellaswag.\+DATA\+\_\+\+CACHE\+\_\+\+DIR = os.\+path.\+join(os.\+path.\+dirname(\+\_\+\+\_\+file\+\_\+\+\_\+), "{}hellaswag"{})}

\Hypertarget{namespacehellaswag_a0df0ca12a3f527bfeb4060f36682ee89}\index{hellaswag@{hellaswag}!default@{default}}
\index{default@{default}!hellaswag@{hellaswag}}
\doxysubsubsection{\texorpdfstring{default}{default}}
{\footnotesize\ttfamily \label{namespacehellaswag_a0df0ca12a3f527bfeb4060f36682ee89} 
hellaswag.\+default}

\Hypertarget{namespacehellaswag_a5086bc93df9ea71189bfe9857509f320}\index{hellaswag@{hellaswag}!enc@{enc}}
\index{enc@{enc}!hellaswag@{hellaswag}}
\doxysubsubsection{\texorpdfstring{enc}{enc}}
{\footnotesize\ttfamily \label{namespacehellaswag_a5086bc93df9ea71189bfe9857509f320} 
hellaswag.\+enc = tiktoken.\+get\+\_\+encoding("{}gpt2"{})}

\Hypertarget{namespacehellaswag_ab9661ab26493651f8ba90bece12dbef8}\index{hellaswag@{hellaswag}!hellaswags@{hellaswags}}
\index{hellaswags@{hellaswags}!hellaswag@{hellaswag}}
\doxysubsubsection{\texorpdfstring{hellaswags}{hellaswags}}
{\footnotesize\ttfamily \label{namespacehellaswag_ab9661ab26493651f8ba90bece12dbef8} 
dict hellaswag.\+hellaswags}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ =\ \ \{}
\DoxyCodeLine{00002\ \ \ \ \ \textcolor{stringliteral}{"{}train"{}}:\ \textcolor{stringliteral}{"{}https://raw.githubusercontent.com/rowanz/hellaswag/master/data/hellaswag\_train.jsonl"{}},}
\DoxyCodeLine{00003\ \ \ \ \ \textcolor{stringliteral}{"{}val"{}}:\ \textcolor{stringliteral}{"{}https://raw.githubusercontent.com/rowanz/hellaswag/master/data/hellaswag\_val.jsonl"{}},}
\DoxyCodeLine{00004\ \ \ \ \ \textcolor{stringliteral}{"{}test"{}}:\ \textcolor{stringliteral}{"{}https://raw.githubusercontent.com/rowanz/hellaswag/master/data/hellaswag\_test.jsonl"{}},}
\DoxyCodeLine{00005\ \}}

\end{DoxyCode}
\Hypertarget{namespacehellaswag_a664d4e5d58531d7120737b76fec2a6e0}\index{hellaswag@{hellaswag}!help@{help}}
\index{help@{help}!hellaswag@{hellaswag}}
\doxysubsubsection{\texorpdfstring{help}{help}}
{\footnotesize\ttfamily \label{namespacehellaswag_a664d4e5d58531d7120737b76fec2a6e0} 
hellaswag.\+help}

\Hypertarget{namespacehellaswag_aac09ebe031df4be9c9af4b76492ed478}\index{hellaswag@{hellaswag}!parser@{parser}}
\index{parser@{parser}!hellaswag@{hellaswag}}
\doxysubsubsection{\texorpdfstring{parser}{parser}}
{\footnotesize\ttfamily \label{namespacehellaswag_aac09ebe031df4be9c9af4b76492ed478} 
hellaswag.\+parser = argparse.\+Argument\+Parser()}

\Hypertarget{namespacehellaswag_a1c70bc8be9b2caddfa7b196fef5827da}\index{hellaswag@{hellaswag}!str@{str}}
\index{str@{str}!hellaswag@{hellaswag}}
\doxysubsubsection{\texorpdfstring{str}{str}}
{\footnotesize\ttfamily \label{namespacehellaswag_a1c70bc8be9b2caddfa7b196fef5827da} 
hellaswag.\+str}

\Hypertarget{namespacehellaswag_a9801be94dfbd6c9bfa4470f87bbdd956}\index{hellaswag@{hellaswag}!type@{type}}
\index{type@{type}!hellaswag@{hellaswag}}
\doxysubsubsection{\texorpdfstring{type}{type}}
{\footnotesize\ttfamily \label{namespacehellaswag_a9801be94dfbd6c9bfa4470f87bbdd956} 
hellaswag.\+type}

