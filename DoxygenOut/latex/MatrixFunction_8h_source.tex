\doxysection{Matrix\+Function.\+h}
\hypertarget{MatrixFunction_8h_source}{}\label{MatrixFunction_8h_source}\index{eigen/unsupported/Eigen/src/MatrixFunctions/MatrixFunction.h@{eigen/unsupported/Eigen/src/MatrixFunctions/MatrixFunction.h}}
\mbox{\hyperlink{MatrixFunction_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ This\ file\ is\ part\ of\ Eigen,\ a\ lightweight\ C++\ template\ library}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ for\ linear\ algebra.}}
\DoxyCodeLine{00003\ \textcolor{comment}{//}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ Copyright\ (C)\ 2009-\/2011,\ 2013\ Jitse\ Niesen\ <jitse@maths.leeds.ac.uk>}}
\DoxyCodeLine{00005\ \textcolor{comment}{//}}
\DoxyCodeLine{00006\ \textcolor{comment}{//\ This\ Source\ Code\ Form\ is\ subject\ to\ the\ terms\ of\ the\ Mozilla}}
\DoxyCodeLine{00007\ \textcolor{comment}{//\ Public\ License\ v.\ 2.0.\ If\ a\ copy\ of\ the\ MPL\ was\ not\ distributed}}
\DoxyCodeLine{00008\ \textcolor{comment}{//\ with\ this\ file,\ You\ can\ obtain\ one\ at\ http://mozilla.org/MPL/2.0/.}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#ifndef\ EIGEN\_MATRIX\_FUNCTION\_H}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#define\ EIGEN\_MATRIX\_FUNCTION\_H}}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{StemFunction_8h}{StemFunction.h}}"{}}}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceEigen}{Eigen}}\ \{\ }
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceinternal}{internal}}\ \{}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00021\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{float}\ \mbox{\hyperlink{namespaceEigen_1_1internal_a83aececb2dc32d30c1aa55f9aa5532d9}{matrix\_function\_separation}}\ =\ 0.1f;}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00029\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00030\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classEigen_1_1internal_1_1MatrixFunctionAtomic}{MatrixFunctionAtomic}}\ }
\DoxyCodeLine{00031\ \{}
\DoxyCodeLine{00032\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00034\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ MatrixType::Scalar\ \mbox{\hyperlink{classEigen_1_1internal_1_1MatrixFunctionAtomic_a890d1f272127ae1cf7a7dabbdef99b89}{Scalar}};}
\DoxyCodeLine{00035\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{structEigen_1_1internal_1_1stem__function}{stem\_function<Scalar>::type}}\ \mbox{\hyperlink{classEigen_1_1internal_1_1MatrixFunctionAtomic_a551beb4efcabe866b0b2eeb6539785eb}{StemFunction}};}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00040\ \ \ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1MatrixFunctionAtomic_a0786bb0349fe5ca5f8df13db7e21e882}{MatrixFunctionAtomic}}(\mbox{\hyperlink{classEigen_1_1internal_1_1MatrixFunctionAtomic_a551beb4efcabe866b0b2eeb6539785eb}{StemFunction}}\ f)\ :\ m\_f(f)\ \{\ \}}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00046\ \ \ \ \ MatrixType\ \mbox{\hyperlink{classEigen_1_1internal_1_1MatrixFunctionAtomic_a704ccdc87d66cb6f93d16e0a0b9e8acf}{compute}}(\textcolor{keyword}{const}\ MatrixType\&\ A);}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00049\ \ \ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1MatrixFunctionAtomic_a551beb4efcabe866b0b2eeb6539785eb}{StemFunction}}*\ m\_f;}
\DoxyCodeLine{00050\ \};}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00052\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00053\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{structEigen_1_1GenericNumTraits_a6e9ee9306607a1a0b4f79be74dca97bb}{NumTraits<typename\ MatrixType::Scalar>::Real}}\ \mbox{\hyperlink{namespaceEigen_1_1internal_ae91bbd019ccf1640f8707dd0926a715a}{matrix\_function\_compute\_mu}}(\textcolor{keyword}{const}\ MatrixType\&\ A)}
\DoxyCodeLine{00054\ \{}
\DoxyCodeLine{00055\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorLazyEvaluatorWritable}{plain\_col\_type<MatrixType>::type}}\ VectorType;}
\DoxyCodeLine{00056\ \ \ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ rows\ =\ A.rows();}
\DoxyCodeLine{00057\ \ \ \textcolor{keyword}{const}\ MatrixType\ \mbox{\hyperlink{TensorIntDiv_8h_ab2b6b0c222cd1ce70d6a831f57241e59}{N}}\ =\ MatrixType::Identity(rows,\ rows)\ -\/\ \mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2fast__type__id__test_8cc_a1ea955b94ea8dc35e689055712257459}{A}};}
\DoxyCodeLine{00058\ \ \ VectorType\ e\ =\ VectorType::Ones(rows);}
\DoxyCodeLine{00059\ \ \ \mbox{\hyperlink{TensorIntDiv_8h_ab2b6b0c222cd1ce70d6a831f57241e59}{N}}.template\ triangularView<Upper>().solveInPlace(e);}
\DoxyCodeLine{00060\ \ \ \textcolor{keywordflow}{return}\ e.cwiseAbs().maxCoeff();}
\DoxyCodeLine{00061\ \}}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00063\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00064\ MatrixType\ \mbox{\hyperlink{classEigen_1_1internal_1_1MatrixFunctionAtomic_a704ccdc87d66cb6f93d16e0a0b9e8acf}{MatrixFunctionAtomic<MatrixType>::compute}}(\textcolor{keyword}{const}\ MatrixType\&\ A)}
\DoxyCodeLine{00065\ \{}
\DoxyCodeLine{00066\ \ \ \textcolor{comment}{//\ TODO:\ Use\ that\ A\ is\ upper\ triangular}}
\DoxyCodeLine{00067\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{structEigen_1_1GenericNumTraits_a6e9ee9306607a1a0b4f79be74dca97bb}{NumTraits<Scalar>::Real}}\ RealScalar;}
\DoxyCodeLine{00068\ \ \ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ rows\ =\ A.rows();}
\DoxyCodeLine{00069\ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1MatrixFunctionAtomic_a890d1f272127ae1cf7a7dabbdef99b89}{Scalar}}\ avgEival\ =\ A.trace()\ /\ \mbox{\hyperlink{classEigen_1_1internal_1_1MatrixFunctionAtomic_a890d1f272127ae1cf7a7dabbdef99b89}{Scalar}}(RealScalar(rows));}
\DoxyCodeLine{00070\ \ \ MatrixType\ Ashifted\ =\ A\ -\/\ avgEival\ *\ MatrixType::Identity(rows,\ rows);}
\DoxyCodeLine{00071\ \ \ RealScalar\ mu\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_ae91bbd019ccf1640f8707dd0926a715a}{matrix\_function\_compute\_mu}}(Ashifted);}
\DoxyCodeLine{00072\ \ \ MatrixType\ \mbox{\hyperlink{abseil-cpp_2absl_2flags_2parse__test_8cc_a3becc13b83617c3c63584edf81880f13}{F}}\ =\ m\_f(avgEival,\ 0)\ *\ MatrixType::Identity(rows,\ rows);}
\DoxyCodeLine{00073\ \ \ MatrixType\ P\ =\ Ashifted;}
\DoxyCodeLine{00074\ \ \ MatrixType\ Fincr;}
\DoxyCodeLine{00075\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ s\ =\ 1;\ double(s)\ <\ 1.1\ *\ double(rows)\ +\ 10.0;\ s++)\ \{\ \textcolor{comment}{//\ upper\ limit\ is\ fairly\ arbitrary}}
\DoxyCodeLine{00076\ \ \ \ \ Fincr\ =\ m\_f(avgEival,\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(s))\ *\ P;}
\DoxyCodeLine{00077\ \ \ \ \ \mbox{\hyperlink{abseil-cpp_2absl_2flags_2parse__test_8cc_a3becc13b83617c3c63584edf81880f13}{F}}\ +=\ Fincr;}
\DoxyCodeLine{00078\ \ \ \ \ P\ =\ \mbox{\hyperlink{classEigen_1_1internal_1_1MatrixFunctionAtomic_a890d1f272127ae1cf7a7dabbdef99b89}{Scalar}}(RealScalar(1)/RealScalar(s\ +\ 1))\ *\ P\ *\ Ashifted;}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00080\ \ \ \ \ \textcolor{comment}{//\ test\ whether\ Taylor\ series\ converged}}
\DoxyCodeLine{00081\ \ \ \ \ \textcolor{keyword}{const}\ RealScalar\ F\_norm\ =\ \mbox{\hyperlink{abseil-cpp_2absl_2flags_2parse__test_8cc_a3becc13b83617c3c63584edf81880f13}{F}}.cwiseAbs().rowwise().sum().maxCoeff();}
\DoxyCodeLine{00082\ \ \ \ \ \textcolor{keyword}{const}\ RealScalar\ Fincr\_norm\ =\ Fincr.cwiseAbs().rowwise().sum().maxCoeff();}
\DoxyCodeLine{00083\ \ \ \ \ \textcolor{keywordflow}{if}\ (Fincr\_norm\ <\ \mbox{\hyperlink{structEigen_1_1NumTraits}{NumTraits<Scalar>::epsilon}}()\ *\ F\_norm)\ \{}
\DoxyCodeLine{00084\ \ \ \ \ \ \ RealScalar\ delta\ =\ 0;}
\DoxyCodeLine{00085\ \ \ \ \ \ \ RealScalar\ rfactorial\ =\ 1;}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ r\ =\ 0;\ r\ <\ rows;\ r++)\ \{}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ RealScalar\ mx\ =\ 0;}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ rows;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}++)}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \ \ mx\ =\ (std::max)(mx,\ std::abs(m\_f(Ashifted(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}},\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ +\ avgEival,\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(s+r))));}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (r\ !=\ 0)}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \ \ rfactorial\ *=\ RealScalar(r);}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ delta\ =\ (std::max)(delta,\ mx\ /\ rfactorial);}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \textcolor{keyword}{const}\ RealScalar\ P\_norm\ =\ P.cwiseAbs().rowwise().sum().maxCoeff();}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (mu\ *\ delta\ *\ P\_norm\ <\ \mbox{\hyperlink{structEigen_1_1NumTraits}{NumTraits<Scalar>::epsilon}}()\ *\ F\_norm)\ \textcolor{comment}{//\ series\ converged}}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00097\ \ \ \ \ \}}
\DoxyCodeLine{00098\ \ \ \}}
\DoxyCodeLine{00099\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{abseil-cpp_2absl_2flags_2parse__test_8cc_a3becc13b83617c3c63584edf81880f13}{F}};}
\DoxyCodeLine{00100\ \}}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00107\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Index,\ \textcolor{keyword}{typename}\ ListOfClusters>}
\DoxyCodeLine{00108\ \textcolor{keyword}{typename}\ ListOfClusters::iterator\ \mbox{\hyperlink{namespaceEigen_1_1internal_af9cdbae9f4f166fae876c54b97c0f2bb}{matrix\_function\_find\_cluster}}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__test_8cc_a35af0be900467fedbb610bd6ea65ed78}{key}},\ ListOfClusters\&\ clusters)}
\DoxyCodeLine{00109\ \{}
\DoxyCodeLine{00110\ \ \ \textcolor{keyword}{typename}\ std::list<Index>::iterator\ j;}
\DoxyCodeLine{00111\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{typename}\ ListOfClusters::iterator\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ clusters.begin();\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ !=\ clusters.end();\ ++\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ \{}
\DoxyCodeLine{00112\ \ \ \ \ j\ =\ std::find(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}-\/>begin(),\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}-\/>end(),\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__test_8cc_a35af0be900467fedbb610bd6ea65ed78}{key}});}
\DoxyCodeLine{00113\ \ \ \ \ \textcolor{keywordflow}{if}\ (j\ !=\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}-\/>end())}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}};}
\DoxyCodeLine{00115\ \ \ \}}
\DoxyCodeLine{00116\ \ \ \textcolor{keywordflow}{return}\ clusters.end();}
\DoxyCodeLine{00117\ \}}
\DoxyCodeLine{00118\ }
\DoxyCodeLine{00130\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ EivalsType,\ \textcolor{keyword}{typename}\ Cluster>}
\DoxyCodeLine{00131\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespaceEigen_1_1internal_a9291a6ab4fe0ad1346049a8f2feddeaa}{matrix\_function\_partition\_eigenvalues}}(\textcolor{keyword}{const}\ EivalsType\&\ eivals,\ std::list<Cluster>\&\ clusters)}
\DoxyCodeLine{00132\ \{}
\DoxyCodeLine{00133\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ EivalsType::RealScalar\ RealScalar;}
\DoxyCodeLine{00134\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}=0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}<eivals.rows();\ ++\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ \{}
\DoxyCodeLine{00135\ \ \ \ \ \textcolor{comment}{//\ Find\ cluster\ containing\ i-\/th\ ei'val,\ adding\ a\ new\ cluster\ if\ necessary}}
\DoxyCodeLine{00136\ \ \ \ \ \textcolor{keyword}{typename}\ std::list<Cluster>::iterator\ qi\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_af9cdbae9f4f166fae876c54b97c0f2bb}{matrix\_function\_find\_cluster}}(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}},\ clusters);}
\DoxyCodeLine{00137\ \ \ \ \ \textcolor{keywordflow}{if}\ (qi\ ==\ clusters.end())\ \{}
\DoxyCodeLine{00138\ \ \ \ \ \ \ Cluster\ l;}
\DoxyCodeLine{00139\ \ \ \ \ \ \ l.push\_back(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}});}
\DoxyCodeLine{00140\ \ \ \ \ \ \ clusters.push\_back(l);}
\DoxyCodeLine{00141\ \ \ \ \ \ \ qi\ =\ clusters.end();}
\DoxyCodeLine{00142\ \ \ \ \ \ \ -\/-\/qi;}
\DoxyCodeLine{00143\ \ \ \ \ \}}
\DoxyCodeLine{00144\ }
\DoxyCodeLine{00145\ \ \ \ \ \textcolor{comment}{//\ Look\ for\ other\ element\ to\ add\ to\ the\ set}}
\DoxyCodeLine{00146\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ j=\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}+1;\ j<eivals.rows();\ ++j)\ \{}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{ArrayCwiseUnaryOps_8h_a35560f7dbf19244fda7e463d14157c43}{abs}}(eivals(j)\ -\/\ eivals(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}))\ <=\ RealScalar(\mbox{\hyperlink{namespaceEigen_1_1internal_a83aececb2dc32d30c1aa55f9aa5532d9}{matrix\_function\_separation}})}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \ \ \&\&\ std::find(qi-\/>begin(),\ qi-\/>end(),\ j)\ ==\ qi-\/>end())\ \{}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \textcolor{keyword}{typename}\ std::list<Cluster>::iterator\ qj\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_af9cdbae9f4f166fae876c54b97c0f2bb}{matrix\_function\_find\_cluster}}(j,\ clusters);}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (qj\ ==\ clusters.end())\ \{}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \ \ qi-\/>push\_back(j);}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \ \ qi-\/>insert(qi-\/>end(),\ qj-\/>begin(),\ qj-\/>end());}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \ \ clusters.erase(qj);}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00157\ \ \ \ \ \}}
\DoxyCodeLine{00158\ \ \ \}}
\DoxyCodeLine{00159\ \}}
\DoxyCodeLine{00160\ }
\DoxyCodeLine{00162\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ ListOfClusters,\ \textcolor{keyword}{typename}\ Index>}
\DoxyCodeLine{00163\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespaceEigen_1_1internal_a1073ba7ac499827baa04c814e4251326}{matrix\_function\_compute\_cluster\_size}}(\textcolor{keyword}{const}\ ListOfClusters\&\ clusters,\ \mbox{\hyperlink{classEigen_1_1Matrix}{Matrix<Index,\ Dynamic,\ 1>}}\&\ clusterSize)}
\DoxyCodeLine{00164\ \{}
\DoxyCodeLine{00165\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ numClusters\ =\ \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\textcolor{keyword}{>}(clusters.size());}
\DoxyCodeLine{00166\ \ \ clusterSize.\mbox{\hyperlink{classEigen_1_1PlainObjectBase_ac21ad5f989f320e46958b75ac8d9a1da}{setZero}}(numClusters);}
\DoxyCodeLine{00167\ \ \ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ clusterIndex\ =\ 0;}
\DoxyCodeLine{00168\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{typename}\ ListOfClusters::const\_iterator\ cluster\ =\ clusters.begin();\ cluster\ !=\ clusters.end();\ ++cluster)\ \{}
\DoxyCodeLine{00169\ \ \ \ \ clusterSize[clusterIndex]\ =\ cluster-\/>size();}
\DoxyCodeLine{00170\ \ \ \ \ ++clusterIndex;}
\DoxyCodeLine{00171\ \ \ \}}
\DoxyCodeLine{00172\ \}}
\DoxyCodeLine{00173\ }
\DoxyCodeLine{00175\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ VectorType>}
\DoxyCodeLine{00176\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespaceEigen_1_1internal_a2144f635d30028a25e7eb3510c315ad3}{matrix\_function\_compute\_block\_start}}(\textcolor{keyword}{const}\ VectorType\&\ clusterSize,\ VectorType\&\ blockStart)}
\DoxyCodeLine{00177\ \{}
\DoxyCodeLine{00178\ \ \ blockStart.resize(clusterSize.rows());}
\DoxyCodeLine{00179\ \ \ blockStart(0)\ =\ 0;}
\DoxyCodeLine{00180\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 1;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ clusterSize.rows();\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}++)\ \{}
\DoxyCodeLine{00181\ \ \ \ \ blockStart(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ blockStart(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}-\/1)\ +\ clusterSize(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}-\/1);}
\DoxyCodeLine{00182\ \ \ \}}
\DoxyCodeLine{00183\ \}}
\DoxyCodeLine{00184\ }
\DoxyCodeLine{00186\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ EivalsType,\ \textcolor{keyword}{typename}\ ListOfClusters,\ \textcolor{keyword}{typename}\ VectorType>}
\DoxyCodeLine{00187\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespaceEigen_1_1internal_ade67364a006320cd7103f0f3366def09}{matrix\_function\_compute\_map}}(\textcolor{keyword}{const}\ EivalsType\&\ eivals,\ \textcolor{keyword}{const}\ ListOfClusters\&\ clusters,\ VectorType\&\ eivalToCluster)}
\DoxyCodeLine{00188\ \{}
\DoxyCodeLine{00189\ \ \ eivalToCluster.resize(eivals.rows());}
\DoxyCodeLine{00190\ \ \ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ clusterIndex\ =\ 0;}
\DoxyCodeLine{00191\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{typename}\ ListOfClusters::const\_iterator\ cluster\ =\ clusters.begin();\ cluster\ !=\ clusters.end();\ ++cluster)\ \{}
\DoxyCodeLine{00192\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ eivals.rows();\ ++\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ \{}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (std::find(cluster-\/>begin(),\ cluster-\/>end(),\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ !=\ cluster-\/>end())\ \{}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ eivalToCluster[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}]\ =\ clusterIndex;}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00196\ \ \ \ \ \}}
\DoxyCodeLine{00197\ \ \ \ \ ++clusterIndex;}
\DoxyCodeLine{00198\ \ \ \}}
\DoxyCodeLine{00199\ \}}
\DoxyCodeLine{00200\ }
\DoxyCodeLine{00202\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ DynVectorType,\ \textcolor{keyword}{typename}\ VectorType>}
\DoxyCodeLine{00203\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespaceEigen_1_1internal_a0434fe5b0ec47e69b8e351ef9e131bcd}{matrix\_function\_compute\_permutation}}(\textcolor{keyword}{const}\ DynVectorType\&\ blockStart,\ \textcolor{keyword}{const}\ DynVectorType\&\ eivalToCluster,\ VectorType\&\ permutation)}
\DoxyCodeLine{00204\ \{}
\DoxyCodeLine{00205\ \ \ DynVectorType\ indexNextEntry\ =\ blockStart;}
\DoxyCodeLine{00206\ \ \ permutation.resize(eivalToCluster.rows());}
\DoxyCodeLine{00207\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ eivalToCluster.rows();\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}++)\ \{}
\DoxyCodeLine{00208\ \ \ \ \ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ cluster\ =\ eivalToCluster[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}];}
\DoxyCodeLine{00209\ \ \ \ \ permutation[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}]\ =\ indexNextEntry[cluster];}
\DoxyCodeLine{00210\ \ \ \ \ ++indexNextEntry[cluster];}
\DoxyCodeLine{00211\ \ \ \}}
\DoxyCodeLine{00212\ \}\ \ }
\DoxyCodeLine{00213\ }
\DoxyCodeLine{00215\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ VectorType,\ \textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00216\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespaceEigen_1_1internal_a59cacdc2f9b480da246258bc9399aa2c}{matrix\_function\_permute\_schur}}(VectorType\&\ permutation,\ MatrixType\&\ U,\ MatrixType\&\ T)}
\DoxyCodeLine{00217\ \{}
\DoxyCodeLine{00218\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ permutation.rows()\ -\/\ 1;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}++)\ \{}
\DoxyCodeLine{00219\ \ \ \ \ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ j;}
\DoxyCodeLine{00220\ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}};\ j\ <\ permutation.rows();\ j++)\ \{}
\DoxyCodeLine{00221\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (permutation(j)\ ==\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00222\ \ \ \ \ \}}
\DoxyCodeLine{00223\ \ \ \ \ \mbox{\hyperlink{Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(permutation(j)\ ==\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}});}
\DoxyCodeLine{00224\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ k\ =\ j-\/1;\ k\ >=\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}};\ k-\/-\/)\ \{}
\DoxyCodeLine{00225\ \ \ \ \ \ \ \mbox{\hyperlink{classEigen_1_1JacobiRotation}{JacobiRotation<typename\ MatrixType::Scalar>}}\ rotation;}
\DoxyCodeLine{00226\ \ \ \ \ \ \ rotation.\mbox{\hyperlink{classEigen_1_1JacobiRotation_a15fb3e9c4378fb87e318b23c7a43b584}{makeGivens}}(T(k,\ k+1),\ T(k+1,\ k+1)\ -\/\ T(k,\ k));}
\DoxyCodeLine{00227\ \ \ \ \ \ \ T.applyOnTheLeft(k,\ k+1,\ rotation.\mbox{\hyperlink{classEigen_1_1JacobiRotation_aaca0173b23a021238ab2a5f0d0003dfd}{adjoint}}());}
\DoxyCodeLine{00228\ \ \ \ \ \ \ T.applyOnTheRight(k,\ k+1,\ rotation);}
\DoxyCodeLine{00229\ \ \ \ \ \ \ U.applyOnTheRight(k,\ k+1,\ rotation);}
\DoxyCodeLine{00230\ \ \ \ \ \ \ std::swap(permutation.coeffRef(k),\ permutation.coeffRef(k+1));}
\DoxyCodeLine{00231\ \ \ \ \ \}}
\DoxyCodeLine{00232\ \ \ \}}
\DoxyCodeLine{00233\ \}}
\DoxyCodeLine{00234\ }
\DoxyCodeLine{00241\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ MatrixType,\ \textcolor{keyword}{typename}\ AtomicType,\ \textcolor{keyword}{typename}\ VectorType>}
\DoxyCodeLine{00242\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespaceEigen_1_1internal_a53e617df189868a791e44d2c4e94403f}{matrix\_function\_compute\_block\_atomic}}(\textcolor{keyword}{const}\ MatrixType\&\ T,\ AtomicType\&\ atomic,\ \textcolor{keyword}{const}\ VectorType\&\ blockStart,\ \textcolor{keyword}{const}\ VectorType\&\ clusterSize,\ MatrixType\&\ fT)}
\DoxyCodeLine{00243\ \{\ }
\DoxyCodeLine{00244\ \ \ fT.setZero(T.rows(),\ T.cols());}
\DoxyCodeLine{00245\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ clusterSize.rows();\ ++\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ \{}
\DoxyCodeLine{00246\ \ \ \ \ fT.block(blockStart(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}),\ blockStart(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}),\ clusterSize(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}),\ clusterSize(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}))}
\DoxyCodeLine{00247\ \ \ \ \ \ \ =\ atomic.compute(T.block(blockStart(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}),\ blockStart(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}),\ clusterSize(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}),\ clusterSize(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})));}
\DoxyCodeLine{00248\ \ \ \}}
\DoxyCodeLine{00249\ \}}
\DoxyCodeLine{00250\ }
\DoxyCodeLine{00273\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00274\ MatrixType\ \mbox{\hyperlink{namespaceEigen_1_1internal_a9f7e5b9803071057e7ed4e887da4a1bb}{matrix\_function\_solve\_triangular\_sylvester}}(\textcolor{keyword}{const}\ MatrixType\&\ A,\ \textcolor{keyword}{const}\ MatrixType\&\ B,\ \textcolor{keyword}{const}\ MatrixType\&\ \mbox{\hyperlink{abseil-cpp_2absl_2hash_2internal_2city__test_8cc_ac54ae397901fe700628cafadea3c5208}{C}})}
\DoxyCodeLine{00275\ \{}
\DoxyCodeLine{00276\ \ \ \mbox{\hyperlink{Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(A.rows()\ ==\ A.cols());}
\DoxyCodeLine{00277\ \ \ \mbox{\hyperlink{Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(A.isUpperTriangular());}
\DoxyCodeLine{00278\ \ \ \mbox{\hyperlink{Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(B.rows()\ ==\ B.cols());}
\DoxyCodeLine{00279\ \ \ \mbox{\hyperlink{Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(B.isUpperTriangular());}
\DoxyCodeLine{00280\ \ \ \mbox{\hyperlink{Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(\mbox{\hyperlink{abseil-cpp_2absl_2hash_2internal_2city__test_8cc_ac54ae397901fe700628cafadea3c5208}{C}}.rows()\ ==\ A.rows());}
\DoxyCodeLine{00281\ \ \ \mbox{\hyperlink{Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(\mbox{\hyperlink{abseil-cpp_2absl_2hash_2internal_2city__test_8cc_ac54ae397901fe700628cafadea3c5208}{C}}.cols()\ ==\ B.rows());}
\DoxyCodeLine{00282\ }
\DoxyCodeLine{00283\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ MatrixType::Scalar\ Scalar;}
\DoxyCodeLine{00284\ }
\DoxyCodeLine{00285\ \ \ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ m\ =\ A.rows();}
\DoxyCodeLine{00286\ \ \ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__test_8cc_a76f11d9a0a47b94f72c2d0e77fb32240}{n}}\ =\ B.rows();}
\DoxyCodeLine{00287\ \ \ MatrixType\ \mbox{\hyperlink{abseil-cpp_2absl_2strings_2internal_2str__format_2parser__test_8cc_ad6254e80d17335001dac03b6e8e15a25}{X}}(m,\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__test_8cc_a76f11d9a0a47b94f72c2d0e77fb32240}{n}});}
\DoxyCodeLine{00288\ }
\DoxyCodeLine{00289\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ m\ -\/\ 1;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ >=\ 0;\ -\/-\/\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ \{}
\DoxyCodeLine{00290\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__test_8cc_a76f11d9a0a47b94f72c2d0e77fb32240}{n}};\ ++j)\ \{}
\DoxyCodeLine{00291\ }
\DoxyCodeLine{00292\ \ \ \ \ \ \ \textcolor{comment}{//\ Compute\ AX\ =\ \(\backslash\)sum\_\{k=i+1\}\string^m\ A\_\{ik\}\ X\_\{kj\}}}
\DoxyCodeLine{00293\ \ \ \ \ \ \ Scalar\ AX;}
\DoxyCodeLine{00294\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ ==\ m\ -\/\ 1)\ \{}
\DoxyCodeLine{00295\ \ \ \ \ AX\ =\ 0;\ }
\DoxyCodeLine{00296\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00297\ \ \ \ \ \mbox{\hyperlink{classEigen_1_1Matrix}{Matrix<Scalar,1,1>}}\ AXmatrix\ =\ A.row(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}).tail(m-\/1-\/\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ *\ \mbox{\hyperlink{abseil-cpp_2absl_2strings_2internal_2str__format_2parser__test_8cc_ad6254e80d17335001dac03b6e8e15a25}{X}}.col(j).tail(m-\/1-\/\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}});}
\DoxyCodeLine{00298\ \ \ \ \ AX\ =\ AXmatrix(0,0);}
\DoxyCodeLine{00299\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00300\ }
\DoxyCodeLine{00301\ \ \ \ \ \ \ \textcolor{comment}{//\ Compute\ XB\ =\ \(\backslash\)sum\_\{k=1\}\string^\{j-\/1\}\ X\_\{ik\}\ B\_\{kj\}}}
\DoxyCodeLine{00302\ \ \ \ \ \ \ Scalar\ XB;}
\DoxyCodeLine{00303\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (j\ ==\ 0)\ \{}
\DoxyCodeLine{00304\ \ \ \ \ XB\ =\ 0;\ }
\DoxyCodeLine{00305\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00306\ \ \ \ \ \mbox{\hyperlink{classEigen_1_1Matrix}{Matrix<Scalar,1,1>}}\ XBmatrix\ =\ \mbox{\hyperlink{abseil-cpp_2absl_2strings_2internal_2str__format_2parser__test_8cc_ad6254e80d17335001dac03b6e8e15a25}{X}}.row(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}).head(j)\ *\ B.col(j).head(j);}
\DoxyCodeLine{00307\ \ \ \ \ XB\ =\ XBmatrix(0,0);}
\DoxyCodeLine{00308\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00309\ }
\DoxyCodeLine{00310\ \ \ \ \ \ \ \mbox{\hyperlink{abseil-cpp_2absl_2strings_2internal_2str__format_2parser__test_8cc_ad6254e80d17335001dac03b6e8e15a25}{X}}(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}},j)\ =\ (\mbox{\hyperlink{abseil-cpp_2absl_2hash_2internal_2city__test_8cc_ac54ae397901fe700628cafadea3c5208}{C}}(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}},j)\ -\/\ AX\ -\/\ XB)\ /\ (\mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2fast__type__id__test_8cc_a1ea955b94ea8dc35e689055712257459}{A}}(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}},\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ +\ B(j,j));}
\DoxyCodeLine{00311\ \ \ \ \ \}}
\DoxyCodeLine{00312\ \ \ \}}
\DoxyCodeLine{00313\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{abseil-cpp_2absl_2strings_2internal_2str__format_2parser__test_8cc_ad6254e80d17335001dac03b6e8e15a25}{X}};}
\DoxyCodeLine{00314\ \}}
\DoxyCodeLine{00315\ }
\DoxyCodeLine{00322\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ MatrixType,\ \textcolor{keyword}{typename}\ VectorType>}
\DoxyCodeLine{00323\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespaceEigen_1_1internal_a8ff76c47bde59d8af688e5925bed8f17}{matrix\_function\_compute\_above\_diagonal}}(\textcolor{keyword}{const}\ MatrixType\&\ T,\ \textcolor{keyword}{const}\ VectorType\&\ blockStart,\ \textcolor{keyword}{const}\ VectorType\&\ clusterSize,\ MatrixType\&\ fT)}
\DoxyCodeLine{00324\ \{\ }
\DoxyCodeLine{00325\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{internal::traits<MatrixType>}}\ Traits;}
\DoxyCodeLine{00326\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ MatrixType::Scalar\ Scalar;}
\DoxyCodeLine{00327\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ Options\ =\ MatrixType::Options;}
\DoxyCodeLine{00328\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{classEigen_1_1Matrix}{Matrix<Scalar,\ Dynamic,\ Dynamic,\ Options,\ Traits::RowsAtCompileTime,\ Traits::ColsAtCompileTime>}}\ DynMatrixType;}
\DoxyCodeLine{00329\ }
\DoxyCodeLine{00330\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ k\ =\ 1;\ k\ <\ clusterSize.rows();\ k++)\ \{}
\DoxyCodeLine{00331\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ clusterSize.rows()\ -\/\ k;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}++)\ \{}
\DoxyCodeLine{00332\ \ \ \ \ \ \ \textcolor{comment}{//\ compute\ (i,\ i+k)\ block}}
\DoxyCodeLine{00333\ \ \ \ \ \ \ DynMatrixType\ A\ =\ T.block(blockStart(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}),\ blockStart(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}),\ clusterSize(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}),\ clusterSize(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}));}
\DoxyCodeLine{00334\ \ \ \ \ \ \ DynMatrixType\ B\ =\ -\/T.block(blockStart(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}+k),\ blockStart(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}+k),\ clusterSize(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}+k),\ clusterSize(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}+k));}
\DoxyCodeLine{00335\ \ \ \ \ \ \ DynMatrixType\ \mbox{\hyperlink{abseil-cpp_2absl_2hash_2internal_2city__test_8cc_ac54ae397901fe700628cafadea3c5208}{C}}\ =\ fT.block(blockStart(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}),\ blockStart(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}),\ clusterSize(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}),\ clusterSize(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}))}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \ \ *\ T.block(blockStart(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}),\ blockStart(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}+k),\ clusterSize(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}),\ clusterSize(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}+k));}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \mbox{\hyperlink{abseil-cpp_2absl_2hash_2internal_2city__test_8cc_ac54ae397901fe700628cafadea3c5208}{C}}\ -\/=\ T.block(blockStart(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}),\ blockStart(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}+k),\ clusterSize(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}),\ clusterSize(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}+k))}
\DoxyCodeLine{00338\ \ \ \ \ \ \ \ \ *\ fT.block(blockStart(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}+k),\ blockStart(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}+k),\ clusterSize(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}+k),\ clusterSize(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}+k));}
\DoxyCodeLine{00339\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ m\ =\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +\ 1;\ m\ <\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +\ k;\ m++)\ \{}
\DoxyCodeLine{00340\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{abseil-cpp_2absl_2hash_2internal_2city__test_8cc_ac54ae397901fe700628cafadea3c5208}{C}}\ +=\ fT.block(blockStart(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}),\ blockStart(m),\ clusterSize(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}),\ clusterSize(m))}
\DoxyCodeLine{00341\ \ \ \ \ \ \ \ \ \ \ *\ T.block(blockStart(m),\ blockStart(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}+k),\ clusterSize(m),\ clusterSize(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}+k));}
\DoxyCodeLine{00342\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{abseil-cpp_2absl_2hash_2internal_2city__test_8cc_ac54ae397901fe700628cafadea3c5208}{C}}\ -\/=\ T.block(blockStart(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}),\ blockStart(m),\ clusterSize(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}),\ clusterSize(m))}
\DoxyCodeLine{00343\ \ \ \ \ \ \ \ \ \ \ *\ fT.block(blockStart(m),\ blockStart(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}+k),\ clusterSize(m),\ clusterSize(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}+k));}
\DoxyCodeLine{00344\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00345\ \ \ \ \ \ \ fT.block(blockStart(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}),\ blockStart(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}+k),\ clusterSize(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}),\ clusterSize(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}+k))}
\DoxyCodeLine{00346\ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_a9f7e5b9803071057e7ed4e887da4a1bb}{matrix\_function\_solve\_triangular\_sylvester}}(A,\ B,\ \mbox{\hyperlink{abseil-cpp_2absl_2hash_2internal_2city__test_8cc_ac54ae397901fe700628cafadea3c5208}{C}});}
\DoxyCodeLine{00347\ \ \ \ \ \}}
\DoxyCodeLine{00348\ \ \ \}}
\DoxyCodeLine{00349\ \}}
\DoxyCodeLine{00350\ }
\DoxyCodeLine{00366\ template\ <typename\ MatrixType,\ int\ IsComplex\ =\ NumTraits<typename\ internal::traits<MatrixType>::Scalar>::IsComplex>}
\DoxyCodeLine{00367\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structEigen_1_1internal_1_1matrix__function__compute}{matrix\_function\_compute}}}
\DoxyCodeLine{00368\ \{\ \ }
\DoxyCodeLine{00379\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ AtomicType,\ \textcolor{keyword}{typename}\ ResultType>\ }
\DoxyCodeLine{00380\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structEigen_1_1internal_1_1matrix__function__compute_a55a328773f5254d0cd29ac699bc2634f}{run}}(\textcolor{keyword}{const}\ MatrixType\&\ A,\ AtomicType\&\ atomic,\ ResultType\ \&result);\ \ \ \ }
\DoxyCodeLine{00381\ \};}
\DoxyCodeLine{00382\ }
\DoxyCodeLine{00389\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00390\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structEigen_1_1internal_1_1matrix__function__compute}{matrix\_function\_compute}}<MatrixType,\ 0>}
\DoxyCodeLine{00391\ \{\ \ }
\DoxyCodeLine{00392\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ MatA,\ \textcolor{keyword}{typename}\ AtomicType,\ \textcolor{keyword}{typename}\ ResultType>}
\DoxyCodeLine{00393\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structEigen_1_1internal_1_1matrix__function__compute_3_01MatrixType_00_010_01_4_ade2dde964eb0b03fb28a13d5d33696e3}{run}}(\textcolor{keyword}{const}\ MatA\&\ A,\ AtomicType\&\ atomic,\ ResultType\ \&result)}
\DoxyCodeLine{00394\ \ \ \{}
\DoxyCodeLine{00395\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{internal::traits<MatrixType>}}\ Traits;}
\DoxyCodeLine{00396\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ Traits::Scalar\ Scalar;}
\DoxyCodeLine{00397\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ Rows\ =\ Traits::RowsAtCompileTime,\ Cols\ =\ Traits::ColsAtCompileTime;}
\DoxyCodeLine{00398\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ MaxRows\ =\ Traits::MaxRowsAtCompileTime,\ MaxCols\ =\ Traits::MaxColsAtCompileTime;}
\DoxyCodeLine{00399\ }
\DoxyCodeLine{00400\ \ \ \ \ \textcolor{keyword}{typedef}\ std::complex<Scalar>\ ComplexScalar;}
\DoxyCodeLine{00401\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{classEigen_1_1Matrix}{Matrix<ComplexScalar,\ Rows,\ Cols,\ 0,\ MaxRows,\ MaxCols>}}\ ComplexMatrix;}
\DoxyCodeLine{00402\ }
\DoxyCodeLine{00403\ \ \ \ \ ComplexMatrix\ CA\ =\ A.template\ \mbox{\hyperlink{CommonCwiseUnaryOps_8h_aa89d007196125d10fa7d6e19811aca05}{cast<ComplexScalar>}}();}
\DoxyCodeLine{00404\ \ \ \ \ ComplexMatrix\ Cresult;}
\DoxyCodeLine{00405\ \ \ \ \ \mbox{\hyperlink{structEigen_1_1internal_1_1matrix__function__compute_a55a328773f5254d0cd29ac699bc2634f}{matrix\_function\_compute<ComplexMatrix>::run}}(CA,\ atomic,\ Cresult);}
\DoxyCodeLine{00406\ \ \ \ \ result\ =\ Cresult.real();}
\DoxyCodeLine{00407\ \ \ \}}
\DoxyCodeLine{00408\ \};}
\DoxyCodeLine{00409\ }
\DoxyCodeLine{00413\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00414\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structEigen_1_1internal_1_1matrix__function__compute}{matrix\_function\_compute}}<MatrixType,\ 1>}
\DoxyCodeLine{00415\ \{}
\DoxyCodeLine{00416\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ MatA,\ \textcolor{keyword}{typename}\ AtomicType,\ \textcolor{keyword}{typename}\ ResultType>}
\DoxyCodeLine{00417\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structEigen_1_1internal_1_1matrix__function__compute_3_01MatrixType_00_011_01_4_ad6c56b11de78e66a39194b001045298a}{run}}(\textcolor{keyword}{const}\ MatA\&\ A,\ AtomicType\&\ atomic,\ ResultType\ \&result)}
\DoxyCodeLine{00418\ \ \ \{}
\DoxyCodeLine{00419\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{internal::traits<MatrixType>}}\ Traits;}
\DoxyCodeLine{00420\ \ \ \ \ }
\DoxyCodeLine{00421\ \ \ \ \ \textcolor{comment}{//\ compute\ Schur\ decomposition\ of\ A}}
\DoxyCodeLine{00422\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1ComplexSchur}{ComplexSchur<MatrixType>}}\ schurOfA(A);}
\DoxyCodeLine{00423\ \ \ \ \ \mbox{\hyperlink{Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(schurOfA.\mbox{\hyperlink{classEigen_1_1ComplexSchur_a8c5ee15fecfd126fc362c3f2fd28f51e}{info}}()==\mbox{\hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5ea671a2aeb0f527802806a441d58a80fcf}{Success}});}
\DoxyCodeLine{00424\ \ \ \ \ MatrixType\ T\ =\ schurOfA.\mbox{\hyperlink{classEigen_1_1ComplexSchur_a210b9d7e6c26fdde18aa5720da1d3e3c}{matrixT}}();}
\DoxyCodeLine{00425\ \ \ \ \ MatrixType\ U\ =\ schurOfA.\mbox{\hyperlink{classEigen_1_1ComplexSchur_a695d312ce07fc0a82ce5d5ce8cd680da}{matrixU}}();}
\DoxyCodeLine{00426\ }
\DoxyCodeLine{00427\ \ \ \ \ \textcolor{comment}{//\ partition\ eigenvalues\ into\ clusters\ of\ ei'vals\ "{}close"{}\ to\ each\ other}}
\DoxyCodeLine{00428\ \ \ \ \ std::list<std::list<Index>\ >\ clusters;\ }
\DoxyCodeLine{00429\ \ \ \ \ \mbox{\hyperlink{namespaceEigen_1_1internal_a9291a6ab4fe0ad1346049a8f2feddeaa}{matrix\_function\_partition\_eigenvalues}}(T.diagonal(),\ clusters);}
\DoxyCodeLine{00430\ }
\DoxyCodeLine{00431\ \ \ \ \ \textcolor{comment}{//\ compute\ size\ of\ each\ cluster}}
\DoxyCodeLine{00432\ \ \ \ \ \mbox{\hyperlink{classEigen_1_1Matrix}{Matrix<Index,\ Dynamic,\ 1>}}\ clusterSize;}
\DoxyCodeLine{00433\ \ \ \ \ \mbox{\hyperlink{namespaceEigen_1_1internal_a1073ba7ac499827baa04c814e4251326}{matrix\_function\_compute\_cluster\_size}}(clusters,\ clusterSize);}
\DoxyCodeLine{00434\ }
\DoxyCodeLine{00435\ \ \ \ \ \textcolor{comment}{//\ blockStart[i]\ is\ row\ index\ at\ which\ block\ corresponding\ to\ i-\/th\ cluster\ starts\ }}
\DoxyCodeLine{00436\ \ \ \ \ \mbox{\hyperlink{classEigen_1_1Matrix}{Matrix<Index,\ Dynamic,\ 1>}}\ blockStart;\ }
\DoxyCodeLine{00437\ \ \ \ \ \mbox{\hyperlink{namespaceEigen_1_1internal_a2144f635d30028a25e7eb3510c315ad3}{matrix\_function\_compute\_block\_start}}(clusterSize,\ blockStart);}
\DoxyCodeLine{00438\ }
\DoxyCodeLine{00439\ \ \ \ \ \textcolor{comment}{//\ compute\ map\ so\ that\ eivalToCluster[i]\ =\ j\ means\ that\ i-\/th\ ei'val\ is\ in\ j-\/th\ cluster\ }}
\DoxyCodeLine{00440\ \ \ \ \ \mbox{\hyperlink{classEigen_1_1Matrix}{Matrix<Index,\ Dynamic,\ 1>}}\ eivalToCluster;}
\DoxyCodeLine{00441\ \ \ \ \ \mbox{\hyperlink{namespaceEigen_1_1internal_ade67364a006320cd7103f0f3366def09}{matrix\_function\_compute\_map}}(T.diagonal(),\ clusters,\ eivalToCluster);}
\DoxyCodeLine{00442\ }
\DoxyCodeLine{00443\ \ \ \ \ \textcolor{comment}{//\ compute\ permutation\ which\ groups\ ei'vals\ in\ same\ cluster\ together\ }}
\DoxyCodeLine{00444\ \ \ \ \ \mbox{\hyperlink{classEigen_1_1Matrix}{Matrix<Index,\ Traits::RowsAtCompileTime,\ 1>}}\ permutation;}
\DoxyCodeLine{00445\ \ \ \ \ \mbox{\hyperlink{namespaceEigen_1_1internal_a0434fe5b0ec47e69b8e351ef9e131bcd}{matrix\_function\_compute\_permutation}}(blockStart,\ eivalToCluster,\ permutation);}
\DoxyCodeLine{00446\ }
\DoxyCodeLine{00447\ \ \ \ \ \textcolor{comment}{//\ permute\ Schur\ decomposition}}
\DoxyCodeLine{00448\ \ \ \ \ \mbox{\hyperlink{namespaceEigen_1_1internal_a59cacdc2f9b480da246258bc9399aa2c}{matrix\_function\_permute\_schur}}(permutation,\ U,\ T);}
\DoxyCodeLine{00449\ }
\DoxyCodeLine{00450\ \ \ \ \ \textcolor{comment}{//\ compute\ result}}
\DoxyCodeLine{00451\ \ \ \ \ MatrixType\ fT;\ \textcolor{comment}{//\ matrix\ function\ applied\ to\ T}}
\DoxyCodeLine{00452\ \ \ \ \ \mbox{\hyperlink{namespaceEigen_1_1internal_a53e617df189868a791e44d2c4e94403f}{matrix\_function\_compute\_block\_atomic}}(T,\ atomic,\ blockStart,\ clusterSize,\ fT);}
\DoxyCodeLine{00453\ \ \ \ \ \mbox{\hyperlink{namespaceEigen_1_1internal_a8ff76c47bde59d8af688e5925bed8f17}{matrix\_function\_compute\_above\_diagonal}}(T,\ blockStart,\ clusterSize,\ fT);}
\DoxyCodeLine{00454\ \ \ \ \ result\ =\ U\ *\ (fT.template\ triangularView<Upper>()\ *\ U.adjoint());}
\DoxyCodeLine{00455\ \ \ \}}
\DoxyCodeLine{00456\ \};}
\DoxyCodeLine{00457\ }
\DoxyCodeLine{00458\ \}\ \textcolor{comment}{//\ end\ of\ namespace\ internal}}
\DoxyCodeLine{00459\ }
\DoxyCodeLine{00470\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Derived>\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classEigen_1_1MatrixFunctionReturnValue}{MatrixFunctionReturnValue}}}
\DoxyCodeLine{00471\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classEigen_1_1ReturnByValue}{ReturnByValue}}<MatrixFunctionReturnValue<Derived>\ >}
\DoxyCodeLine{00472\ \{}
\DoxyCodeLine{00473\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00474\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ Derived::Scalar\ \mbox{\hyperlink{classEigen_1_1MatrixFunctionReturnValue_a04913315ae94d6ec3dd3b4b75d05c47f}{Scalar}};}
\DoxyCodeLine{00475\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{structEigen_1_1internal_1_1stem__function}{internal::stem\_function<Scalar>::type}}\ \mbox{\hyperlink{classEigen_1_1MatrixFunctionReturnValue_a904ff1725acff43790a75d6134b234b6}{StemFunction}};}
\DoxyCodeLine{00476\ }
\DoxyCodeLine{00477\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00478\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorLazyEvaluatorWritable}{internal::ref\_selector<Derived>::type}}\ \mbox{\hyperlink{classEigen_1_1MatrixFunctionReturnValue_a47abb3b94f82f1f3a415a805e44cee9c}{DerivedNested}};}
\DoxyCodeLine{00479\ }
\DoxyCodeLine{00480\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00481\ }
\DoxyCodeLine{00487\ \ \ \ \ \mbox{\hyperlink{classEigen_1_1MatrixFunctionReturnValue_af193d7a3e1b4e65dc70e64eb4bc8e17f}{MatrixFunctionReturnValue}}(\textcolor{keyword}{const}\ Derived\&\ A,\ \mbox{\hyperlink{classEigen_1_1MatrixFunctionReturnValue_a904ff1725acff43790a75d6134b234b6}{StemFunction}}\ f)\ :\ m\_A(A),\ m\_f(f)\ \{\ \}}
\DoxyCodeLine{00488\ }
\DoxyCodeLine{00493\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ ResultType>}
\DoxyCodeLine{00494\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEigen_1_1MatrixFunctionReturnValue_a202d594ae254e3ea5420ff95d9f03a67}{evalTo}}(ResultType\&\ result)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00495\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00496\ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorLazyEvaluatorWritable}{internal::nested\_eval<Derived,\ 10>::type}}\ NestedEvalType;}
\DoxyCodeLine{00497\ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{structEigen_1_1internal_1_1remove__all_a8c6b21d1e637059fba1949ede3cf3b7b}{internal::remove\_all<NestedEvalType>::type}}\ NestedEvalTypeClean;}
\DoxyCodeLine{00498\ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{internal::traits<NestedEvalTypeClean>}}\ Traits;}
\DoxyCodeLine{00499\ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ std::complex<typename\ NumTraits<Scalar>::Real>\ ComplexScalar;}
\DoxyCodeLine{00500\ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{classEigen_1_1Matrix}{Matrix<ComplexScalar,\ Dynamic,\ Dynamic,\ 0,\ Traits::RowsAtCompileTime,\ Traits::ColsAtCompileTime>}}\ DynMatrixType;}
\DoxyCodeLine{00501\ }
\DoxyCodeLine{00502\ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{classEigen_1_1internal_1_1MatrixFunctionAtomic}{internal::MatrixFunctionAtomic<DynMatrixType>}}\ AtomicType;}
\DoxyCodeLine{00503\ \ \ \ \ \ \ AtomicType\ atomic(m\_f);}
\DoxyCodeLine{00504\ }
\DoxyCodeLine{00505\ \ \ \ \ \ \ \mbox{\hyperlink{structEigen_1_1internal_1_1matrix__function__compute_a55a328773f5254d0cd29ac699bc2634f}{internal::matrix\_function\_compute<typename\ NestedEvalTypeClean::PlainObject>::run}}(m\_A,\ atomic,\ result);}
\DoxyCodeLine{00506\ \ \ \ \ \}}
\DoxyCodeLine{00507\ }
\DoxyCodeLine{00508\ \ \ \ \ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ \mbox{\hyperlink{classEigen_1_1MatrixFunctionReturnValue_a0cdf35cbef496858b738e85055199f51}{rows}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ m\_A.rows();\ \}}
\DoxyCodeLine{00509\ \ \ \ \ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ \mbox{\hyperlink{classEigen_1_1MatrixFunctionReturnValue_a9ed627acab1f8b40cc55e7ce47a88db4}{cols}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ m\_A.cols();\ \}}
\DoxyCodeLine{00510\ }
\DoxyCodeLine{00511\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00512\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1MatrixFunctionReturnValue_a47abb3b94f82f1f3a415a805e44cee9c}{DerivedNested}}\ m\_A;}
\DoxyCodeLine{00513\ \ \ \ \ \mbox{\hyperlink{classEigen_1_1MatrixFunctionReturnValue_a904ff1725acff43790a75d6134b234b6}{StemFunction}}\ *m\_f;}
\DoxyCodeLine{00514\ \};}
\DoxyCodeLine{00515\ }
\DoxyCodeLine{00516\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceinternal}{internal}}\ \{}
\DoxyCodeLine{00517\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Derived>}
\DoxyCodeLine{00518\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}<\mbox{\hyperlink{classEigen_1_1MatrixFunctionReturnValue}{MatrixFunctionReturnValue}}<Derived>\ >}
\DoxyCodeLine{00519\ \{}
\DoxyCodeLine{00520\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ Derived::PlainObject\ \mbox{\hyperlink{structEigen_1_1internal_1_1traits_3_01MatrixFunctionReturnValue_3_01Derived_01_4_01_4_aac5345686a6a41b10c487da7bde748ac}{ReturnType}};}
\DoxyCodeLine{00521\ \};}
\DoxyCodeLine{00522\ \}}
\DoxyCodeLine{00523\ }
\DoxyCodeLine{00524\ }
\DoxyCodeLine{00525\ \textcolor{comment}{/**********\ MatrixBase\ methods\ **********/}}
\DoxyCodeLine{00526\ }
\DoxyCodeLine{00527\ }
\DoxyCodeLine{00528\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Derived>}
\DoxyCodeLine{00529\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1MatrixFunctionReturnValue}{MatrixFunctionReturnValue<Derived>}}\ \mbox{\hyperlink{classEigen_1_1MatrixBase_a104a1b8e719b93822ad4331248edc447}{MatrixBase<Derived>::matrixFunction}}(\textcolor{keyword}{typename}\ \mbox{\hyperlink{structEigen_1_1internal_1_1stem__function}{internal::stem\_function}}<\textcolor{keyword}{typename}\ \mbox{\hyperlink{structEigen_1_1internal_1_1traits}{internal::traits<Derived>::Scalar}}>::type\ f)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00530\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00531\ \ \ \mbox{\hyperlink{Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(rows()\ ==\ cols());}
\DoxyCodeLine{00532\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classEigen_1_1MatrixFunctionReturnValue}{MatrixFunctionReturnValue<Derived>}}(derived(),\ f);}
\DoxyCodeLine{00533\ \}}
\DoxyCodeLine{00534\ }
\DoxyCodeLine{00535\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Derived>}
\DoxyCodeLine{00536\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1MatrixFunctionReturnValue}{MatrixFunctionReturnValue<Derived>}}\ \mbox{\hyperlink{classEigen_1_1MatrixBase}{MatrixBase<Derived>::sin}}()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00537\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00538\ \ \ \mbox{\hyperlink{Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(rows()\ ==\ cols());}
\DoxyCodeLine{00539\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{structEigen_1_1internal_1_1stem__function_a2428a4c223a76dffbe761b003d43adf6}{internal::stem\_function<Scalar>::ComplexScalar}}\ ComplexScalar;}
\DoxyCodeLine{00540\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classEigen_1_1MatrixFunctionReturnValue}{MatrixFunctionReturnValue<Derived>}}(derived(),\ \mbox{\hyperlink{namespaceEigen_1_1internal_a297dc38f5c9b80e2a1da7dcf2a453c90}{internal::stem\_function\_sin<ComplexScalar>}});}
\DoxyCodeLine{00541\ \}}
\DoxyCodeLine{00542\ }
\DoxyCodeLine{00543\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Derived>}
\DoxyCodeLine{00544\ \textcolor{keyword}{const}\ MatrixFunctionReturnValue<Derived>\ MatrixBase<Derived>::cos()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00545\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00546\ \ \ \mbox{\hyperlink{Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(rows()\ ==\ cols());}
\DoxyCodeLine{00547\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{structEigen_1_1internal_1_1stem__function_a2428a4c223a76dffbe761b003d43adf6}{internal::stem\_function<Scalar>::ComplexScalar}}\ ComplexScalar;}
\DoxyCodeLine{00548\ \ \ \textcolor{keywordflow}{return}\ MatrixFunctionReturnValue<Derived>(derived(),\ \mbox{\hyperlink{namespaceEigen_1_1internal_a9727c15ffb97a40df226fce93e2628b3}{internal::stem\_function\_cos<ComplexScalar>}});}
\DoxyCodeLine{00549\ \}}
\DoxyCodeLine{00550\ }
\DoxyCodeLine{00551\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Derived>}
\DoxyCodeLine{00552\ \textcolor{keyword}{const}\ MatrixFunctionReturnValue<Derived>\ MatrixBase<Derived>::sinh()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00553\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00554\ \ \ \mbox{\hyperlink{Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(rows()\ ==\ cols());}
\DoxyCodeLine{00555\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{structEigen_1_1internal_1_1stem__function_a2428a4c223a76dffbe761b003d43adf6}{internal::stem\_function<Scalar>::ComplexScalar}}\ ComplexScalar;}
\DoxyCodeLine{00556\ \ \ \textcolor{keywordflow}{return}\ MatrixFunctionReturnValue<Derived>(derived(),\ \mbox{\hyperlink{namespaceEigen_1_1internal_ab2855d150c9eebb8ed6cb63a292dda0d}{internal::stem\_function\_sinh<ComplexScalar>}});}
\DoxyCodeLine{00557\ \}}
\DoxyCodeLine{00558\ }
\DoxyCodeLine{00559\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Derived>}
\DoxyCodeLine{00560\ \textcolor{keyword}{const}\ MatrixFunctionReturnValue<Derived>\ MatrixBase<Derived>::cosh()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00561\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00562\ \ \ \mbox{\hyperlink{Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(rows()\ ==\ cols());}
\DoxyCodeLine{00563\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{structEigen_1_1internal_1_1stem__function_a2428a4c223a76dffbe761b003d43adf6}{internal::stem\_function<Scalar>::ComplexScalar}}\ ComplexScalar;}
\DoxyCodeLine{00564\ \ \ \textcolor{keywordflow}{return}\ MatrixFunctionReturnValue<Derived>(derived(),\ \mbox{\hyperlink{namespaceEigen_1_1internal_aab7949e5c95ec574eff5c4229da36846}{internal::stem\_function\_cosh<ComplexScalar>}});}
\DoxyCodeLine{00565\ \}}
\DoxyCodeLine{00566\ }
\DoxyCodeLine{00567\ \}\ \textcolor{comment}{//\ end\ namespace\ Eigen}}
\DoxyCodeLine{00568\ }
\DoxyCodeLine{00569\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ EIGEN\_MATRIX\_FUNCTION\_H}}

\end{DoxyCode}
