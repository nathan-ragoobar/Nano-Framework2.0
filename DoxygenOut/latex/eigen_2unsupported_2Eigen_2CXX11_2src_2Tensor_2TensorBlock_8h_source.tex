\doxysection{Tensor\+Block.\+h}
\hypertarget{eigen_2unsupported_2Eigen_2CXX11_2src_2Tensor_2TensorBlock_8h_source}{}\label{eigen_2unsupported_2Eigen_2CXX11_2src_2Tensor_2TensorBlock_8h_source}\index{eigen/unsupported/Eigen/CXX11/src/Tensor/TensorBlock.h@{eigen/unsupported/Eigen/CXX11/src/Tensor/TensorBlock.h}}
\mbox{\hyperlink{eigen_2unsupported_2Eigen_2CXX11_2src_2Tensor_2TensorBlock_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ This\ file\ is\ part\ of\ Eigen,\ a\ lightweight\ C++\ template\ library}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ for\ linear\ algebra.}}
\DoxyCodeLine{00003\ \textcolor{comment}{//}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ This\ Source\ Code\ Form\ is\ subject\ to\ the\ terms\ of\ the\ Mozilla}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ Public\ License\ v.\ 2.0.\ If\ a\ copy\ of\ the\ MPL\ was\ not\ distributed}}
\DoxyCodeLine{00006\ \textcolor{comment}{//\ with\ this\ file,\ You\ can\ obtain\ one\ at\ http://mozilla.org/MPL/2.0/.}}
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#ifndef\ EIGEN\_CXX11\_TENSOR\_TENSOR\_BLOCK\_H}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#define\ EIGEN\_CXX11\_TENSOR\_TENSOR\_BLOCK\_H}}
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00011\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceEigen}{Eigen}}\ \{}
\DoxyCodeLine{00012\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceinternal}{internal}}\ \{}
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00014\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ //}}
\DoxyCodeLine{00015\ \textcolor{comment}{//\ Forward\ declarations\ for\ templates\ defined\ below.}}
\DoxyCodeLine{00016\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Scalar,\ \textcolor{keyword}{typename}\ IndexType,\ \textcolor{keywordtype}{int}\ NumDims,\ \textcolor{keywordtype}{int}\ Layout>}
\DoxyCodeLine{00017\ \textcolor{keyword}{class\ }TensorBlockIO;}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ //}}
\DoxyCodeLine{00020\ \textcolor{comment}{//\ Helper\ function\ to\ compute\ strides\ for\ densely\ stored\ buffer\ of\ given}}
\DoxyCodeLine{00021\ \textcolor{comment}{//\ dimensions.}}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \textcolor{comment}{//\ TODO(ezhulenev):\ We\ compute\ strides\ 1000\ times\ in\ different\ evaluators,\ use}}
\DoxyCodeLine{00024\ \textcolor{comment}{//\ this\ function\ instead\ everywhere.}}
\DoxyCodeLine{00025\ \textcolor{keyword}{template}\ <\textcolor{keywordtype}{int}\ Layout,\ \textcolor{keyword}{typename}\ IndexType,\ \textcolor{keywordtype}{int}\ NumDims>}
\DoxyCodeLine{00026\ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_a1fdc6f94f20527c7275768d82b2eb9ce}{EIGEN\_ALWAYS\_INLINE}}\ \mbox{\hyperlink{structEigen_1_1DSizes}{DSizes<IndexType,\ NumDims>}}\ \mbox{\hyperlink{namespaceEigen_1_1internal_ae6bac895069b4299831c59aeb680ce3e}{strides}}(}
\DoxyCodeLine{00027\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1DSizes}{DSizes<IndexType,\ NumDims>}}\&\ dimensions)\ \{}
\DoxyCodeLine{00028\ \ \ \mbox{\hyperlink{structEigen_1_1DSizes}{DSizes<IndexType,\ NumDims>}}\ \mbox{\hyperlink{namespaceEigen_1_1internal_ae6bac895069b4299831c59aeb680ce3e}{strides}};}
\DoxyCodeLine{00029\ \ \ \textcolor{keywordflow}{if}\ (NumDims\ ==\ 0)\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespaceEigen_1_1internal_ae6bac895069b4299831c59aeb680ce3e}{strides}};}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00031\ \ \ \textcolor{comment}{//\ TODO(ezhulenev):\ Use\ templates\ to\ unroll\ this\ loop\ (similar\ to}}
\DoxyCodeLine{00032\ \ \ \textcolor{comment}{//\ h\_array\_reduce\ in\ CXX11meta.h)?\ Benchmark\ it.}}
\DoxyCodeLine{00033\ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(Layout)\ ==\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(\mbox{\hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13a0cbd4bdd0abcfc0224c5fcb5e4f6669a}{ColMajor}}))\ \{}
\DoxyCodeLine{00034\ \ \ \ \ \mbox{\hyperlink{namespaceEigen_1_1internal_ae6bac895069b4299831c59aeb680ce3e}{strides}}[0]\ =\ 1;}
\DoxyCodeLine{00035\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 1;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ NumDims;\ ++\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ \{}
\DoxyCodeLine{00036\ \ \ \ \ \ \ \mbox{\hyperlink{namespaceEigen_1_1internal_ae6bac895069b4299831c59aeb680ce3e}{strides}}[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}]\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_ae6bac895069b4299831c59aeb680ce3e}{strides}}[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ -\/\ 1]\ *\ dimensions[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ -\/\ 1];}
\DoxyCodeLine{00037\ \ \ \ \ \}}
\DoxyCodeLine{00038\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00039\ \ \ \ \ \mbox{\hyperlink{namespaceEigen_1_1internal_ae6bac895069b4299831c59aeb680ce3e}{strides}}[NumDims\ -\/\ 1]\ =\ 1;}
\DoxyCodeLine{00040\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ NumDims\ -\/\ 2;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ >=\ 0;\ -\/-\/\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ \{}
\DoxyCodeLine{00041\ \ \ \ \ \ \ \mbox{\hyperlink{namespaceEigen_1_1internal_ae6bac895069b4299831c59aeb680ce3e}{strides}}[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}]\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_ae6bac895069b4299831c59aeb680ce3e}{strides}}[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +\ 1]\ *\ dimensions[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +\ 1];}
\DoxyCodeLine{00042\ \ \ \ \ \}}
\DoxyCodeLine{00043\ \ \ \}}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespaceEigen_1_1internal_ae6bac895069b4299831c59aeb680ce3e}{strides}};}
\DoxyCodeLine{00046\ \}}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \textcolor{keyword}{template}\ <\textcolor{keywordtype}{int}\ Layout,\ \textcolor{keyword}{typename}\ IndexType,\ \textcolor{keywordtype}{size\_t}\ NumDims>}
\DoxyCodeLine{00049\ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_a1fdc6f94f20527c7275768d82b2eb9ce}{EIGEN\_ALWAYS\_INLINE}}\ \mbox{\hyperlink{structEigen_1_1DSizes}{DSizes<IndexType,\ NumDims>}}\ \mbox{\hyperlink{namespaceEigen_1_1internal_ae6bac895069b4299831c59aeb680ce3e}{strides}}(}
\DoxyCodeLine{00050\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1array}{Eigen::array<IndexType,\ NumDims>}}\&\ dimensions)\ \{}
\DoxyCodeLine{00051\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespaceEigen_1_1internal_ae6bac895069b4299831c59aeb680ce3e}{strides<Layout>}}(\mbox{\hyperlink{structEigen_1_1DSizes}{DSizes<IndexType,\ NumDims>}}(dimensions));}
\DoxyCodeLine{00052\ \}}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00054\ \textcolor{keyword}{template}\ <\textcolor{keywordtype}{int}\ Layout,\ std::ptrdiff\_t...\ Indices>}
\DoxyCodeLine{00055\ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \mbox{\hyperlink{structEigen_1_1DSizes}{DSizes}}<std::ptrdiff\_t,\ \textcolor{keyword}{sizeof}...(Indices)>\ \mbox{\hyperlink{namespaceEigen_1_1internal_ae6bac895069b4299831c59aeb680ce3e}{strides}}(}
\DoxyCodeLine{00056\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1Sizes}{Sizes<Indices...>}}\&\ sizes)\ \{}
\DoxyCodeLine{00057\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespaceEigen_1_1internal_ae6bac895069b4299831c59aeb680ce3e}{strides<Layout>}}(\mbox{\hyperlink{structEigen_1_1DSizes}{DSizes}}<std::ptrdiff\_t,\ \textcolor{keyword}{sizeof}...(Indices)>(sizes));}
\DoxyCodeLine{00058\ \}}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00060\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ //}}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ \textcolor{comment}{//\ Tensor\ block\ shape\ type\ defines\ what\ are\ the\ shape\ preference\ for\ the\ blocks}}
\DoxyCodeLine{00063\ \textcolor{comment}{//\ extracted\ from\ the\ larger\ tensor.}}
\DoxyCodeLine{00064\ \textcolor{comment}{//}}
\DoxyCodeLine{00065\ \textcolor{comment}{//\ Example:\ blocks\ of\ 100\ elements\ from\ the\ large\ 100x100\ tensor:}}
\DoxyCodeLine{00066\ \textcolor{comment}{//\ -\/\ tensor:\ 100x100}}
\DoxyCodeLine{00067\ \textcolor{comment}{//\ -\/\ target\_block\_size:\ 100}}
\DoxyCodeLine{00068\ \textcolor{comment}{//}}
\DoxyCodeLine{00069\ \textcolor{comment}{//\ TensorBlockShapeType:}}
\DoxyCodeLine{00070\ \textcolor{comment}{//\ \ -\/\ kUniformAllDims:\ 100\ blocks\ of\ size\ 10x10}}
\DoxyCodeLine{00071\ \textcolor{comment}{//\ \ -\/\ kSkewedInnerDims:\ 100\ blocks\ of\ size\ 100x1\ (or\ 1x100\ depending\ on\ a\ column}}
\DoxyCodeLine{00072\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ or\ row\ major\ layout)}}
\DoxyCodeLine{00073\ \textcolor{keyword}{enum\ class}\ \mbox{\hyperlink{namespaceEigen_1_1internal_af8b5cefcff8749f792756a379a17941d}{TensorBlockShapeType}}\ \{\ \mbox{\hyperlink{namespaceEigen_1_1internal_af8b5cefcff8749f792756a379a17941da7cb0f57bf813fcb63ae4bd2d81f37672}{kUniformAllDims}},\ \mbox{\hyperlink{namespaceEigen_1_1internal_af8b5cefcff8749f792756a379a17941daeaeafd3133ead02c0e0ffd56f2401a47}{kSkewedInnerDims}}\ \};}
\DoxyCodeLine{00074\ }
\DoxyCodeLine{00075\ \textcolor{keyword}{struct\ }TensorBlockResourceRequirements\ \{}
\DoxyCodeLine{00076\ \ \ \mbox{\hyperlink{namespaceEigen_1_1internal_af8b5cefcff8749f792756a379a17941d}{TensorBlockShapeType}}\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements_ab9ec777dfae8b80991da086a4d96493a}{shape\_type}};\ \ \textcolor{comment}{//\ target\ block\ shape}}
\DoxyCodeLine{00077\ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements_a9222a177f35b7f4ffeda380409b6ad9b}{size}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ target\ block\ size}}
\DoxyCodeLine{00078\ \ \ \mbox{\hyperlink{classEigen_1_1TensorOpCost}{TensorOpCost}}\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements_ab30180b31f9d530f1f580d4709f8e4a0}{cost\_per\_coeff}};\ \ \ \ \ \ \textcolor{comment}{//\ cost\ of\ computing\ a\ single\ block\ element}}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00080\ \textcolor{preprocessor}{\#ifdef\ EIGEN\_HIPCC}}
\DoxyCodeLine{00081\ \ \ \textcolor{comment}{//\ For\ HIPCC,\ we\ need\ to\ explicitly\ declare\ as\ a\ "{}device\ fun"{},\ the\ constructor}}
\DoxyCodeLine{00082\ \ \ \textcolor{comment}{//\ which\ is\ implicitly\ invoked\ in\ the\ "{}merge"{}\ /\ "{}any"{}\ routines.\ else\ HIPCC}}
\DoxyCodeLine{00083\ \ \ \textcolor{comment}{//\ errors\ out\ complaining\ about\ the\ lack\ of\ a\ matching\ constructor}}
\DoxyCodeLine{00084\ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}}
\DoxyCodeLine{00085\ \ \ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements}{TensorBlockResourceRequirements}}(\mbox{\hyperlink{namespaceEigen_1_1internal_af8b5cefcff8749f792756a379a17941d}{TensorBlockShapeType}}\ shape\_type\_,\ \textcolor{keywordtype}{size\_t}\ size\_,}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classEigen_1_1TensorOpCost}{TensorOpCost}}\ cost\_)}
\DoxyCodeLine{00087\ \ \ \ \ :\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements_ab9ec777dfae8b80991da086a4d96493a}{shape\_type}}(shape\_type\_),\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements_a9222a177f35b7f4ffeda380409b6ad9b}{size}}(size\_),\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements_ab30180b31f9d530f1f580d4709f8e4a0}{cost\_per\_coeff}}(cost\_)}
\DoxyCodeLine{00088\ \ \ \{\}}
\DoxyCodeLine{00089\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00090\ }
\DoxyCodeLine{00091\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Scalar>}
\DoxyCodeLine{00092\ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}\ \textcolor{keyword}{static}\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements}{TensorBlockResourceRequirements}}\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements_a5296ef45736ae165150e886da1190c26}{withShapeAndSize}}(}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \mbox{\hyperlink{namespaceEigen_1_1internal_af8b5cefcff8749f792756a379a17941d}{TensorBlockShapeType}}\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements_ab9ec777dfae8b80991da086a4d96493a}{shape\_type}},\ \textcolor{keywordtype}{size\_t}\ size\_in\_bytes,}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \mbox{\hyperlink{classEigen_1_1TensorOpCost}{TensorOpCost}}\ cost)\ \{}
\DoxyCodeLine{00095\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements_a9222a177f35b7f4ffeda380409b6ad9b}{size}}\ =\ \mbox{\hyperlink{namespaceEigen_1_1numext_a29d502349f2ec9897c808e65e0f96eb4}{numext::maxi}}(\textcolor{keywordtype}{size\_t}(1),\ size\_in\_bytes\ /\ \textcolor{keyword}{sizeof}(Scalar));}
\DoxyCodeLine{00096\ \ \ \ \ \textcolor{keywordflow}{return}\ \{\mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements_ab9ec777dfae8b80991da086a4d96493a}{shape\_type}},\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements_a9222a177f35b7f4ffeda380409b6ad9b}{size}},\ cost\};}
\DoxyCodeLine{00097\ \ \ \}}
\DoxyCodeLine{00098\ }
\DoxyCodeLine{00099\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Scalar>}
\DoxyCodeLine{00100\ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}\ \textcolor{keyword}{static}\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements}{TensorBlockResourceRequirements}}\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements_a4ceb88ac7cc926bc50cd46a570903721}{withShapeAndSize}}(}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \mbox{\hyperlink{namespaceEigen_1_1internal_af8b5cefcff8749f792756a379a17941d}{TensorBlockShapeType}}\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements_ab9ec777dfae8b80991da086a4d96493a}{shape\_type}},\ \textcolor{keywordtype}{size\_t}\ size\_in\_bytes)\ \{}
\DoxyCodeLine{00102\ \ \ \ \ \textcolor{comment}{//\ This\ default\ cost\ per\ coefficient\ is\ valid\ for\ most\ materialized\ tensor}}
\DoxyCodeLine{00103\ \ \ \ \ \textcolor{comment}{//\ block\ evaluation\ implementations,\ because\ they\ typically\ just\ read}}
\DoxyCodeLine{00104\ \ \ \ \ \textcolor{comment}{//\ coefficients\ from\ the\ underlying\ tensor\ storage,\ and\ write\ to\ the\ tensor}}
\DoxyCodeLine{00105\ \ \ \ \ \textcolor{comment}{//\ block\ buffer\ (scratch\ or\ destination\ memory,\ reads\ and\ writes\ have\ linear}}
\DoxyCodeLine{00106\ \ \ \ \ \textcolor{comment}{//\ access\ pattern).\ We\ ignore\ the\ fixed\ cost\ of\ block\ evaluation,\ because\ in}}
\DoxyCodeLine{00107\ \ \ \ \ \textcolor{comment}{//\ practice\ it\ should\ negligible.}}
\DoxyCodeLine{00108\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00109\ \ \ \ \ \textcolor{comment}{//\ Lazy\ block\ evaluation\ adds\ the\ cost\ of\ calling\ a\ functor\ for\ each}}
\DoxyCodeLine{00110\ \ \ \ \ \textcolor{comment}{//\ coefficient.}}
\DoxyCodeLine{00111\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00112\ \ \ \ \ \textcolor{comment}{//\ All\ non-\/trivial\ block\ evaluation\ implementations\ must\ provide\ their\ own}}
\DoxyCodeLine{00113\ \ \ \ \ \textcolor{comment}{//\ cost\ approximation\ (e.g.\ shuffling\ inner\ dimension\ has\ a\ much\ higher\ cost}}
\DoxyCodeLine{00114\ \ \ \ \ \textcolor{comment}{//\ because\ it\ reads\ memory\ randomly,\ although\ the\ total\ number\ of\ moved}}
\DoxyCodeLine{00115\ \ \ \ \ \textcolor{comment}{//\ bytes\ is\ the\ same).}}
\DoxyCodeLine{00116\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements_a5296ef45736ae165150e886da1190c26}{withShapeAndSize<Scalar>}}(\mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements_ab9ec777dfae8b80991da086a4d96493a}{shape\_type}},\ size\_in\_bytes,}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{\textcolor{comment}{/*bytes\_loaded=*/}\textcolor{keyword}{sizeof}(Scalar),}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*bytes\_stored=*/}\textcolor{keyword}{sizeof}(Scalar),}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*compute\_cycles=*/}0\});}
\DoxyCodeLine{00120\ \ \ \}}
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00122\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Scalar>}
\DoxyCodeLine{00123\ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}\ \textcolor{keyword}{static}\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements}{TensorBlockResourceRequirements}}\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements_a636f7a3d1d332d6a8c1833c27d4f6cd9}{skewed}}(}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ size\_in\_bytes)\ \{}
\DoxyCodeLine{00125\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements_a5296ef45736ae165150e886da1190c26}{withShapeAndSize<Scalar>}}(\mbox{\hyperlink{namespaceEigen_1_1internal_af8b5cefcff8749f792756a379a17941daeaeafd3133ead02c0e0ffd56f2401a47}{TensorBlockShapeType::kSkewedInnerDims}},}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ size\_in\_bytes);}
\DoxyCodeLine{00127\ \ \ \}}
\DoxyCodeLine{00128\ }
\DoxyCodeLine{00129\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Scalar>}
\DoxyCodeLine{00130\ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}\ \textcolor{keyword}{static}\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements}{TensorBlockResourceRequirements}}\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements_a9f58ddfb29853a07e1b454b42d1afc29}{uniform}}(}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ size\_in\_bytes)\ \{}
\DoxyCodeLine{00132\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements_a5296ef45736ae165150e886da1190c26}{withShapeAndSize<Scalar>}}(\mbox{\hyperlink{namespaceEigen_1_1internal_af8b5cefcff8749f792756a379a17941da7cb0f57bf813fcb63ae4bd2d81f37672}{TensorBlockShapeType::kUniformAllDims}},}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ size\_in\_bytes);}
\DoxyCodeLine{00134\ \ \ \}}
\DoxyCodeLine{00135\ }
\DoxyCodeLine{00136\ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}}
\DoxyCodeLine{00137\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements}{TensorBlockResourceRequirements}}}
\DoxyCodeLine{00138\ \ \ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements_a93330d19dc8f0b6946892ec9631af524}{merge}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements}{TensorBlockResourceRequirements}}\&\ lhs,}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements}{TensorBlockResourceRequirements}}\&\ rhs)\ \{}
\DoxyCodeLine{00140\ \ \ \ \ \textcolor{keywordflow}{return}\ \{\mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements_a93330d19dc8f0b6946892ec9631af524}{merge}}(lhs.shape\_type,\ rhs.shape\_type),\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ shape\_type}}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements_a93330d19dc8f0b6946892ec9631af524}{merge}}(lhs.size,\ rhs.size),\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ size}}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements_a93330d19dc8f0b6946892ec9631af524}{merge}}(lhs.cost\_per\_coeff,\ rhs.cost\_per\_coeff)\};\ \ \textcolor{comment}{//\ cost\_per\_coeff}}
\DoxyCodeLine{00143\ \ \ \}}
\DoxyCodeLine{00144\ }
\DoxyCodeLine{00145\ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements}{TensorBlockResourceRequirements}}\&\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements_aba0b94718b690fe359df235db10acca7}{addCostPerCoeff}}(}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \mbox{\hyperlink{classEigen_1_1TensorOpCost}{TensorOpCost}}\ cost)\ \{}
\DoxyCodeLine{00147\ \ \ \ \ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements_ab30180b31f9d530f1f580d4709f8e4a0}{cost\_per\_coeff}}\ +=\ cost;}
\DoxyCodeLine{00148\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00149\ \ \ \}}
\DoxyCodeLine{00150\ }
\DoxyCodeLine{00151\ \ \ \textcolor{comment}{//\ This\ is\ a\ resource\ requirement\ that\ should\ be\ returned\ from\ expressions}}
\DoxyCodeLine{00152\ \ \ \textcolor{comment}{//\ that\ do\ not\ have\ any\ block\ evaluation\ preference\ (e.g.\ default\ tensor}}
\DoxyCodeLine{00153\ \ \ \textcolor{comment}{//\ expression\ with\ raw\ buffer\ access).}}
\DoxyCodeLine{00154\ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}}
\DoxyCodeLine{00155\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements}{TensorBlockResourceRequirements}}\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements_a8a5ae7f46e67679dffc4a94eed61fc43}{any}}()\ \{}
\DoxyCodeLine{00156\ \ \ \ \ \textcolor{keywordflow}{return}\ \{\mbox{\hyperlink{namespaceEigen_1_1internal_af8b5cefcff8749f792756a379a17941da7cb0f57bf813fcb63ae4bd2d81f37672}{TensorBlockShapeType::kUniformAllDims}},\ 1,\ \{0,\ 0,\ 0\}\};}
\DoxyCodeLine{00157\ \ \ \}}
\DoxyCodeLine{00158\ }
\DoxyCodeLine{00159\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00160\ \ \ \textcolor{keyword}{using\ }Requirements\ =\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements}{TensorBlockResourceRequirements}};}
\DoxyCodeLine{00161\ }
\DoxyCodeLine{00162\ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}}
\DoxyCodeLine{00163\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements_a93330d19dc8f0b6946892ec9631af524}{merge}}(\textcolor{keywordtype}{size\_t}\ lhs\_size,\ \textcolor{keywordtype}{size\_t}\ rhs\_size)\ \{}
\DoxyCodeLine{00164\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespaceEigen_1_1numext_a29d502349f2ec9897c808e65e0f96eb4}{numext::maxi}}(lhs\_size,\ rhs\_size);}
\DoxyCodeLine{00165\ \ \ \}}
\DoxyCodeLine{00166\ }
\DoxyCodeLine{00167\ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}}
\DoxyCodeLine{00168\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \mbox{\hyperlink{namespaceEigen_1_1internal_af8b5cefcff8749f792756a379a17941d}{TensorBlockShapeType}}}
\DoxyCodeLine{00169\ \ \ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements_a93330d19dc8f0b6946892ec9631af524}{merge}}(\mbox{\hyperlink{namespaceEigen_1_1internal_af8b5cefcff8749f792756a379a17941d}{TensorBlockShapeType}}\ lhs,\ \mbox{\hyperlink{namespaceEigen_1_1internal_af8b5cefcff8749f792756a379a17941d}{TensorBlockShapeType}}\ rhs)\ \{}
\DoxyCodeLine{00170\ \ \ \ \ \textcolor{keywordflow}{return}\ (lhs\ ==\ \mbox{\hyperlink{namespaceEigen_1_1internal_af8b5cefcff8749f792756a379a17941daeaeafd3133ead02c0e0ffd56f2401a47}{TensorBlockShapeType::kSkewedInnerDims}}\ ||}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ \ \ \ \ rhs\ ==\ \mbox{\hyperlink{namespaceEigen_1_1internal_af8b5cefcff8749f792756a379a17941daeaeafd3133ead02c0e0ffd56f2401a47}{TensorBlockShapeType::kSkewedInnerDims}})}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ?\ \mbox{\hyperlink{namespaceEigen_1_1internal_af8b5cefcff8749f792756a379a17941daeaeafd3133ead02c0e0ffd56f2401a47}{TensorBlockShapeType::kSkewedInnerDims}}}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{namespaceEigen_1_1internal_af8b5cefcff8749f792756a379a17941da7cb0f57bf813fcb63ae4bd2d81f37672}{TensorBlockShapeType::kUniformAllDims}};}
\DoxyCodeLine{00174\ \ \ \}}
\DoxyCodeLine{00175\ }
\DoxyCodeLine{00176\ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}}
\DoxyCodeLine{00177\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ TensorOpCost\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements_a93330d19dc8f0b6946892ec9631af524}{merge}}(TensorOpCost\ lhs\_cost,}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ TensorOpCost\ rhs\_cost)\ \{}
\DoxyCodeLine{00179\ \ \ \ \ \textcolor{keywordflow}{return}\ lhs\_cost\ +\ rhs\_cost;}
\DoxyCodeLine{00180\ \ \ \}}
\DoxyCodeLine{00181\ \};}
\DoxyCodeLine{00182\ }
\DoxyCodeLine{00183\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ //}}
\DoxyCodeLine{00184\ \textcolor{comment}{//\ TensorBlockDescriptor\ specifies\ a\ block\ offset\ within\ a\ tensor\ and\ the\ block}}
\DoxyCodeLine{00185\ \textcolor{comment}{//\ sizes\ along\ each\ of\ the\ tensor\ dimensions.}}
\DoxyCodeLine{00186\ }
\DoxyCodeLine{00187\ \textcolor{keyword}{template}\ <\textcolor{keywordtype}{int}\ NumDims,\ \textcolor{keyword}{typename}\ IndexType\ =\ Eigen::Index>}
\DoxyCodeLine{00188\ \textcolor{keyword}{class\ }TensorBlockDescriptor\ \{}
\DoxyCodeLine{00189\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00190\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{structEigen_1_1DSizes}{DSizes<IndexType,\ NumDims>}}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_a2e90aa5d687009f0e924088d71235b06}{Dimensions}};}
\DoxyCodeLine{00191\ }
\DoxyCodeLine{00192\ \ \ \textcolor{comment}{//\ If\ we\ evaluate\ a\ Tensor\ assignment,\ and\ expression\ on\ the\ left,\ already\ has}}
\DoxyCodeLine{00193\ \ \ \textcolor{comment}{//\ a\ memory\ buffer,\ then\ we\ might\ do\ performance\ optimization,\ and\ evaluate}}
\DoxyCodeLine{00194\ \ \ \textcolor{comment}{//\ the\ root\ expression\ directly\ into\ the\ final\ output\ memory.\ Some\ time\ it's}}
\DoxyCodeLine{00195\ \ \ \textcolor{comment}{//\ possible\ to\ reuse\ it\ for\ materializing\ subexpressions\ inside\ an\ expression}}
\DoxyCodeLine{00196\ \ \ \textcolor{comment}{//\ tree,\ to\ to\ avoid\ dynamic\ memory\ allocation.}}
\DoxyCodeLine{00197\ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00198\ \ \ \textcolor{comment}{//\ The\ pointer\ type\ of\ the\ underlying\ storage\ is\ erased,\ because\ passing}}
\DoxyCodeLine{00199\ \ \ \textcolor{comment}{//\ Scalar\ type\ through\ all\ the\ expression\ evaluation\ layers\ is\ way\ too\ many}}
\DoxyCodeLine{00200\ \ \ \textcolor{comment}{//\ templates.\ In\ practice\ destination\ buffer\ type\ should\ always\ match\ the}}
\DoxyCodeLine{00201\ \ \ \textcolor{comment}{//\ evaluated\ expression\ scalar\ type.}}
\DoxyCodeLine{00202\ \ \ \textcolor{keyword}{class\ }\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_1_1DestinationBuffer}{DestinationBuffer}}\ \{}
\DoxyCodeLine{00203\ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00204\ \ \ \ \ \textcolor{keyword}{enum}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_1_1DestinationBuffer_a3184ea8e5d6744cd03dc1bae419feeea}{DestinationBufferKind}}\ :\ \textcolor{keywordtype}{int}\ \{}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \textcolor{comment}{//\ The\ above\ explicit\ specification\ of\ "{}int"{}\ as\ the\ enum\ basetype\ is}}
\DoxyCodeLine{00206\ \ \ \ \ \ \ \textcolor{comment}{//\ needed\ to\ get\ around\ a\ HIPCC\ link\ error\ ("{}the\ field\ type\ is\ not}}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \textcolor{comment}{//\ amp-\/compatible"{})}}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \textcolor{comment}{//\ which\ is\ issued\ for\ class\ members\ with\ the\ enum\ type.}}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \textcolor{comment}{//\ TODO(rocm):}}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \textcolor{comment}{//\ remove\ the\ "{}int"{}\ basetype\ once\ HIPCC\ has\ been\ fixed\ to\ not\ error\ out}}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \textcolor{comment}{//\ in\ the\ above\ scenario.}}
\DoxyCodeLine{00212\ }
\DoxyCodeLine{00213\ \ \ \ \ \ \ \textcolor{comment}{//\ Destination\ buffer\ is\ not\ defined\ (`m\_data`\ ==\ nullptr).}}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_1_1DestinationBuffer_a3184ea8e5d6744cd03dc1bae419feeeaae19ad38011a4e204773b3287f7614770}{kEmpty}},}
\DoxyCodeLine{00215\ }
\DoxyCodeLine{00216\ \ \ \ \ \ \ \textcolor{comment}{//\ Tensor\ block\ defined\ by\ an\ owning\ tensor\ block\ descriptor\ can\ fit}}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \textcolor{comment}{//\ contiguously\ into\ the\ destination\ buffer.\ In\ this\ case\ it's\ safe\ to}}
\DoxyCodeLine{00218\ \ \ \ \ \ \ \textcolor{comment}{//\ materialize\ tensor\ block\ in\ the\ destination\ buffer,\ wrap\ it\ in\ a}}
\DoxyCodeLine{00219\ \ \ \ \ \ \ \textcolor{comment}{//\ TensorMap,\ and\ use\ to\ build\ Eigen\ expression\ on\ top\ of\ it.}}
\DoxyCodeLine{00220\ \ \ \ \ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_1_1DestinationBuffer_a3184ea8e5d6744cd03dc1bae419feeeaa5ec32653d93954e1c3a35264fa63867a}{kContiguous}},}
\DoxyCodeLine{00221\ }
\DoxyCodeLine{00222\ \ \ \ \ \ \ \textcolor{comment}{//\ Destination\ buffer\ strides\ do\ not\ match\ strides\ of\ the\ contiguously}}
\DoxyCodeLine{00223\ \ \ \ \ \ \ \textcolor{comment}{//\ stored\ block,\ and\ it's\ impossible\ to\ define\ a\ TensorMap\ over\ this}}
\DoxyCodeLine{00224\ \ \ \ \ \ \ \textcolor{comment}{//\ buffer.\ However\ if\ we\ are\ evaluating\ a\ root\ of\ an\ expression\ tree,\ we}}
\DoxyCodeLine{00225\ \ \ \ \ \ \ \textcolor{comment}{//\ still\ can\ materialize\ an\ output\ into\ this\ destination,\ because\ we\ can}}
\DoxyCodeLine{00226\ \ \ \ \ \ \ \textcolor{comment}{//\ guarantee\ that\ no\ one\ will\ ever\ access\ it\ through\ block\ API.}}
\DoxyCodeLine{00227\ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00228\ \ \ \ \ \ \ \textcolor{comment}{//\ In\ theory\ it\ is\ possible\ to\ build\ valid\ TensorStriding<TensorMap>}}
\DoxyCodeLine{00229\ \ \ \ \ \ \ \textcolor{comment}{//\ expression\ on\ top\ of\ this\ destination\ buffer,\ however\ it\ has}}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \textcolor{comment}{//\ inefficient\ coeff/packet\ access,\ and\ defeats\ the\ purpose\ of\ fast\ block}}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \textcolor{comment}{//\ evaluation\ API.}}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_1_1DestinationBuffer_a3184ea8e5d6744cd03dc1bae419feeeaa0741173551ebe4cb1a2dff4717011b66}{kStrided}}}
\DoxyCodeLine{00233\ \ \ \ \ \};}
\DoxyCodeLine{00234\ }
\DoxyCodeLine{00235\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Scalar>}
\DoxyCodeLine{00236\ \ \ \ \ Scalar*\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_1_1DestinationBuffer_ac3e6e84ec91f54983c9215be89e4dde0}{data}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(m\_data\_type\_size\ ==\ \textcolor{keyword}{sizeof}(Scalar));}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}Scalar*\textcolor{keyword}{>}(m\_data);}
\DoxyCodeLine{00239\ \ \ \ \ \}}
\DoxyCodeLine{00240\ }
\DoxyCodeLine{00241\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1DSizes}{Dimensions}}\&\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_1_1DestinationBuffer_a1587695f7bd516a1713c5cc67b771317}{strides}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ m\_strides;\ \}}
\DoxyCodeLine{00242\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_1_1DestinationBuffer_a3184ea8e5d6744cd03dc1bae419feeea}{DestinationBufferKind}}\&\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_1_1DestinationBuffer_a6a89d849d7e983850f0fbaccdb1d62f9}{kind}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ m\_kind;\ \}}
\DoxyCodeLine{00243\ }
\DoxyCodeLine{00244\ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00245\ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor}{TensorBlockDescriptor}};}
\DoxyCodeLine{00246\ }
\DoxyCodeLine{00247\ \ \ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_1_1DestinationBuffer}{DestinationBuffer}}()\ :\ m\_data(NULL),\ m\_data\_type\_size(0),\ m\_kind(\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_1_1DestinationBuffer_a3184ea8e5d6744cd03dc1bae419feeeaae19ad38011a4e204773b3287f7614770}{kEmpty}})\ \{\}}
\DoxyCodeLine{00248\ }
\DoxyCodeLine{00249\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Scalar>}
\DoxyCodeLine{00250\ \ \ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_1_1DestinationBuffer}{DestinationBuffer}}(Scalar*\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_1_1DestinationBuffer_ac3e6e84ec91f54983c9215be89e4dde0}{data}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1DSizes}{Dimensions}}\&\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_1_1DestinationBuffer_a1587695f7bd516a1713c5cc67b771317}{strides}},}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_1_1DestinationBuffer_a3184ea8e5d6744cd03dc1bae419feeea}{DestinationBufferKind}}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_1_1DestinationBuffer_a6a89d849d7e983850f0fbaccdb1d62f9}{kind}})}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ :\ m\_data(static\_cast<void*>(\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_1_1DestinationBuffer_ac3e6e84ec91f54983c9215be89e4dde0}{data}})),}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \ \ \ \ m\_data\_type\_size(sizeof(Scalar)),}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ \ \ m\_strides(\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_1_1DestinationBuffer_a1587695f7bd516a1713c5cc67b771317}{strides}}),}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ \ \ m\_kind(\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_1_1DestinationBuffer_a6a89d849d7e983850f0fbaccdb1d62f9}{kind}})\ \{\}}
\DoxyCodeLine{00256\ }
\DoxyCodeLine{00257\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keywordtype}{int}\ Layout,\ \textcolor{keyword}{typename}\ Scalar>}
\DoxyCodeLine{00258\ \ \ \ \ \textcolor{keyword}{static}\ DestinationBuffer\ make(\textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor}{TensorBlockDescriptor}}\&\ desc,}
\DoxyCodeLine{00259\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Scalar*\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_1_1DestinationBuffer_ac3e6e84ec91f54983c9215be89e4dde0}{data}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_a2e90aa5d687009f0e924088d71235b06}{Dimensions}}\&\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_1_1DestinationBuffer_a1587695f7bd516a1713c5cc67b771317}{strides}})\ \{}
\DoxyCodeLine{00260\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ DestinationBuffer(\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_1_1DestinationBuffer_ac3e6e84ec91f54983c9215be89e4dde0}{data}},\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_1_1DestinationBuffer_a1587695f7bd516a1713c5cc67b771317}{strides}},\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_1_1DestinationBuffer_a6a89d849d7e983850f0fbaccdb1d62f9}{kind<Layout>}}(desc,\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_1_1DestinationBuffer_a1587695f7bd516a1713c5cc67b771317}{strides}}));}
\DoxyCodeLine{00261\ \ \ \ \ \}}
\DoxyCodeLine{00262\ }
\DoxyCodeLine{00263\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keywordtype}{int}\ Layout>}
\DoxyCodeLine{00264\ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_1_1DestinationBuffer_a3184ea8e5d6744cd03dc1bae419feeea}{DestinationBufferKind}}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_1_1DestinationBuffer_a6a89d849d7e983850f0fbaccdb1d62f9}{kind}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_1_1DestinationBuffer_ae9828db527a4bb19e1e7ff87a1c10cb9}{TensorBlockDescriptor}}\&\ desc,}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_a2e90aa5d687009f0e924088d71235b06}{Dimensions}}\&\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_1_1DestinationBuffer_a1587695f7bd516a1713c5cc67b771317}{strides}})\ \{}
\DoxyCodeLine{00266\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_a2e90aa5d687009f0e924088d71235b06}{Dimensions}}\&\ desc\_dims\ =\ desc.dimensions();}
\DoxyCodeLine{00267\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_a2e90aa5d687009f0e924088d71235b06}{Dimensions}}\&\ desc\_strides\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_ae6bac895069b4299831c59aeb680ce3e}{internal::strides<Layout>}}(desc\_dims);}
\DoxyCodeLine{00268\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ NumDims;\ ++\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ \{}
\DoxyCodeLine{00269\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (desc\_dims[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}]\ ==\ 1)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00270\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (desc\_strides[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}]\ !=\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_1_1DestinationBuffer_a1587695f7bd516a1713c5cc67b771317}{strides}}[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}])\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_1_1DestinationBuffer_a3184ea8e5d6744cd03dc1bae419feeeaa0741173551ebe4cb1a2dff4717011b66}{kStrided}};}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00272\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_1_1DestinationBuffer_a3184ea8e5d6744cd03dc1bae419feeeaa5ec32653d93954e1c3a35264fa63867a}{kContiguous}};}
\DoxyCodeLine{00273\ \ \ \ \ \}}
\DoxyCodeLine{00274\ }
\DoxyCodeLine{00275\ \ \ \ \ \textcolor{comment}{//\ Storage\ pointer\ is\ type\ erased,\ to\ reduce\ template\ bloat,\ but\ we\ still}}
\DoxyCodeLine{00276\ \ \ \ \ \textcolor{comment}{//\ keep\ the\ size\ of\ the\ underlying\ element\ type\ for\ error\ checking.}}
\DoxyCodeLine{00277\ \ \ \ \ \textcolor{keywordtype}{void}*\ m\_data;}
\DoxyCodeLine{00278\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ m\_data\_type\_size;}
\DoxyCodeLine{00279\ }
\DoxyCodeLine{00280\ \ \ \ \ \textcolor{comment}{//\ Destination\ buffer\ dimensions\ always\ match\ the\ dimensions\ of\ a\ tensor}}
\DoxyCodeLine{00281\ \ \ \ \ \textcolor{comment}{//\ block\ descriptor\ it\ belongs\ to,\ however\ strides\ might\ be\ different.}}
\DoxyCodeLine{00282\ \ \ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_a2e90aa5d687009f0e924088d71235b06}{Dimensions}}\ m\_strides;}
\DoxyCodeLine{00283\ }
\DoxyCodeLine{00284\ \ \ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_1_1DestinationBuffer_a3184ea8e5d6744cd03dc1bae419feeea}{DestinationBufferKind}}\ m\_kind;}
\DoxyCodeLine{00285\ \ \ \};}
\DoxyCodeLine{00286\ }
\DoxyCodeLine{00287\ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_aca5bf8c1fb818e5d982a57353b925d9b}{TensorBlockDescriptor}}(\textcolor{keyword}{const}\ IndexType\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_a686be958df6a4ab77f9b6832cd1b8f96}{offset}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1DSizes}{Dimensions}}\&\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_aad3784ea0105aa915630b3ecbbdd35c7}{dimensions}},}
\DoxyCodeLine{00288\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_1_1DestinationBuffer}{DestinationBuffer}}\&\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_a3f532ad0c2916de6f1e7f994614c0063}{destination}})}
\DoxyCodeLine{00289\ \ \ \ \ \ \ :\ m\_offset(\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_a686be958df6a4ab77f9b6832cd1b8f96}{offset}}),}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ m\_dimensions(\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_aad3784ea0105aa915630b3ecbbdd35c7}{dimensions}}),}
\DoxyCodeLine{00291\ \ \ \ \ \ \ \ \ m\_destination(\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_a3f532ad0c2916de6f1e7f994614c0063}{destination}})\ \{\}}
\DoxyCodeLine{00292\ }
\DoxyCodeLine{00293\ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_ae07d1bfe1b59a7d332a0ac8a95501062}{TensorBlockDescriptor}}(\textcolor{keyword}{const}\ IndexType\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_a686be958df6a4ab77f9b6832cd1b8f96}{offset}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1DSizes}{Dimensions}}\&\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_aad3784ea0105aa915630b3ecbbdd35c7}{dimensions}})}
\DoxyCodeLine{00294\ \ \ \ \ \ \ :\ m\_offset(\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_a686be958df6a4ab77f9b6832cd1b8f96}{offset}}),}
\DoxyCodeLine{00295\ \ \ \ \ \ \ \ \ m\_dimensions(\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_aad3784ea0105aa915630b3ecbbdd35c7}{dimensions}}),}
\DoxyCodeLine{00296\ \ \ \ \ \ \ \ \ m\_destination(\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_1_1DestinationBuffer}{DestinationBuffer}}())\ \{\}}
\DoxyCodeLine{00297\ }
\DoxyCodeLine{00298\ \ \ IndexType\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_a686be958df6a4ab77f9b6832cd1b8f96}{offset}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ m\_offset;\ \}}
\DoxyCodeLine{00299\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1DSizes}{Dimensions}}\&\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_aad3784ea0105aa915630b3ecbbdd35c7}{dimensions}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ m\_dimensions;\ \}}
\DoxyCodeLine{00300\ \ \ IndexType\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_a89c4bf7986164e0cfe376181e9032ed4}{dimension}}(\textcolor{keywordtype}{int}\ index)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ m\_dimensions[index];\ \}}
\DoxyCodeLine{00301\ \ \ IndexType\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_a595bc99b9603c07e17f9f26a4e8d71f0}{size}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespaceEigen_1_1internal_a3b99e338d92a91c8b3f89d32d0ca2c39}{array\_prod<IndexType>}}(m\_dimensions);\ \}}
\DoxyCodeLine{00302\ }
\DoxyCodeLine{00303\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_1_1DestinationBuffer}{DestinationBuffer}}\&\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_a3f532ad0c2916de6f1e7f994614c0063}{destination}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ m\_destination;\ \}}
\DoxyCodeLine{00304\ }
\DoxyCodeLine{00305\ \ \ \textcolor{keyword}{template}\ <\textcolor{keywordtype}{int}\ Layout,\ \textcolor{keyword}{typename}\ Scalar>}
\DoxyCodeLine{00306\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_a3b775d906d4ccfa8586694513d8eb5fc}{AddDestinationBuffer}}(Scalar*\ dst\_base,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1DSizes}{Dimensions}}\&\ dst\_strides)\ \{}
\DoxyCodeLine{00307\ \ \ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(dst\_base\ !=\ NULL);}
\DoxyCodeLine{00308\ \ \ \ \ m\_destination\ =}
\DoxyCodeLine{00309\ \ \ \ \ \ \ \ \ DestinationBuffer::template\ make<Layout>(*\textcolor{keyword}{this},\ dst\_base,\ dst\_strides);}
\DoxyCodeLine{00310\ \ \ \}}
\DoxyCodeLine{00311\ }
\DoxyCodeLine{00312\ \ \ \textcolor{keyword}{template}\ <\textcolor{keywordtype}{int}\ Layout,\ \textcolor{keyword}{typename}\ Scalar,\ \textcolor{keyword}{typename}\ DstStr\textcolor{keywordtype}{id}esIndexType>}
\DoxyCodeLine{00313\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_a1813ea107b72b29db56c17f9c92d9e47}{AddDestinationBuffer}}(}
\DoxyCodeLine{00314\ \ \ \ \ \ \ Scalar*\ dst\_base,}
\DoxyCodeLine{00315\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1DSizes}{DSizes<DstStridesIndexType,\ NumDims>}}\&\ dst\_strides)\ \{}
\DoxyCodeLine{00316\ \ \ \ \ \textcolor{comment}{//\ DSizes\ constructor\ will\ do\ index\ type\ promotion\ if\ it's\ safe.}}
\DoxyCodeLine{00317\ \ \ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_a3b775d906d4ccfa8586694513d8eb5fc}{AddDestinationBuffer<Layout>}}(dst\_base,\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_a2e90aa5d687009f0e924088d71235b06}{Dimensions}}(dst\_strides));}
\DoxyCodeLine{00318\ \ \ \}}
\DoxyCodeLine{00319\ }
\DoxyCodeLine{00320\ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor}{TensorBlockDescriptor}}\&\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_adc355a74e7b1fc154f8e0f5a740a7086}{DropDestinationBuffer}}()\ \{}
\DoxyCodeLine{00321\ \ \ \ \ m\_destination.m\_data\ =\ NULL;}
\DoxyCodeLine{00322\ \ \ \ \ m\_destination.m\_kind\ =\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_1_1DestinationBuffer_a3184ea8e5d6744cd03dc1bae419feeeaae19ad38011a4e204773b3287f7614770}{DestinationBuffer::kEmpty}};}
\DoxyCodeLine{00323\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00324\ \ \ \}}
\DoxyCodeLine{00325\ }
\DoxyCodeLine{00326\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_a6f411bdb93e39a081d05b21690494433}{HasDestinationBuffer}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00327\ \ \ \ \ \textcolor{keywordflow}{return}\ m\_destination.\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_1_1DestinationBuffer_a6a89d849d7e983850f0fbaccdb1d62f9}{kind}}()\ !=\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_1_1DestinationBuffer_a3184ea8e5d6744cd03dc1bae419feeeaae19ad38011a4e204773b3287f7614770}{DestinationBuffer::kEmpty}};}
\DoxyCodeLine{00328\ \ \ \}}
\DoxyCodeLine{00329\ }
\DoxyCodeLine{00330\ \ \ \textcolor{comment}{//\ Returns\ a\ copy\ of\ \`{}*this`\ with\ updated\ offset.}}
\DoxyCodeLine{00331\ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor}{TensorBlockDescriptor}}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_a0397df4c198c8c066fdcd01ce8e16bb7}{WithOffset}}(IndexType\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_a686be958df6a4ab77f9b6832cd1b8f96}{offset}})\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00332\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_aca5bf8c1fb818e5d982a57353b925d9b}{TensorBlockDescriptor}}(\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_a686be958df6a4ab77f9b6832cd1b8f96}{offset}},\ m\_dimensions,\ m\_destination);}
\DoxyCodeLine{00333\ \ \ \}}
\DoxyCodeLine{00334\ }
\DoxyCodeLine{00335\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00336\ \ \ \textcolor{comment}{//\ Offset\ and\ dimensions\ are\ immutable\ after\ construction.\ Block\ descriptor}}
\DoxyCodeLine{00337\ \ \ \textcolor{comment}{//\ can\ only\ be\ mutated\ by\ adding\ or\ dropping\ destination.}}
\DoxyCodeLine{00338\ \ \ \textcolor{keyword}{const}\ IndexType\ m\_offset;}
\DoxyCodeLine{00339\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_a2e90aa5d687009f0e924088d71235b06}{Dimensions}}\ m\_dimensions;}
\DoxyCodeLine{00340\ \ \ DestinationBuffer\ m\_destination;}
\DoxyCodeLine{00341\ \};}
\DoxyCodeLine{00342\ }
\DoxyCodeLine{00343\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ //}}
\DoxyCodeLine{00344\ \textcolor{comment}{//\ TensorBlockMapper\ is\ responsible\ for\ iterating\ over\ the\ blocks\ of\ a\ tensor.}}
\DoxyCodeLine{00345\ }
\DoxyCodeLine{00346\ \textcolor{keyword}{template}\ <\textcolor{keywordtype}{int}\ NumDims,\ \textcolor{keywordtype}{int}\ Layout,\ \textcolor{keyword}{typename}\ IndexType\ =\ Eigen::Index>}
\DoxyCodeLine{00347\ \textcolor{keyword}{class\ }TensorBlockMapper\ \{}
\DoxyCodeLine{00348\ \ \ \textcolor{keyword}{typedef}\ TensorBlockDescriptor<NumDims,\ IndexType>\ BlockDescriptor;}
\DoxyCodeLine{00349\ }
\DoxyCodeLine{00350\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00351\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{structEigen_1_1DSizes}{DSizes<IndexType,\ NumDims>}}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockMapper_ae50b21cf0c501ee48ad6f09996511b6c}{Dimensions}};}
\DoxyCodeLine{00352\ }
\DoxyCodeLine{00353\ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockMapper_ab608fa4a0164c82f35e7142dc766b437}{TensorBlockMapper}}()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00354\ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockMapper_a2914ace578bce3ea2991255d66efeb0a}{TensorBlockMapper}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1DSizes}{DSizes<IndexType,\ NumDims>}}\&\ dimensions,}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements}{TensorBlockResourceRequirements}}\&\ requirements)}
\DoxyCodeLine{00356\ \ \ \ \ \ \ :\ m\_tensor\_dimensions(dimensions),\ m\_requirements(requirements)\ \{}
\DoxyCodeLine{00357\ \ \ \ \ \textcolor{comment}{//\ Compute\ block\ dimensions\ and\ the\ total\ number\ of\ blocks.}}
\DoxyCodeLine{00358\ \ \ \ \ InitializeBlockDimensions();}
\DoxyCodeLine{00359\ \ \ \}}
\DoxyCodeLine{00360\ }
\DoxyCodeLine{00361\ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}\ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ IndexType\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockMapper_a55d59205aa759a6a09d983d0da972415}{blockCount}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00362\ \ \ \ \ \textcolor{keywordflow}{return}\ m\_total\_block\_count;}
\DoxyCodeLine{00363\ \ \ \}}
\DoxyCodeLine{00364\ }
\DoxyCodeLine{00365\ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}\ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ IndexType\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockMapper_ab740d683f57662751c42ba522121c8f1}{blockTotalSize}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00366\ \ \ \ \ \textcolor{keywordflow}{return}\ m\_block\_dimensions.\mbox{\hyperlink{structEigen_1_1DSizes_aaa880c9fd53051ef158094e1e529e1f0}{TotalSize}}();}
\DoxyCodeLine{00367\ \ \ \}}
\DoxyCodeLine{00368\ }
\DoxyCodeLine{00369\ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}\ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1DSizes}{DSizes<IndexType,\ NumDims>}}\&}
\DoxyCodeLine{00370\ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockMapper_ad1e968ac1247207202ce3a959007a3d6}{blockDimensions}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00371\ \ \ \ \ \textcolor{keywordflow}{return}\ m\_block\_dimensions;}
\DoxyCodeLine{00372\ \ \ \}}
\DoxyCodeLine{00373\ }
\DoxyCodeLine{00374\ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}\ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ BlockDescriptor}
\DoxyCodeLine{00375\ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockMapper_afd53a52193236e8096f9f2e912a9807a}{blockDescriptor}}(IndexType\ block\_index)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00376\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ isColMajor\ =\ Layout\ ==\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(\mbox{\hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13a0cbd4bdd0abcfc0224c5fcb5e4f6669a}{ColMajor}});}
\DoxyCodeLine{00377\ }
\DoxyCodeLine{00378\ \ \ \ \ IndexType\ offset\ =\ 0;}
\DoxyCodeLine{00379\ \ \ \ \ \mbox{\hyperlink{structEigen_1_1DSizes}{DSizes<IndexType,\ NumDims>}}\ dimensions;}
\DoxyCodeLine{00380\ }
\DoxyCodeLine{00381\ \ \ \ \ \textcolor{keywordflow}{if}\ (NumDims\ ==\ 0)\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor}{BlockDescriptor}}(offset,\ dimensions);}
\DoxyCodeLine{00382\ }
\DoxyCodeLine{00383\ \ \ \ \ \textcolor{comment}{//\ Iterate\ outer\ -\/>\ inner\ dimensions.}}
\DoxyCodeLine{00384\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ NumDims\ -\/\ 1;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ >=\ 0;\ -\/-\/\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ \{}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ dim\ =\ isColMajor\ ?\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ :\ NumDims\ -\/\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ -\/\ 1;}
\DoxyCodeLine{00386\ }
\DoxyCodeLine{00387\ \ \ \ \ \ \ \textcolor{keyword}{const}\ IndexType\ idx\ =\ block\_index\ /\ m\_block\_strides[dim];}
\DoxyCodeLine{00388\ \ \ \ \ \ \ block\_index\ -\/=\ idx\ *\ m\_block\_strides[dim];}
\DoxyCodeLine{00389\ }
\DoxyCodeLine{00390\ \ \ \ \ \ \ \textcolor{keyword}{const}\ IndexType\ coord\ =\ idx\ *\ m\_block\_dimensions[dim];}
\DoxyCodeLine{00391\ \ \ \ \ \ \ dimensions[dim]\ =\ \mbox{\hyperlink{namespaceEigen_1_1numext_ab3b30bf0bcfa1ad91dbec75fabb3bea0}{numext::mini}}(m\_tensor\_dimensions[dim]\ -\/\ coord,}
\DoxyCodeLine{00392\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_block\_dimensions[dim]);}
\DoxyCodeLine{00393\ \ \ \ \ \ \ offset\ +=\ coord\ *\ m\_tensor\_strides[dim];}
\DoxyCodeLine{00394\ \ \ \ \ \}}
\DoxyCodeLine{00395\ }
\DoxyCodeLine{00396\ \ \ \ \ \textcolor{keywordflow}{return}\ \{offset,\ dimensions\};}
\DoxyCodeLine{00397\ \ \ \}}
\DoxyCodeLine{00398\ }
\DoxyCodeLine{00399\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00400\ \ \ \textcolor{keywordtype}{void}\ InitializeBlockDimensions()\ \{}
\DoxyCodeLine{00401\ \ \ \ \ \textcolor{comment}{//\ Requested\ block\ shape\ and\ size.}}
\DoxyCodeLine{00402\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_1_1internal_af8b5cefcff8749f792756a379a17941d}{TensorBlockShapeType}}\ shape\_type\ =\ m\_requirements.\mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements_ab9ec777dfae8b80991da086a4d96493a}{shape\_type}};}
\DoxyCodeLine{00403\ \ \ \ \ IndexType\ target\_block\_size\ =}
\DoxyCodeLine{00404\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceEigen_1_1numext_a29d502349f2ec9897c808e65e0f96eb4}{numext::maxi<IndexType>}}(1,\ \textcolor{keyword}{static\_cast<}IndexType\textcolor{keyword}{>}(m\_requirements.\mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockResourceRequirements_a9222a177f35b7f4ffeda380409b6ad9b}{size}}));}
\DoxyCodeLine{00405\ }
\DoxyCodeLine{00406\ \ \ \ \ IndexType\ tensor\_size\ =\ m\_tensor\_dimensions.\mbox{\hyperlink{structEigen_1_1DSizes_aaa880c9fd53051ef158094e1e529e1f0}{TotalSize}}();}
\DoxyCodeLine{00407\ }
\DoxyCodeLine{00408\ \ \ \ \ \textcolor{comment}{//\ Corner\ case:\ one\ of\ the\ dimensions\ is\ zero.\ Logic\ below\ is\ too\ complex}}
\DoxyCodeLine{00409\ \ \ \ \ \textcolor{comment}{//\ to\ handle\ this\ case\ on\ a\ general\ basis,\ just\ use\ unit\ block\ size.}}
\DoxyCodeLine{00410\ \ \ \ \ \textcolor{comment}{//\ Note:\ we\ must\ not\ yield\ blocks\ with\ zero\ dimensions\ (recipe\ for}}
\DoxyCodeLine{00411\ \ \ \ \ \textcolor{comment}{//\ overflows/underflows,\ divisions\ by\ zero\ and\ NaNs\ later).}}
\DoxyCodeLine{00412\ \ \ \ \ \textcolor{keywordflow}{if}\ (tensor\_size\ ==\ 0)\ \{}
\DoxyCodeLine{00413\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ NumDims;\ ++\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ \{}
\DoxyCodeLine{00414\ \ \ \ \ \ \ \ \ m\_block\_dimensions[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}]\ =\ 1;}
\DoxyCodeLine{00415\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00416\ \ \ \ \ \ \ m\_total\_block\_count\ =\ 0;}
\DoxyCodeLine{00417\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00418\ \ \ \ \ \}}
\DoxyCodeLine{00419\ }
\DoxyCodeLine{00420\ \ \ \ \ \textcolor{comment}{//\ If\ tensor\ fits\ into\ a\ target\ block\ size,\ evaluate\ it\ as\ a\ single\ block.}}
\DoxyCodeLine{00421\ \ \ \ \ \textcolor{keywordflow}{if}\ (tensor\_size\ <=\ target\_block\_size)\ \{}
\DoxyCodeLine{00422\ \ \ \ \ \ \ m\_block\_dimensions\ =\ m\_tensor\_dimensions;}
\DoxyCodeLine{00423\ \ \ \ \ \ \ m\_total\_block\_count\ =\ 1;}
\DoxyCodeLine{00424\ \ \ \ \ \ \ \textcolor{comment}{//\ The\ only\ valid\ block\ index\ is\ \`{}0`,\ and\ in\ this\ case\ we\ do\ not\ need}}
\DoxyCodeLine{00425\ \ \ \ \ \ \ \textcolor{comment}{//\ to\ compute\ real\ strides\ for\ tensor\ or\ blocks\ (see\ blockDescriptor).}}
\DoxyCodeLine{00426\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ NumDims;\ ++\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ \{}
\DoxyCodeLine{00427\ \ \ \ \ \ \ \ \ m\_tensor\_strides[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}]\ =\ 0;}
\DoxyCodeLine{00428\ \ \ \ \ \ \ \ \ m\_block\_strides[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}]\ =\ 1;}
\DoxyCodeLine{00429\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00430\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00431\ \ \ \ \ \}}
\DoxyCodeLine{00432\ }
\DoxyCodeLine{00433\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ isColMajor\ =\ Layout\ ==\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(\mbox{\hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13a0cbd4bdd0abcfc0224c5fcb5e4f6669a}{ColMajor}});}
\DoxyCodeLine{00434\ }
\DoxyCodeLine{00435\ \ \ \ \ \textcolor{comment}{//\ Block\ shape\ skewed\ towards\ inner\ dimension.}}
\DoxyCodeLine{00436\ \ \ \ \ \textcolor{keywordflow}{if}\ (shape\_type\ ==\ \mbox{\hyperlink{namespaceEigen_1_1internal_af8b5cefcff8749f792756a379a17941daeaeafd3133ead02c0e0ffd56f2401a47}{TensorBlockShapeType::kSkewedInnerDims}})\ \{}
\DoxyCodeLine{00437\ \ \ \ \ \ \ IndexType\ coeff\_to\_allocate\ =\ target\_block\_size;}
\DoxyCodeLine{00438\ }
\DoxyCodeLine{00439\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ NumDims;\ ++\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ \{}
\DoxyCodeLine{00440\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ dim\ =\ isColMajor\ ?\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ :\ NumDims\ -\/\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ -\/\ 1;}
\DoxyCodeLine{00441\ \ \ \ \ \ \ \ \ m\_block\_dimensions[dim]\ =}
\DoxyCodeLine{00442\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceEigen_1_1numext_ab3b30bf0bcfa1ad91dbec75fabb3bea0}{numext::mini}}(coeff\_to\_allocate,\ m\_tensor\_dimensions[dim]);}
\DoxyCodeLine{00443\ \ \ \ \ \ \ \ \ coeff\_to\_allocate\ =\ \mbox{\hyperlink{namespaceEigen_a13ec9832931270b80961236d30f6d2e3}{divup}}(}
\DoxyCodeLine{00444\ \ \ \ \ \ \ \ \ \ \ \ \ coeff\_to\_allocate,}
\DoxyCodeLine{00445\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceEigen_1_1numext_a29d502349f2ec9897c808e65e0f96eb4}{numext::maxi}}(\textcolor{keyword}{static\_cast<}IndexType\textcolor{keyword}{>}(1),\ m\_block\_dimensions[dim]));}
\DoxyCodeLine{00446\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00447\ \ \ \ \ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(coeff\_to\_allocate\ ==\ 1);}
\DoxyCodeLine{00448\ }
\DoxyCodeLine{00449\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (shape\_type\ ==\ \mbox{\hyperlink{namespaceEigen_1_1internal_af8b5cefcff8749f792756a379a17941da7cb0f57bf813fcb63ae4bd2d81f37672}{TensorBlockShapeType::kUniformAllDims}})\ \{}
\DoxyCodeLine{00450\ \ \ \ \ \ \ \textcolor{comment}{//\ Tensor\ will\ not\ fit\ within\ 'target\_block\_size'\ budget:\ calculate\ tensor}}
\DoxyCodeLine{00451\ \ \ \ \ \ \ \textcolor{comment}{//\ block\ dimension\ sizes\ based\ on\ "{}square"{}\ dimension\ size\ target.}}
\DoxyCodeLine{00452\ \ \ \ \ \ \ \textcolor{keyword}{const}\ IndexType\ dim\_size\_target\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_a66f17ef65b1821965dcb8ad9a660b064}{convert\_index<IndexType>}}(}
\DoxyCodeLine{00453\ \ \ \ \ \ \ \ \ \ \ std::pow(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(target\_block\_size),}
\DoxyCodeLine{00454\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1.0f\ /\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(m\_block\_dimensions.\mbox{\hyperlink{structEigen_1_1DSizes_ab4c9d5b27ab311e394a886e5bb99f35a}{rank}}())));}
\DoxyCodeLine{00455\ }
\DoxyCodeLine{00456\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ NumDims;\ ++\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ \{}
\DoxyCodeLine{00457\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ TODO(andydavis)\ Adjust\ the\ inner\ most\ 'block\_dim\_size'\ to\ make\ it}}
\DoxyCodeLine{00458\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ a\ multiple\ of\ the\ packet\ size.\ Note\ that\ reducing}}
\DoxyCodeLine{00459\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ 'block\_dim\_size'\ in\ this\ manner\ can\ increase\ the\ number\ of}}
\DoxyCodeLine{00460\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ blocks,\ and\ so\ will\ amplify\ any\ per-\/block\ overhead.}}
\DoxyCodeLine{00461\ \ \ \ \ \ \ \ \ m\_block\_dimensions[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}]\ =}
\DoxyCodeLine{00462\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceEigen_1_1numext_ab3b30bf0bcfa1ad91dbec75fabb3bea0}{numext::mini}}(dim\_size\_target,\ m\_tensor\_dimensions[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}]);}
\DoxyCodeLine{00463\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00464\ }
\DoxyCodeLine{00465\ \ \ \ \ \ \ \textcolor{comment}{//\ Add\ any\ un-\/allocated\ coefficients\ to\ inner\ dimension(s).}}
\DoxyCodeLine{00466\ \ \ \ \ \ \ IndexType\ total\_size\ =\ m\_block\_dimensions.\mbox{\hyperlink{structEigen_1_1DSizes_aaa880c9fd53051ef158094e1e529e1f0}{TotalSize}}();}
\DoxyCodeLine{00467\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ NumDims;\ ++\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ \{}
\DoxyCodeLine{00468\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ dim\ =\ isColMajor\ ?\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ :\ NumDims\ -\/\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ -\/\ 1;}
\DoxyCodeLine{00469\ }
\DoxyCodeLine{00470\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_block\_dimensions[dim]\ <\ m\_tensor\_dimensions[dim])\ \{}
\DoxyCodeLine{00471\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ IndexType\ total\_size\_other\_dims\ =}
\DoxyCodeLine{00472\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ total\_size\ /\ m\_block\_dimensions[dim];}
\DoxyCodeLine{00473\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ IndexType\ alloc\_avail\ =}
\DoxyCodeLine{00474\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceEigen_a13ec9832931270b80961236d30f6d2e3}{divup<IndexType>}}(target\_block\_size,\ total\_size\_other\_dims);}
\DoxyCodeLine{00475\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (alloc\_avail\ ==\ m\_block\_dimensions[dim])\ \{}
\DoxyCodeLine{00476\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Insufficient\ excess\ coefficients\ to\ allocate.}}
\DoxyCodeLine{00477\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00478\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00479\ \ \ \ \ \ \ \ \ \ \ m\_block\_dimensions[dim]\ =}
\DoxyCodeLine{00480\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceEigen_1_1numext_ab3b30bf0bcfa1ad91dbec75fabb3bea0}{numext::mini}}(m\_tensor\_dimensions[dim],\ alloc\_avail);}
\DoxyCodeLine{00481\ \ \ \ \ \ \ \ \ \ \ total\_size\ =\ total\_size\_other\_dims\ *\ m\_block\_dimensions[dim];}
\DoxyCodeLine{00482\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00483\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00484\ }
\DoxyCodeLine{00485\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00486\ \ \ \ \ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(\textcolor{keyword}{false});\ \ \textcolor{comment}{//\ unknown\ block\ shape}}
\DoxyCodeLine{00487\ \ \ \ \ \}}
\DoxyCodeLine{00488\ }
\DoxyCodeLine{00489\ \ \ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(m\_block\_dimensions.\mbox{\hyperlink{structEigen_1_1DSizes_aaa880c9fd53051ef158094e1e529e1f0}{TotalSize}}()\ >=}
\DoxyCodeLine{00490\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceEigen_1_1numext_ab3b30bf0bcfa1ad91dbec75fabb3bea0}{numext::mini<IndexType>}}(target\_block\_size,}
\DoxyCodeLine{00491\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_tensor\_dimensions.\mbox{\hyperlink{structEigen_1_1DSizes_aaa880c9fd53051ef158094e1e529e1f0}{TotalSize}}()));}
\DoxyCodeLine{00492\ }
\DoxyCodeLine{00493\ \ \ \ \ \textcolor{comment}{//\ Calculate\ block\ counts\ by\ dimension\ and\ total\ block\ count.}}
\DoxyCodeLine{00494\ \ \ \ \ DSizes<IndexType,\ NumDims>\ block\_count;}
\DoxyCodeLine{00495\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ NumDims;\ ++\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ \{}
\DoxyCodeLine{00496\ \ \ \ \ \ \ block\_count[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}]\ =\ \mbox{\hyperlink{namespaceEigen_a13ec9832931270b80961236d30f6d2e3}{divup}}(m\_tensor\_dimensions[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}],\ m\_block\_dimensions[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}]);}
\DoxyCodeLine{00497\ \ \ \ \ \}}
\DoxyCodeLine{00498\ \ \ \ \ m\_total\_block\_count\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_a3b99e338d92a91c8b3f89d32d0ca2c39}{array\_prod}}(block\_count);}
\DoxyCodeLine{00499\ }
\DoxyCodeLine{00500\ \ \ \ \ \textcolor{comment}{//\ Calculate\ block\ strides\ (used\ for\ enumerating\ blocks).}}
\DoxyCodeLine{00501\ \ \ \ \ m\_tensor\_strides\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_ae6bac895069b4299831c59aeb680ce3e}{strides<Layout>}}(m\_tensor\_dimensions);}
\DoxyCodeLine{00502\ \ \ \ \ m\_block\_strides\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_ae6bac895069b4299831c59aeb680ce3e}{strides<Layout>}}(block\_count);}
\DoxyCodeLine{00503\ \ \ \}}
\DoxyCodeLine{00504\ }
\DoxyCodeLine{00505\ \ \ DSizes<IndexType,\ NumDims>\ m\_tensor\_dimensions;}
\DoxyCodeLine{00506\ \ \ TensorBlockResourceRequirements\ m\_requirements;}
\DoxyCodeLine{00507\ }
\DoxyCodeLine{00508\ \ \ DSizes<IndexType,\ NumDims>\ m\_block\_dimensions;}
\DoxyCodeLine{00509\ \ \ IndexType\ m\_total\_block\_count;}
\DoxyCodeLine{00510\ }
\DoxyCodeLine{00511\ \ \ DSizes<IndexType,\ NumDims>\ m\_tensor\_strides;}
\DoxyCodeLine{00512\ \ \ DSizes<IndexType,\ NumDims>\ m\_block\_strides;}
\DoxyCodeLine{00513\ \};}
\DoxyCodeLine{00514\ }
\DoxyCodeLine{00515\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ //}}
\DoxyCodeLine{00516\ \textcolor{comment}{//\ TensorBlockScratchAllocator\ is\ responsible\ for\ allocating\ temporary\ buffers}}
\DoxyCodeLine{00517\ \textcolor{comment}{//\ for\ block\ evaluation\ (output\ or\ input\ block\ materialization).\ Given\ that}}
\DoxyCodeLine{00518\ \textcolor{comment}{//\ Eigen\ expression\ traversal\ order\ is\ deterministic,\ all\ temporary\ allocations}}
\DoxyCodeLine{00519\ \textcolor{comment}{//\ are\ happening\ in\ the\ same\ order,\ and\ usually\ have\ exactly\ the\ same\ size.}}
\DoxyCodeLine{00520\ \textcolor{comment}{//\ Scratch\ allocator\ keeps\ a\ trace\ of\ all\ dynamic\ allocations,\ and\ after\ the}}
\DoxyCodeLine{00521\ \textcolor{comment}{//\ first\ block\ evaluation\ is\ completed,\ we\ should\ be\ able\ to\ reuse\ all\ the}}
\DoxyCodeLine{00522\ \textcolor{comment}{//\ temporary\ buffers\ for\ the\ next\ block\ evaluation.}}
\DoxyCodeLine{00523\ }
\DoxyCodeLine{00524\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Device>}
\DoxyCodeLine{00525\ \textcolor{keyword}{class\ }TensorBlockScratchAllocator\ \{}
\DoxyCodeLine{00526\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00527\ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockScratchAllocator_acd8c640849755c780d81026114a84307}{TensorBlockScratchAllocator}}(\textcolor{keyword}{const}\ Device\&\ device)}
\DoxyCodeLine{00528\ \ \ \ \ \ \ :\ m\_device(device),\ m\_allocation\_index(0)\ \{\}}
\DoxyCodeLine{00529\ }
\DoxyCodeLine{00530\ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockScratchAllocator_a7268f8d404084ddebb6bac735a54690e}{\string~TensorBlockScratchAllocator}}()\ \{}
\DoxyCodeLine{00531\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ m\_allocations.size();\ ++\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ \{}
\DoxyCodeLine{00532\ \ \ \ \ \ \ m\_device.deallocate(m\_allocations[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}].\mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2low__level__alloc__test_8cc_a935adc2e417a61d7eb6f04efb18ba031}{ptr}});}
\DoxyCodeLine{00533\ \ \ \ \ \}}
\DoxyCodeLine{00534\ \ \ \}}
\DoxyCodeLine{00535\ }
\DoxyCodeLine{00536\ \ \ \textcolor{keywordtype}{void}*\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockScratchAllocator_ac02d3370d9e0ad2c3b50992cdf3c4b4a}{allocate}}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2low__level__alloc_8cc_aad9b71a31372d5c0ab9c23163efe9544}{size}})\ \{}
\DoxyCodeLine{00537\ \ \ \ \ \textcolor{comment}{//\ TODO(ezhulenev):\ Remove\ when\ replaced\ with\ inlined\ vector.}}
\DoxyCodeLine{00538\ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_allocations.capacity()\ ==\ 0)\ m\_allocations.reserve(8);}
\DoxyCodeLine{00539\ }
\DoxyCodeLine{00540\ \ \ \ \ \textcolor{comment}{//\ Check\ if\ we\ already\ have\ an\ existing\ allocation\ att\ current\ index.}}
\DoxyCodeLine{00541\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ num\_allocations\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(m\_allocations.size());}
\DoxyCodeLine{00542\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ has\_allocation\ =\ m\_allocation\_index\ <\ num\_allocations;}
\DoxyCodeLine{00543\ }
\DoxyCodeLine{00544\ \ \ \ \ \textcolor{comment}{//\ Allocation\ index\ can't\ be\ larger\ than\ the\ number\ of\ allocations.}}
\DoxyCodeLine{00545\ \ \ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(m\_allocation\_index\ <=\ num\_allocations);}
\DoxyCodeLine{00546\ }
\DoxyCodeLine{00547\ \ \ \ \ \textcolor{comment}{//\ If\ we\ have\ existing\ allocation,\ and\ its\ size\ is\ larger\ or\ equal\ to}}
\DoxyCodeLine{00548\ \ \ \ \ \textcolor{comment}{//\ requested\ size,\ we\ do\ nothing.}}
\DoxyCodeLine{00549\ }
\DoxyCodeLine{00550\ \ \ \ \ \textcolor{comment}{//\ If\ current\ allocation\ can't\ fit\ requested\ size,\ we\ deallocate\ it,\ and}}
\DoxyCodeLine{00551\ \ \ \ \ \textcolor{comment}{//\ replace\ with\ a\ larger\ allocation.}}
\DoxyCodeLine{00552\ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_allocation\ \&\&\ m\_allocations[m\_allocation\_index].\mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2low__level__alloc_8cc_aad9b71a31372d5c0ab9c23163efe9544}{size}}\ <\ \mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2low__level__alloc_8cc_aad9b71a31372d5c0ab9c23163efe9544}{size}})\ \{}
\DoxyCodeLine{00553\ \ \ \ \ \ \ m\_device.deallocate(m\_allocations[m\_allocation\_index].\mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2low__level__alloc__test_8cc_a935adc2e417a61d7eb6f04efb18ba031}{ptr}});}
\DoxyCodeLine{00554\ \ \ \ \ \ \ m\_allocations[m\_allocation\_index].ptr\ =\ m\_device.allocate(\mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2low__level__alloc_8cc_aad9b71a31372d5c0ab9c23163efe9544}{size}});}
\DoxyCodeLine{00555\ \ \ \ \ \ \ m\_allocations[m\_allocation\_index].size\ =\ \mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2low__level__alloc_8cc_aad9b71a31372d5c0ab9c23163efe9544}{size}};}
\DoxyCodeLine{00556\ \ \ \ \ \}}
\DoxyCodeLine{00557\ }
\DoxyCodeLine{00558\ \ \ \ \ \textcolor{comment}{//\ Make\ a\ new\ allocation\ if\ we\ don't\ have\ and\ existing\ one.}}
\DoxyCodeLine{00559\ \ \ \ \ \textcolor{keywordflow}{if}\ (!has\_allocation)\ \{}
\DoxyCodeLine{00560\ \ \ \ \ \ \ Allocation\ allocation;}
\DoxyCodeLine{00561\ \ \ \ \ \ \ allocation.ptr\ =\ m\_device.allocate(\mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2low__level__alloc_8cc_aad9b71a31372d5c0ab9c23163efe9544}{size}});}
\DoxyCodeLine{00562\ \ \ \ \ \ \ allocation.size\ =\ \mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2low__level__alloc_8cc_aad9b71a31372d5c0ab9c23163efe9544}{size}};}
\DoxyCodeLine{00563\ \ \ \ \ \ \ m\_allocations.push\_back(allocation);}
\DoxyCodeLine{00564\ \ \ \ \ \}}
\DoxyCodeLine{00565\ }
\DoxyCodeLine{00566\ \ \ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(m\_allocations[m\_allocation\_index].\mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2low__level__alloc__test_8cc_a935adc2e417a61d7eb6f04efb18ba031}{ptr}}\ !=\ NULL);}
\DoxyCodeLine{00567\ \ \ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(m\_allocations[m\_allocation\_index].\mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2low__level__alloc_8cc_aad9b71a31372d5c0ab9c23163efe9544}{size}}\ >=\ \mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2low__level__alloc_8cc_aad9b71a31372d5c0ab9c23163efe9544}{size}});}
\DoxyCodeLine{00568\ }
\DoxyCodeLine{00569\ \ \ \ \ \textcolor{keywordflow}{return}\ m\_allocations[m\_allocation\_index++].ptr;}
\DoxyCodeLine{00570\ \ \ \}}
\DoxyCodeLine{00571\ }
\DoxyCodeLine{00572\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockScratchAllocator_ad6be75c9647956be001485a15c341035}{reset}}()\ \{\ m\_allocation\_index\ =\ 0;\ \}}
\DoxyCodeLine{00573\ }
\DoxyCodeLine{00574\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00575\ \ \ \textcolor{keyword}{struct\ }Allocation\ \{}
\DoxyCodeLine{00576\ \ \ \ \ \textcolor{keywordtype}{void}*\ ptr;}
\DoxyCodeLine{00577\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2low__level__alloc_8cc_aad9b71a31372d5c0ab9c23163efe9544}{size}};}
\DoxyCodeLine{00578\ \ \ \};}
\DoxyCodeLine{00579\ }
\DoxyCodeLine{00580\ \ \ \textcolor{keyword}{const}\ Device\&\ m\_device;}
\DoxyCodeLine{00581\ \ \ \textcolor{keywordtype}{int}\ m\_allocation\_index;}
\DoxyCodeLine{00582\ \ \ \textcolor{comment}{//\ TODO(ezhulenev):\ This\ should\ be\ an\ inlined\ vector.}}
\DoxyCodeLine{00583\ \ \ std::vector<Allocation>\ m\_allocations;}
\DoxyCodeLine{00584\ \};}
\DoxyCodeLine{00585\ }
\DoxyCodeLine{00586\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ //}}
\DoxyCodeLine{00587\ \textcolor{comment}{//\ TensorBlockKind\ represents\ all\ possible\ block\ kinds,\ that\ can\ be\ produced\ by}}
\DoxyCodeLine{00588\ \textcolor{comment}{//\ TensorEvaluator::evalBlock\ function.}}
\DoxyCodeLine{00589\ \textcolor{keyword}{enum}\ \mbox{\hyperlink{namespaceEigen_1_1internal_a3368ad2fe1e9bf12c1f1f767733bfcb8}{TensorBlockKind}}\ \{}
\DoxyCodeLine{00590\ \ \ \textcolor{comment}{//\ Tensor\ block\ that\ is\ a\ lazy\ expression\ that\ must\ be\ assigned\ to\ a}}
\DoxyCodeLine{00591\ \ \ \textcolor{comment}{//\ destination\ using\ TensorBlockAssign.}}
\DoxyCodeLine{00592\ \ \ \mbox{\hyperlink{namespaceEigen_1_1internal_a3368ad2fe1e9bf12c1f1f767733bfcb8ace215f48d36828e6bad1d71377bc2559}{kExpr}},}
\DoxyCodeLine{00593\ }
\DoxyCodeLine{00594\ \ \ \textcolor{comment}{//\ Tensor\ block\ that\ is\ a\ view\ into\ a\ memory\ buffer\ owned\ by\ an\ underlying}}
\DoxyCodeLine{00595\ \ \ \textcolor{comment}{//\ Tensor\ expression\ (e.g.\ it\ can\ be\ a\ view\ into\ a\ Tensor\ buffer).}}
\DoxyCodeLine{00596\ \ \ \mbox{\hyperlink{namespaceEigen_1_1internal_a3368ad2fe1e9bf12c1f1f767733bfcb8a723a026b289608a724cf05c310d59c4b}{kView}},}
\DoxyCodeLine{00597\ }
\DoxyCodeLine{00598\ \ \ \textcolor{comment}{//\ Tensor\ block\ that\ was\ materialized\ in\ a\ scratch\ memory\ buffer,\ allocated}}
\DoxyCodeLine{00599\ \ \ \textcolor{comment}{//\ with\ TensorBlockScratchAllocator.\ This\ block\ must\ be\ copied\ to\ a}}
\DoxyCodeLine{00600\ \ \ \textcolor{comment}{//\ destination,\ similar\ to\ a\ block\ of\ \`{}kExpr`\ type.}}
\DoxyCodeLine{00601\ \ \ \mbox{\hyperlink{namespaceEigen_1_1internal_a3368ad2fe1e9bf12c1f1f767733bfcb8ac8dceefd547bc4ae231652c685cac909}{kMaterializedInScratch}},}
\DoxyCodeLine{00602\ }
\DoxyCodeLine{00603\ \ \ \textcolor{comment}{//\ Tensor\ block\ that\ was\ materialized\ directly\ into\ the\ final\ output\ memory}}
\DoxyCodeLine{00604\ \ \ \textcolor{comment}{//\ buffer.\ For\ example\ if\ the\ left\ side\ of\ an\ assignment\ is\ a\ Tensor,\ we\ can}}
\DoxyCodeLine{00605\ \ \ \textcolor{comment}{//\ directly\ materialize\ the\ block\ in\ the\ destination\ memory.}}
\DoxyCodeLine{00606\ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00607\ \ \ \textcolor{comment}{//\ If\ strides\ in\ the\ output\ buffer\ do\ not\ match\ tensor\ block\ strides,\ the}}
\DoxyCodeLine{00608\ \ \ \textcolor{comment}{//\ Tensor\ expression\ will\ be\ invalid,\ and\ should\ not\ be\ used\ by}}
\DoxyCodeLine{00609\ \ \ \textcolor{comment}{//\ TensorBlockAssign\ or\ for\ constructing\ another\ block\ expression.}}
\DoxyCodeLine{00610\ \ \ \mbox{\hyperlink{namespaceEigen_1_1internal_a3368ad2fe1e9bf12c1f1f767733bfcb8afb02d51e432b8f43976514055ee90d41}{kMaterializedInOutput}}}
\DoxyCodeLine{00611\ \};}
\DoxyCodeLine{00612\ }
\DoxyCodeLine{00613\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ //}}
\DoxyCodeLine{00614\ \textcolor{comment}{//\ TensorBlockNotImplemented\ should\ be\ used\ to\ defined\ TensorBlock\ typedef\ in}}
\DoxyCodeLine{00615\ \textcolor{comment}{//\ TensorEvaluators\ that\ do\ not\ support\ block\ evaluation.}}
\DoxyCodeLine{00616\ }
\DoxyCodeLine{00617\ \textcolor{keyword}{class\ }TensorBlockNotImplemented\ \{}
\DoxyCodeLine{00618\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00619\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockNotImplemented_a0e8e3ce2354260713cb3e954dc8c9e11}{XprType}};}
\DoxyCodeLine{00620\ \};}
\DoxyCodeLine{00621\ }
\DoxyCodeLine{00622\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ //}}
\DoxyCodeLine{00623\ \textcolor{comment}{//\ XprScalar\ extracts\ Scalar\ type\ from\ the\ Eigen\ expressions\ (if\ expression\ type}}
\DoxyCodeLine{00624\ \textcolor{comment}{//\ is\ not\ void).\ It's\ required\ to\ be\ able\ to\ define\ lazy\ block\ expression\ for}}
\DoxyCodeLine{00625\ \textcolor{comment}{//\ argument\ types,\ that\ do\ not\ support\ block\ evaluation.}}
\DoxyCodeLine{00626\ }
\DoxyCodeLine{00627\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ XprType>}
\DoxyCodeLine{00628\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structEigen_1_1internal_1_1XprScalar}{XprScalar}}\ \{}
\DoxyCodeLine{00629\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ XprType::Scalar\ \mbox{\hyperlink{structEigen_1_1internal_1_1XprScalar_a5fff9f58106ea14bc0855091d5d07f5f}{type}};}
\DoxyCodeLine{00630\ \};}
\DoxyCodeLine{00631\ \textcolor{keyword}{template}\ <>}
\DoxyCodeLine{00632\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structEigen_1_1internal_1_1XprScalar}{XprScalar}}<void>\ \{}
\DoxyCodeLine{00633\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structEigen_1_1internal_1_1XprScalar_3_01void_01_4_add32bf8f49481e81ed31ee5fa49fc14b}{type}};}
\DoxyCodeLine{00634\ \};}
\DoxyCodeLine{00635\ }
\DoxyCodeLine{00636\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ //}}
\DoxyCodeLine{00637\ \textcolor{comment}{//\ TensorMaterializedBlock\ is\ a\ fully\ evaluated\ block\ of\ the\ original\ tensor,}}
\DoxyCodeLine{00638\ \textcolor{comment}{//\ and\ XprType\ is\ just\ a\ TensorMap\ over\ the\ data.\ This\ block\ type\ is\ typically}}
\DoxyCodeLine{00639\ \textcolor{comment}{//\ used\ to\ materialize\ blocks\ of\ tensor\ expressions,\ that\ can't\ be\ efficiently}}
\DoxyCodeLine{00640\ \textcolor{comment}{//\ represented\ as\ lazy\ Tensor\ expressions\ with\ fast\ coeff/packet\ operations,}}
\DoxyCodeLine{00641\ \textcolor{comment}{//\ e.g.\ we\ materialize\ all\ broadcasts\ into\ evaluated\ blocks.}}
\DoxyCodeLine{00642\ \textcolor{comment}{//}}
\DoxyCodeLine{00643\ \textcolor{comment}{//\ TensorMaterializedBlock\ does\ not\ own\ its\ memory\ buffer,\ it's\ either\ a\ memory}}
\DoxyCodeLine{00644\ \textcolor{comment}{//\ buffer\ that\ backs\ the\ original\ expression\ (e.g.\ block\ is\ just\ a\ view\ into\ a}}
\DoxyCodeLine{00645\ \textcolor{comment}{//\ Tensor),\ or\ a\ memory\ buffer\ allocated\ with\ scratch\ allocator,\ and\ in\ this}}
\DoxyCodeLine{00646\ \textcolor{comment}{//\ case\ the\ scratch\ allocator\ will\ deallocate\ it\ at\ the\ end\ of\ block\ based}}
\DoxyCodeLine{00647\ \textcolor{comment}{//\ expression\ execution.}}
\DoxyCodeLine{00648\ \textcolor{comment}{//}}
\DoxyCodeLine{00649\ \textcolor{comment}{//\ If\ the\ block\ was\ evaluated\ directly\ into\ the\ output\ buffer,\ and\ strides\ in}}
\DoxyCodeLine{00650\ \textcolor{comment}{//\ the\ output\ buffer\ do\ not\ match\ block\ strides,\ the\ TensorMap\ expression\ will}}
\DoxyCodeLine{00651\ \textcolor{comment}{//\ be\ invalid,\ and\ should\ never\ be\ used\ in\ block\ assignment\ or\ any\ other\ tensor}}
\DoxyCodeLine{00652\ \textcolor{comment}{//\ expression.}}
\DoxyCodeLine{00653\ }
\DoxyCodeLine{00654\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Scalar,\ \textcolor{keywordtype}{int}\ NumDims,\ \textcolor{keywordtype}{int}\ Layout,}
\DoxyCodeLine{00655\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typename}\ IndexType\ =\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Eigen::Index}}>}
\DoxyCodeLine{00656\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock}{TensorMaterializedBlock}}\ \{}
\DoxyCodeLine{00657\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00658\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{structEigen_1_1DSizes}{DSizes<IndexType,\ NumDims>}}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_a16f61738aca8bcc3091a33c7630d8498}{Dimensions}};}
\DoxyCodeLine{00659\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{classEigen_1_1TensorMap}{TensorMap<const\ Tensor<Scalar,\ NumDims,\ Layout>}}\ >\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_ab0108d8fd335ab5b22ec2e8f9862eadf}{XprType}};}
\DoxyCodeLine{00660\ }
\DoxyCodeLine{00661\ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_a11a75b6c267b92d5def380e14003ec53}{TensorMaterializedBlock}}(\mbox{\hyperlink{namespaceEigen_1_1internal_a3368ad2fe1e9bf12c1f1f767733bfcb8}{TensorBlockKind}}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_a41110cf737c9b69b65e96ad86c82706f}{kind}},\ \textcolor{keyword}{const}\ Scalar*\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_a26382974f27aae85dceeb6b0005ed73b}{data}},}
\DoxyCodeLine{00662\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1DSizes}{Dimensions}}\&\ dimensions,\ \textcolor{keywordtype}{bool}\ valid\_expr\ =\ \textcolor{keyword}{true})}
\DoxyCodeLine{00663\ \ \ \ \ \ \ :\ m\_kind(\mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_a41110cf737c9b69b65e96ad86c82706f}{kind}}),}
\DoxyCodeLine{00664\ \ \ \ \ \ \ \ \ m\_data(\mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_a26382974f27aae85dceeb6b0005ed73b}{data}}),}
\DoxyCodeLine{00665\ \ \ \ \ \ \ \ \ m\_dimensions(dimensions),}
\DoxyCodeLine{00666\ \ \ \ \ \ \ \ \ m\_expr(m\_data,\ m\_dimensions),}
\DoxyCodeLine{00667\ \ \ \ \ \ \ \ \ m\_valid\_expr(valid\_expr)\ \{}
\DoxyCodeLine{00668\ \ \ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(m\_kind\ ==\ internal::TensorBlockKind::kView\ ||}
\DoxyCodeLine{00669\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_kind\ ==\ internal::TensorBlockKind::kMaterializedInScratch\ ||}
\DoxyCodeLine{00670\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_kind\ ==\ internal::TensorBlockKind::kMaterializedInOutput);}
\DoxyCodeLine{00671\ \ \ \}}
\DoxyCodeLine{00672\ }
\DoxyCodeLine{00673\ \ \ \mbox{\hyperlink{namespaceEigen_1_1internal_a3368ad2fe1e9bf12c1f1f767733bfcb8}{TensorBlockKind}}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_a41110cf737c9b69b65e96ad86c82706f}{kind}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ m\_kind;\ \}}
\DoxyCodeLine{00674\ \ \ \textcolor{comment}{//\ NOTE(ezhulenev):\ Returning\ XprType\ by\ value\ like\ in\ other\ block\ types}}
\DoxyCodeLine{00675\ \ \ \textcolor{comment}{//\ causes\ asan\ failures.\ The\ theory\ is\ that\ XprType::Nested\ doesn't\ work}}
\DoxyCodeLine{00676\ \ \ \textcolor{comment}{//\ properly\ for\ TensorMap.}}
\DoxyCodeLine{00677\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1TensorMap}{XprType}}\&\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_abcc5bcd9c0ed6a5f3ead7571494f0d8f}{expr}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00678\ \ \ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(m\_valid\_expr);}
\DoxyCodeLine{00679\ \ \ \ \ \textcolor{keywordflow}{return}\ m\_expr;}
\DoxyCodeLine{00680\ \ \ \}}
\DoxyCodeLine{00681\ \ \ \textcolor{keyword}{const}\ Scalar*\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_a26382974f27aae85dceeb6b0005ed73b}{data}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ m\_data;\ \}}
\DoxyCodeLine{00682\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_afbaf016c3620e52e420ed8aeede311b6}{cleanup}}()\ \{\}}
\DoxyCodeLine{00683\ }
\DoxyCodeLine{00684\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor}{internal::TensorBlockDescriptor<NumDims,\ IndexType>}}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_a70da4c32519ed3ae4e83ba764a7e0378}{TensorBlockDesc}};}
\DoxyCodeLine{00685\ }
\DoxyCodeLine{00686\ \ \ \textcolor{comment}{//\ TensorMaterializedBlock\ can\ be\ backed\ by\ different\ types\ of\ storage:}}
\DoxyCodeLine{00687\ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00688\ \ \ \textcolor{comment}{//\ \ \ (1)\ Contiguous\ block\ of\ memory\ allocated\ with\ scratch\ allocator.}}
\DoxyCodeLine{00689\ \ \ \textcolor{comment}{//\ \ \ (2)\ Contiguous\ block\ of\ memory\ reused\ from\ tensor\ block\ descriptor}}
\DoxyCodeLine{00690\ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ destination\ buffer.}}
\DoxyCodeLine{00691\ \ \ \textcolor{comment}{//\ \ \ (3)\ Strided\ block\ of\ memory\ reused\ from\ tensor\ block\ descriptor}}
\DoxyCodeLine{00692\ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ destination\ buffer.}}
\DoxyCodeLine{00693\ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00694\ \ \ \textcolor{keyword}{class\ }\mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_1_1Storage}{Storage}}\ \{}
\DoxyCodeLine{00695\ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00696\ \ \ \ \ Scalar*\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_1_1Storage_a17f998b791bc30f0603758ded9a3af76}{data}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ m\_data;\ \}}
\DoxyCodeLine{00697\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1DSizes}{Dimensions}}\&\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_1_1Storage_a19c5c6ed95bdbd24a32ef8c3489ca62f}{dimensions}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ m\_dimensions;\ \}}
\DoxyCodeLine{00698\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1DSizes}{Dimensions}}\&\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_1_1Storage_a21e90086713b66a30fe3c619161c1b47}{strides}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ m\_strides;\ \}}
\DoxyCodeLine{00699\ }
\DoxyCodeLine{00700\ \ \ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock}{TensorMaterializedBlock}}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_1_1Storage_a45777db05fa2a1a4fc633ea40ed9b9e1}{AsTensorMaterializedBlock}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00701\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_1_1Storage_a525e0f3a06ab1baa9761cf542cdef64c}{TensorMaterializedBlock}}(}
\DoxyCodeLine{00702\ \ \ \ \ \ \ \ \ \ \ m\_materialized\_in\_output}
\DoxyCodeLine{00703\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ?\ internal::TensorBlockKind::kMaterializedInOutput}
\DoxyCodeLine{00704\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ internal::TensorBlockKind::kMaterializedInScratch,}
\DoxyCodeLine{00705\ \ \ \ \ \ \ \ \ \ \ m\_data,\ m\_dimensions,\ !m\_strided\_storage);}
\DoxyCodeLine{00706\ \ \ \ \ \}}
\DoxyCodeLine{00707\ }
\DoxyCodeLine{00708\ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00709\ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock}{TensorMaterializedBlock}};}
\DoxyCodeLine{00710\ }
\DoxyCodeLine{00711\ \ \ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_1_1Storage}{Storage}}(Scalar*\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_1_1Storage_a17f998b791bc30f0603758ded9a3af76}{data}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1DSizes}{Dimensions}}\&\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_1_1Storage_a19c5c6ed95bdbd24a32ef8c3489ca62f}{dimensions}},}
\DoxyCodeLine{00712\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1DSizes}{Dimensions}}\&\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_1_1Storage_a21e90086713b66a30fe3c619161c1b47}{strides}},\ \textcolor{keywordtype}{bool}\ materialized\_in\_output,}
\DoxyCodeLine{00713\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ strided\_storage)}
\DoxyCodeLine{00714\ \ \ \ \ \ \ \ \ :\ m\_data(\mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_1_1Storage_a17f998b791bc30f0603758ded9a3af76}{data}}),}
\DoxyCodeLine{00715\ \ \ \ \ \ \ \ \ \ \ m\_dimensions(\mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_1_1Storage_a19c5c6ed95bdbd24a32ef8c3489ca62f}{dimensions}}),}
\DoxyCodeLine{00716\ \ \ \ \ \ \ \ \ \ \ m\_strides(\mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_1_1Storage_a21e90086713b66a30fe3c619161c1b47}{strides}}),}
\DoxyCodeLine{00717\ \ \ \ \ \ \ \ \ \ \ m\_materialized\_in\_output(materialized\_in\_output),}
\DoxyCodeLine{00718\ \ \ \ \ \ \ \ \ \ \ m\_strided\_storage(strided\_storage)\ \{\}}
\DoxyCodeLine{00719\ }
\DoxyCodeLine{00720\ \ \ \ \ Scalar*\ m\_data;}
\DoxyCodeLine{00721\ \ \ \ \ \mbox{\hyperlink{structEigen_1_1DSizes}{Dimensions}}\ m\_dimensions;}
\DoxyCodeLine{00722\ \ \ \ \ \mbox{\hyperlink{structEigen_1_1DSizes}{Dimensions}}\ m\_strides;}
\DoxyCodeLine{00723\ \ \ \ \ \textcolor{keywordtype}{bool}\ m\_materialized\_in\_output;}
\DoxyCodeLine{00724\ \ \ \ \ \textcolor{keywordtype}{bool}\ m\_strided\_storage;}
\DoxyCodeLine{00725\ \ \ \};}
\DoxyCodeLine{00726\ }
\DoxyCodeLine{00727\ \ \ \textcolor{comment}{//\ Creates\ a\ storage\ for\ materialized\ block\ either\ from\ the\ block\ descriptor}}
\DoxyCodeLine{00728\ \ \ \textcolor{comment}{//\ destination\ buffer,\ or\ allocates\ a\ new\ buffer\ with\ scratch\ allocator.}}
\DoxyCodeLine{00729\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ TensorBlockScratch>}
\DoxyCodeLine{00730\ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keyword}{static}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_1_1Storage}{Storage}}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_a5709458a007b8c05e77842981b731535}{prepareStorage}}(}
\DoxyCodeLine{00731\ \ \ \ \ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor}{TensorBlockDesc}}\&\ desc,\ TensorBlockScratch\&\ scratch,}
\DoxyCodeLine{00732\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ allow\_strided\_storage\ =\ \textcolor{keyword}{false})\ \{}
\DoxyCodeLine{00733\ \ \ \ \ \textcolor{comment}{//\ Try\ to\ reuse\ destination\ as\ an\ output\ block\ buffer.}}
\DoxyCodeLine{00734\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_1_1DestinationBuffer}{TensorBlockDesc::DestinationBuffer}}\ DestinationBuffer;}
\DoxyCodeLine{00735\ }
\DoxyCodeLine{00736\ \ \ \ \ \textcolor{keywordflow}{if}\ (desc.\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_a3f532ad0c2916de6f1e7f994614c0063}{destination}}().\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_1_1DestinationBuffer_a6a89d849d7e983850f0fbaccdb1d62f9}{kind}}()\ ==\ DestinationBuffer::kContiguous)\ \{}
\DoxyCodeLine{00737\ \ \ \ \ \ \ Scalar*\ buffer\ =\ desc.\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_a3f532ad0c2916de6f1e7f994614c0063}{destination}}().template\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_a26382974f27aae85dceeb6b0005ed73b}{data<Scalar>}}();}
\DoxyCodeLine{00738\ \ \ \ \ \ \ desc.\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_adc355a74e7b1fc154f8e0f5a740a7086}{DropDestinationBuffer}}();}
\DoxyCodeLine{00739\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_1_1Storage}{Storage}}(buffer,\ desc.\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_aad3784ea0105aa915630b3ecbbdd35c7}{dimensions}}(),}
\DoxyCodeLine{00740\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceEigen_1_1internal_ae6bac895069b4299831c59aeb680ce3e}{internal::strides<Layout>}}(desc.\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_aad3784ea0105aa915630b3ecbbdd35c7}{dimensions}}()),}
\DoxyCodeLine{00741\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*materialized\_in\_output=*/}\textcolor{keyword}{true},}
\DoxyCodeLine{00742\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*strided\_storage=*/}\textcolor{keyword}{false});}
\DoxyCodeLine{00743\ }
\DoxyCodeLine{00744\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (desc.\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_a3f532ad0c2916de6f1e7f994614c0063}{destination}}().\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_1_1DestinationBuffer_a6a89d849d7e983850f0fbaccdb1d62f9}{kind}}()\ ==\ DestinationBuffer::kStrided\ \&\&}
\DoxyCodeLine{00745\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ allow\_strided\_storage)\ \{}
\DoxyCodeLine{00746\ \ \ \ \ \ \ Scalar*\ buffer\ =\ desc.\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_a3f532ad0c2916de6f1e7f994614c0063}{destination}}().template\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_a26382974f27aae85dceeb6b0005ed73b}{data<Scalar>}}();}
\DoxyCodeLine{00747\ \ \ \ \ \ \ desc.\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_adc355a74e7b1fc154f8e0f5a740a7086}{DropDestinationBuffer}}();}
\DoxyCodeLine{00748\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_1_1Storage}{Storage}}(buffer,\ desc.\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_aad3784ea0105aa915630b3ecbbdd35c7}{dimensions}}(),\ desc.\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_a3f532ad0c2916de6f1e7f994614c0063}{destination}}().\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_1_1DestinationBuffer_a1587695f7bd516a1713c5cc67b771317}{strides}}(),}
\DoxyCodeLine{00749\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*materialized\_in\_output=*/}\textcolor{keyword}{true},\ \textcolor{comment}{/*strided\_storage=*/}\textcolor{keyword}{true});}
\DoxyCodeLine{00750\ }
\DoxyCodeLine{00751\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00752\ \ \ \ \ \ \ \textcolor{keywordtype}{void}*\ mem\ =\ scratch.allocate(desc.\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_a595bc99b9603c07e17f9f26a4e8d71f0}{size}}()\ *\ \textcolor{keyword}{sizeof}(Scalar));}
\DoxyCodeLine{00753\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_1_1Storage}{Storage}}(\textcolor{keyword}{static\_cast<}Scalar*\textcolor{keyword}{>}(mem),\ desc.\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_aad3784ea0105aa915630b3ecbbdd35c7}{dimensions}}(),}
\DoxyCodeLine{00754\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceEigen_1_1internal_ae6bac895069b4299831c59aeb680ce3e}{internal::strides<Layout>}}(desc.\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_aad3784ea0105aa915630b3ecbbdd35c7}{dimensions}}()),}
\DoxyCodeLine{00755\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*materialized\_in\_output=*/}\textcolor{keyword}{false},}
\DoxyCodeLine{00756\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*strided\_storage=*/}\textcolor{keyword}{false});}
\DoxyCodeLine{00757\ \ \ \ \ \}}
\DoxyCodeLine{00758\ \ \ \}}
\DoxyCodeLine{00759\ }
\DoxyCodeLine{00760\ \ \ \textcolor{comment}{//\ Creates\ a\ materialized\ block\ for\ the\ given\ descriptor\ from\ a\ memory\ buffer.}}
\DoxyCodeLine{00761\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ DataDimensions,\ \textcolor{keyword}{typename}\ TensorBlockScratch>}
\DoxyCodeLine{00762\ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keyword}{static}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock}{TensorMaterializedBlock}}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_a28f1d13d562525c80214efbfe02b1faf}{materialize}}(}
\DoxyCodeLine{00763\ \ \ \ \ \ \ \textcolor{keyword}{const}\ Scalar*\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_a26382974f27aae85dceeb6b0005ed73b}{data}},\ \textcolor{keyword}{const}\ DataDimensions\&\ data\_dims,}
\DoxyCodeLine{00764\ \ \ \ \ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor}{TensorBlockDesc}}\&\ desc,\ TensorBlockScratch\&\ scratch)\ \{}
\DoxyCodeLine{00765\ \ \ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(\mbox{\hyperlink{structEigen_1_1internal_1_1array__size}{array\_size<DataDimensions>::value}}\ ==\ desc.\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_aad3784ea0105aa915630b3ecbbdd35c7}{dimensions}}().\mbox{\hyperlink{classEigen_1_1array_a332ffdbd5ae2690a6f983959baecc972}{size}}());}
\DoxyCodeLine{00766\ }
\DoxyCodeLine{00767\ \ \ \ \ \textcolor{comment}{//\ If\ a\ tensor\ block\ dimensions\ covers\ a\ contiguous\ block\ of\ the\ underlying}}
\DoxyCodeLine{00768\ \ \ \ \ \textcolor{comment}{//\ memory,\ we\ can\ skip\ block\ buffer\ memory\ allocation,\ and\ construct\ a\ block}}
\DoxyCodeLine{00769\ \ \ \ \ \textcolor{comment}{//\ from\ existing\ \`{}data`\ memory\ buffer.}}
\DoxyCodeLine{00770\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00771\ \ \ \ \ \textcolor{comment}{//\ Example:\ (RowMajor\ layout)}}
\DoxyCodeLine{00772\ \ \ \ \ \textcolor{comment}{//\ \ \ data\_dims:\ \ \ \ \ \ \ \ \ \ [11,\ 12,\ 13,\ 14]}}
\DoxyCodeLine{00773\ \ \ \ \ \textcolor{comment}{//\ \ \ desc.dimensions():\ \ [1,\ \ \ 1,\ \ 3,\ 14]}}
\DoxyCodeLine{00774\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00775\ \ \ \ \ \textcolor{comment}{//\ In\ this\ case\ we\ can\ construct\ a\ TensorBlock\ starting\ at}}
\DoxyCodeLine{00776\ \ \ \ \ \textcolor{comment}{//\ \`{}data\ +\ desc.offset()`,\ with\ a\ \`{}desc.dimensions()`\ block\ sizes.}}
\DoxyCodeLine{00777\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ is\_col\_major\ =\ Layout\ ==\ \mbox{\hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13a0cbd4bdd0abcfc0224c5fcb5e4f6669a}{ColMajor}};}
\DoxyCodeLine{00778\ }
\DoxyCodeLine{00779\ \ \ \ \ \textcolor{comment}{//\ Find\ out\ how\ many\ inner\ dimensions\ have\ a\ matching\ size.}}
\DoxyCodeLine{00780\ \ \ \ \ \textcolor{keywordtype}{int}\ num\_matching\_inner\_dims\ =\ 0;}
\DoxyCodeLine{00781\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ NumDims;\ ++\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ \{}
\DoxyCodeLine{00782\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ dim\ =\ is\_col\_major\ ?\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ :\ NumDims\ -\/\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ -\/\ 1;}
\DoxyCodeLine{00783\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (data\_dims[dim]\ !=\ desc.\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_aad3784ea0105aa915630b3ecbbdd35c7}{dimensions}}()[dim])\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00784\ \ \ \ \ \ \ ++num\_matching\_inner\_dims;}
\DoxyCodeLine{00785\ \ \ \ \ \}}
\DoxyCodeLine{00786\ }
\DoxyCodeLine{00787\ \ \ \ \ \textcolor{comment}{//\ All\ the\ outer\ dimensions\ must\ be\ of\ size\ \`{}1`,\ except\ a\ single\ dimension}}
\DoxyCodeLine{00788\ \ \ \ \ \textcolor{comment}{//\ before\ the\ matching\ inner\ dimension\ (`3`\ in\ the\ example\ above).}}
\DoxyCodeLine{00789\ \ \ \ \ \textcolor{keywordtype}{bool}\ can\_use\_direct\_access\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00790\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ num\_matching\_inner\_dims\ +\ 1;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ NumDims;\ ++\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ \{}
\DoxyCodeLine{00791\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ dim\ =\ is\_col\_major\ ?\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ :\ NumDims\ -\/\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ -\/\ 1;}
\DoxyCodeLine{00792\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (desc.\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_a89c4bf7986164e0cfe376181e9032ed4}{dimension}}(dim)\ !=\ 1)\ \{}
\DoxyCodeLine{00793\ \ \ \ \ \ \ \ \ can\_use\_direct\_access\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00794\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00795\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00796\ \ \ \ \ \}}
\DoxyCodeLine{00797\ }
\DoxyCodeLine{00798\ \ \ \ \ \textcolor{keywordflow}{if}\ (can\_use\_direct\_access)\ \{}
\DoxyCodeLine{00799\ \ \ \ \ \ \ \textcolor{keyword}{const}\ Scalar*\ block\_start\ =\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_a26382974f27aae85dceeb6b0005ed73b}{data}}\ +\ desc.\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_a686be958df6a4ab77f9b6832cd1b8f96}{offset}}();}
\DoxyCodeLine{00800\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_a11a75b6c267b92d5def380e14003ec53}{TensorMaterializedBlock}}(internal::TensorBlockKind::kView,}
\DoxyCodeLine{00801\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ block\_start,\ desc.\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_aad3784ea0105aa915630b3ecbbdd35c7}{dimensions}}());}
\DoxyCodeLine{00802\ }
\DoxyCodeLine{00803\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00804\ \ \ \ \ \ \ \textcolor{comment}{//\ Reuse\ destination\ buffer\ or\ allocate\ new\ buffer\ with\ scratch\ allocator.}}
\DoxyCodeLine{00805\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_1_1Storage}{Storage}}\ storage\ =\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_a5709458a007b8c05e77842981b731535}{prepareStorage}}(desc,\ scratch);}
\DoxyCodeLine{00806\ }
\DoxyCodeLine{00807\ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockIO}{internal::TensorBlockIO<Scalar,\ IndexType,\ NumDims,\ Layout>}}}
\DoxyCodeLine{00808\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockIO}{TensorBlockIO}};}
\DoxyCodeLine{00809\ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockIO_1_1Dst}{TensorBlockIO::Dst}}\ TensorBlockIODst;}
\DoxyCodeLine{00810\ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockIO_1_1Src}{TensorBlockIO::Src}}\ TensorBlockIOSrc;}
\DoxyCodeLine{00811\ }
\DoxyCodeLine{00812\ \ \ \ \ \ \ TensorBlockIOSrc\ src(\mbox{\hyperlink{namespaceEigen_1_1internal_ae6bac895069b4299831c59aeb680ce3e}{internal::strides<Layout>}}(\mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_a16f61738aca8bcc3091a33c7630d8498}{Dimensions}}(data\_dims)),}
\DoxyCodeLine{00813\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_a26382974f27aae85dceeb6b0005ed73b}{data}},\ desc.\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockDescriptor_a686be958df6a4ab77f9b6832cd1b8f96}{offset}}());}
\DoxyCodeLine{00814\ \ \ \ \ \ \ TensorBlockIODst\ dst(storage.\mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_1_1Storage_a19c5c6ed95bdbd24a32ef8c3489ca62f}{dimensions}}(),\ storage.\mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_1_1Storage_a21e90086713b66a30fe3c619161c1b47}{strides}}(),}
\DoxyCodeLine{00815\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ storage.\mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_1_1Storage_a17f998b791bc30f0603758ded9a3af76}{data}}());}
\DoxyCodeLine{00816\ }
\DoxyCodeLine{00817\ \ \ \ \ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockIO_a3eed5c23e9578f8ed8b2946045ab1d68}{TensorBlockIO::Copy}}(dst,\ src);}
\DoxyCodeLine{00818\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ storage.\mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_1_1Storage_a45777db05fa2a1a4fc633ea40ed9b9e1}{AsTensorMaterializedBlock}}();}
\DoxyCodeLine{00819\ \ \ \ \ \}}
\DoxyCodeLine{00820\ \ \ \}}
\DoxyCodeLine{00821\ }
\DoxyCodeLine{00822\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00823\ \ \ \mbox{\hyperlink{namespaceEigen_1_1internal_a3368ad2fe1e9bf12c1f1f767733bfcb8}{TensorBlockKind}}\ m\_kind;}
\DoxyCodeLine{00824\ \ \ \textcolor{keyword}{const}\ Scalar*\ m\_data;}
\DoxyCodeLine{00825\ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_a16f61738aca8bcc3091a33c7630d8498}{Dimensions}}\ m\_dimensions;}
\DoxyCodeLine{00826\ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorMaterializedBlock_ab0108d8fd335ab5b22ec2e8f9862eadf}{XprType}}\ m\_expr;}
\DoxyCodeLine{00827\ \ \ \textcolor{keywordtype}{bool}\ m\_valid\_expr;}
\DoxyCodeLine{00828\ \};}
\DoxyCodeLine{00829\ }
\DoxyCodeLine{00830\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ //}}
\DoxyCodeLine{00831\ \textcolor{comment}{//\ TensorCwiseUnaryBlock\ is\ a\ lazy\ tensor\ expression\ block\ that\ applies\ UnaryOp}}
\DoxyCodeLine{00832\ \textcolor{comment}{//\ functor\ to\ the\ blocks\ produced\ by\ the\ underlying\ Tensor\ expression.}}
\DoxyCodeLine{00833\ }
\DoxyCodeLine{00834\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ UnaryOp,\ \textcolor{keyword}{typename}\ ArgTensorBlock>}
\DoxyCodeLine{00835\ \textcolor{keyword}{class\ }TensorCwiseUnaryBlock\ \{}
\DoxyCodeLine{00836\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ NoArgBlockAccess\ =}
\DoxyCodeLine{00837\ \ \ \ \ \ \ \mbox{\hyperlink{structEigen_1_1internal_1_1is__void}{internal::is\_void<typename\ ArgTensorBlock::XprType>::value}};}
\DoxyCodeLine{00838\ }
\DoxyCodeLine{00839\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00840\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ conditional<}
\DoxyCodeLine{00841\ \ \ \ \ \ \ NoArgBlockAccess,\ void,}
\DoxyCodeLine{00842\ \ \ \ \ \ \ \mbox{\hyperlink{classEigen_1_1TensorCwiseUnaryOp}{TensorCwiseUnaryOp<UnaryOp,\ const\ typename\ ArgTensorBlock::XprType>}}\ >::}
\DoxyCodeLine{00843\ \ \ \ \ \ \ type\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorCwiseUnaryBlock_af51318b150bcf0f6a7d77e546070668b}{XprType}};}
\DoxyCodeLine{00844\ }
\DoxyCodeLine{00845\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{structEigen_1_1internal_1_1XprScalar_a5fff9f58106ea14bc0855091d5d07f5f}{XprScalar<XprType>::type}}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorCwiseUnaryBlock_abae5712166aaff66272c060947b0c2e0}{Scalar}};}
\DoxyCodeLine{00846\ }
\DoxyCodeLine{00847\ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorCwiseUnaryBlock_a57ad42f1e4929ee99e0f9206384bcf6e}{TensorCwiseUnaryBlock}}(\textcolor{keyword}{const}\ ArgTensorBlock\&\ arg\_block,\ \textcolor{keyword}{const}\ UnaryOp\&\ functor)}
\DoxyCodeLine{00848\ \ \ \ \ \ \ :\ m\_arg\_block(arg\_block),\ m\_functor(functor)\ \{\}}
\DoxyCodeLine{00849\ }
\DoxyCodeLine{00850\ \ \ \mbox{\hyperlink{namespaceEigen_1_1internal_a3368ad2fe1e9bf12c1f1f767733bfcb8}{TensorBlockKind}}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorCwiseUnaryBlock_ad7c990bd89549d1b96765ec83097b649}{kind}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ internal::TensorBlockKind::kExpr;\ \}}
\DoxyCodeLine{00851\ }
\DoxyCodeLine{00852\ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorLazyEvaluatorWritable}{XprType}}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorCwiseUnaryBlock_af4807056750b95490191ad22a718f2b2}{expr}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorCwiseUnaryBlock_af51318b150bcf0f6a7d77e546070668b}{XprType}}(m\_arg\_block.expr(),\ m\_functor);\ \}}
\DoxyCodeLine{00853\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorCwiseUnaryBlock_abae5712166aaff66272c060947b0c2e0}{Scalar}}*\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorCwiseUnaryBlock_a0a8a0397f00b4a35a27d6a91bde3f325}{data}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ NULL;\ \}}
\DoxyCodeLine{00854\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorCwiseUnaryBlock_ac3be82467362f3078b3231e56b1df7a3}{cleanup}}()\ \{\ m\_arg\_block.cleanup();\ \}}
\DoxyCodeLine{00855\ }
\DoxyCodeLine{00856\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00857\ \ \ ArgTensorBlock\ m\_arg\_block;}
\DoxyCodeLine{00858\ \ \ UnaryOp\ m\_functor;}
\DoxyCodeLine{00859\ \};}
\DoxyCodeLine{00860\ }
\DoxyCodeLine{00861\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ //}}
\DoxyCodeLine{00862\ \textcolor{comment}{//\ TensorCwiseUnaryBlock\ is\ a\ lazy\ tensor\ expression\ block\ that\ applies\ BinaryOp}}
\DoxyCodeLine{00863\ \textcolor{comment}{//\ functor\ to\ the\ blocks\ produced\ by\ the\ underlying\ Tensor\ expression.}}
\DoxyCodeLine{00864\ }
\DoxyCodeLine{00865\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ BinaryOp,\ \textcolor{keyword}{typename}\ LhsTensorBlock,\ \textcolor{keyword}{typename}\ RhsTensorBlock>}
\DoxyCodeLine{00866\ \textcolor{keyword}{class\ }TensorCwiseBinaryBlock\ \{}
\DoxyCodeLine{00867\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ NoArgBlockAccess\ =}
\DoxyCodeLine{00868\ \ \ \ \ \ \ \mbox{\hyperlink{structEigen_1_1internal_1_1is__void}{internal::is\_void<typename\ LhsTensorBlock::XprType>::value}}\ ||}
\DoxyCodeLine{00869\ \ \ \ \ \ \ \mbox{\hyperlink{structEigen_1_1internal_1_1is__void}{internal::is\_void<typename\ RhsTensorBlock::XprType>::value}};}
\DoxyCodeLine{00870\ }
\DoxyCodeLine{00871\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00872\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ conditional<}
\DoxyCodeLine{00873\ \ \ \ \ \ \ NoArgBlockAccess,\ void,}
\DoxyCodeLine{00874\ \ \ \ \ \ \ \mbox{\hyperlink{classEigen_1_1TensorCwiseBinaryOp}{TensorCwiseBinaryOp}}<BinaryOp,\ \textcolor{keyword}{const}\ \textcolor{keyword}{typename}\ LhsTensorBlock::XprType,}
\DoxyCodeLine{00875\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{typename}\ RhsTensorBlock::XprType>\ >::type}
\DoxyCodeLine{00876\ \ \ \ \ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorCwiseBinaryBlock_a778e4082126efdf7b2a7537e0bf6c6c8}{XprType}};}
\DoxyCodeLine{00877\ }
\DoxyCodeLine{00878\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{structEigen_1_1internal_1_1XprScalar_a5fff9f58106ea14bc0855091d5d07f5f}{XprScalar<XprType>::type}}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorCwiseBinaryBlock_aa5242ab1b79fb0d13ee96daf18efa8a9}{Scalar}};}
\DoxyCodeLine{00879\ }
\DoxyCodeLine{00880\ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorCwiseBinaryBlock_a1713545d427df172f2074afbcfbba686}{TensorCwiseBinaryBlock}}(\textcolor{keyword}{const}\ LhsTensorBlock\&\ left\_block,}
\DoxyCodeLine{00881\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ RhsTensorBlock\&\ right\_block,}
\DoxyCodeLine{00882\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ BinaryOp\&\ functor)}
\DoxyCodeLine{00883\ \ \ \ \ \ \ :\ m\_left\_block(left\_block),}
\DoxyCodeLine{00884\ \ \ \ \ \ \ \ \ m\_right\_block(right\_block),}
\DoxyCodeLine{00885\ \ \ \ \ \ \ \ \ m\_functor(functor)\ \{\}}
\DoxyCodeLine{00886\ }
\DoxyCodeLine{00887\ \ \ \mbox{\hyperlink{namespaceEigen_1_1internal_a3368ad2fe1e9bf12c1f1f767733bfcb8}{TensorBlockKind}}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorCwiseBinaryBlock_a1a387ce2b21b23f2edcd9648123e7923}{kind}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ internal::TensorBlockKind::kExpr;\ \}}
\DoxyCodeLine{00888\ }
\DoxyCodeLine{00889\ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorLazyEvaluatorWritable}{XprType}}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorCwiseBinaryBlock_a388efe0b53d1cc2ded06f6d719858d7b}{expr}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00890\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorCwiseBinaryBlock_a778e4082126efdf7b2a7537e0bf6c6c8}{XprType}}(m\_left\_block.expr(),\ m\_right\_block.expr(),\ m\_functor);}
\DoxyCodeLine{00891\ \ \ \}}
\DoxyCodeLine{00892\ }
\DoxyCodeLine{00893\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorCwiseBinaryBlock_aa5242ab1b79fb0d13ee96daf18efa8a9}{Scalar}}*\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorCwiseBinaryBlock_ab27a1dbebffff11a0422f450b3b1afe4}{data}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ NULL;\ \}}
\DoxyCodeLine{00894\ }
\DoxyCodeLine{00895\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorCwiseBinaryBlock_a76e159651c01aa3bdda5d0834bdc9e29}{cleanup}}()\ \{}
\DoxyCodeLine{00896\ \ \ \ \ m\_left\_block.cleanup();}
\DoxyCodeLine{00897\ \ \ \ \ m\_right\_block.cleanup();}
\DoxyCodeLine{00898\ \ \ \}}
\DoxyCodeLine{00899\ }
\DoxyCodeLine{00900\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00901\ \ \ LhsTensorBlock\ m\_left\_block;}
\DoxyCodeLine{00902\ \ \ RhsTensorBlock\ m\_right\_block;}
\DoxyCodeLine{00903\ \ \ BinaryOp\ m\_functor;}
\DoxyCodeLine{00904\ \};}
\DoxyCodeLine{00905\ }
\DoxyCodeLine{00906\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ //}}
\DoxyCodeLine{00907\ \textcolor{comment}{//\ TensorUnaryExprBlock\ is\ a\ lazy\ tensor\ expression\ block\ that\ can\ construct}}
\DoxyCodeLine{00908\ \textcolor{comment}{//\ an\ arbitrary\ tensor\ expression\ from\ a\ block\ of\ the\ underlying\ type\ (this\ is\ a}}
\DoxyCodeLine{00909\ \textcolor{comment}{//\ generalization\ of\ the\ TensorCwiseUnaryBlock\ for\ arbitrary\ expressions).}}
\DoxyCodeLine{00910\ }
\DoxyCodeLine{00911\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ BlockFactory,\ \textcolor{keyword}{typename}\ ArgTensorBlock>}
\DoxyCodeLine{00912\ \textcolor{keyword}{class\ }TensorUnaryExprBlock\ \{}
\DoxyCodeLine{00913\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ ArgTensorBlock::XprType\ ArgXprType;}
\DoxyCodeLine{00914\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ NoArgBlockAccess\ =\ \mbox{\hyperlink{structEigen_1_1internal_1_1is__void}{internal::is\_void<ArgXprType>::value}};}
\DoxyCodeLine{00915\ }
\DoxyCodeLine{00916\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00917\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ conditional<}
\DoxyCodeLine{00918\ \ \ \ \ \ \ NoArgBlockAccess,\ void,}
\DoxyCodeLine{00919\ \ \ \ \ \ \ \textcolor{keyword}{typename}\ BlockFactory::template\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorLazyEvaluatorWritable}{XprType<ArgXprType>::type}}>::type\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorUnaryExprBlock_adfbfa440bf626578ac03415210f05a66}{XprType}};}
\DoxyCodeLine{00920\ }
\DoxyCodeLine{00921\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{structEigen_1_1internal_1_1XprScalar_a5fff9f58106ea14bc0855091d5d07f5f}{XprScalar<XprType>::type}}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorUnaryExprBlock_a14be03f0b80adf25adb55887cbeab88d}{Scalar}};}
\DoxyCodeLine{00922\ }
\DoxyCodeLine{00923\ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorUnaryExprBlock_a18e6ecac42ef41cadc1974362b3e5b04}{TensorUnaryExprBlock}}(\textcolor{keyword}{const}\ ArgTensorBlock\&\ arg\_block,}
\DoxyCodeLine{00924\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ BlockFactory\&\ factory)}
\DoxyCodeLine{00925\ \ \ \ \ \ \ :\ m\_arg\_block(arg\_block),\ m\_factory(factory)\ \{\}}
\DoxyCodeLine{00926\ }
\DoxyCodeLine{00927\ \ \ \mbox{\hyperlink{namespaceEigen_1_1internal_a3368ad2fe1e9bf12c1f1f767733bfcb8}{TensorBlockKind}}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorUnaryExprBlock_afec16f645a34ae318ce83b76c31edd05}{kind}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ internal::TensorBlockKind::kExpr;\ \}}
\DoxyCodeLine{00928\ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorLazyEvaluatorWritable}{XprType}}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorUnaryExprBlock_a2701bb673318d25879b0db4c96da7d1d}{expr}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ m\_factory.expr(m\_arg\_block.expr());\ \}}
\DoxyCodeLine{00929\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorUnaryExprBlock_a14be03f0b80adf25adb55887cbeab88d}{Scalar}}*\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorUnaryExprBlock_a6372ede42e77bd71dc9c15721190befc}{data}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ NULL;\ \}}
\DoxyCodeLine{00930\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorUnaryExprBlock_a6973c71dfcbc99c9d6c2b30a6586d29b}{cleanup}}()\ \{\ m\_arg\_block.cleanup();\ \}}
\DoxyCodeLine{00931\ }
\DoxyCodeLine{00932\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00933\ \ \ ArgTensorBlock\ m\_arg\_block;}
\DoxyCodeLine{00934\ \ \ BlockFactory\ m\_factory;}
\DoxyCodeLine{00935\ \};}
\DoxyCodeLine{00936\ }
\DoxyCodeLine{00937\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ //}}
\DoxyCodeLine{00938\ \textcolor{comment}{//\ TensorTernaryExprBlock\ is\ a\ lazy\ tensor\ expression\ block\ that\ can\ construct}}
\DoxyCodeLine{00939\ \textcolor{comment}{//\ an\ arbitrary\ tensor\ expression\ from\ three\ blocks\ of\ the\ underlying\ type.}}
\DoxyCodeLine{00940\ }
\DoxyCodeLine{00941\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ BlockFactory,\ \textcolor{keyword}{typename}\ Arg1TensorBlock,}
\DoxyCodeLine{00942\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typename}\ Arg2TensorBlock,\ \textcolor{keyword}{typename}\ Arg3TensorBlock>}
\DoxyCodeLine{00943\ \textcolor{keyword}{class\ }TensorTernaryExprBlock\ \{}
\DoxyCodeLine{00944\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ Arg1TensorBlock::XprType\ Arg1XprType;}
\DoxyCodeLine{00945\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ Arg2TensorBlock::XprType\ Arg2XprType;}
\DoxyCodeLine{00946\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ Arg3TensorBlock::XprType\ Arg3XprType;}
\DoxyCodeLine{00947\ }
\DoxyCodeLine{00948\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ NoArgBlockAccess\ =\ \mbox{\hyperlink{structEigen_1_1internal_1_1is__void}{internal::is\_void<Arg1XprType>::value}}\ ||}
\DoxyCodeLine{00949\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structEigen_1_1internal_1_1is__void}{internal::is\_void<Arg2XprType>::value}}\ ||}
\DoxyCodeLine{00950\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structEigen_1_1internal_1_1is__void}{internal::is\_void<Arg3XprType>::value}};}
\DoxyCodeLine{00951\ }
\DoxyCodeLine{00952\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00953\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ conditional<}
\DoxyCodeLine{00954\ \ \ \ \ \ \ NoArgBlockAccess,\ void,}
\DoxyCodeLine{00955\ \ \ \ \ \ \ \textcolor{keyword}{typename}\ BlockFactory::template\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorTernaryExprBlock_acf554bfbbe50b7ae27cbb3240f7158d4}{XprType}}<Arg1XprType,\ Arg2XprType,}
\DoxyCodeLine{00956\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Arg3XprType>::type>::type\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorTernaryExprBlock_acf554bfbbe50b7ae27cbb3240f7158d4}{XprType}};}
\DoxyCodeLine{00957\ }
\DoxyCodeLine{00958\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{structEigen_1_1internal_1_1XprScalar_a5fff9f58106ea14bc0855091d5d07f5f}{XprScalar<XprType>::type}}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorTernaryExprBlock_a0deacbaec4efc55e2991d850404a5eef}{Scalar}};}
\DoxyCodeLine{00959\ }
\DoxyCodeLine{00960\ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorTernaryExprBlock_a4d0f32996f30e129f5606dc592459375}{TensorTernaryExprBlock}}(\textcolor{keyword}{const}\ Arg1TensorBlock\&\ arg1\_block,}
\DoxyCodeLine{00961\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Arg2TensorBlock\&\ arg2\_block,}
\DoxyCodeLine{00962\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Arg3TensorBlock\&\ arg3\_block,}
\DoxyCodeLine{00963\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ BlockFactory\&\ factory)}
\DoxyCodeLine{00964\ \ \ \ \ \ \ :\ m\_arg1\_block(arg1\_block),}
\DoxyCodeLine{00965\ \ \ \ \ \ \ \ \ m\_arg2\_block(arg2\_block),}
\DoxyCodeLine{00966\ \ \ \ \ \ \ \ \ m\_arg3\_block(arg3\_block),}
\DoxyCodeLine{00967\ \ \ \ \ \ \ \ \ m\_factory(factory)\ \{\}}
\DoxyCodeLine{00968\ }
\DoxyCodeLine{00969\ \ \ \mbox{\hyperlink{namespaceEigen_1_1internal_a3368ad2fe1e9bf12c1f1f767733bfcb8}{TensorBlockKind}}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorTernaryExprBlock_a22474925e1b25d8a6d7fb3b1e26206c7}{kind}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ internal::TensorBlockKind::kExpr;\ \}}
\DoxyCodeLine{00970\ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorLazyEvaluatorWritable}{XprType}}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorTernaryExprBlock_a0ec59ca1bf9a9cedbeeb68a480351842}{expr}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00971\ \ \ \ \ \textcolor{keywordflow}{return}\ m\_factory.expr(m\_arg1\_block.expr(),\ m\_arg2\_block.expr(),}
\DoxyCodeLine{00972\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_arg3\_block.expr());}
\DoxyCodeLine{00973\ \ \ \}}
\DoxyCodeLine{00974\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorTernaryExprBlock_a0deacbaec4efc55e2991d850404a5eef}{Scalar}}*\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorTernaryExprBlock_a4ffa940bbf528c372860f14ab0056107}{data}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ NULL;\ \}}
\DoxyCodeLine{00975\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorTernaryExprBlock_acf9515d1f5386c07e11c6f9f6056e075}{cleanup}}()\ \{}
\DoxyCodeLine{00976\ \ \ \ \ m\_arg1\_block.cleanup();}
\DoxyCodeLine{00977\ \ \ \ \ m\_arg2\_block.cleanup();}
\DoxyCodeLine{00978\ \ \ \ \ m\_arg3\_block.cleanup();}
\DoxyCodeLine{00979\ \ \ \}}
\DoxyCodeLine{00980\ }
\DoxyCodeLine{00981\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00982\ \ \ Arg1TensorBlock\ m\_arg1\_block;}
\DoxyCodeLine{00983\ \ \ Arg2TensorBlock\ m\_arg2\_block;}
\DoxyCodeLine{00984\ \ \ Arg3TensorBlock\ m\_arg3\_block;}
\DoxyCodeLine{00985\ \ \ BlockFactory\ m\_factory;}
\DoxyCodeLine{00986\ \};}
\DoxyCodeLine{00987\ }
\DoxyCodeLine{00988\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ //}}
\DoxyCodeLine{00989\ \textcolor{comment}{//\ StridedLinearBufferCopy\ provides\ a\ method\ to\ copy\ data\ between\ two\ linear}}
\DoxyCodeLine{00990\ \textcolor{comment}{//\ buffers\ with\ different\ strides,\ with\ optimized\ paths\ for\ scatter/gather.}}
\DoxyCodeLine{00991\ }
\DoxyCodeLine{00992\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Scalar,\ \textcolor{keyword}{typename}\ IndexType>}
\DoxyCodeLine{00993\ \textcolor{keyword}{class\ }StridedLinearBufferCopy\ \{}
\DoxyCodeLine{00994\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{structEigen_1_1internal_1_1packet__traits_a811c5bde6641fd0f7a8f88be5e11ce27}{packet\_traits<Scalar>::type}}\ Packet;}
\DoxyCodeLine{00995\ \ \ \textcolor{keyword}{enum}\ \{}
\DoxyCodeLine{00996\ \ \ \ \ Vectorizable\ =\ \mbox{\hyperlink{structEigen_1_1internal_1_1packet__traits_a9fce3b012e6a350f2bd9163d7820fefaa57b1420dcdf4decb6bc1e9259de1e1d5}{packet\_traits<Scalar>::Vectorizable}},}
\DoxyCodeLine{00997\ \ \ \ \ PacketSize\ =\ \mbox{\hyperlink{structEigen_1_1internal_1_1packet__traits_a9fce3b012e6a350f2bd9163d7820fefaa0e933e5c1966ffb2dccec1f29678a1ed}{packet\_traits<Scalar>::size}}}
\DoxyCodeLine{00998\ \ \ \};}
\DoxyCodeLine{00999\ }
\DoxyCodeLine{01000\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{01001\ \ \ \textcolor{comment}{//\ Specifying\ linear\ copy\ kind\ statically\ gives\ \string~30\%\ speedup\ for\ small\ sizes.}}
\DoxyCodeLine{01002\ \ \ \textcolor{keyword}{enum\ class}\ \mbox{\hyperlink{classEigen_1_1internal_1_1StridedLinearBufferCopy_a9b33c9925cacf0deff3334bc2f2d389d}{Kind}}\ \{}
\DoxyCodeLine{01003\ \ \ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1StridedLinearBufferCopy_a9b33c9925cacf0deff3334bc2f2d389da32a843da6ea40ab3b17a3421ccdf671b}{Linear}}\ =\ 0,\ \ \ \ \ \ \ \textcolor{comment}{//\ src\_stride\ ==\ 1\ \&\&\ dst\_stride\ ==\ 1}}
\DoxyCodeLine{01004\ \ \ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1StridedLinearBufferCopy_a9b33c9925cacf0deff3334bc2f2d389da09870720ca8134284e4e305ac6ce5f19}{Scatter}}\ =\ 1,\ \ \ \ \ \ \textcolor{comment}{//\ src\_stride\ ==\ 1\ \&\&\ dst\_stride\ !=\ 1}}
\DoxyCodeLine{01005\ \ \ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1StridedLinearBufferCopy_a9b33c9925cacf0deff3334bc2f2d389dac6fac6cb6e9ef1112afbe80ba7d75e9d}{FillLinear}}\ =\ 2,\ \ \ \textcolor{comment}{//\ src\_stride\ ==\ 0\ \&\&\ dst\_stride\ ==\ 1}}
\DoxyCodeLine{01006\ \ \ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1StridedLinearBufferCopy_a9b33c9925cacf0deff3334bc2f2d389da169f5b22a803b87d715fd6100cbece9a}{FillScatter}}\ =\ 3,\ \ \textcolor{comment}{//\ src\_stride\ ==\ 0\ \&\&\ dst\_stride\ !=\ 1}}
\DoxyCodeLine{01007\ \ \ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1StridedLinearBufferCopy_a9b33c9925cacf0deff3334bc2f2d389daad22c799930d644e8468fe44c0312d53}{Gather}}\ =\ 4,\ \ \ \ \ \ \ \textcolor{comment}{//\ dst\_stride\ ==\ 1}}
\DoxyCodeLine{01008\ \ \ \ \ Random\ =\ 5\ \ \ \ \ \ \ \ \textcolor{comment}{//\ everything\ else}}
\DoxyCodeLine{01009\ \ \ \};}
\DoxyCodeLine{01010\ }
\DoxyCodeLine{01011\ \ \ \textcolor{keyword}{struct\ }Dst\ \{}
\DoxyCodeLine{01012\ \ \ \ \ \mbox{\hyperlink{structEigen_1_1internal_1_1StridedLinearBufferCopy_1_1Dst_a48c69187bf11579bf9ad3d4e018e63fe}{Dst}}(IndexType\ \mbox{\hyperlink{abseil-cpp_2absl_2strings_2internal_2str__format_2parser__test_8cc_a0d49472070872337a386fae346d4ff78}{o}},\ IndexType\ s,\ Scalar*\ d)\ :\ \mbox{\hyperlink{structEigen_1_1internal_1_1StridedLinearBufferCopy_1_1Dst_a4ac11f2f8e2166afd97a63de17780175}{offset}}(\mbox{\hyperlink{abseil-cpp_2absl_2strings_2internal_2str__format_2parser__test_8cc_a0d49472070872337a386fae346d4ff78}{o}}),\ \mbox{\hyperlink{structEigen_1_1internal_1_1StridedLinearBufferCopy_1_1Dst_a6fa92dc5ced9b852ea836771812ff3bb}{stride}}(s),\ \mbox{\hyperlink{structEigen_1_1internal_1_1StridedLinearBufferCopy_1_1Dst_a8c6889428cd30ce38c1fcd06a085f32b}{data}}(d)\ \{\}}
\DoxyCodeLine{01013\ }
\DoxyCodeLine{01014\ \ \ \ \ IndexType\ \mbox{\hyperlink{structEigen_1_1internal_1_1StridedLinearBufferCopy_1_1Dst_a4ac11f2f8e2166afd97a63de17780175}{offset}};}
\DoxyCodeLine{01015\ \ \ \ \ IndexType\ \mbox{\hyperlink{structEigen_1_1internal_1_1StridedLinearBufferCopy_1_1Dst_a6fa92dc5ced9b852ea836771812ff3bb}{stride}};}
\DoxyCodeLine{01016\ \ \ \ \ Scalar*\ \mbox{\hyperlink{structEigen_1_1internal_1_1StridedLinearBufferCopy_1_1Dst_a8c6889428cd30ce38c1fcd06a085f32b}{data}};}
\DoxyCodeLine{01017\ \ \ \};}
\DoxyCodeLine{01018\ }
\DoxyCodeLine{01019\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structEigen_1_1internal_1_1StridedLinearBufferCopy_1_1Src}{Src}}\ \{}
\DoxyCodeLine{01020\ \ \ \ \ \mbox{\hyperlink{structEigen_1_1internal_1_1StridedLinearBufferCopy_1_1Src_a7ffa309f5d6e9cbc0119119a142fb39a}{Src}}(IndexType\ \mbox{\hyperlink{abseil-cpp_2absl_2strings_2internal_2str__format_2parser__test_8cc_a0d49472070872337a386fae346d4ff78}{o}},\ IndexType\ s,\ \textcolor{keyword}{const}\ Scalar*\ d)}
\DoxyCodeLine{01021\ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{structEigen_1_1internal_1_1StridedLinearBufferCopy_1_1Src_ab145d541c9d6cbfbf677189eb5e8e221}{offset}}(\mbox{\hyperlink{abseil-cpp_2absl_2strings_2internal_2str__format_2parser__test_8cc_a0d49472070872337a386fae346d4ff78}{o}}),\ \mbox{\hyperlink{structEigen_1_1internal_1_1StridedLinearBufferCopy_1_1Src_af1fcd08fd276f0c258d82e68dda767ba}{stride}}(s),\ \mbox{\hyperlink{structEigen_1_1internal_1_1StridedLinearBufferCopy_1_1Src_acf77260d5311777d61f7c11da70ee4be}{data}}(d)\ \{\}}
\DoxyCodeLine{01022\ }
\DoxyCodeLine{01023\ \ \ \ \ IndexType\ \mbox{\hyperlink{structEigen_1_1internal_1_1StridedLinearBufferCopy_1_1Src_ab145d541c9d6cbfbf677189eb5e8e221}{offset}};}
\DoxyCodeLine{01024\ \ \ \ \ IndexType\ \mbox{\hyperlink{structEigen_1_1internal_1_1StridedLinearBufferCopy_1_1Src_af1fcd08fd276f0c258d82e68dda767ba}{stride}};}
\DoxyCodeLine{01025\ \ \ \ \ \textcolor{keyword}{const}\ Scalar*\ \mbox{\hyperlink{structEigen_1_1internal_1_1StridedLinearBufferCopy_1_1Src_acf77260d5311777d61f7c11da70ee4be}{data}};}
\DoxyCodeLine{01026\ \ \ \};}
\DoxyCodeLine{01027\ }
\DoxyCodeLine{01028\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Str\textcolor{keywordtype}{id}edLinearBufferCopy::Kind\ kind>}
\DoxyCodeLine{01029\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}\ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEigen_1_1internal_1_1StridedLinearBufferCopy_ab9173990055cffadb030e6c23ee34a01}{Run}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1internal_1_1StridedLinearBufferCopy_1_1Dst}{Dst}}\&\ dst,}
\DoxyCodeLine{01030\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1internal_1_1StridedLinearBufferCopy_1_1Src}{Src}}\&\ src,}
\DoxyCodeLine{01031\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2internal_2raw__hash__set__test_8cc_ad43c3812e6d13e0518d9f8b8f463ffcf}{count}})\ \{}
\DoxyCodeLine{01032\ \ \ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1StridedLinearBufferCopy_ab9173990055cffadb030e6c23ee34a01}{Run<kind>}}(\mbox{\hyperlink{abseil-cpp_2absl_2container_2internal_2raw__hash__set__test_8cc_ad43c3812e6d13e0518d9f8b8f463ffcf}{count}},\ dst.offset,\ dst.stride,\ dst.data,\ src.\mbox{\hyperlink{structEigen_1_1internal_1_1StridedLinearBufferCopy_1_1Src_ab145d541c9d6cbfbf677189eb5e8e221}{offset}},\ src.\mbox{\hyperlink{structEigen_1_1internal_1_1StridedLinearBufferCopy_1_1Src_af1fcd08fd276f0c258d82e68dda767ba}{stride}},}
\DoxyCodeLine{01033\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ src.\mbox{\hyperlink{structEigen_1_1internal_1_1StridedLinearBufferCopy_1_1Src_acf77260d5311777d61f7c11da70ee4be}{data}});}
\DoxyCodeLine{01034\ \ \ \}}
\DoxyCodeLine{01035\ }
\DoxyCodeLine{01036\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{01037\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Str\textcolor{keywordtype}{id}edLinearBufferCopy::Kind\ kind>}
\DoxyCodeLine{01038\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}\ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEigen_1_1internal_1_1StridedLinearBufferCopy_ab9173990055cffadb030e6c23ee34a01}{Run}}(}
\DoxyCodeLine{01039\ \ \ \ \ \ \ \textcolor{keyword}{const}\ IndexType\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2internal_2raw__hash__set__test_8cc_ad43c3812e6d13e0518d9f8b8f463ffcf}{count}},\ \textcolor{keyword}{const}\ IndexType\ dst\_offset,}
\DoxyCodeLine{01040\ \ \ \ \ \ \ \textcolor{keyword}{const}\ IndexType\ dst\_stride,\ Scalar*\ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_a05b03c839f8f1357916472a45013c57b}{EIGEN\_RESTRICT}}\ dst\_data,}
\DoxyCodeLine{01041\ \ \ \ \ \ \ \textcolor{keyword}{const}\ IndexType\ src\_offset,\ \textcolor{keyword}{const}\ IndexType\ src\_stride,}
\DoxyCodeLine{01042\ \ \ \ \ \ \ \textcolor{keyword}{const}\ Scalar*\ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_a05b03c839f8f1357916472a45013c57b}{EIGEN\_RESTRICT}}\ src\_data)\ \{}
\DoxyCodeLine{01043\ \ \ \ \ \textcolor{keyword}{const}\ Scalar*\ src\ =\ \&src\_data[src\_offset];}
\DoxyCodeLine{01044\ \ \ \ \ Scalar*\ dst\ =\ \&dst\_data[dst\_offset];}
\DoxyCodeLine{01045\ }
\DoxyCodeLine{01046\ \ \ \ \ \textcolor{keywordflow}{if}\ (!Vectorizable)\ \{}
\DoxyCodeLine{01047\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2internal_2raw__hash__set__test_8cc_ad43c3812e6d13e0518d9f8b8f463ffcf}{count}};\ ++\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ \{}
\DoxyCodeLine{01048\ \ \ \ \ \ \ \ \ dst[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ *\ dst\_stride]\ =\ src[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ *\ src\_stride];}
\DoxyCodeLine{01049\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01050\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01051\ \ \ \ \ \}}
\DoxyCodeLine{01052\ }
\DoxyCodeLine{01053\ \ \ \ \ \textcolor{keyword}{const}\ IndexType\ vectorized\_size\ =\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2internal_2raw__hash__set__test_8cc_ad43c3812e6d13e0518d9f8b8f463ffcf}{count}}\ -\/\ PacketSize;}
\DoxyCodeLine{01054\ \ \ \ \ IndexType\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 0;}
\DoxyCodeLine{01055\ }
\DoxyCodeLine{01056\ \ \ \ \ \textcolor{keywordflow}{if}\ (kind\ ==\ \mbox{\hyperlink{classEigen_1_1internal_1_1StridedLinearBufferCopy_a9b33c9925cacf0deff3334bc2f2d389da32a843da6ea40ab3b17a3421ccdf671b}{StridedLinearBufferCopy::Kind::Linear}})\ \{}
\DoxyCodeLine{01057\ \ \ \ \ \ \ \textcolor{comment}{//\ ********************************************************************\ //}}
\DoxyCodeLine{01058\ \ \ \ \ \ \ \textcolor{comment}{//\ Linear\ copy\ from\ \`{}src`\ to\ \`{}dst`.}}
\DoxyCodeLine{01059\ \ \ \ \ \ \ \textcolor{keyword}{const}\ IndexType\ unrolled\_size\ =\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2internal_2raw__hash__set__test_8cc_ad43c3812e6d13e0518d9f8b8f463ffcf}{count}}\ -\/\ 4\ *\ PacketSize;}
\DoxyCodeLine{01060\ \ \ \ \ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(src\_stride\ ==\ 1\ \&\&\ dst\_stride\ ==\ 1);}
\DoxyCodeLine{01061\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <=\ unrolled\_size;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +=\ 4\ *\ PacketSize)\ \{}
\DoxyCodeLine{01062\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ 4;\ ++j)\ \{}
\DoxyCodeLine{01063\ \ \ \ \ \ \ \ \ \ \ Packet\ p\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_a5987b33df9fc7e5bd824287307fac913}{ploadu<Packet>}}(src\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +\ j\ *\ PacketSize);}
\DoxyCodeLine{01064\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceEigen_1_1internal_abcb1c5d429335ed8c976a6b238287a2e}{pstoreu<Scalar,\ Packet>}}(dst\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +\ j\ *\ PacketSize,\ p);}
\DoxyCodeLine{01065\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01066\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01067\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <=\ vectorized\_size;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +=\ PacketSize)\ \{}
\DoxyCodeLine{01068\ \ \ \ \ \ \ \ \ Packet\ \mbox{\hyperlink{namespaceabsl_a828e0f13fb3947cdf6406b7a4feec8aca83878c91171338902e0fe0fb97a8c47a}{p}}\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_a5987b33df9fc7e5bd824287307fac913}{ploadu<Packet>}}(src\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}});}
\DoxyCodeLine{01069\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceEigen_1_1internal_abcb1c5d429335ed8c976a6b238287a2e}{pstoreu<Scalar,\ Packet>}}(dst\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}},\ p);}
\DoxyCodeLine{01070\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01071\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2internal_2raw__hash__set__test_8cc_ad43c3812e6d13e0518d9f8b8f463ffcf}{count}};\ ++\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ \{}
\DoxyCodeLine{01072\ \ \ \ \ \ \ \ \ dst[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}]\ =\ src[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}];}
\DoxyCodeLine{01073\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01074\ \ \ \ \ \ \ \textcolor{comment}{//\ ********************************************************************\ //}}
\DoxyCodeLine{01075\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (kind\ ==\ \mbox{\hyperlink{classEigen_1_1internal_1_1StridedLinearBufferCopy_a9b33c9925cacf0deff3334bc2f2d389da09870720ca8134284e4e305ac6ce5f19}{StridedLinearBufferCopy::Kind::Scatter}})\ \{}
\DoxyCodeLine{01076\ \ \ \ \ \ \ \textcolor{comment}{//\ Scatter\ from\ \`{}src`\ to\ \`{}dst`.}}
\DoxyCodeLine{01077\ \ \ \ \ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(src\_stride\ ==\ 1\ \&\&\ dst\_stride\ !=\ 1);}
\DoxyCodeLine{01078\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <=\ vectorized\_size;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +=\ PacketSize)\ \{}
\DoxyCodeLine{01079\ \ \ \ \ \ \ \ \ Packet\ \mbox{\hyperlink{namespaceabsl_a828e0f13fb3947cdf6406b7a4feec8aca83878c91171338902e0fe0fb97a8c47a}{p}}\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_a5987b33df9fc7e5bd824287307fac913}{ploadu<Packet>}}(src\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}});}
\DoxyCodeLine{01080\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceEigen_1_1internal_a8ec395bc54b860a3f62a879fec09cf19}{pscatter<Scalar,\ Packet>}}(dst\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ *\ dst\_stride,\ p,\ dst\_stride);}
\DoxyCodeLine{01081\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01082\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2internal_2raw__hash__set__test_8cc_ad43c3812e6d13e0518d9f8b8f463ffcf}{count}};\ ++\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ \{}
\DoxyCodeLine{01083\ \ \ \ \ \ \ \ \ dst[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ *\ dst\_stride]\ =\ src[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}];}
\DoxyCodeLine{01084\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01085\ \ \ \ \ \ \ \textcolor{comment}{//\ ********************************************************************\ //}}
\DoxyCodeLine{01086\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (kind\ ==\ \mbox{\hyperlink{classEigen_1_1internal_1_1StridedLinearBufferCopy_a9b33c9925cacf0deff3334bc2f2d389dac6fac6cb6e9ef1112afbe80ba7d75e9d}{StridedLinearBufferCopy::Kind::FillLinear}})\ \{}
\DoxyCodeLine{01087\ \ \ \ \ \ \ \textcolor{comment}{//\ Fill\ \`{}dst`\ with\ value\ at\ \`{}*src`.}}
\DoxyCodeLine{01088\ \ \ \ \ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(src\_stride\ ==\ 0\ \&\&\ dst\_stride\ ==\ 1);}
\DoxyCodeLine{01089\ \ \ \ \ \ \ \textcolor{keyword}{const}\ IndexType\ unrolled\_size\ =\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2internal_2raw__hash__set__test_8cc_ad43c3812e6d13e0518d9f8b8f463ffcf}{count}}\ -\/\ 4\ *\ PacketSize;}
\DoxyCodeLine{01090\ \ \ \ \ \ \ Packet\ \mbox{\hyperlink{namespaceabsl_a828e0f13fb3947cdf6406b7a4feec8aca83878c91171338902e0fe0fb97a8c47a}{p}}\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_adb6cba700a88a195f7bcb75db14bce7f}{pload1<Packet>}}(src);}
\DoxyCodeLine{01091\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <=\ unrolled\_size;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +=\ 4\ *\ PacketSize)\ \{}
\DoxyCodeLine{01092\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ \mbox{\hyperlink{namespaceabsl_adb6bd4a9012b471ac01613aff8d4d81ba363b122c528f54df4a0446b6bab05515}{j}}\ <\ 4;\ ++\mbox{\hyperlink{namespaceabsl_adb6bd4a9012b471ac01613aff8d4d81ba363b122c528f54df4a0446b6bab05515}{j}})\ \{}
\DoxyCodeLine{01093\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceEigen_1_1internal_abcb1c5d429335ed8c976a6b238287a2e}{pstoreu<Scalar,\ Packet>}}(dst\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +\ j\ *\ PacketSize,\ p);}
\DoxyCodeLine{01094\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01095\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01096\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <=\ vectorized\_size;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +=\ PacketSize)\ \{}
\DoxyCodeLine{01097\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceEigen_1_1internal_abcb1c5d429335ed8c976a6b238287a2e}{pstoreu<Scalar,\ Packet>}}(dst\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}},\ p);}
\DoxyCodeLine{01098\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01099\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2internal_2raw__hash__set__test_8cc_ad43c3812e6d13e0518d9f8b8f463ffcf}{count}};\ ++\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ \{}
\DoxyCodeLine{01100\ \ \ \ \ \ \ \ \ dst[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}]\ =\ *src;}
\DoxyCodeLine{01101\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01102\ \ \ \ \ \ \ \textcolor{comment}{//\ ********************************************************************\ //}}
\DoxyCodeLine{01103\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (kind\ ==\ \mbox{\hyperlink{classEigen_1_1internal_1_1StridedLinearBufferCopy_a9b33c9925cacf0deff3334bc2f2d389da169f5b22a803b87d715fd6100cbece9a}{StridedLinearBufferCopy::Kind::FillScatter}})\ \{}
\DoxyCodeLine{01104\ \ \ \ \ \ \ \textcolor{comment}{//\ Scatter\ \`{}*src`\ into\ \`{}dst`.}}
\DoxyCodeLine{01105\ \ \ \ \ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(src\_stride\ ==\ 0\ \&\&\ dst\_stride\ !=\ 1);}
\DoxyCodeLine{01106\ \ \ \ \ \ \ Packet\ \mbox{\hyperlink{namespaceabsl_a828e0f13fb3947cdf6406b7a4feec8aca83878c91171338902e0fe0fb97a8c47a}{p}}\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_adb6cba700a88a195f7bcb75db14bce7f}{pload1<Packet>}}(src);}
\DoxyCodeLine{01107\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <=\ vectorized\_size;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +=\ PacketSize)\ \{}
\DoxyCodeLine{01108\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceEigen_1_1internal_a8ec395bc54b860a3f62a879fec09cf19}{pscatter<Scalar,\ Packet>}}(dst\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ *\ dst\_stride,\ p,\ dst\_stride);}
\DoxyCodeLine{01109\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01110\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2internal_2raw__hash__set__test_8cc_ad43c3812e6d13e0518d9f8b8f463ffcf}{count}};\ ++\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ \{}
\DoxyCodeLine{01111\ \ \ \ \ \ \ \ \ dst[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ *\ dst\_stride]\ =\ *src;}
\DoxyCodeLine{01112\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01113\ \ \ \ \ \ \ \textcolor{comment}{//\ ********************************************************************\ //}}
\DoxyCodeLine{01114\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (kind\ ==\ \mbox{\hyperlink{classEigen_1_1internal_1_1StridedLinearBufferCopy_a9b33c9925cacf0deff3334bc2f2d389daad22c799930d644e8468fe44c0312d53}{StridedLinearBufferCopy::Kind::Gather}})\ \{}
\DoxyCodeLine{01115\ \ \ \ \ \ \ \textcolor{comment}{//\ Gather\ from\ \`{}src`\ into\ \`{}dst`.}}
\DoxyCodeLine{01116\ \ \ \ \ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(dst\_stride\ ==\ 1);}
\DoxyCodeLine{01117\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <=\ vectorized\_size;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +=\ PacketSize)\ \{}
\DoxyCodeLine{01118\ \ \ \ \ \ \ \ \ Packet\ \mbox{\hyperlink{namespaceabsl_a828e0f13fb3947cdf6406b7a4feec8aca83878c91171338902e0fe0fb97a8c47a}{p}}\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_a49ef1e59fe39c143bd5a24f8f9d2dcbd}{pgather<Scalar,\ Packet>}}(src\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ *\ src\_stride,\ src\_stride);}
\DoxyCodeLine{01119\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceEigen_1_1internal_abcb1c5d429335ed8c976a6b238287a2e}{pstoreu<Scalar,\ Packet>}}(dst\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}},\ p);}
\DoxyCodeLine{01120\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01121\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2internal_2raw__hash__set__test_8cc_ad43c3812e6d13e0518d9f8b8f463ffcf}{count}};\ ++\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ \{}
\DoxyCodeLine{01122\ \ \ \ \ \ \ \ \ dst[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}]\ =\ src[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ *\ src\_stride];}
\DoxyCodeLine{01123\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01124\ \ \ \ \ \ \ \textcolor{comment}{//\ ********************************************************************\ //}}
\DoxyCodeLine{01125\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (kind\ ==\ \mbox{\hyperlink{classEigen_1_1internal_1_1StridedLinearBufferCopy_a9b33c9925cacf0deff3334bc2f2d389da64663f4646781c9c0110838b905daa23}{StridedLinearBufferCopy::Kind::Random}})\ \{}
\DoxyCodeLine{01126\ \ \ \ \ \ \ \textcolor{comment}{//\ Random.}}
\DoxyCodeLine{01127\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2internal_2raw__hash__set__test_8cc_ad43c3812e6d13e0518d9f8b8f463ffcf}{count}};\ ++\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ \{}
\DoxyCodeLine{01128\ \ \ \ \ \ \ \ \ dst[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ *\ dst\_stride]\ =\ src[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ *\ src\_stride];}
\DoxyCodeLine{01129\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01130\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01131\ \ \ \ \ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(\textcolor{keyword}{false});}
\DoxyCodeLine{01132\ \ \ \ \ \}}
\DoxyCodeLine{01133\ \ \ \}}
\DoxyCodeLine{01134\ \};}
\DoxyCodeLine{01135\ }
\DoxyCodeLine{01136\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ //}}
\DoxyCodeLine{01137\ \textcolor{comment}{//\ TensorBlockIO\ copies\ data\ from\ \`{}src`\ tensor\ block,\ to\ the\ \`{}dst`\ tensor\ block.}}
\DoxyCodeLine{01138\ \textcolor{comment}{//\ It's\ possible\ to\ specify\ src-\/>dst\ dimension\ mapping\ for\ the\ copy\ operation.}}
\DoxyCodeLine{01139\ \textcolor{comment}{//\ Dimensions\ of\ \`{}dst`\ specify\ how\ many\ elements\ have\ to\ be\ copied,\ for\ the}}
\DoxyCodeLine{01140\ \textcolor{comment}{//\ \`{}src`\ we\ need\ to\ know\ only\ stride\ to\ navigate\ through\ source\ memory\ buffer.}}
\DoxyCodeLine{01141\ }
\DoxyCodeLine{01142\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Scalar,\ \textcolor{keyword}{typename}\ IndexType,\ \textcolor{keywordtype}{int}\ NumDims,\ \textcolor{keywordtype}{int}\ Layout>}
\DoxyCodeLine{01143\ \textcolor{keyword}{class\ }TensorBlockIO\ \{}
\DoxyCodeLine{01144\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ IsColMajor\ =\ (Layout\ ==\ \mbox{\hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13a0cbd4bdd0abcfc0224c5fcb5e4f6669a}{ColMajor}});}
\DoxyCodeLine{01145\ }
\DoxyCodeLine{01146\ \ \ \textcolor{keyword}{typedef}\ StridedLinearBufferCopy<Scalar,\ IndexType>\ LinCopy;}
\DoxyCodeLine{01147\ }
\DoxyCodeLine{01148\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{01149\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{structEigen_1_1DSizes}{DSizes<IndexType,\ NumDims>}}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockIO_ab2b3314b8999481e776a595d27045a51}{Dimensions}};}
\DoxyCodeLine{01150\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{structEigen_1_1DSizes}{DSizes<int,\ NumDims>}}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockIO_abab99984c6e663b4ae461515ef8bf9c5}{DimensionsMap}};}
\DoxyCodeLine{01151\ }
\DoxyCodeLine{01152\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockIO_1_1Dst}{Dst}}\ \{}
\DoxyCodeLine{01153\ \ \ \ \ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockIO_1_1Dst_aeb8a61469d7fc663f2192e1c3971a143}{Dst}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1DSizes}{Dimensions}}\&\ dst\_dims,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1DSizes}{Dimensions}}\&\ dst\_strides,\ Scalar*\ dst,}
\DoxyCodeLine{01154\ \ \ \ \ \ \ \ \ IndexType\ dst\_offset\ =\ 0)}
\DoxyCodeLine{01155\ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockIO_1_1Dst_ac796ea360382528424e2b50d09d18e65}{dims}}(dst\_dims),\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockIO_1_1Dst_a99e3a5453a68da58738cfc48113b9601}{strides}}(dst\_strides),\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockIO_1_1Dst_a8ed9897587b23e75bf4b85c94830925e}{data}}(dst),\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockIO_1_1Dst_a4d5ff8d4eb9d4bbac43511114251136d}{offset}}(dst\_offset)\ \{\}}
\DoxyCodeLine{01156\ }
\DoxyCodeLine{01157\ \ \ \ \ \mbox{\hyperlink{structEigen_1_1DSizes}{Dimensions}}\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockIO_1_1Dst_ac796ea360382528424e2b50d09d18e65}{dims}};}
\DoxyCodeLine{01158\ \ \ \ \ \mbox{\hyperlink{structEigen_1_1DSizes}{Dimensions}}\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockIO_1_1Dst_a99e3a5453a68da58738cfc48113b9601}{strides}};}
\DoxyCodeLine{01159\ \ \ \ \ Scalar*\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockIO_1_1Dst_a8ed9897587b23e75bf4b85c94830925e}{data}};}
\DoxyCodeLine{01160\ \ \ \ \ IndexType\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockIO_1_1Dst_a4d5ff8d4eb9d4bbac43511114251136d}{offset}};}
\DoxyCodeLine{01161\ \ \ \};}
\DoxyCodeLine{01162\ }
\DoxyCodeLine{01163\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockIO_1_1Src}{Src}}\ \{}
\DoxyCodeLine{01164\ \ \ \ \ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockIO_1_1Src_ade5df73afe7a91432eea047ca821da80}{Src}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1DSizes}{Dimensions}}\&\ src\_strides,\ \textcolor{keyword}{const}\ Scalar*\ src,}
\DoxyCodeLine{01165\ \ \ \ \ \ \ \ \ IndexType\ src\_offset\ =\ 0)}
\DoxyCodeLine{01166\ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockIO_1_1Src_a6e7a522304fc7465449a868299fdcef5}{strides}}(src\_strides),\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockIO_1_1Src_a76ce53b18a459b8942f795dccacd512c}{data}}(src),\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockIO_1_1Src_a7be585e5b9c1d2e1d3a9703286ad6ec8}{offset}}(src\_offset)\ \{\}}
\DoxyCodeLine{01167\ }
\DoxyCodeLine{01168\ \ \ \ \ \mbox{\hyperlink{structEigen_1_1DSizes}{Dimensions}}\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockIO_1_1Src_a6e7a522304fc7465449a868299fdcef5}{strides}};}
\DoxyCodeLine{01169\ \ \ \ \ \textcolor{keyword}{const}\ Scalar*\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockIO_1_1Src_a76ce53b18a459b8942f795dccacd512c}{data}};}
\DoxyCodeLine{01170\ \ \ \ \ IndexType\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockIO_1_1Src_a7be585e5b9c1d2e1d3a9703286ad6ec8}{offset}};}
\DoxyCodeLine{01171\ \ \ \};}
\DoxyCodeLine{01172\ }
\DoxyCodeLine{01173\ \ \ \textcolor{comment}{//\ Copies\ data\ to\ \`{}dst`\ from\ \`{}src`,\ using\ provided\ dimensions\ mapping:}}
\DoxyCodeLine{01174\ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{01175\ \ \ \textcolor{comment}{//\ \ \ src\_dimension\_index\ =\ dst\_to\_src\_dim\_map[dst\_dimension\_index]}}
\DoxyCodeLine{01176\ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{01177\ \ \ \textcolor{comment}{//\ Returns\ the\ number\ of\ copied\ elements.}}
\DoxyCodeLine{01178\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}\ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ IndexType\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockIO_a3eed5c23e9578f8ed8b2946045ab1d68}{Copy}}(}
\DoxyCodeLine{01179\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockIO_1_1Dst}{Dst}}\&\ dst,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockIO_1_1Src}{Src}}\&\ src,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1DSizes}{DimensionsMap}}\&\ dst\_to\_src\_dim\_map)\ \{}
\DoxyCodeLine{01180\ \ \ \ \ \textcolor{comment}{//\ Copy\ single\ scalar\ value\ from\ \`{}src`\ to\ \`{}dst`.}}
\DoxyCodeLine{01181\ \ \ \ \ \textcolor{keywordflow}{if}\ (NumDims\ ==\ 0)\ \{}
\DoxyCodeLine{01182\ \ \ \ \ \ \ *(dst.data\ +\ dst.offset)\ =\ *(src.\mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockIO_1_1Src_a76ce53b18a459b8942f795dccacd512c}{data}}\ +\ src.\mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockIO_1_1Src_a7be585e5b9c1d2e1d3a9703286ad6ec8}{offset}});}
\DoxyCodeLine{01183\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{01184\ \ \ \ \ \}}
\DoxyCodeLine{01185\ }
\DoxyCodeLine{01186\ \ \ \ \ \textcolor{comment}{//\ Both\ \`{}dst`\ and\ \`{}src`\ must\ have\ contiguous\ innermost\ dimension.\ We\ also}}
\DoxyCodeLine{01187\ \ \ \ \ \textcolor{comment}{//\ accept\ the\ special\ case\ with\ stride\ '0',\ because\ it's\ used\ as\ a\ trick\ to}}
\DoxyCodeLine{01188\ \ \ \ \ \textcolor{comment}{//\ implement\ broadcasting.}}
\DoxyCodeLine{01189\ \ \ \ \ \{}
\DoxyCodeLine{01190\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ inner\_dim\ =\ IsColMajor\ ?\ 0\ :\ NumDims\ -\/\ 1;}
\DoxyCodeLine{01191\ \ \ \ \ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_a7cf6d5b460def34dc4e6acf42889b6a9}{EIGEN\_UNUSED\_VARIABLE}}(inner\_dim);}
\DoxyCodeLine{01192\ \ \ \ \ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(dst.strides[inner\_dim]\ ==\ 1\ ||\ dst.strides[inner\_dim]\ ==\ 0);}
\DoxyCodeLine{01193\ \ \ \ \ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(src.\mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockIO_1_1Src_a6e7a522304fc7465449a868299fdcef5}{strides}}[inner\_dim]\ ==\ 1\ ||\ src.\mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockIO_1_1Src_a6e7a522304fc7465449a868299fdcef5}{strides}}[inner\_dim]\ ==\ 0);}
\DoxyCodeLine{01194\ \ \ \ \ \}}
\DoxyCodeLine{01195\ }
\DoxyCodeLine{01196\ \ \ \ \ \textcolor{comment}{//\ Give\ a\ shorter\ name\ to\ \`{}dst\_to\_src\_dim\_map`.}}
\DoxyCodeLine{01197\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1DSizes}{DimensionsMap}}\&\ dim\_map\ =\ dst\_to\_src\_dim\_map;}
\DoxyCodeLine{01198\ }
\DoxyCodeLine{01199\ \ \ \ \ \textcolor{comment}{//\ Do\ not\ squeeze\ reordered\ inner\ dimensions.}}
\DoxyCodeLine{01200\ \ \ \ \ \textcolor{keywordtype}{int}\ num\_squeezable\_dims\ =\ NumSqueezableInnerDims(dim\_map);}
\DoxyCodeLine{01201\ }
\DoxyCodeLine{01202\ \ \ \ \ \textcolor{comment}{//\ NOTE:\ We\ find\ the\ innermost\ dimension\ (contiguous\ in\ memory)\ in\ the\ dst}}
\DoxyCodeLine{01203\ \ \ \ \ \textcolor{comment}{//\ block,\ and\ we\ write\ data\ linearly\ into\ that\ dimension,\ reading\ it\ from}}
\DoxyCodeLine{01204\ \ \ \ \ \textcolor{comment}{//\ the\ src.\ If\ dimensions\ are\ reordered,\ we\ might\ end\ up\ reading\ data\ from}}
\DoxyCodeLine{01205\ \ \ \ \ \textcolor{comment}{//\ the\ src\ with\ \`{}stride\ !=\ 1`.}}
\DoxyCodeLine{01206\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{01207\ \ \ \ \ \textcolor{comment}{//\ NOTE:\ Random-\/Read/Linear-\/Write\ can\ be\ up\ to\ \string~2X\ faster\ than}}
\DoxyCodeLine{01208\ \ \ \ \ \textcolor{comment}{//\ Linear-\/Read/Random-\/Write:\ https://stackoverflow.com/a/54935680}}
\DoxyCodeLine{01209\ }
\DoxyCodeLine{01210\ \ \ \ \ \textcolor{comment}{//\ Find\ the\ innermost\ dimension\ in\ the\ dst\ whose\ size\ is\ not\ 1.\ This\ is\ the}}
\DoxyCodeLine{01211\ \ \ \ \ \textcolor{comment}{//\ effective\ inner\ dim.}}
\DoxyCodeLine{01212\ \ \ \ \ \textcolor{keywordtype}{int}\ num\_size\_one\_inner\_dims\ =\ 0;}
\DoxyCodeLine{01213\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ num\_squeezable\_dims;\ ++\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ \{}
\DoxyCodeLine{01214\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ dst\_dim\ =\ IsColMajor\ ?\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ :\ NumDims\ -\/\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ -\/\ 1;}
\DoxyCodeLine{01215\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (dst.dims[dst\_dim]\ !=\ 1)\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01216\ \ \ \ \ \ \ num\_size\_one\_inner\_dims++;}
\DoxyCodeLine{01217\ \ \ \ \ \}}
\DoxyCodeLine{01218\ }
\DoxyCodeLine{01219\ \ \ \ \ \textcolor{comment}{//\ If\ all\ dimensions\ are\ of\ size\ 1,\ just\ copy\ a\ scalar\ from\ \`{}src`\ to\ \`{}dst`.}}
\DoxyCodeLine{01220\ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_size\_one\_inner\_dims\ ==\ NumDims)\ \{}
\DoxyCodeLine{01221\ \ \ \ \ \ \ *(dst.data\ +\ dst.offset)\ =\ *(src.\mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockIO_1_1Src_a76ce53b18a459b8942f795dccacd512c}{data}}\ +\ src.\mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockIO_1_1Src_a7be585e5b9c1d2e1d3a9703286ad6ec8}{offset}});}
\DoxyCodeLine{01222\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{01223\ \ \ \ \ \}}
\DoxyCodeLine{01224\ }
\DoxyCodeLine{01225\ \ \ \ \ \textcolor{comment}{//\ Outermost\ dimension\ in\ the\ dst\ with\ \`{}stride\ ==\ 1`\ (contiguous\ in\ memory).}}
\DoxyCodeLine{01226\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ dst\_stride1\_dim\ =\ IsColMajor}
\DoxyCodeLine{01227\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ?\ num\_size\_one\_inner\_dims}
\DoxyCodeLine{01228\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ NumDims\ -\/\ num\_size\_one\_inner\_dims\ -\/\ 1;}
\DoxyCodeLine{01229\ }
\DoxyCodeLine{01230\ \ \ \ \ \textcolor{comment}{//\ Dimension\ in\ the\ src\ that\ corresponds\ to\ the\ dst\ innermost\ dimension.}}
\DoxyCodeLine{01231\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ src\_dim\_for\_dst\_stride1\_dim\ =}
\DoxyCodeLine{01232\ \ \ \ \ \ \ \ \ NumDims\ ==\ 0\ ?\ 1\ :\ dim\_map[dst\_stride1\_dim];}
\DoxyCodeLine{01233\ }
\DoxyCodeLine{01234\ \ \ \ \ \textcolor{comment}{//\ Size\ of\ the\ innermost\ dimension\ (length\ of\ contiguous\ blocks\ of\ memory).}}
\DoxyCodeLine{01235\ \ \ \ \ IndexType\ dst\_inner\_dim\_size\ =\ NumDims\ ==\ 0\ ?\ 1\ :\ dst.dims[dst\_stride1\_dim];}
\DoxyCodeLine{01236\ }
\DoxyCodeLine{01237\ \ \ \ \ \textcolor{comment}{//\ Squeeze\ multiple\ inner\ dims\ into\ one\ if\ they\ are\ contiguous\ in\ \`{}dst`\ and}}
\DoxyCodeLine{01238\ \ \ \ \ \textcolor{comment}{//\ \`{}src`\ memory,\ so\ we\ can\ do\ less\ linear\ copy\ calls.}}
\DoxyCodeLine{01239\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ num\_size\_one\_inner\_dims\ +\ 1;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ num\_squeezable\_dims;\ ++\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ \{}
\DoxyCodeLine{01240\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ dst\_dim\ =\ IsColMajor\ ?\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ :\ NumDims\ -\/\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ -\/\ 1;}
\DoxyCodeLine{01241\ \ \ \ \ \ \ \textcolor{keyword}{const}\ IndexType\ dst\_stride\ =\ dst.strides[dst\_dim];}
\DoxyCodeLine{01242\ \ \ \ \ \ \ \textcolor{keyword}{const}\ IndexType\ src\_stride\ =\ src.\mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockIO_1_1Src_a6e7a522304fc7465449a868299fdcef5}{strides}}[dim\_map[dst\_dim]];}
\DoxyCodeLine{01243\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (dst\_inner\_dim\_size\ ==\ dst\_stride\ \&\&\ dst\_stride\ ==\ src\_stride)\ \{}
\DoxyCodeLine{01244\ \ \ \ \ \ \ \ \ dst\_inner\_dim\_size\ *=\ dst.dims[dst\_dim];}
\DoxyCodeLine{01245\ \ \ \ \ \ \ \ \ ++num\_size\_one\_inner\_dims;}
\DoxyCodeLine{01246\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01247\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01248\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01249\ \ \ \ \ \}}
\DoxyCodeLine{01250\ }
\DoxyCodeLine{01251\ \ \ \ \ \textcolor{comment}{//\ Setup\ strides\ to\ read\ data\ from\ \`{}src`\ and\ write\ to\ \`{}dst`.}}
\DoxyCodeLine{01252\ \ \ \ \ IndexType\ input\_offset\ =\ src.\mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockIO_1_1Src_a7be585e5b9c1d2e1d3a9703286ad6ec8}{offset}};}
\DoxyCodeLine{01253\ \ \ \ \ IndexType\ output\_offset\ =\ dst.offset;}
\DoxyCodeLine{01254\ \ \ \ \ IndexType\ input\_stride\ =}
\DoxyCodeLine{01255\ \ \ \ \ \ \ \ \ NumDims\ ==\ 0\ ?\ 1\ :\ src.\mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockIO_1_1Src_a6e7a522304fc7465449a868299fdcef5}{strides}}[src\_dim\_for\_dst\_stride1\_dim];}
\DoxyCodeLine{01256\ \ \ \ \ IndexType\ output\_stride\ =\ NumDims\ ==\ 0\ ?\ 1\ :\ dst.strides[dst\_stride1\_dim];}
\DoxyCodeLine{01257\ }
\DoxyCodeLine{01258\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ at\_least\_1\_dim\ =\ NumDims\ <=\ 1\ ?\ 1\ :\ NumDims\ -\/\ 1;}
\DoxyCodeLine{01259\ \ \ \ \ \mbox{\hyperlink{classEigen_1_1array}{array<BlockIteratorState,\ at\_least\_1\_dim>}}\ it;}
\DoxyCodeLine{01260\ }
\DoxyCodeLine{01261\ \ \ \ \ \textcolor{comment}{//\ Initialize\ block\ iterator\ state.\ Squeeze\ away\ any\ dimension\ of\ size\ 1.}}
\DoxyCodeLine{01262\ \ \ \ \ \textcolor{keywordtype}{int}\ idx\ =\ 0;\ \ \textcolor{comment}{//\ currently\ initialized\ iterator\ state\ index}}
\DoxyCodeLine{01263\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ num\_size\_one\_inner\_dims;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ NumDims\ -\/\ 1;\ ++\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ \{}
\DoxyCodeLine{01264\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ dst\_dim\ =\ IsColMajor\ ?\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +\ 1\ :\ NumDims\ -\/\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ -\/\ 2;}
\DoxyCodeLine{01265\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (dst.dims[dst\_dim]\ ==\ 1)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01266\ }
\DoxyCodeLine{01267\ \ \ \ \ \ \ it[idx].\mbox{\hyperlink{classEigen_1_1array_a332ffdbd5ae2690a6f983959baecc972}{size}}\ =\ dst.dims[dst\_dim];}
\DoxyCodeLine{01268\ \ \ \ \ \ \ it[idx].input\_stride\ =\ src.\mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockIO_1_1Src_a6e7a522304fc7465449a868299fdcef5}{strides}}[dim\_map[dst\_dim]];}
\DoxyCodeLine{01269\ \ \ \ \ \ \ it[idx].output\_stride\ =\ dst.strides[dst\_dim];}
\DoxyCodeLine{01270\ }
\DoxyCodeLine{01271\ \ \ \ \ \ \ it[idx].input\_span\ =\ it[idx].input\_stride\ *\ (it[idx].\mbox{\hyperlink{classEigen_1_1array_a332ffdbd5ae2690a6f983959baecc972}{size}}\ -\/\ 1);}
\DoxyCodeLine{01272\ \ \ \ \ \ \ it[idx].output\_span\ =\ it[idx].output\_stride\ *\ (it[idx].\mbox{\hyperlink{classEigen_1_1array_a332ffdbd5ae2690a6f983959baecc972}{size}}\ -\/\ 1);}
\DoxyCodeLine{01273\ }
\DoxyCodeLine{01274\ \ \ \ \ \ \ idx++;}
\DoxyCodeLine{01275\ \ \ \ \ \}}
\DoxyCodeLine{01276\ }
\DoxyCodeLine{01277\ \ \ \ \ \textcolor{comment}{//\ Iterate\ copying\ data\ from\ src\ to\ dst.}}
\DoxyCodeLine{01278\ \ \ \ \ \textcolor{keyword}{const}\ IndexType\ block\_total\_size\ =\ NumDims\ ==\ 0\ ?\ 1\ :\ dst.dims.TotalSize();}
\DoxyCodeLine{01279\ }
\DoxyCodeLine{01280\ \textcolor{preprocessor}{\#define\ COPY\_INNER\_DIM(KIND)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{01281\ \textcolor{preprocessor}{\ \ IndexType\ num\_copied\ =\ 0;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{01282\ \textcolor{preprocessor}{\ \ for\ (num\_copied\ =\ 0;\ num\_copied\ <\ block\_total\_size;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{01283\ \textcolor{preprocessor}{\ \ \ \ \ \ \ num\_copied\ +=\ dst\_inner\_dim\_size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{01284\ \textcolor{preprocessor}{\ \ \ \ LinCopy::template\ Run<KIND>(\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{01285\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ typename\ LinCopy::Dst(output\_offset,\ output\_stride,\ dst.data),\ \(\backslash\)}}
\DoxyCodeLine{01286\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ typename\ LinCopy::Src(input\_offset,\ input\_stride,\ src.data),\ \ \ \(\backslash\)}}
\DoxyCodeLine{01287\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ dst\_inner\_dim\_size);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{01288\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{01289\ \textcolor{preprocessor}{\ \ \ \ for\ (int\ j\ =\ 0;\ j\ <\ idx;\ ++j)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{01290\ \textcolor{preprocessor}{\ \ \ \ \ \ if\ (++it[j].count\ <\ it[j].size)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{01291\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ input\_offset\ +=\ it[j].input\_stride;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{01292\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ output\_offset\ +=\ it[j].output\_stride;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{01293\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ break;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{01294\ \textcolor{preprocessor}{\ \ \ \ \ \ \}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{01295\ \textcolor{preprocessor}{\ \ \ \ \ \ it[j].count\ =\ 0;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{01296\ \textcolor{preprocessor}{\ \ \ \ \ \ input\_offset\ -\/=\ it[j].input\_span;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{01297\ \textcolor{preprocessor}{\ \ \ \ \ \ output\_offset\ -\/=\ it[j].output\_span;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{01298\ \textcolor{preprocessor}{\ \ \ \ \}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{01299\ \textcolor{preprocessor}{\ \ \}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{01300\ \textcolor{preprocessor}{\ \ return\ num\_copied;}}
\DoxyCodeLine{01301\ }
\DoxyCodeLine{01302\ \ \ \ \ \textcolor{keywordflow}{if}\ (input\_stride\ ==\ 1\ \&\&\ output\_stride\ ==\ 1)\ \{}
\DoxyCodeLine{01303\ \ \ \ \ \ \ \mbox{\hyperlink{eigen_2unsupported_2Eigen_2CXX11_2src_2Tensor_2TensorBlock_8h_ab9d7073ae4eb62074f8ddc408f013426}{COPY\_INNER\_DIM}}(\mbox{\hyperlink{classEigen_1_1internal_1_1StridedLinearBufferCopy_a9b33c9925cacf0deff3334bc2f2d389da32a843da6ea40ab3b17a3421ccdf671b}{LinCopy::Kind::Linear}});}
\DoxyCodeLine{01304\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (input\_stride\ ==\ 1\ \&\&\ output\_stride\ !=\ 1)\ \{}
\DoxyCodeLine{01305\ \ \ \ \ \ \ \mbox{\hyperlink{eigen_2unsupported_2Eigen_2CXX11_2src_2Tensor_2TensorBlock_8h_ab9d7073ae4eb62074f8ddc408f013426}{COPY\_INNER\_DIM}}(\mbox{\hyperlink{classEigen_1_1internal_1_1StridedLinearBufferCopy_a9b33c9925cacf0deff3334bc2f2d389da09870720ca8134284e4e305ac6ce5f19}{LinCopy::Kind::Scatter}});}
\DoxyCodeLine{01306\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (input\_stride\ ==\ 0\ \&\&\ output\_stride\ ==\ 1)\ \{}
\DoxyCodeLine{01307\ \ \ \ \ \ \ \mbox{\hyperlink{eigen_2unsupported_2Eigen_2CXX11_2src_2Tensor_2TensorBlock_8h_ab9d7073ae4eb62074f8ddc408f013426}{COPY\_INNER\_DIM}}(\mbox{\hyperlink{classEigen_1_1internal_1_1StridedLinearBufferCopy_a9b33c9925cacf0deff3334bc2f2d389dac6fac6cb6e9ef1112afbe80ba7d75e9d}{LinCopy::Kind::FillLinear}});}
\DoxyCodeLine{01308\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (input\_stride\ ==\ 0\ \&\&\ output\_stride\ !=\ 1)\ \{}
\DoxyCodeLine{01309\ \ \ \ \ \ \ \mbox{\hyperlink{eigen_2unsupported_2Eigen_2CXX11_2src_2Tensor_2TensorBlock_8h_ab9d7073ae4eb62074f8ddc408f013426}{COPY\_INNER\_DIM}}(\mbox{\hyperlink{classEigen_1_1internal_1_1StridedLinearBufferCopy_a9b33c9925cacf0deff3334bc2f2d389da169f5b22a803b87d715fd6100cbece9a}{LinCopy::Kind::FillScatter}});}
\DoxyCodeLine{01310\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (output\_stride\ ==\ 1)\ \{}
\DoxyCodeLine{01311\ \ \ \ \ \ \ \mbox{\hyperlink{eigen_2unsupported_2Eigen_2CXX11_2src_2Tensor_2TensorBlock_8h_ab9d7073ae4eb62074f8ddc408f013426}{COPY\_INNER\_DIM}}(\mbox{\hyperlink{classEigen_1_1internal_1_1StridedLinearBufferCopy_a9b33c9925cacf0deff3334bc2f2d389daad22c799930d644e8468fe44c0312d53}{LinCopy::Kind::Gather}});}
\DoxyCodeLine{01312\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01313\ \ \ \ \ \ \ \mbox{\hyperlink{eigen_2unsupported_2Eigen_2CXX11_2src_2Tensor_2TensorBlock_8h_ab9d7073ae4eb62074f8ddc408f013426}{COPY\_INNER\_DIM}}(\mbox{\hyperlink{classEigen_1_1internal_1_1StridedLinearBufferCopy_a9b33c9925cacf0deff3334bc2f2d389da64663f4646781c9c0110838b905daa23}{LinCopy::Kind::Random}});}
\DoxyCodeLine{01314\ \ \ \ \ \}}
\DoxyCodeLine{01315\ }
\DoxyCodeLine{01316\ \textcolor{preprocessor}{\#undef\ COPY\_INNER\_DIM}}
\DoxyCodeLine{01317\ \ \ \}}
\DoxyCodeLine{01318\ }
\DoxyCodeLine{01319\ \ \ \textcolor{comment}{//\ Copy\ from\ \`{}src`\ to\ \`{}dst`\ with\ an\ identity\ src-\/>dst\ dimension\ map.\ Returns}}
\DoxyCodeLine{01320\ \ \ \textcolor{comment}{//\ the\ number\ of\ copied\ elements.}}
\DoxyCodeLine{01321\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}\ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_a1fdc6f94f20527c7275768d82b2eb9ce}{EIGEN\_ALWAYS\_INLINE}}\ IndexType\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockIO_a656190e6d8f4d4d62bf9ba413febe52a}{Copy}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockIO_1_1Dst}{Dst}}\&\ dst,}
\DoxyCodeLine{01322\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockIO_1_1Src}{Src}}\&\ src)\ \{}
\DoxyCodeLine{01323\ \ \ \ \ \mbox{\hyperlink{structEigen_1_1DSizes}{DimensionsMap}}\ dst\_to\_src\_map;}
\DoxyCodeLine{01324\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ NumDims;\ ++\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ dst\_to\_src\_map[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}]\ =\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}};}
\DoxyCodeLine{01325\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockIO_a3eed5c23e9578f8ed8b2946045ab1d68}{Copy}}(dst,\ src,\ dst\_to\_src\_map);}
\DoxyCodeLine{01326\ \ \ \}}
\DoxyCodeLine{01327\ }
\DoxyCodeLine{01328\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{01329\ \ \ \textcolor{keyword}{struct\ }BlockIteratorState\ \{}
\DoxyCodeLine{01330\ \ \ \ \ BlockIteratorState()}
\DoxyCodeLine{01331\ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2low__level__alloc_8cc_aad9b71a31372d5c0ab9c23163efe9544}{size}}(0),}
\DoxyCodeLine{01332\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{abseil-cpp_2absl_2container_2internal_2raw__hash__set__test_8cc_ad43c3812e6d13e0518d9f8b8f463ffcf}{count}}(0),}
\DoxyCodeLine{01333\ \ \ \ \ \ \ \ \ \ \ input\_stride(0),}
\DoxyCodeLine{01334\ \ \ \ \ \ \ \ \ \ \ output\_stride(0),}
\DoxyCodeLine{01335\ \ \ \ \ \ \ \ \ \ \ input\_span(0),}
\DoxyCodeLine{01336\ \ \ \ \ \ \ \ \ \ \ output\_span(0)\ \{\}}
\DoxyCodeLine{01337\ }
\DoxyCodeLine{01338\ \ \ \ \ IndexType\ \mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2low__level__alloc_8cc_aad9b71a31372d5c0ab9c23163efe9544}{size}};}
\DoxyCodeLine{01339\ \ \ \ \ IndexType\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2internal_2raw__hash__set__test_8cc_ad43c3812e6d13e0518d9f8b8f463ffcf}{count}};}
\DoxyCodeLine{01340\ \ \ \ \ IndexType\ input\_stride;}
\DoxyCodeLine{01341\ \ \ \ \ IndexType\ output\_stride;}
\DoxyCodeLine{01342\ \ \ \ \ IndexType\ input\_span;}
\DoxyCodeLine{01343\ \ \ \ \ IndexType\ output\_span;}
\DoxyCodeLine{01344\ \ \ \};}
\DoxyCodeLine{01345\ }
\DoxyCodeLine{01346\ \ \ \textcolor{comment}{//\ Compute\ how\ many\ inner\ dimensions\ it's\ allowed\ to\ squeeze\ when\ doing\ IO}}
\DoxyCodeLine{01347\ \ \ \textcolor{comment}{//\ between\ two\ tensor\ blocks.\ It's\ safe\ to\ squeeze\ inner\ dimensions,\ only}}
\DoxyCodeLine{01348\ \ \ \textcolor{comment}{//\ if\ they\ are\ not\ reordered.}}
\DoxyCodeLine{01349\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{int}\ NumSqueezableInnerDims(\textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockIO_abab99984c6e663b4ae461515ef8bf9c5}{DimensionsMap}}\&\ dim\_map)\ \{}
\DoxyCodeLine{01350\ \ \ \ \ \textcolor{keywordtype}{int}\ num\_squeezable\_dims\ =\ 0;}
\DoxyCodeLine{01351\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ NumDims;\ ++\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ \{}
\DoxyCodeLine{01352\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ dim\ =\ IsColMajor\ ?\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ :\ NumDims\ -\/\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ -\/\ 1;}
\DoxyCodeLine{01353\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (dim\_map[dim]\ !=\ dim)\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01354\ \ \ \ \ \ \ num\_squeezable\_dims++;}
\DoxyCodeLine{01355\ \ \ \ \ \}}
\DoxyCodeLine{01356\ \ \ \ \ \textcolor{keywordflow}{return}\ num\_squeezable\_dims;}
\DoxyCodeLine{01357\ \ \ \}}
\DoxyCodeLine{01358\ \};}
\DoxyCodeLine{01359\ }
\DoxyCodeLine{01360\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ //}}
\DoxyCodeLine{01361\ \textcolor{comment}{//\ TensorBlockAssignment\ assigns\ a\ block\ expression\ of\ type\ \`{}TensorBlockExpr`\ to}}
\DoxyCodeLine{01362\ \textcolor{comment}{//\ a\ Tensor\ block\ defined\ by\ \`{}desc`,\ backed\ by\ a\ memory\ buffer\ at\ \`{}target`.}}
\DoxyCodeLine{01363\ \textcolor{comment}{//}}
\DoxyCodeLine{01364\ \textcolor{comment}{//\ Currently\ there\ is\ no\ way\ to\ write\ from\ a\ Tensor\ expression\ to\ a\ block\ of}}
\DoxyCodeLine{01365\ \textcolor{comment}{//\ memory,\ if\ dimensions\ are\ reordered.\ If\ you\ need\ to\ do\ that,\ you\ should}}
\DoxyCodeLine{01366\ \textcolor{comment}{//\ materialize\ a\ Tensor\ block\ expression\ into\ a\ memory\ buffer,\ and\ then\ use}}
\DoxyCodeLine{01367\ \textcolor{comment}{//\ TensorBlockIO\ to\ copy\ data\ between\ two\ memory\ buffers\ with\ a\ custom}}
\DoxyCodeLine{01368\ \textcolor{comment}{//\ \`{}target-\/>src`\ dimension\ map\ (see\ definition\ above).}}
\DoxyCodeLine{01369\ \textcolor{comment}{//}}
\DoxyCodeLine{01370\ \textcolor{comment}{//\ Also\ currently\ the\ innermost\ dimension\ of\ \`{}target`\ must\ have\ a\ stride\ '1'}}
\DoxyCodeLine{01371\ \textcolor{comment}{//\ (contiguous\ in\ memory).\ This\ restriction\ could\ be\ lifted\ with\ a\ \`{}pscatter`,}}
\DoxyCodeLine{01372\ \textcolor{comment}{//\ but\ in\ practice\ it's\ never\ needed,\ and\ there\ is\ a\ similar\ TensorBlockIO}}
\DoxyCodeLine{01373\ \textcolor{comment}{//\ workaround\ for\ that.}}
\DoxyCodeLine{01374\ \textcolor{comment}{//}}
\DoxyCodeLine{01375\ \textcolor{comment}{//\ TODO(ezhulenev):\ TensorBlockAssignment\ is\ a\ special\ case\ of\ TensorBlockIO}}
\DoxyCodeLine{01376\ \textcolor{comment}{//\ where\ \`{}src`\ is\ a\ tensor\ expression.\ Explore\ if\ it\ is\ possible\ to\ rewrite\ IO}}
\DoxyCodeLine{01377\ \textcolor{comment}{//\ to\ use\ expressions\ instead\ of\ pointers,\ and\ after\ that\ TensorBlockAssignment}}
\DoxyCodeLine{01378\ \textcolor{comment}{//\ will\ become\ an\ alias\ to\ IO.}}
\DoxyCodeLine{01379\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Scalar,\ \textcolor{keywordtype}{int}\ NumDims,\ \textcolor{keyword}{typename}\ TensorBlockExpr,}
\DoxyCodeLine{01380\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typename}\ IndexType\ =\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Eigen::Index}}>}
\DoxyCodeLine{01381\ \textcolor{keyword}{class\ }TensorBlockAssignment\ \{}
\DoxyCodeLine{01382\ \ \ \textcolor{comment}{//\ We\ will\ use\ coeff/packet\ path\ to\ evaluate\ block\ expressions.}}
\DoxyCodeLine{01383\ \ \ \textcolor{keyword}{typedef}\ TensorEvaluator<const\ TensorBlockExpr,\ DefaultDevice>}
\DoxyCodeLine{01384\ \ \ \ \ \ \ TensorBlockEvaluator;}
\DoxyCodeLine{01385\ }
\DoxyCodeLine{01386\ \ \ \textcolor{keyword}{typedef}\ DSizes<IndexType,\ NumDims>\ Dimensions;}
\DoxyCodeLine{01387\ }
\DoxyCodeLine{01388\ \ \ \textcolor{keyword}{enum}\ \{}
\DoxyCodeLine{01389\ \ \ \ \ Vectorizable\ =\ \mbox{\hyperlink{structEigen_1_1internal_1_1packet__traits_a9fce3b012e6a350f2bd9163d7820fefaa57b1420dcdf4decb6bc1e9259de1e1d5}{packet\_traits<Scalar>::Vectorizable}},}
\DoxyCodeLine{01390\ \ \ \ \ PacketSize\ =\ \mbox{\hyperlink{structEigen_1_1internal_1_1packet__traits_a9fce3b012e6a350f2bd9163d7820fefaa0e933e5c1966ffb2dccec1f29678a1ed}{packet\_traits<Scalar>::size}}}
\DoxyCodeLine{01391\ \ \ \};}
\DoxyCodeLine{01392\ }
\DoxyCodeLine{01393\ \ \ \textcolor{keyword}{template}\ <\textcolor{keywordtype}{bool}\ Vectorizable,\ \textcolor{keyword}{typename}\ Evaluator>}
\DoxyCodeLine{01394\ \ \ \textcolor{keyword}{struct\ }InnerDimAssign\ \{}
\DoxyCodeLine{01395\ \ \ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_a1fdc6f94f20527c7275768d82b2eb9ce}{EIGEN\_ALWAYS\_INLINE}}\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ Run(Scalar*\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockAssignment_aafb6b57b6c0a830dbc3a695fb0e40b75}{target}},\ IndexType\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2internal_2raw__hash__set__test_8cc_ad43c3812e6d13e0518d9f8b8f463ffcf}{count}},}
\DoxyCodeLine{01396\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Evaluator\&\ eval,}
\DoxyCodeLine{01397\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ IndexType\ eval\_offset)\ \{}
\DoxyCodeLine{01398\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (IndexType\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2internal_2raw__hash__set__test_8cc_ad43c3812e6d13e0518d9f8b8f463ffcf}{count}};\ ++\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ \{}
\DoxyCodeLine{01399\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockAssignment_aafb6b57b6c0a830dbc3a695fb0e40b75}{target}}[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}]\ =\ eval.coeff(eval\_offset\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}});}
\DoxyCodeLine{01400\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01401\ \ \ \ \ \}}
\DoxyCodeLine{01402\ \ \ \};}
\DoxyCodeLine{01403\ }
\DoxyCodeLine{01404\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Evaluator>}
\DoxyCodeLine{01405\ \ \ \textcolor{keyword}{struct\ }InnerDimAssign<true,\ Evaluator>\ \{}
\DoxyCodeLine{01406\ \ \ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_a1fdc6f94f20527c7275768d82b2eb9ce}{EIGEN\_ALWAYS\_INLINE}}\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ Run(Scalar*\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockAssignment_aafb6b57b6c0a830dbc3a695fb0e40b75}{target}},\ IndexType\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2internal_2raw__hash__set__test_8cc_ad43c3812e6d13e0518d9f8b8f463ffcf}{count}},}
\DoxyCodeLine{01407\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Evaluator\&\ eval,}
\DoxyCodeLine{01408\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ IndexType\ eval\_offset)\ \{}
\DoxyCodeLine{01409\ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{structEigen_1_1internal_1_1packet__traits_a811c5bde6641fd0f7a8f88be5e11ce27}{packet\_traits<Scalar>::type}}\ Packet;}
\DoxyCodeLine{01410\ }
\DoxyCodeLine{01411\ \ \ \ \ \ \ \textcolor{keyword}{const}\ IndexType\ unrolled\_size\ =\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2internal_2raw__hash__set__test_8cc_ad43c3812e6d13e0518d9f8b8f463ffcf}{count}}\ -\/\ 4\ *\ PacketSize;}
\DoxyCodeLine{01412\ \ \ \ \ \ \ \textcolor{keyword}{const}\ IndexType\ vectorized\_size\ =\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2internal_2raw__hash__set__test_8cc_ad43c3812e6d13e0518d9f8b8f463ffcf}{count}}\ -\/\ PacketSize;}
\DoxyCodeLine{01413\ \ \ \ \ \ \ IndexType\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 0;}
\DoxyCodeLine{01414\ }
\DoxyCodeLine{01415\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <=\ unrolled\_size;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +=\ 4\ *\ PacketSize)\ \{}
\DoxyCodeLine{01416\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ \mbox{\hyperlink{namespaceabsl_adb6bd4a9012b471ac01613aff8d4d81ba363b122c528f54df4a0446b6bab05515}{j}}\ <\ 4;\ ++\mbox{\hyperlink{namespaceabsl_adb6bd4a9012b471ac01613aff8d4d81ba363b122c528f54df4a0446b6bab05515}{j}})\ \{}
\DoxyCodeLine{01417\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ IndexType\ idx\ =\ eval\_offset\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +\ \mbox{\hyperlink{namespaceabsl_adb6bd4a9012b471ac01613aff8d4d81ba363b122c528f54df4a0446b6bab05515}{j}}\ *\ PacketSize;}
\DoxyCodeLine{01418\ \ \ \ \ \ \ \ \ \ \ Packet\ \mbox{\hyperlink{namespaceabsl_a828e0f13fb3947cdf6406b7a4feec8aca83878c91171338902e0fe0fb97a8c47a}{p}}\ =\ eval.template\ packet<Unaligned>(idx);}
\DoxyCodeLine{01419\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceEigen_1_1internal_abcb1c5d429335ed8c976a6b238287a2e}{pstoreu<Scalar>}}(\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockAssignment_aafb6b57b6c0a830dbc3a695fb0e40b75}{target}}\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +\ j\ *\ PacketSize,\ p);}
\DoxyCodeLine{01420\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01421\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01422\ }
\DoxyCodeLine{01423\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <=\ vectorized\_size;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +=\ PacketSize)\ \{}
\DoxyCodeLine{01424\ \ \ \ \ \ \ \ \ Packet\ \mbox{\hyperlink{namespaceabsl_a828e0f13fb3947cdf6406b7a4feec8aca83878c91171338902e0fe0fb97a8c47a}{p}}\ =\ eval.template\ packet<Unaligned>(eval\_offset\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}});}
\DoxyCodeLine{01425\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceEigen_1_1internal_abcb1c5d429335ed8c976a6b238287a2e}{pstoreu<Scalar>}}(\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockAssignment_aafb6b57b6c0a830dbc3a695fb0e40b75}{target}}\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}},\ p);}
\DoxyCodeLine{01426\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01427\ }
\DoxyCodeLine{01428\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2internal_2raw__hash__set__test_8cc_ad43c3812e6d13e0518d9f8b8f463ffcf}{count}};\ ++\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ \{}
\DoxyCodeLine{01429\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockAssignment_aafb6b57b6c0a830dbc3a695fb0e40b75}{target}}[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}]\ =\ eval.coeff(eval\_offset\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}});}
\DoxyCodeLine{01430\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01431\ \ \ \ \ \}}
\DoxyCodeLine{01432\ \ \ \};}
\DoxyCodeLine{01433\ }
\DoxyCodeLine{01434\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{01435\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{namespaceEigen_1_1Architecture_ae54c092bdb3a978b9aa8cc50dcafc13caf142d1bc71ecab4fc12885fb665276f9}{Target}}\ \{}
\DoxyCodeLine{01436\ \ \ \ \ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockAssignment_1_1Target_ab30d4678b03ff13c4d0cdab341d2543f}{Target}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1DSizes}{Dimensions}}\&\ target\_dims,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1DSizes}{Dimensions}}\&\ target\_strides,}
\DoxyCodeLine{01437\ \ \ \ \ \ \ \ \ \ \ \ Scalar*\ target\_data,\ IndexType\ target\_offset\ =\ 0)}
\DoxyCodeLine{01438\ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockAssignment_1_1Target_a37492345dcc1500e9c1a5b40de95533b}{dims}}(target\_dims),}
\DoxyCodeLine{01439\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockAssignment_1_1Target_a17495ac58643954fe08dc2a4935e7229}{strides}}(target\_strides),}
\DoxyCodeLine{01440\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockAssignment_1_1Target_af7bdafa1626cd3f57a3b4f3b5e180ac8}{data}}(target\_data),}
\DoxyCodeLine{01441\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockAssignment_1_1Target_abc9c7d9aa7a698fcbfc92fd65a9af8cd}{offset}}(target\_offset)\ \{\}}
\DoxyCodeLine{01442\ }
\DoxyCodeLine{01443\ \ \ \ \ \mbox{\hyperlink{structEigen_1_1DSizes}{Dimensions}}\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockAssignment_1_1Target_a37492345dcc1500e9c1a5b40de95533b}{dims}};}
\DoxyCodeLine{01444\ \ \ \ \ \mbox{\hyperlink{structEigen_1_1DSizes}{Dimensions}}\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockAssignment_1_1Target_a17495ac58643954fe08dc2a4935e7229}{strides}};}
\DoxyCodeLine{01445\ \ \ \ \ Scalar*\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockAssignment_1_1Target_af7bdafa1626cd3f57a3b4f3b5e180ac8}{data}};}
\DoxyCodeLine{01446\ \ \ \ \ IndexType\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockAssignment_1_1Target_abc9c7d9aa7a698fcbfc92fd65a9af8cd}{offset}};}
\DoxyCodeLine{01447\ \ \ \};}
\DoxyCodeLine{01448\ }
\DoxyCodeLine{01449\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockAssignment_1_1Target}{Target}}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockAssignment_aafb6b57b6c0a830dbc3a695fb0e40b75}{target}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1DSizes}{Dimensions}}\&\ target\_dims,}
\DoxyCodeLine{01450\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1DSizes}{Dimensions}}\&\ target\_strides,\ Scalar*\ target\_data,}
\DoxyCodeLine{01451\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ IndexType\ target\_offset\ =\ 0)\ \{}
\DoxyCodeLine{01452\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockAssignment_1_1Target}{Target}}(target\_dims,\ target\_strides,\ target\_data,\ target\_offset);}
\DoxyCodeLine{01453\ \ \ \}}
\DoxyCodeLine{01454\ }
\DoxyCodeLine{01455\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ TargetDimsIndexType,\ \textcolor{keyword}{typename}\ TargetStr\textcolor{keywordtype}{id}esIndexType>}
\DoxyCodeLine{01456\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockAssignment_1_1Target}{Target}}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockAssignment_ac0e88a9ccb42d249d6e57d95f8e09378}{target}}(}
\DoxyCodeLine{01457\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1DSizes}{DSizes<TargetDimsIndexType,\ NumDims>}}\&\ target\_dims,}
\DoxyCodeLine{01458\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1DSizes}{DSizes<TargetStridesIndexType,\ NumDims>}}\&\ target\_strides,}
\DoxyCodeLine{01459\ \ \ \ \ \ \ Scalar*\ target\_data,\ IndexType\ target\_offset\ =\ 0)\ \{}
\DoxyCodeLine{01460\ \ \ \ \ \textcolor{comment}{//\ DSizes\ constructor\ will\ do\ index\ type\ promotion\ if\ it's\ safe.}}
\DoxyCodeLine{01461\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockAssignment_1_1Target}{Target}}(\mbox{\hyperlink{structEigen_1_1DSizes}{Dimensions}}(target\_dims),\ \mbox{\hyperlink{structEigen_1_1DSizes}{Dimensions}}(target\_strides),}
\DoxyCodeLine{01462\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ target\_data,\ target\_offset);}
\DoxyCodeLine{01463\ \ \ \}}
\DoxyCodeLine{01464\ }
\DoxyCodeLine{01465\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}\ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockAssignment_a8481db430b0d05871071c61449b48576}{Run}}(}
\DoxyCodeLine{01466\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockAssignment_1_1Target}{Target}}\&\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockAssignment_aafb6b57b6c0a830dbc3a695fb0e40b75}{target}},\ \textcolor{keyword}{const}\ TensorBlockExpr\&\ expr)\ \{}
\DoxyCodeLine{01467\ \ \ \ \ \textcolor{comment}{//\ Prepare\ evaluator\ for\ block\ expression.}}
\DoxyCodeLine{01468\ \ \ \ \ \mbox{\hyperlink{structEigen_1_1DefaultDevice}{DefaultDevice}}\ default\_device;}
\DoxyCodeLine{01469\ \ \ \ \ \mbox{\hyperlink{structEigen_1_1TensorEvaluator}{TensorBlockEvaluator}}\ \mbox{\hyperlink{structEigen_1_1internal_1_1eval}{eval}}(expr,\ default\_device);}
\DoxyCodeLine{01470\ }
\DoxyCodeLine{01471\ \ \ \ \ \textcolor{comment}{//\ Tensor\ block\ expression\ dimension\ should\ match\ destination\ dimensions.}}
\DoxyCodeLine{01472\ \ \ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(\mbox{\hyperlink{namespaceEigen_a0dcc94ba428bad798d2087b2bde597f7}{dimensions\_match}}(\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockAssignment_aafb6b57b6c0a830dbc3a695fb0e40b75}{target}}.\mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockAssignment_1_1Target_a37492345dcc1500e9c1a5b40de95533b}{dims}},\ \mbox{\hyperlink{structEigen_1_1internal_1_1eval}{eval}}.dimensions()));}
\DoxyCodeLine{01473\ }
\DoxyCodeLine{01474\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ Layout\ =\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_ab5b731db71101dd0e4a8453fa43f9881aad2f498adfc79da8b4728669ac46f653}{TensorBlockEvaluator::Layout}};}
\DoxyCodeLine{01475\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ is\_col\_major\ =\ Layout\ ==\ \mbox{\hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13a0cbd4bdd0abcfc0224c5fcb5e4f6669a}{ColMajor}};}
\DoxyCodeLine{01476\ }
\DoxyCodeLine{01477\ \ \ \ \ \textcolor{comment}{//\ Initialize\ output\ inner\ dimension\ size\ based\ on\ a\ layout.}}
\DoxyCodeLine{01478\ \ \ \ \ \textcolor{keyword}{const}\ IndexType\ output\_size\ =\ NumDims\ ==\ 0\ ?\ 1\ :\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockAssignment_aafb6b57b6c0a830dbc3a695fb0e40b75}{target}}.\mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockAssignment_1_1Target_a37492345dcc1500e9c1a5b40de95533b}{dims}}.\mbox{\hyperlink{structEigen_1_1DSizes_aaa880c9fd53051ef158094e1e529e1f0}{TotalSize}}();}
\DoxyCodeLine{01479\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inner\_dim\_idx\ =\ is\_col\_major\ ?\ 0\ :\ NumDims\ -\/\ 1;}
\DoxyCodeLine{01480\ \ \ \ \ IndexType\ output\_inner\_dim\_size\ =\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockAssignment_aafb6b57b6c0a830dbc3a695fb0e40b75}{target}}.\mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockAssignment_1_1Target_a37492345dcc1500e9c1a5b40de95533b}{dims}}[inner\_dim\_idx];}
\DoxyCodeLine{01481\ }
\DoxyCodeLine{01482\ \ \ \ \ \textcolor{comment}{//\ Target\ inner\ dimension\ stride\ must\ be\ '1'.}}
\DoxyCodeLine{01483\ \ \ \ \ \mbox{\hyperlink{eigen_2Eigen_2src_2Core_2util_2Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockAssignment_aafb6b57b6c0a830dbc3a695fb0e40b75}{target}}.\mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockAssignment_1_1Target_a17495ac58643954fe08dc2a4935e7229}{strides}}[inner\_dim\_idx]\ ==\ 1);}
\DoxyCodeLine{01484\ }
\DoxyCodeLine{01485\ \ \ \ \ \textcolor{comment}{//\ Squeeze\ multiple\ inner\ dims\ into\ one\ if\ they\ are\ contiguous\ in\ \`{}target`.}}
\DoxyCodeLine{01486\ \ \ \ \ IndexType\ num\_squeezed\_dims\ =\ 0;}
\DoxyCodeLine{01487\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 1;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ NumDims;\ ++\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ \{}
\DoxyCodeLine{01488\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ dim\ =\ is\_col\_major\ ?\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ :\ NumDims\ -\/\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ -\/\ 1;}
\DoxyCodeLine{01489\ \ \ \ \ \ \ \textcolor{keyword}{const}\ IndexType\ target\_stride\ =\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockAssignment_aafb6b57b6c0a830dbc3a695fb0e40b75}{target}}.\mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockAssignment_1_1Target_a17495ac58643954fe08dc2a4935e7229}{strides}}[dim];}
\DoxyCodeLine{01490\ }
\DoxyCodeLine{01491\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (output\_inner\_dim\_size\ ==\ target\_stride)\ \{}
\DoxyCodeLine{01492\ \ \ \ \ \ \ \ \ output\_inner\_dim\_size\ *=\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockAssignment_aafb6b57b6c0a830dbc3a695fb0e40b75}{target}}.\mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockAssignment_1_1Target_a37492345dcc1500e9c1a5b40de95533b}{dims}}[dim];}
\DoxyCodeLine{01493\ \ \ \ \ \ \ \ \ num\_squeezed\_dims++;}
\DoxyCodeLine{01494\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01495\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01496\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01497\ \ \ \ \ \}}
\DoxyCodeLine{01498\ }
\DoxyCodeLine{01499\ \ \ \ \ \textcolor{comment}{//\ Initialize\ output\ block\ iterator\ state.\ Dimension\ in\ this\ array\ are}}
\DoxyCodeLine{01500\ \ \ \ \ \textcolor{comment}{//\ always\ in\ inner\_most\ -\/>\ outer\_most\ order\ (col\ major\ layout).}}
\DoxyCodeLine{01501\ \ \ \ \ \mbox{\hyperlink{classEigen_1_1array}{array<BlockIteratorState,\ NumDims>}}\ it;}
\DoxyCodeLine{01502\ }
\DoxyCodeLine{01503\ \ \ \ \ \textcolor{keywordtype}{int}\ idx\ =\ 0;\ \ \textcolor{comment}{//\ currently\ initialized\ iterator\ state\ index}}
\DoxyCodeLine{01504\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ num\_squeezed\_dims;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ NumDims\ -\/\ 1;\ ++\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ \{}
\DoxyCodeLine{01505\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ dim\ =\ is\_col\_major\ ?\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +\ 1\ :\ NumDims\ -\/\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ -\/\ 2;}
\DoxyCodeLine{01506\ }
\DoxyCodeLine{01507\ \ \ \ \ \ \ it[idx].count\ =\ 0;}
\DoxyCodeLine{01508\ \ \ \ \ \ \ it[idx].\mbox{\hyperlink{classEigen_1_1array_a332ffdbd5ae2690a6f983959baecc972}{size}}\ =\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockAssignment_aafb6b57b6c0a830dbc3a695fb0e40b75}{target}}.\mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockAssignment_1_1Target_a37492345dcc1500e9c1a5b40de95533b}{dims}}[dim];}
\DoxyCodeLine{01509\ \ \ \ \ \ \ it[idx].output\_stride\ =\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockAssignment_aafb6b57b6c0a830dbc3a695fb0e40b75}{target}}.\mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockAssignment_1_1Target_a17495ac58643954fe08dc2a4935e7229}{strides}}[dim];}
\DoxyCodeLine{01510\ \ \ \ \ \ \ it[idx].output\_span\ =\ it[idx].output\_stride\ *\ (it[idx].\mbox{\hyperlink{classEigen_1_1array_a332ffdbd5ae2690a6f983959baecc972}{size}}\ -\/\ 1);}
\DoxyCodeLine{01511\ \ \ \ \ \ \ idx++;}
\DoxyCodeLine{01512\ \ \ \ \ \}}
\DoxyCodeLine{01513\ }
\DoxyCodeLine{01514\ \ \ \ \ \textcolor{comment}{//\ We\ read\ block\ expression\ from\ the\ beginning,\ and\ start\ writing\ data\ to}}
\DoxyCodeLine{01515\ \ \ \ \ \textcolor{comment}{//\ \`{}target`\ at\ given\ offset.}}
\DoxyCodeLine{01516\ \ \ \ \ IndexType\ input\_offset\ =\ 0;}
\DoxyCodeLine{01517\ \ \ \ \ IndexType\ output\_offset\ =\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockAssignment_aafb6b57b6c0a830dbc3a695fb0e40b75}{target}}.\mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockAssignment_1_1Target_abc9c7d9aa7a698fcbfc92fd65a9af8cd}{offset}};}
\DoxyCodeLine{01518\ }
\DoxyCodeLine{01519\ \ \ \ \ \textcolor{comment}{//\ Iterate\ copying\ data\ from\ \`{}eval`\ to\ \`{}target`.}}
\DoxyCodeLine{01520\ \ \ \ \ \textcolor{keywordflow}{for}\ (IndexType\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ output\_size;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +=\ output\_inner\_dim\_size)\ \{}
\DoxyCodeLine{01521\ \ \ \ \ \ \ \textcolor{comment}{//\ Assign\ to\ \`{}target`\ at\ current\ offset.}}
\DoxyCodeLine{01522\ \ \ \ \ \ \ InnerDimAssign<Vectorizable\ \&\&\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_ab5b731db71101dd0e4a8453fa43f9881af2762e97058bc608b68a22f4b1b04e93}{TensorBlockEvaluator::PacketAccess}},}
\DoxyCodeLine{01523\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structEigen_1_1TensorEvaluator}{TensorBlockEvaluator}}>\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockAssignment_a8481db430b0d05871071c61449b48576}{::Run}}(\mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockAssignment_aafb6b57b6c0a830dbc3a695fb0e40b75}{target}}.\mbox{\hyperlink{structEigen_1_1internal_1_1TensorBlockAssignment_1_1Target_af7bdafa1626cd3f57a3b4f3b5e180ac8}{data}}\ +\ output\_offset,}
\DoxyCodeLine{01524\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ output\_inner\_dim\_size,\ \mbox{\hyperlink{structEigen_1_1internal_1_1eval}{eval}},}
\DoxyCodeLine{01525\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ input\_offset);}
\DoxyCodeLine{01526\ }
\DoxyCodeLine{01527\ \ \ \ \ \ \ \textcolor{comment}{//\ Move\ input\ offset\ forward\ by\ the\ number\ of\ assigned\ coefficients.}}
\DoxyCodeLine{01528\ \ \ \ \ \ \ input\_offset\ +=\ output\_inner\_dim\_size;}
\DoxyCodeLine{01529\ }
\DoxyCodeLine{01530\ \ \ \ \ \ \ \textcolor{comment}{//\ Update\ index.}}
\DoxyCodeLine{01531\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ idx;\ ++j)\ \{}
\DoxyCodeLine{01532\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (++it[j].\mbox{\hyperlink{abseil-cpp_2absl_2container_2internal_2raw__hash__set__test_8cc_ad43c3812e6d13e0518d9f8b8f463ffcf}{count}}\ <\ it[j].\mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2low__level__alloc_8cc_aad9b71a31372d5c0ab9c23163efe9544}{size}})\ \{}
\DoxyCodeLine{01533\ \ \ \ \ \ \ \ \ \ \ output\_offset\ +=\ it[j].output\_stride;}
\DoxyCodeLine{01534\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01535\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01536\ \ \ \ \ \ \ \ \ it[j].count\ =\ 0;}
\DoxyCodeLine{01537\ \ \ \ \ \ \ \ \ output\_offset\ -\/=\ it[j].output\_span;}
\DoxyCodeLine{01538\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01539\ \ \ \ \ \}}
\DoxyCodeLine{01540\ \ \ \}}
\DoxyCodeLine{01541\ }
\DoxyCodeLine{01542\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{01543\ \ \ \textcolor{keyword}{struct\ }BlockIteratorState\ \{}
\DoxyCodeLine{01544\ \ \ \ \ BlockIteratorState()}
\DoxyCodeLine{01545\ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2internal_2raw__hash__set__test_8cc_ad43c3812e6d13e0518d9f8b8f463ffcf}{count}}(0),\ \mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2low__level__alloc_8cc_aad9b71a31372d5c0ab9c23163efe9544}{size}}(0),\ output\_stride(0),\ output\_span(0)\ \{\}}
\DoxyCodeLine{01546\ }
\DoxyCodeLine{01547\ \ \ \ \ IndexType\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2internal_2raw__hash__set__test_8cc_ad43c3812e6d13e0518d9f8b8f463ffcf}{count}};}
\DoxyCodeLine{01548\ \ \ \ \ IndexType\ \mbox{\hyperlink{abseil-cpp_2absl_2base_2internal_2low__level__alloc_8cc_aad9b71a31372d5c0ab9c23163efe9544}{size}};}
\DoxyCodeLine{01549\ \ \ \ \ IndexType\ output\_stride;}
\DoxyCodeLine{01550\ \ \ \ \ IndexType\ output\_span;}
\DoxyCodeLine{01551\ \ \ \};}
\DoxyCodeLine{01552\ \};}
\DoxyCodeLine{01553\ }
\DoxyCodeLine{01554\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ //}}
\DoxyCodeLine{01555\ }
\DoxyCodeLine{01556\ \}\ \ \textcolor{comment}{//\ namespace\ internal}}
\DoxyCodeLine{01557\ \}\ \ \textcolor{comment}{//\ namespace\ Eigen}}
\DoxyCodeLine{01558\ }
\DoxyCodeLine{01559\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ EIGEN\_CXX11\_TENSOR\_TENSOR\_BLOCK\_H}}

\end{DoxyCode}
