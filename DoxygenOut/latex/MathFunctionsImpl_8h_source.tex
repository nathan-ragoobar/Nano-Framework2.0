\doxysection{Math\+Functions\+Impl.\+h}
\hypertarget{MathFunctionsImpl_8h_source}{}\label{MathFunctionsImpl_8h_source}\index{eigen/Eigen/src/Core/MathFunctionsImpl.h@{eigen/Eigen/src/Core/MathFunctionsImpl.h}}
\mbox{\hyperlink{MathFunctionsImpl_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ This\ file\ is\ part\ of\ Eigen,\ a\ lightweight\ C++\ template\ library}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ for\ linear\ algebra.}}
\DoxyCodeLine{00003\ \textcolor{comment}{//}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ Copyright\ (C)\ 2014\ Pedro\ Gonnet\ (pedro.gonnet@gmail.com)}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ Copyright\ (C)\ 2016\ Gael\ Guennebaud\ <gael.guennebaud@inria.fr>}}
\DoxyCodeLine{00006\ \textcolor{comment}{//}}
\DoxyCodeLine{00007\ \textcolor{comment}{//\ This\ Source\ Code\ Form\ is\ subject\ to\ the\ terms\ of\ the\ Mozilla}}
\DoxyCodeLine{00008\ \textcolor{comment}{//\ Public\ License\ v.\ 2.0.\ If\ a\ copy\ of\ the\ MPL\ was\ not\ distributed}}
\DoxyCodeLine{00009\ \textcolor{comment}{//\ with\ this\ file,\ You\ can\ obtain\ one\ at\ http://mozilla.org/MPL/2.0/.}}
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#ifndef\ EIGEN\_MATHFUNCTIONSIMPL\_H}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#define\ EIGEN\_MATHFUNCTIONSIMPL\_H}}
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00014\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceEigen}{Eigen}}\ \{}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceinternal}{internal}}\ \{}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00028\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00029\ T\ \mbox{\hyperlink{namespaceEigen_1_1internal_ab589c1da1f207b3493c463c5f006c8cc}{generic\_fast\_tanh\_float}}(\textcolor{keyword}{const}\ T\&\ a\_x)}
\DoxyCodeLine{00030\ \{}
\DoxyCodeLine{00031\ \ \ \textcolor{comment}{//\ Clamp\ the\ inputs\ to\ the\ range\ [-\/c,\ c]}}
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\#ifdef\ EIGEN\_VECTORIZE\_FMA}}
\DoxyCodeLine{00033\ \ \ \textcolor{keyword}{const}\ T\ plus\_clamp\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_afa6f9a9f3c905b28cc29841935e44fdb}{pset1<T>}}(7.99881172180175781f);}
\DoxyCodeLine{00034\ \ \ \textcolor{keyword}{const}\ T\ minus\_clamp\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_afa6f9a9f3c905b28cc29841935e44fdb}{pset1<T>}}(-\/7.99881172180175781f);}
\DoxyCodeLine{00035\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00036\ \ \ \textcolor{keyword}{const}\ T\ plus\_clamp\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_afa6f9a9f3c905b28cc29841935e44fdb}{pset1<T>}}(7.90531110763549805f);}
\DoxyCodeLine{00037\ \ \ \textcolor{keyword}{const}\ T\ minus\_clamp\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_afa6f9a9f3c905b28cc29841935e44fdb}{pset1<T>}}(-\/7.90531110763549805f);}
\DoxyCodeLine{00038\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00039\ \ \ \textcolor{keyword}{const}\ T\ tiny\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_afa6f9a9f3c905b28cc29841935e44fdb}{pset1<T>}}(0.0004f);}
\DoxyCodeLine{00040\ \ \ \textcolor{keyword}{const}\ T\ x\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_a5b48179611579b41066884b064345c60}{pmax}}(\mbox{\hyperlink{namespaceEigen_1_1internal_a7963a08a4667f2c17320ca8c82b8571d}{pmin}}(a\_x,\ plus\_clamp),\ minus\_clamp);}
\DoxyCodeLine{00041\ \ \ \textcolor{keyword}{const}\ T\ tiny\_mask\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_a80fd0d3339d8d54c333ad65081a4d83d}{pcmp\_lt}}(\mbox{\hyperlink{namespaceEigen_1_1internal_a9fdd6f0bbf0e65f4b7f1d47a7b9e76c0}{pabs}}(a\_x),\ tiny);}
\DoxyCodeLine{00042\ \ \ \textcolor{comment}{//\ The\ monomial\ coefficients\ of\ the\ numerator\ polynomial\ (odd).}}
\DoxyCodeLine{00043\ \ \ \textcolor{keyword}{const}\ T\ alpha\_1\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_afa6f9a9f3c905b28cc29841935e44fdb}{pset1<T>}}(4.89352455891786e-\/03f);}
\DoxyCodeLine{00044\ \ \ \textcolor{keyword}{const}\ T\ alpha\_3\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_afa6f9a9f3c905b28cc29841935e44fdb}{pset1<T>}}(6.37261928875436e-\/04f);}
\DoxyCodeLine{00045\ \ \ \textcolor{keyword}{const}\ T\ alpha\_5\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_afa6f9a9f3c905b28cc29841935e44fdb}{pset1<T>}}(1.48572235717979e-\/05f);}
\DoxyCodeLine{00046\ \ \ \textcolor{keyword}{const}\ T\ alpha\_7\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_afa6f9a9f3c905b28cc29841935e44fdb}{pset1<T>}}(5.12229709037114e-\/08f);}
\DoxyCodeLine{00047\ \ \ \textcolor{keyword}{const}\ T\ alpha\_9\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_afa6f9a9f3c905b28cc29841935e44fdb}{pset1<T>}}(-\/8.60467152213735e-\/11f);}
\DoxyCodeLine{00048\ \ \ \textcolor{keyword}{const}\ T\ alpha\_11\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_afa6f9a9f3c905b28cc29841935e44fdb}{pset1<T>}}(2.00018790482477e-\/13f);}
\DoxyCodeLine{00049\ \ \ \textcolor{keyword}{const}\ T\ alpha\_13\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_afa6f9a9f3c905b28cc29841935e44fdb}{pset1<T>}}(-\/2.76076847742355e-\/16f);}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ \ \ \textcolor{comment}{//\ The\ monomial\ coefficients\ of\ the\ denominator\ polynomial\ (even).}}
\DoxyCodeLine{00052\ \ \ \textcolor{keyword}{const}\ T\ beta\_0\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_afa6f9a9f3c905b28cc29841935e44fdb}{pset1<T>}}(4.89352518554385e-\/03f);}
\DoxyCodeLine{00053\ \ \ \textcolor{keyword}{const}\ T\ beta\_2\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_afa6f9a9f3c905b28cc29841935e44fdb}{pset1<T>}}(2.26843463243900e-\/03f);}
\DoxyCodeLine{00054\ \ \ \textcolor{keyword}{const}\ T\ beta\_4\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_afa6f9a9f3c905b28cc29841935e44fdb}{pset1<T>}}(1.18534705686654e-\/04f);}
\DoxyCodeLine{00055\ \ \ \textcolor{keyword}{const}\ T\ beta\_6\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_afa6f9a9f3c905b28cc29841935e44fdb}{pset1<T>}}(1.19825839466702e-\/06f);}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00057\ \ \ \textcolor{comment}{//\ Since\ the\ polynomials\ are\ odd/even,\ we\ need\ x\string^2.}}
\DoxyCodeLine{00058\ \ \ \textcolor{keyword}{const}\ T\ x2\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_a776f5f4b514ecaed2a98db928b8f745f}{pmul}}(x,\ x);}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00060\ \ \ \textcolor{comment}{//\ Evaluate\ the\ numerator\ polynomial\ p.}}
\DoxyCodeLine{00061\ \ \ T\ p\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_a74b4d1fb91602aebe1ae5742e8c2d566}{pmadd}}(x2,\ alpha\_13,\ alpha\_11);}
\DoxyCodeLine{00062\ \ \ p\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_a74b4d1fb91602aebe1ae5742e8c2d566}{pmadd}}(x2,\ p,\ alpha\_9);}
\DoxyCodeLine{00063\ \ \ p\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_a74b4d1fb91602aebe1ae5742e8c2d566}{pmadd}}(x2,\ p,\ alpha\_7);}
\DoxyCodeLine{00064\ \ \ p\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_a74b4d1fb91602aebe1ae5742e8c2d566}{pmadd}}(x2,\ p,\ alpha\_5);}
\DoxyCodeLine{00065\ \ \ p\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_a74b4d1fb91602aebe1ae5742e8c2d566}{pmadd}}(x2,\ p,\ alpha\_3);}
\DoxyCodeLine{00066\ \ \ p\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_a74b4d1fb91602aebe1ae5742e8c2d566}{pmadd}}(x2,\ p,\ alpha\_1);}
\DoxyCodeLine{00067\ \ \ p\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_a776f5f4b514ecaed2a98db928b8f745f}{pmul}}(x,\ p);}
\DoxyCodeLine{00068\ }
\DoxyCodeLine{00069\ \ \ \textcolor{comment}{//\ Evaluate\ the\ denominator\ polynomial\ q.}}
\DoxyCodeLine{00070\ \ \ T\ q\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_a74b4d1fb91602aebe1ae5742e8c2d566}{pmadd}}(x2,\ beta\_6,\ beta\_4);}
\DoxyCodeLine{00071\ \ \ q\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_a74b4d1fb91602aebe1ae5742e8c2d566}{pmadd}}(x2,\ q,\ beta\_2);}
\DoxyCodeLine{00072\ \ \ q\ =\ \mbox{\hyperlink{namespaceEigen_1_1internal_a74b4d1fb91602aebe1ae5742e8c2d566}{pmadd}}(x2,\ q,\ beta\_0);}
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00074\ \ \ \textcolor{comment}{//\ Divide\ the\ numerator\ by\ the\ denominator.}}
\DoxyCodeLine{00075\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespaceEigen_1_1internal_a81b8c065f999e872788f9066d1eed36e}{pselect}}(tiny\_mask,\ x,\ \mbox{\hyperlink{namespaceEigen_1_1internal_a462e918f3381d435028a0decd5485844}{pdiv}}(p,\ q));}
\DoxyCodeLine{00076\ \}}
\DoxyCodeLine{00077\ }
\DoxyCodeLine{00078\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ RealScalar>}
\DoxyCodeLine{00079\ \mbox{\hyperlink{Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}\ \mbox{\hyperlink{Macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}}
\DoxyCodeLine{00080\ RealScalar\ \mbox{\hyperlink{namespaceEigen_1_1internal_a34bb4f1547f13730e187d12038529cd5}{positive\_real\_hypot}}(\textcolor{keyword}{const}\ RealScalar\&\ x,\ \textcolor{keyword}{const}\ RealScalar\&\ \mbox{\hyperlink{namespaceEigen_1_1internal_a3cc80fc03610837da180f7e6d8e7b3ec}{y}})}
\DoxyCodeLine{00081\ \{}
\DoxyCodeLine{00082\ \ \ \textcolor{comment}{//\ IEEE\ IEC\ 6059\ special\ cases.}}
\DoxyCodeLine{00083\ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{namespaceEigen_1_1numext_abb3b49669b99439edde626469bce3e72}{numext::isinf}})(x)\ ||\ (\mbox{\hyperlink{namespaceEigen_1_1numext_abb3b49669b99439edde626469bce3e72}{numext::isinf}})(\mbox{\hyperlink{namespaceEigen_1_1internal_a3cc80fc03610837da180f7e6d8e7b3ec}{y}}))}
\DoxyCodeLine{00084\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structEigen_1_1GenericNumTraits_ac0eb6dd89e4229113abf965c2187bccc}{NumTraits<RealScalar>::infinity}}();}
\DoxyCodeLine{00085\ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{namespaceEigen_1_1numext_aee63c0c33fd9851dec60235bf7005d2a}{numext::isnan}})(x)\ ||\ (\mbox{\hyperlink{namespaceEigen_1_1numext_aee63c0c33fd9851dec60235bf7005d2a}{numext::isnan}})(\mbox{\hyperlink{namespaceEigen_1_1internal_a3cc80fc03610837da180f7e6d8e7b3ec}{y}}))}
\DoxyCodeLine{00086\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structEigen_1_1GenericNumTraits_a8ea85f391d7484f0344a6aaa79f7d6a9}{NumTraits<RealScalar>::quiet\_NaN}}();}
\DoxyCodeLine{00087\ \ \ \ \ }
\DoxyCodeLine{00088\ \ \ \mbox{\hyperlink{Macros_8h_a25f979bbb7bb48bdd9486d46c53f461a}{EIGEN\_USING\_STD}}(sqrt);}
\DoxyCodeLine{00089\ \ \ RealScalar\ p,\ qp;}
\DoxyCodeLine{00090\ \ \ p\ =\ \mbox{\hyperlink{namespaceEigen_1_1numext_a29d502349f2ec9897c808e65e0f96eb4}{numext::maxi}}(x,\mbox{\hyperlink{namespaceEigen_1_1internal_a3cc80fc03610837da180f7e6d8e7b3ec}{y}});}
\DoxyCodeLine{00091\ \ \ \textcolor{keywordflow}{if}(p==RealScalar(0))\ \textcolor{keywordflow}{return}\ RealScalar(0);}
\DoxyCodeLine{00092\ \ \ qp\ =\ \mbox{\hyperlink{namespaceEigen_1_1numext_ab3b30bf0bcfa1ad91dbec75fabb3bea0}{numext::mini}}(\mbox{\hyperlink{namespaceEigen_1_1internal_a3cc80fc03610837da180f7e6d8e7b3ec}{y}},x)\ /\ p;}
\DoxyCodeLine{00093\ \ \ \textcolor{keywordflow}{return}\ p\ *\ \mbox{\hyperlink{ArrayCwiseUnaryOps_8h_a656b9217a2fcb6de59dc8d1eb3079cc7}{sqrt}}(RealScalar(1)\ +\ qp*qp);}
\DoxyCodeLine{00094\ \}}
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00096\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Scalar>}
\DoxyCodeLine{00097\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structEigen_1_1internal_1_1hypot__impl}{hypot\_impl}}}
\DoxyCodeLine{00098\ \{}
\DoxyCodeLine{00099\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{structEigen_1_1GenericNumTraits_a6e9ee9306607a1a0b4f79be74dca97bb}{NumTraits<Scalar>::Real}}\ \mbox{\hyperlink{structEigen_1_1internal_1_1hypot__impl_ace8783fc8c1295c2672bd1a31d47eeb9}{RealScalar}};}
\DoxyCodeLine{00100\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}}
\DoxyCodeLine{00101\ \ \ \textcolor{keyword}{inline}\ \mbox{\hyperlink{structEigen_1_1internal_1_1hypot__impl_ace8783fc8c1295c2672bd1a31d47eeb9}{RealScalar}}\ \mbox{\hyperlink{structEigen_1_1internal_1_1hypot__impl_aa057812a64aa791dff0627e94a187f53}{run}}(\textcolor{keyword}{const}\ Scalar\&\ x,\ \textcolor{keyword}{const}\ Scalar\&\ \mbox{\hyperlink{namespaceEigen_1_1internal_a3cc80fc03610837da180f7e6d8e7b3ec}{y}})}
\DoxyCodeLine{00102\ \ \ \{}
\DoxyCodeLine{00103\ \ \ \ \ \mbox{\hyperlink{Macros_8h_a25f979bbb7bb48bdd9486d46c53f461a}{EIGEN\_USING\_STD}}(\mbox{\hyperlink{ArrayCwiseUnaryOps_8h_a35560f7dbf19244fda7e463d14157c43}{abs}});}
\DoxyCodeLine{00104\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespaceEigen_1_1internal_a34bb4f1547f13730e187d12038529cd5}{positive\_real\_hypot<RealScalar>}}(\mbox{\hyperlink{ArrayCwiseUnaryOps_8h_a35560f7dbf19244fda7e463d14157c43}{abs}}(x),\ \mbox{\hyperlink{ArrayCwiseUnaryOps_8h_a35560f7dbf19244fda7e463d14157c43}{abs}}(\mbox{\hyperlink{namespaceEigen_1_1internal_a3cc80fc03610837da180f7e6d8e7b3ec}{y}}));}
\DoxyCodeLine{00105\ \ \ \}}
\DoxyCodeLine{00106\ \};}
\DoxyCodeLine{00107\ }
\DoxyCodeLine{00108\ \textcolor{comment}{//\ Generic\ complex\ sqrt\ implementation\ that\ correctly\ handles\ corner\ cases}}
\DoxyCodeLine{00109\ \textcolor{comment}{//\ according\ to\ https://en.cppreference.com/w/cpp/numeric/complex/sqrt}}
\DoxyCodeLine{00110\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00111\ \mbox{\hyperlink{Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}\ std::complex<T>\ \mbox{\hyperlink{namespaceEigen_1_1internal_ac92e3e68f2311398a6fa4c8b6f188283}{complex\_sqrt}}(\textcolor{keyword}{const}\ std::complex<T>\&\ z)\ \{}
\DoxyCodeLine{00112\ \ \ \textcolor{comment}{//\ Computes\ the\ principal\ sqrt\ of\ the\ input.}}
\DoxyCodeLine{00113\ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00114\ \ \ \textcolor{comment}{//\ For\ a\ complex\ square\ root\ of\ the\ number\ x\ +\ i*y.\ We\ want\ to\ find\ real}}
\DoxyCodeLine{00115\ \ \ \textcolor{comment}{//\ numbers\ u\ and\ v\ such\ that}}
\DoxyCodeLine{00116\ \ \ \textcolor{comment}{//\ \ \ \ (u\ +\ i*v)\string^2\ =\ x\ +\ i*y\ \ <=>}}
\DoxyCodeLine{00117\ \ \ \textcolor{comment}{//\ \ \ \ u\string^2\ -\/\ v\string^2\ +\ i*2*u*v\ =\ x\ +\ i*v.}}
\DoxyCodeLine{00118\ \ \ \textcolor{comment}{//\ By\ equating\ the\ real\ and\ imaginary\ parts\ we\ get:}}
\DoxyCodeLine{00119\ \ \ \textcolor{comment}{//\ \ \ \ u\string^2\ -\/\ v\string^2\ =\ x}}
\DoxyCodeLine{00120\ \ \ \textcolor{comment}{//\ \ \ \ 2*u*v\ =\ y.}}
\DoxyCodeLine{00121\ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00122\ \ \ \textcolor{comment}{//\ For\ x\ >=\ 0,\ this\ has\ the\ numerically\ stable\ solution}}
\DoxyCodeLine{00123\ \ \ \textcolor{comment}{//\ \ \ \ u\ =\ sqrt(0.5\ *\ (x\ +\ sqrt(x\string^2\ +\ y\string^2)))}}
\DoxyCodeLine{00124\ \ \ \textcolor{comment}{//\ \ \ \ v\ =\ y\ /\ (2\ *\ u)}}
\DoxyCodeLine{00125\ \ \ \textcolor{comment}{//\ and\ for\ x\ <\ 0,}}
\DoxyCodeLine{00126\ \ \ \textcolor{comment}{//\ \ \ \ v\ =\ sign(y)\ *\ sqrt(0.5\ *\ (-\/x\ +\ sqrt(x\string^2\ +\ y\string^2)))}}
\DoxyCodeLine{00127\ \ \ \textcolor{comment}{//\ \ \ \ u\ =\ y\ /\ (2\ *\ v)}}
\DoxyCodeLine{00128\ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00129\ \ \ \textcolor{comment}{//\ Letting\ w\ =\ sqrt(0.5\ *\ (|x|\ +\ |z|)),}}
\DoxyCodeLine{00130\ \ \ \textcolor{comment}{//\ \ \ if\ x\ ==\ 0:\ u\ =\ w,\ v\ =\ sign(y)\ *\ w}}
\DoxyCodeLine{00131\ \ \ \textcolor{comment}{//\ \ \ if\ x\ >\ 0:\ \ u\ =\ w,\ v\ =\ y\ /\ (2\ *\ w)}}
\DoxyCodeLine{00132\ \ \ \textcolor{comment}{//\ \ \ if\ x\ <\ 0:\ \ u\ =\ |y|\ /\ (2\ *\ w),\ v\ =\ sign(y)\ *\ w}}
\DoxyCodeLine{00133\ }
\DoxyCodeLine{00134\ \ \ \textcolor{keyword}{const}\ T\ x\ =\ numext::real(z);}
\DoxyCodeLine{00135\ \ \ \textcolor{keyword}{const}\ T\ \mbox{\hyperlink{namespaceEigen_1_1internal_a3cc80fc03610837da180f7e6d8e7b3ec}{y}}\ =\ numext::imag(z);}
\DoxyCodeLine{00136\ \ \ \textcolor{keyword}{const}\ T\ zero\ =\ T(0);}
\DoxyCodeLine{00137\ \ \ \textcolor{keyword}{const}\ T\ w\ =\ \mbox{\hyperlink{namespaceEigen_1_1numext_a982549ff7a7aa1a72c691bca5ea32ae4}{numext::sqrt}}(T(0.5)\ *\ (\mbox{\hyperlink{namespaceEigen_1_1numext_ac09cd9261a50a46dd4937868020c7c45}{numext::abs}}(x)\ +\ numext::hypot(x,\ \mbox{\hyperlink{namespaceEigen_1_1internal_a3cc80fc03610837da180f7e6d8e7b3ec}{y}})));}
\DoxyCodeLine{00138\ }
\DoxyCodeLine{00139\ \ \ \textcolor{keywordflow}{return}}
\DoxyCodeLine{00140\ \ \ \ \ (\mbox{\hyperlink{namespaceEigen_1_1numext_abb3b49669b99439edde626469bce3e72}{numext::isinf}})(\mbox{\hyperlink{namespaceEigen_1_1internal_a3cc80fc03610837da180f7e6d8e7b3ec}{y}})\ ?\ std::complex<T>(\mbox{\hyperlink{structEigen_1_1NumTraits}{NumTraits<T>::infinity}}(),\ \mbox{\hyperlink{namespaceEigen_1_1internal_a3cc80fc03610837da180f7e6d8e7b3ec}{y}})}
\DoxyCodeLine{00141\ \ \ \ \ \ \ :\ x\ ==\ zero\ ?\ std::complex<T>(w,\ \mbox{\hyperlink{namespaceEigen_1_1internal_a3cc80fc03610837da180f7e6d8e7b3ec}{y}}\ <\ zero\ ?\ -\/w\ :\ w)}
\DoxyCodeLine{00142\ \ \ \ \ \ \ :\ x\ >\ zero\ ?\ std::complex<T>(w,\ \mbox{\hyperlink{namespaceEigen_1_1internal_a3cc80fc03610837da180f7e6d8e7b3ec}{y}}\ /\ (2\ *\ w))}
\DoxyCodeLine{00143\ \ \ \ \ \ \ :\ std::complex<T>(\mbox{\hyperlink{namespaceEigen_1_1numext_ac09cd9261a50a46dd4937868020c7c45}{numext::abs}}(\mbox{\hyperlink{namespaceEigen_1_1internal_a3cc80fc03610837da180f7e6d8e7b3ec}{y}})\ /\ (2\ *\ w),\ \mbox{\hyperlink{namespaceEigen_1_1internal_a3cc80fc03610837da180f7e6d8e7b3ec}{y}}\ <\ zero\ ?\ -\/w\ :\ w\ );}
\DoxyCodeLine{00144\ \}}
\DoxyCodeLine{00145\ }
\DoxyCodeLine{00146\ \textcolor{comment}{//\ Generic\ complex\ rsqrt\ implementation.}}
\DoxyCodeLine{00147\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00148\ \mbox{\hyperlink{Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}\ std::complex<T>\ \mbox{\hyperlink{namespaceEigen_1_1internal_afa8377dd47b49bcccc7a3fd43c3ba77c}{complex\_rsqrt}}(\textcolor{keyword}{const}\ std::complex<T>\&\ z)\ \{}
\DoxyCodeLine{00149\ \ \ \textcolor{comment}{//\ Computes\ the\ principal\ reciprocal\ sqrt\ of\ the\ input.}}
\DoxyCodeLine{00150\ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00151\ \ \ \textcolor{comment}{//\ For\ a\ complex\ reciprocal\ square\ root\ of\ the\ number\ z\ =\ x\ +\ i*y.\ We\ want\ to}}
\DoxyCodeLine{00152\ \ \ \textcolor{comment}{//\ find\ real\ numbers\ u\ and\ v\ such\ that}}
\DoxyCodeLine{00153\ \ \ \textcolor{comment}{//\ \ \ \ (u\ +\ i*v)\string^2\ =\ 1\ /\ (x\ +\ i*y)\ \ <=>}}
\DoxyCodeLine{00154\ \ \ \textcolor{comment}{//\ \ \ \ u\string^2\ -\/\ v\string^2\ +\ i*2*u*v\ =\ x/|z|\string^2\ -\/\ i*v/|z|\string^2.}}
\DoxyCodeLine{00155\ \ \ \textcolor{comment}{//\ By\ equating\ the\ real\ and\ imaginary\ parts\ we\ get:}}
\DoxyCodeLine{00156\ \ \ \textcolor{comment}{//\ \ \ \ u\string^2\ -\/\ v\string^2\ =\ x/|z|\string^2}}
\DoxyCodeLine{00157\ \ \ \textcolor{comment}{//\ \ \ \ 2*u*v\ =\ y/|z|\string^2.}}
\DoxyCodeLine{00158\ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00159\ \ \ \textcolor{comment}{//\ For\ x\ >=\ 0,\ this\ has\ the\ numerically\ stable\ solution}}
\DoxyCodeLine{00160\ \ \ \textcolor{comment}{//\ \ \ \ u\ =\ sqrt(0.5\ *\ (x\ +\ |z|))\ /\ |z|}}
\DoxyCodeLine{00161\ \ \ \textcolor{comment}{//\ \ \ \ v\ =\ -\/y\ /\ (2\ *\ u\ *\ |z|)}}
\DoxyCodeLine{00162\ \ \ \textcolor{comment}{//\ and\ for\ x\ <\ 0,}}
\DoxyCodeLine{00163\ \ \ \textcolor{comment}{//\ \ \ \ v\ =\ -\/sign(y)\ *\ sqrt(0.5\ *\ (-\/x\ +\ |z|))\ /\ |z|}}
\DoxyCodeLine{00164\ \ \ \textcolor{comment}{//\ \ \ \ u\ =\ -\/y\ /\ (2\ *\ v\ *\ |z|)}}
\DoxyCodeLine{00165\ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00166\ \ \ \textcolor{comment}{//\ Letting\ w\ =\ sqrt(0.5\ *\ (|x|\ +\ |z|)),}}
\DoxyCodeLine{00167\ \ \ \textcolor{comment}{//\ \ \ if\ x\ ==\ 0:\ u\ =\ w\ /\ |z|,\ v\ =\ -\/sign(y)\ *\ w\ /\ |z|}}
\DoxyCodeLine{00168\ \ \ \textcolor{comment}{//\ \ \ if\ x\ >\ 0:\ \ u\ =\ w\ /\ |z|,\ v\ =\ -\/y\ /\ (2\ *\ w\ *\ |z|)}}
\DoxyCodeLine{00169\ \ \ \textcolor{comment}{//\ \ \ if\ x\ <\ 0:\ \ u\ =\ |y|\ /\ (2\ *\ w\ *\ |z|),\ v\ =\ -\/sign(y)\ *\ w\ /\ |z|}}
\DoxyCodeLine{00170\ }
\DoxyCodeLine{00171\ \ \ \textcolor{keyword}{const}\ T\ x\ =\ numext::real(z);}
\DoxyCodeLine{00172\ \ \ \textcolor{keyword}{const}\ T\ \mbox{\hyperlink{namespaceEigen_1_1internal_a3cc80fc03610837da180f7e6d8e7b3ec}{y}}\ =\ numext::imag(z);}
\DoxyCodeLine{00173\ \ \ \textcolor{keyword}{const}\ T\ zero\ =\ T(0);}
\DoxyCodeLine{00174\ }
\DoxyCodeLine{00175\ \ \ \textcolor{keyword}{const}\ T\ abs\_z\ =\ numext::hypot(x,\ \mbox{\hyperlink{namespaceEigen_1_1internal_a3cc80fc03610837da180f7e6d8e7b3ec}{y}});}
\DoxyCodeLine{00176\ \ \ \textcolor{keyword}{const}\ T\ w\ =\ \mbox{\hyperlink{namespaceEigen_1_1numext_a982549ff7a7aa1a72c691bca5ea32ae4}{numext::sqrt}}(T(0.5)\ *\ (\mbox{\hyperlink{namespaceEigen_1_1numext_ac09cd9261a50a46dd4937868020c7c45}{numext::abs}}(x)\ +\ abs\_z));}
\DoxyCodeLine{00177\ \ \ \textcolor{keyword}{const}\ T\ woz\ =\ w\ /\ abs\_z;}
\DoxyCodeLine{00178\ \ \ \textcolor{comment}{//\ Corner\ cases\ consistent\ with\ 1/sqrt(z)\ on\ gcc/clang.}}
\DoxyCodeLine{00179\ \ \ \textcolor{keywordflow}{return}}
\DoxyCodeLine{00180\ \ \ \ \ abs\_z\ ==\ zero\ ?\ std::complex<T>(\mbox{\hyperlink{structEigen_1_1NumTraits}{NumTraits<T>::infinity}}(),\ \mbox{\hyperlink{structEigen_1_1NumTraits}{NumTraits<T>::quiet\_NaN}}())}
\DoxyCodeLine{00181\ \ \ \ \ \ \ :\ ((\mbox{\hyperlink{namespaceEigen_1_1numext_abb3b49669b99439edde626469bce3e72}{numext::isinf}})(x)\ ||\ (\mbox{\hyperlink{namespaceEigen_1_1numext_abb3b49669b99439edde626469bce3e72}{numext::isinf}})(\mbox{\hyperlink{namespaceEigen_1_1internal_a3cc80fc03610837da180f7e6d8e7b3ec}{y}}))\ ?\ std::complex<T>(zero,\ zero)}
\DoxyCodeLine{00182\ \ \ \ \ \ \ :\ x\ ==\ zero\ ?\ std::complex<T>(woz,\ \mbox{\hyperlink{namespaceEigen_1_1internal_a3cc80fc03610837da180f7e6d8e7b3ec}{y}}\ <\ zero\ ?\ woz\ :\ -\/woz)}
\DoxyCodeLine{00183\ \ \ \ \ \ \ :\ x\ >\ zero\ ?\ std::complex<T>(woz,\ -\/\mbox{\hyperlink{namespaceEigen_1_1internal_a3cc80fc03610837da180f7e6d8e7b3ec}{y}}\ /\ (2\ *\ w\ *\ abs\_z))}
\DoxyCodeLine{00184\ \ \ \ \ \ \ :\ std::complex<T>(\mbox{\hyperlink{namespaceEigen_1_1numext_ac09cd9261a50a46dd4937868020c7c45}{numext::abs}}(\mbox{\hyperlink{namespaceEigen_1_1internal_a3cc80fc03610837da180f7e6d8e7b3ec}{y}})\ /\ (2\ *\ w\ *\ abs\_z),\ \mbox{\hyperlink{namespaceEigen_1_1internal_a3cc80fc03610837da180f7e6d8e7b3ec}{y}}\ <\ zero\ ?\ woz\ :\ -\/woz\ );}
\DoxyCodeLine{00185\ \}}
\DoxyCodeLine{00186\ }
\DoxyCodeLine{00187\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00188\ \mbox{\hyperlink{Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}\ std::complex<T>\ \mbox{\hyperlink{namespaceEigen_1_1internal_ab618d9f91937fc8af2f975fd29447a97}{complex\_log}}(\textcolor{keyword}{const}\ std::complex<T>\&\ z)\ \{}
\DoxyCodeLine{00189\ \ \ \textcolor{comment}{//\ Computes\ complex\ log.}}
\DoxyCodeLine{00190\ \ \ T\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2internal_2common__policy__traits__test_8cc_aa4c2a5552e9bc49b1816ff532f558c74}{a}}\ =\ \mbox{\hyperlink{namespaceEigen_1_1numext_ac09cd9261a50a46dd4937868020c7c45}{numext::abs}}(z);}
\DoxyCodeLine{00191\ \ \ \mbox{\hyperlink{Macros_8h_a25f979bbb7bb48bdd9486d46c53f461a}{EIGEN\_USING\_STD}}(\mbox{\hyperlink{namespaceEigen_aabbac4a376874ce85e22f24da1845008}{atan2}});}
\DoxyCodeLine{00192\ \ \ T\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2internal_2layout__test_8cc_ad66453096871179e6c6effe0df4b483b}{b}}\ =\ \mbox{\hyperlink{namespaceEigen_aabbac4a376874ce85e22f24da1845008}{atan2}}(z.imag(),\ z.real());}
\DoxyCodeLine{00193\ \ \ \textcolor{keywordflow}{return}\ std::complex<T>(\mbox{\hyperlink{namespaceEigen_1_1numext_a156fa9c73b414b6996bfcddf3fed4c77}{numext::log}}(\mbox{\hyperlink{abseil-cpp_2absl_2container_2internal_2common__policy__traits__test_8cc_aa4c2a5552e9bc49b1816ff532f558c74}{a}}),\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2internal_2layout__test_8cc_ad66453096871179e6c6effe0df4b483b}{b}});}
\DoxyCodeLine{00194\ \}}
\DoxyCodeLine{00195\ }
\DoxyCodeLine{00196\ \}\ \textcolor{comment}{//\ end\ namespace\ internal}}
\DoxyCodeLine{00197\ }
\DoxyCodeLine{00198\ \}\ \textcolor{comment}{//\ end\ namespace\ Eigen}}
\DoxyCodeLine{00199\ }
\DoxyCodeLine{00200\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ EIGEN\_MATHFUNCTIONSIMPL\_H}}

\end{DoxyCode}
