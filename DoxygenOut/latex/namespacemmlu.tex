\doxysection{mmlu Namespace Reference}
\hypertarget{namespacemmlu}{}\label{namespacemmlu}\index{mmlu@{mmlu}}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacemmlu_af2b7f797f28a765f28918fd6bec415e4}{download}} ()
\item 
\mbox{\hyperlink{namespacemmlu_abdbe9fa036e6ccba534a2bc1e75ca642}{iterate\+\_\+examples}} ()
\item 
\mbox{\hyperlink{namespacemmlu_a5a75264428cde1aa2c31c53aeab60977}{render\+\_\+example}} (example)
\item 
\mbox{\hyperlink{namespacemmlu_a42b8a58b84a9b20b099c2632431bdb68}{evaluate}} (model\+\_\+type, device)
\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacemmlu_ad8eace99f44e6a93342db65937711882}{DATA\+\_\+\+CACHE\+\_\+\+DIR}} = os.\+path.\+join(os.\+path.\+dirname(\+\_\+\+\_\+file\+\_\+\+\_\+), "{}mmlu"{})
\item 
\mbox{\hyperlink{namespacemmlu_a280417621b40e90127b9e4c03007ab7e}{enc}} = tiktoken.\+get\+\_\+encoding("{}gpt2"{})
\item 
\mbox{\hyperlink{namespacemmlu_a6075aadcdd80d632b058a4112f286c46}{str}} \mbox{\hyperlink{namespacemmlu_a79009be2a5013fe941c66f99ab1881fa}{data\+\_\+url}} = "{}https\+://people.\+eecs.\+berkeley.\+edu/\texorpdfstring{$\sim$}{\string~}hendrycks/data.\+tar"{}
\item 
\mbox{\hyperlink{namespacemmlu_a3930325185d0e3b34652376d003f2e36}{parser}} = argparse.\+Argument\+Parser()
\item 
\mbox{\hyperlink{namespacemmlu_a87d0812a9633a0433d6dc22055255297}{type}}
\item 
\mbox{\hyperlink{namespacemmlu_a6075aadcdd80d632b058a4112f286c46}{str}}
\item 
\mbox{\hyperlink{namespacemmlu_a221064d306511d4d5cdd368fabef2626}{default}}
\item 
\mbox{\hyperlink{namespacemmlu_a6651e0520898b80bafada60d2ab85829}{help}}
\item 
\mbox{\hyperlink{namespacemmlu_aa91391e0072eb8ff1525bcd80252e9f2}{args}} = parser.\+parse\+\_\+args()
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\begin{DoxyVerb}Downloads and evaluates MMLU in Python.
This then acts as the reference file for llm.c
https://github.com/hendrycks/test

gpt2 (124M)
- this script: 14042 acc: 0.2557 acc_norm: 0.2721

gpt2-xl (1558M)
- this script: 14042 acc: 0.2927 acc_norm: 0.3035
\end{DoxyVerb}
 

\doxysubsection{Function Documentation}
\Hypertarget{namespacemmlu_af2b7f797f28a765f28918fd6bec415e4}\index{mmlu@{mmlu}!download@{download}}
\index{download@{download}!mmlu@{mmlu}}
\doxysubsubsection{\texorpdfstring{download()}{download()}}
{\footnotesize\ttfamily \label{namespacemmlu_af2b7f797f28a765f28918fd6bec415e4} 
mmlu.\+download (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Downloads MMLU to DATA_CACHE_DIR\end{DoxyVerb}
 \Hypertarget{namespacemmlu_a42b8a58b84a9b20b099c2632431bdb68}\index{mmlu@{mmlu}!evaluate@{evaluate}}
\index{evaluate@{evaluate}!mmlu@{mmlu}}
\doxysubsubsection{\texorpdfstring{evaluate()}{evaluate()}}
{\footnotesize\ttfamily \label{namespacemmlu_a42b8a58b84a9b20b099c2632431bdb68} 
mmlu.\+evaluate (\begin{DoxyParamCaption}\item[{}]{model\+\_\+type}{, }\item[{}]{device}{}\end{DoxyParamCaption})}

\Hypertarget{namespacemmlu_abdbe9fa036e6ccba534a2bc1e75ca642}\index{mmlu@{mmlu}!iterate\_examples@{iterate\_examples}}
\index{iterate\_examples@{iterate\_examples}!mmlu@{mmlu}}
\doxysubsubsection{\texorpdfstring{iterate\_examples()}{iterate\_examples()}}
{\footnotesize\ttfamily \label{namespacemmlu_abdbe9fa036e6ccba534a2bc1e75ca642} 
mmlu.\+iterate\+\_\+examples (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}

\Hypertarget{namespacemmlu_a5a75264428cde1aa2c31c53aeab60977}\index{mmlu@{mmlu}!render\_example@{render\_example}}
\index{render\_example@{render\_example}!mmlu@{mmlu}}
\doxysubsubsection{\texorpdfstring{render\_example()}{render\_example()}}
{\footnotesize\ttfamily \label{namespacemmlu_a5a75264428cde1aa2c31c53aeab60977} 
mmlu.\+render\+\_\+example (\begin{DoxyParamCaption}\item[{}]{example}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Given the example as a dictionary, render it as three torch tensors:
- tokens (the tokens of context + completion, of size 4xN, as there are always 4 candidates)
- mask (is 1 in the region of the candidate completion, where we evaluate likelihoods)
- label (the index of the correct completion, which we hope has the highest likelihood)
\end{DoxyVerb}
 

\doxysubsection{Variable Documentation}
\Hypertarget{namespacemmlu_aa91391e0072eb8ff1525bcd80252e9f2}\index{mmlu@{mmlu}!args@{args}}
\index{args@{args}!mmlu@{mmlu}}
\doxysubsubsection{\texorpdfstring{args}{args}}
{\footnotesize\ttfamily \label{namespacemmlu_aa91391e0072eb8ff1525bcd80252e9f2} 
mmlu.\+args = parser.\+parse\+\_\+args()}

\Hypertarget{namespacemmlu_ad8eace99f44e6a93342db65937711882}\index{mmlu@{mmlu}!DATA\_CACHE\_DIR@{DATA\_CACHE\_DIR}}
\index{DATA\_CACHE\_DIR@{DATA\_CACHE\_DIR}!mmlu@{mmlu}}
\doxysubsubsection{\texorpdfstring{DATA\_CACHE\_DIR}{DATA\_CACHE\_DIR}}
{\footnotesize\ttfamily \label{namespacemmlu_ad8eace99f44e6a93342db65937711882} 
mmlu.\+DATA\+\_\+\+CACHE\+\_\+\+DIR = os.\+path.\+join(os.\+path.\+dirname(\+\_\+\+\_\+file\+\_\+\+\_\+), "{}mmlu"{})}

\Hypertarget{namespacemmlu_a79009be2a5013fe941c66f99ab1881fa}\index{mmlu@{mmlu}!data\_url@{data\_url}}
\index{data\_url@{data\_url}!mmlu@{mmlu}}
\doxysubsubsection{\texorpdfstring{data\_url}{data\_url}}
{\footnotesize\ttfamily \label{namespacemmlu_a79009be2a5013fe941c66f99ab1881fa} 
\mbox{\hyperlink{namespacemmlu_a6075aadcdd80d632b058a4112f286c46}{str}} mmlu.\+data\+\_\+url = "{}https\+://people.\+eecs.\+berkeley.\+edu/\texorpdfstring{$\sim$}{\string~}hendrycks/data.\+tar"{}}

\Hypertarget{namespacemmlu_a221064d306511d4d5cdd368fabef2626}\index{mmlu@{mmlu}!default@{default}}
\index{default@{default}!mmlu@{mmlu}}
\doxysubsubsection{\texorpdfstring{default}{default}}
{\footnotesize\ttfamily \label{namespacemmlu_a221064d306511d4d5cdd368fabef2626} 
mmlu.\+default}

\Hypertarget{namespacemmlu_a280417621b40e90127b9e4c03007ab7e}\index{mmlu@{mmlu}!enc@{enc}}
\index{enc@{enc}!mmlu@{mmlu}}
\doxysubsubsection{\texorpdfstring{enc}{enc}}
{\footnotesize\ttfamily \label{namespacemmlu_a280417621b40e90127b9e4c03007ab7e} 
mmlu.\+enc = tiktoken.\+get\+\_\+encoding("{}gpt2"{})}

\Hypertarget{namespacemmlu_a6651e0520898b80bafada60d2ab85829}\index{mmlu@{mmlu}!help@{help}}
\index{help@{help}!mmlu@{mmlu}}
\doxysubsubsection{\texorpdfstring{help}{help}}
{\footnotesize\ttfamily \label{namespacemmlu_a6651e0520898b80bafada60d2ab85829} 
mmlu.\+help}

\Hypertarget{namespacemmlu_a3930325185d0e3b34652376d003f2e36}\index{mmlu@{mmlu}!parser@{parser}}
\index{parser@{parser}!mmlu@{mmlu}}
\doxysubsubsection{\texorpdfstring{parser}{parser}}
{\footnotesize\ttfamily \label{namespacemmlu_a3930325185d0e3b34652376d003f2e36} 
mmlu.\+parser = argparse.\+Argument\+Parser()}

\Hypertarget{namespacemmlu_a6075aadcdd80d632b058a4112f286c46}\index{mmlu@{mmlu}!str@{str}}
\index{str@{str}!mmlu@{mmlu}}
\doxysubsubsection{\texorpdfstring{str}{str}}
{\footnotesize\ttfamily \label{namespacemmlu_a6075aadcdd80d632b058a4112f286c46} 
mmlu.\+str}

\Hypertarget{namespacemmlu_a87d0812a9633a0433d6dc22055255297}\index{mmlu@{mmlu}!type@{type}}
\index{type@{type}!mmlu@{mmlu}}
\doxysubsubsection{\texorpdfstring{type}{type}}
{\footnotesize\ttfamily \label{namespacemmlu_a87d0812a9633a0433d6dc22055255297} 
mmlu.\+type}

