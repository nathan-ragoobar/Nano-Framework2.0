\doxysection{Matrix\+Power.\+h}
\hypertarget{MatrixPower_8h_source}{}\label{MatrixPower_8h_source}\index{eigen/unsupported/Eigen/src/MatrixFunctions/MatrixPower.h@{eigen/unsupported/Eigen/src/MatrixFunctions/MatrixPower.h}}
\mbox{\hyperlink{MatrixPower_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ This\ file\ is\ part\ of\ Eigen,\ a\ lightweight\ C++\ template\ library}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ for\ linear\ algebra.}}
\DoxyCodeLine{00003\ \textcolor{comment}{//}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ Copyright\ (C)\ 2012,\ 2013\ Chen-\/Pang\ He\ <jdh8@ms63.hinet.net>}}
\DoxyCodeLine{00005\ \textcolor{comment}{//}}
\DoxyCodeLine{00006\ \textcolor{comment}{//\ This\ Source\ Code\ Form\ is\ subject\ to\ the\ terms\ of\ the\ Mozilla}}
\DoxyCodeLine{00007\ \textcolor{comment}{//\ Public\ License\ v.\ 2.0.\ If\ a\ copy\ of\ the\ MPL\ was\ not\ distributed}}
\DoxyCodeLine{00008\ \textcolor{comment}{//\ with\ this\ file,\ You\ can\ obtain\ one\ at\ http://mozilla.org/MPL/2.0/.}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#ifndef\ EIGEN\_MATRIX\_POWER}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#define\ EIGEN\_MATRIX\_POWER}}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceEigen}{Eigen}}\ \{}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00015\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>\ \textcolor{keyword}{class\ }MatrixPower;}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00030\ \textcolor{comment}{/*\ TODO\ This\ class\ is\ only\ used\ by\ MatrixPower,\ so\ it\ should\ be\ nested}}
\DoxyCodeLine{00031\ \textcolor{comment}{\ *\ into\ MatrixPower,\ like\ MatrixPower::ReturnValue.\ However,\ my}}
\DoxyCodeLine{00032\ \textcolor{comment}{\ *\ compiler\ complained\ about\ unused\ template\ parameter\ in\ the}}
\DoxyCodeLine{00033\ \textcolor{comment}{\ *\ following\ declaration\ in\ namespace\ internal.}}
\DoxyCodeLine{00034\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00035\ \textcolor{comment}{\ *\ template<typename\ MatrixType>}}
\DoxyCodeLine{00036\ \textcolor{comment}{\ *\ struct\ traits<MatrixPower<MatrixType>::ReturnValue>;}}
\DoxyCodeLine{00037\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00038\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00039\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classEigen_1_1MatrixPowerParenthesesReturnValue}{MatrixPowerParenthesesReturnValue}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classEigen_1_1ReturnByValue}{ReturnByValue}}<\ MatrixPowerParenthesesReturnValue<MatrixType>\ >}
\DoxyCodeLine{00040\ \{}
\DoxyCodeLine{00041\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00042\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ MatrixType::RealScalar\ \mbox{\hyperlink{classEigen_1_1MatrixPowerParenthesesReturnValue_a8d1fd6571a29ceb3672d560c2391a71e}{RealScalar}};}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00050\ \ \ \ \ \mbox{\hyperlink{classEigen_1_1MatrixPowerParenthesesReturnValue_ae3a02d943a31427a6dc8c1f60f3367d7}{MatrixPowerParenthesesReturnValue}}(\mbox{\hyperlink{classEigen_1_1MatrixPower}{MatrixPower<MatrixType>}}\&\ \mbox{\hyperlink{classEigen_1_1ArrayBase_acb769e1ab1d809abb77c7ab98021ad81}{pow}},\ \mbox{\hyperlink{classEigen_1_1MatrixPowerParenthesesReturnValue_a8d1fd6571a29ceb3672d560c2391a71e}{RealScalar}}\ p)\ :\ m\_pow(\mbox{\hyperlink{classEigen_1_1ArrayBase_acb769e1ab1d809abb77c7ab98021ad81}{pow}}),\ m\_p(p)}
\DoxyCodeLine{00051\ \ \ \ \ \{\ \}}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ ResultType>}
\DoxyCodeLine{00059\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEigen_1_1MatrixPowerParenthesesReturnValue_af91430ff248b714158cfba4301cc0e2b}{evalTo}}(ResultType\&\ result)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00060\ \textcolor{keyword}{\ \ \ \ }\{\ m\_pow.compute(result,\ m\_p);\ \}}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ \ \ \ \ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ \mbox{\hyperlink{classEigen_1_1MatrixPowerParenthesesReturnValue_a3d4c222d1ac986d5634d48e7c4c063ba}{rows}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ m\_pow.rows();\ \}}
\DoxyCodeLine{00063\ \ \ \ \ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ \mbox{\hyperlink{classEigen_1_1MatrixPowerParenthesesReturnValue_aa28962cac15946c4855f8155aa55c371}{cols}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ m\_pow.cols();\ \}}
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00065\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00066\ \ \ \ \ \mbox{\hyperlink{classEigen_1_1MatrixPower}{MatrixPower<MatrixType>}}\&\ m\_pow;}
\DoxyCodeLine{00067\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1MatrixPowerParenthesesReturnValue_a8d1fd6571a29ceb3672d560c2391a71e}{RealScalar}}\ m\_p;}
\DoxyCodeLine{00068\ \};}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00085\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00086\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classEigen_1_1MatrixPowerAtomic}{MatrixPowerAtomic}}\ :\ \mbox{\hyperlink{classEigen_1_1internal_1_1noncopyable}{internal::noncopyable}}}
\DoxyCodeLine{00087\ \{}
\DoxyCodeLine{00088\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00089\ \ \ \ \ \textcolor{keyword}{enum}\ \{}
\DoxyCodeLine{00090\ \ \ \ \ \ \ RowsAtCompileTime\ =\ MatrixType::RowsAtCompileTime,}
\DoxyCodeLine{00091\ \ \ \ \ \ \ MaxRowsAtCompileTime\ =\ MatrixType::MaxRowsAtCompileTime}
\DoxyCodeLine{00092\ \ \ \ \ \};}
\DoxyCodeLine{00093\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ MatrixType::Scalar\ Scalar;}
\DoxyCodeLine{00094\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ MatrixType::RealScalar\ RealScalar;}
\DoxyCodeLine{00095\ \ \ \ \ \textcolor{keyword}{typedef}\ std::complex<RealScalar>\ ComplexScalar;}
\DoxyCodeLine{00096\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{classEigen_1_1Block}{Block<MatrixType,Dynamic,Dynamic>}}\ \mbox{\hyperlink{classEigen_1_1Block}{ResultType}};}
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00098\ \ \ \ \ \textcolor{keyword}{const}\ MatrixType\&\ m\_A;}
\DoxyCodeLine{00099\ \ \ \ \ RealScalar\ m\_p;}
\DoxyCodeLine{00100\ }
\DoxyCodeLine{00101\ \ \ \ \ \textcolor{keywordtype}{void}\ computePade(\textcolor{keywordtype}{int}\ degree,\ \textcolor{keyword}{const}\ MatrixType\&\ IminusT,\ \mbox{\hyperlink{classEigen_1_1Block}{ResultType}}\&\ res)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00102\ \ \ \ \ \textcolor{keywordtype}{void}\ compute2x2(\mbox{\hyperlink{classEigen_1_1Block}{ResultType}}\&\ res,\ RealScalar\ p)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00103\ \ \ \ \ \textcolor{keywordtype}{void}\ computeBig(\mbox{\hyperlink{classEigen_1_1Block}{ResultType}}\&\ res)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00104\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{int}\ getPadeDegree(\textcolor{keywordtype}{float}\ normIminusT);}
\DoxyCodeLine{00105\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{int}\ getPadeDegree(\textcolor{keywordtype}{double}\ normIminusT);}
\DoxyCodeLine{00106\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{int}\ getPadeDegree(\textcolor{keywordtype}{long}\ \textcolor{keywordtype}{double}\ normIminusT);}
\DoxyCodeLine{00107\ \ \ \ \ \textcolor{keyword}{static}\ ComplexScalar\ computeSuperDiag(\textcolor{keyword}{const}\ ComplexScalar\&,\ \textcolor{keyword}{const}\ ComplexScalar\&,\ RealScalar\ p);}
\DoxyCodeLine{00108\ \ \ \ \ \textcolor{keyword}{static}\ RealScalar\ computeSuperDiag(RealScalar,\ RealScalar,\ RealScalar\ p);}
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00110\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00122\ \ \ \ \ \mbox{\hyperlink{classEigen_1_1MatrixPowerAtomic_ac0ec5f8d6c203cd9b53e2c95e01037d4}{MatrixPowerAtomic}}(\textcolor{keyword}{const}\ MatrixType\&\ T,\ RealScalar\ p);}
\DoxyCodeLine{00123\ \ \ \ \ }
\DoxyCodeLine{00130\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEigen_1_1MatrixPowerAtomic_ac3cdfb54a5b60079d068784534cbc174}{compute}}(\mbox{\hyperlink{classEigen_1_1Block}{ResultType}}\&\ res)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00131\ \};}
\DoxyCodeLine{00132\ }
\DoxyCodeLine{00133\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00134\ \mbox{\hyperlink{classEigen_1_1MatrixPowerAtomic_ac0ec5f8d6c203cd9b53e2c95e01037d4}{MatrixPowerAtomic<MatrixType>::MatrixPowerAtomic}}(\textcolor{keyword}{const}\ MatrixType\&\ T,\ RealScalar\ p)\ :}
\DoxyCodeLine{00135\ \ \ m\_A(T),\ m\_p(p)}
\DoxyCodeLine{00136\ \{}
\DoxyCodeLine{00137\ \ \ \mbox{\hyperlink{Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(T.rows()\ ==\ T.cols());}
\DoxyCodeLine{00138\ \ \ \mbox{\hyperlink{Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(p\ >\ -\/1\ \&\&\ p\ <\ 1);}
\DoxyCodeLine{00139\ \}}
\DoxyCodeLine{00140\ }
\DoxyCodeLine{00141\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00142\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEigen_1_1MatrixPowerAtomic_ac3cdfb54a5b60079d068784534cbc174}{MatrixPowerAtomic<MatrixType>::compute}}(\mbox{\hyperlink{classEigen_1_1Block}{ResultType}}\&\ res)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00143\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00144\ \ \ \textcolor{keyword}{using\ }std::pow;}
\DoxyCodeLine{00145\ \ \ \textcolor{keywordflow}{switch}\ (m\_A.rows())\ \{}
\DoxyCodeLine{00146\ \ \ \ \ \textcolor{keywordflow}{case}\ 0:}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00148\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{00149\ \ \ \ \ \ \ res(0,0)\ =\ \mbox{\hyperlink{classEigen_1_1ArrayBase_acb769e1ab1d809abb77c7ab98021ad81}{pow}}(m\_A(0,0),\ m\_p);}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00151\ \ \ \ \ \textcolor{keywordflow}{case}\ 2:}
\DoxyCodeLine{00152\ \ \ \ \ \ \ compute2x2(res,\ m\_p);}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00154\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00155\ \ \ \ \ \ \ computeBig(res);}
\DoxyCodeLine{00156\ \ \ \}}
\DoxyCodeLine{00157\ \}}
\DoxyCodeLine{00158\ }
\DoxyCodeLine{00159\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00160\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEigen_1_1MatrixPowerAtomic}{MatrixPowerAtomic<MatrixType>::computePade}}(\textcolor{keywordtype}{int}\ degree,\ \textcolor{keyword}{const}\ MatrixType\&\ IminusT,\ ResultType\&\ res)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00161\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00162\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 2*degree;}
\DoxyCodeLine{00163\ \ \ res\ =\ (m\_p-\/RealScalar(degree))\ /\ RealScalar(2*\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}-\/2)\ *\ IminusT;}
\DoxyCodeLine{00164\ }
\DoxyCodeLine{00165\ \ \ \textcolor{keywordflow}{for}\ (-\/-\/\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}};\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}};\ -\/-\/\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ \{}
\DoxyCodeLine{00166\ \ \ \ \ res\ =\ (MatrixType::Identity(IminusT.rows(),\ IminusT.cols())\ +\ res).\textcolor{keyword}{template}\ triangularView<Upper>()}
\DoxyCodeLine{00167\ \ \ \ \ .solve((\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}==1\ ?\ -\/m\_p\ :\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\&1\ ?\ (-\/m\_p-\/RealScalar(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}/2))/RealScalar(2*\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ :\ (m\_p-\/RealScalar(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}/2))/RealScalar(2*\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}-\/2))\ *\ IminusT).eval();}
\DoxyCodeLine{00168\ \ \ \}}
\DoxyCodeLine{00169\ \ \ res\ +=\ MatrixType::Identity(IminusT.rows(),\ IminusT.cols());}
\DoxyCodeLine{00170\ \}}
\DoxyCodeLine{00171\ }
\DoxyCodeLine{00172\ \textcolor{comment}{//\ This\ function\ assumes\ that\ res\ has\ the\ correct\ size\ (see\ bug\ 614)}}
\DoxyCodeLine{00173\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00174\ \textcolor{keywordtype}{void}\ MatrixPowerAtomic<MatrixType>::compute2x2(ResultType\&\ res,\ RealScalar\ p)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00175\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00176\ \ \ \textcolor{keyword}{using\ }std::abs;}
\DoxyCodeLine{00177\ \ \ \textcolor{keyword}{using\ }std::pow;}
\DoxyCodeLine{00178\ \ \ res.coeffRef(0,0)\ =\ \mbox{\hyperlink{classEigen_1_1ArrayBase_acb769e1ab1d809abb77c7ab98021ad81}{pow}}(m\_A.coeff(0,0),\ p);}
\DoxyCodeLine{00179\ }
\DoxyCodeLine{00180\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}=1;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ m\_A.cols();\ ++\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ \{}
\DoxyCodeLine{00181\ \ \ \ \ res.coeffRef(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}},\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ \mbox{\hyperlink{classEigen_1_1ArrayBase_acb769e1ab1d809abb77c7ab98021ad81}{pow}}(m\_A.coeff(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}},\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}),\ p);}
\DoxyCodeLine{00182\ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_A.coeff(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}-\/1,\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}-\/1)\ ==\ m\_A.coeff(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}},\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}))}
\DoxyCodeLine{00183\ \ \ \ \ \ \ res.coeffRef(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}-\/1,\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ \mbox{\hyperlink{namespaceabsl_a828e0f13fb3947cdf6406b7a4feec8aca83878c91171338902e0fe0fb97a8c47a}{p}}\ *\ \mbox{\hyperlink{classEigen_1_1ArrayBase_acb769e1ab1d809abb77c7ab98021ad81}{pow}}(m\_A.coeff(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}},\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}),\ p-\/1);}
\DoxyCodeLine{00184\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (2*\mbox{\hyperlink{ArrayCwiseUnaryOps_8h_a35560f7dbf19244fda7e463d14157c43}{abs}}(m\_A.coeff(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}-\/1,\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}-\/1))\ <\ \mbox{\hyperlink{ArrayCwiseUnaryOps_8h_a35560f7dbf19244fda7e463d14157c43}{abs}}(m\_A.coeff(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}},\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}))\ ||\ 2*\mbox{\hyperlink{ArrayCwiseUnaryOps_8h_a35560f7dbf19244fda7e463d14157c43}{abs}}(m\_A.coeff(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}},\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}))\ <\ \mbox{\hyperlink{ArrayCwiseUnaryOps_8h_a35560f7dbf19244fda7e463d14157c43}{abs}}(m\_A.coeff(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}-\/1,\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}-\/1)))}
\DoxyCodeLine{00185\ \ \ \ \ \ \ res.coeffRef(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}-\/1,\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ (res.coeff(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}},\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})-\/res.coeff(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}-\/1,\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}-\/1))\ /\ (m\_A.coeff(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}},\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})-\/m\_A.coeff(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}-\/1,\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}-\/1));}
\DoxyCodeLine{00186\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00187\ \ \ \ \ \ \ res.coeffRef(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}-\/1,\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ =\ computeSuperDiag(m\_A.coeff(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}},\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}),\ m\_A.coeff(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}-\/1,\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}-\/1),\ p);}
\DoxyCodeLine{00188\ \ \ \ \ res.coeffRef(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}-\/1,\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ *=\ m\_A.coeff(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}-\/1,\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}});}
\DoxyCodeLine{00189\ \ \ \}}
\DoxyCodeLine{00190\ \}}
\DoxyCodeLine{00191\ }
\DoxyCodeLine{00192\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00193\ \textcolor{keywordtype}{void}\ MatrixPowerAtomic<MatrixType>::computeBig(ResultType\&\ res)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00194\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00195\ \ \ \textcolor{keyword}{using\ }std::ldexp;}
\DoxyCodeLine{00196\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ digits\ =\ std::numeric\_limits<RealScalar>::digits;}
\DoxyCodeLine{00197\ \ \ \textcolor{keyword}{const}\ RealScalar\ maxNormForPade\ =\ RealScalar(}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ digits\ <=\ \ 24?\ 4.3386528e-\/1L\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ single\ precision}}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ digits\ <=\ \ 53?\ 2.789358995219730e-\/1L\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ double\ precision}}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ digits\ <=\ \ 64?\ 2.4471944416607995472e-\/1L\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ extended\ precision}}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ digits\ <=\ 106?\ 1.1016843812851143391275867258512e-\/1L\ \ \ \ \textcolor{comment}{//\ double-\/double}}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 9.134603732914548552537150753385375e-\/2L);\ \textcolor{comment}{//\ quadruple\ precision}}
\DoxyCodeLine{00203\ \ \ MatrixType\ IminusT,\ sqrtT,\ T\ =\ m\_A.template\ triangularView<Upper>();}
\DoxyCodeLine{00204\ \ \ RealScalar\ normIminusT;}
\DoxyCodeLine{00205\ \ \ \textcolor{keywordtype}{int}\ degree,\ degree2,\ numberOfSquareRoots\ =\ 0;}
\DoxyCodeLine{00206\ \ \ \textcolor{keywordtype}{bool}\ hasExtraSquareRoot\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00207\ }
\DoxyCodeLine{00208\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}=0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ m\_A.cols();\ ++\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})}
\DoxyCodeLine{00209\ \ \ \ \ \mbox{\hyperlink{Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(m\_A(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}},\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ !=\ RealScalar(0));}
\DoxyCodeLine{00210\ }
\DoxyCodeLine{00211\ \ \ \textcolor{keywordflow}{while}\ (\textcolor{keyword}{true})\ \{}
\DoxyCodeLine{00212\ \ \ \ \ IminusT\ =\ MatrixType::Identity(m\_A.rows(),\ m\_A.cols())\ -\/\ T;}
\DoxyCodeLine{00213\ \ \ \ \ normIminusT\ =\ IminusT.cwiseAbs().colwise().sum().maxCoeff();}
\DoxyCodeLine{00214\ \ \ \ \ \textcolor{keywordflow}{if}\ (normIminusT\ <\ maxNormForPade)\ \{}
\DoxyCodeLine{00215\ \ \ \ \ \ \ degree\ =\ getPadeDegree(normIminusT);}
\DoxyCodeLine{00216\ \ \ \ \ \ \ degree2\ =\ getPadeDegree(normIminusT/2);}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (degree\ -\/\ degree2\ <=\ 1\ ||\ hasExtraSquareRoot)}
\DoxyCodeLine{00218\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00219\ \ \ \ \ \ \ hasExtraSquareRoot\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00220\ \ \ \ \ \}}
\DoxyCodeLine{00221\ \ \ \ \ \mbox{\hyperlink{namespaceEigen_ae51c91f920f6ea4a7f6f72caa1e8249f}{matrix\_sqrt\_triangular}}(T,\ sqrtT);}
\DoxyCodeLine{00222\ \ \ \ \ T\ =\ sqrtT.template\ triangularView<Upper>();}
\DoxyCodeLine{00223\ \ \ \ \ ++numberOfSquareRoots;}
\DoxyCodeLine{00224\ \ \ \}}
\DoxyCodeLine{00225\ \ \ computePade(degree,\ IminusT,\ res);}
\DoxyCodeLine{00226\ }
\DoxyCodeLine{00227\ \ \ \textcolor{keywordflow}{for}\ (;\ numberOfSquareRoots;\ -\/-\/numberOfSquareRoots)\ \{}
\DoxyCodeLine{00228\ \ \ \ \ compute2x2(res,\ ldexp(m\_p,\ -\/numberOfSquareRoots));}
\DoxyCodeLine{00229\ \ \ \ \ res\ =\ res.template\ triangularView<Upper>()\ *\ res;}
\DoxyCodeLine{00230\ \ \ \}}
\DoxyCodeLine{00231\ \ \ compute2x2(res,\ m\_p);}
\DoxyCodeLine{00232\ \}}
\DoxyCodeLine{00233\ \ \ }
\DoxyCodeLine{00234\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00235\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{int}\ MatrixPowerAtomic<MatrixType>::getPadeDegree(\textcolor{keywordtype}{float}\ normIminusT)}
\DoxyCodeLine{00236\ \{}
\DoxyCodeLine{00237\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{float}\ maxNormForPade[]\ =\ \{\ 2.8064004e-\/1f\ \textcolor{comment}{/*\ degree\ =\ 3\ */}\ ,\ 4.3386528e-\/1f\ \};}
\DoxyCodeLine{00238\ \ \ \textcolor{keywordtype}{int}\ degree\ =\ 3;}
\DoxyCodeLine{00239\ \ \ \textcolor{keywordflow}{for}\ (;\ degree\ <=\ 4;\ ++degree)}
\DoxyCodeLine{00240\ \ \ \ \ \textcolor{keywordflow}{if}\ (normIminusT\ <=\ maxNormForPade[degree\ -\/\ 3])}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00242\ \ \ \textcolor{keywordflow}{return}\ degree;}
\DoxyCodeLine{00243\ \}}
\DoxyCodeLine{00244\ }
\DoxyCodeLine{00245\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00246\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{int}\ MatrixPowerAtomic<MatrixType>::getPadeDegree(\textcolor{keywordtype}{double}\ normIminusT)}
\DoxyCodeLine{00247\ \{}
\DoxyCodeLine{00248\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ maxNormForPade[]\ =\ \{\ 1.884160592658218e-\/2\ \textcolor{comment}{/*\ degree\ =\ 3\ */}\ ,\ 6.038881904059573e-\/2,\ 1.239917516308172e-\/1,}
\DoxyCodeLine{00249\ \ \ \ \ \ \ 1.999045567181744e-\/1,\ 2.789358995219730e-\/1\ \};}
\DoxyCodeLine{00250\ \ \ \textcolor{keywordtype}{int}\ degree\ =\ 3;}
\DoxyCodeLine{00251\ \ \ \textcolor{keywordflow}{for}\ (;\ degree\ <=\ 7;\ ++degree)}
\DoxyCodeLine{00252\ \ \ \ \ \textcolor{keywordflow}{if}\ (normIminusT\ <=\ maxNormForPade[degree\ -\/\ 3])}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00254\ \ \ \textcolor{keywordflow}{return}\ degree;}
\DoxyCodeLine{00255\ \}}
\DoxyCodeLine{00256\ }
\DoxyCodeLine{00257\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00258\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{int}\ MatrixPowerAtomic<MatrixType>::getPadeDegree(\textcolor{keywordtype}{long}\ \textcolor{keywordtype}{double}\ normIminusT)}
\DoxyCodeLine{00259\ \{}
\DoxyCodeLine{00260\ \textcolor{preprocessor}{\#if\ \ \ LDBL\_MANT\_DIG\ ==\ 53}}
\DoxyCodeLine{00261\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ maxPadeDegree\ =\ 7;}
\DoxyCodeLine{00262\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ maxNormForPade[]\ =\ \{\ 1.884160592658218e-\/2L\ \textcolor{comment}{/*\ degree\ =\ 3\ */}\ ,\ 6.038881904059573e-\/2L,\ 1.239917516308172e-\/1L,}
\DoxyCodeLine{00263\ \ \ \ \ \ \ 1.999045567181744e-\/1L,\ 2.789358995219730e-\/1L\ \};}
\DoxyCodeLine{00264\ \textcolor{preprocessor}{\#elif\ LDBL\_MANT\_DIG\ <=\ 64}}
\DoxyCodeLine{00265\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ maxPadeDegree\ =\ 8;}
\DoxyCodeLine{00266\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{double}\ maxNormForPade[]\ =\ \{\ 6.3854693117491799460e-\/3L\ \textcolor{comment}{/*\ degree\ =\ 3\ */}\ ,\ 2.6394893435456973676e-\/2L,}
\DoxyCodeLine{00267\ \ \ \ \ \ \ 6.4216043030404063729e-\/2L,\ 1.1701165502926694307e-\/1L,\ 1.7904284231268670284e-\/1L,\ 2.4471944416607995472e-\/1L\ \};}
\DoxyCodeLine{00268\ \textcolor{preprocessor}{\#elif\ LDBL\_MANT\_DIG\ <=\ 106}}
\DoxyCodeLine{00269\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ maxPadeDegree\ =\ 10;}
\DoxyCodeLine{00270\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ maxNormForPade[]\ =\ \{\ 1.0007161601787493236741409687186e-\/4L\ \textcolor{comment}{/*\ degree\ =\ 3\ */}\ ,}
\DoxyCodeLine{00271\ \ \ \ \ \ \ 1.0007161601787493236741409687186e-\/3L,\ 4.7069769360887572939882574746264e-\/3L,\ 1.3220386624169159689406653101695e-\/2L,}
\DoxyCodeLine{00272\ \ \ \ \ \ \ 2.8063482381631737920612944054906e-\/2L,\ 4.9625993951953473052385361085058e-\/2L,\ 7.7367040706027886224557538328171e-\/2L,}
\DoxyCodeLine{00273\ \ \ \ \ \ \ 1.1016843812851143391275867258512e-\/1L\ \};}
\DoxyCodeLine{00274\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00275\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ maxPadeDegree\ =\ 10;}
\DoxyCodeLine{00276\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ maxNormForPade[]\ =\ \{\ 5.524506147036624377378713555116378e-\/5L\ \textcolor{comment}{/*\ degree\ =\ 3\ */}\ ,}
\DoxyCodeLine{00277\ \ \ \ \ \ \ 6.640600568157479679823602193345995e-\/4L,\ 3.227716520106894279249709728084626e-\/3L,}
\DoxyCodeLine{00278\ \ \ \ \ \ \ 9.619593944683432960546978734646284e-\/3L,\ 2.134595382433742403911124458161147e-\/2L,}
\DoxyCodeLine{00279\ \ \ \ \ \ \ 3.908166513900489428442993794761185e-\/2L,\ 6.266780814639442865832535460550138e-\/2L,}
\DoxyCodeLine{00280\ \ \ \ \ \ \ 9.134603732914548552537150753385375e-\/2L\ \};}
\DoxyCodeLine{00281\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00282\ \ \ \textcolor{keywordtype}{int}\ degree\ =\ 3;}
\DoxyCodeLine{00283\ \ \ \textcolor{keywordflow}{for}\ (;\ degree\ <=\ maxPadeDegree;\ ++degree)}
\DoxyCodeLine{00284\ \ \ \ \ \textcolor{keywordflow}{if}\ (normIminusT\ <=\ maxNormForPade[degree\ -\/\ 3])}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00286\ \ \ \textcolor{keywordflow}{return}\ degree;}
\DoxyCodeLine{00287\ \}}
\DoxyCodeLine{00288\ }
\DoxyCodeLine{00289\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00290\ \textcolor{keyword}{inline}\ \textcolor{keyword}{typename}\ MatrixPowerAtomic<MatrixType>::ComplexScalar}
\DoxyCodeLine{00291\ MatrixPowerAtomic<MatrixType>::computeSuperDiag(\textcolor{keyword}{const}\ ComplexScalar\&\ curr,\ \textcolor{keyword}{const}\ ComplexScalar\&\ prev,\ RealScalar\ p)}
\DoxyCodeLine{00292\ \{}
\DoxyCodeLine{00293\ \ \ \textcolor{keyword}{using\ }std::ceil;}
\DoxyCodeLine{00294\ \ \ \textcolor{keyword}{using\ }std::exp;}
\DoxyCodeLine{00295\ \ \ \textcolor{keyword}{using\ }std::log;}
\DoxyCodeLine{00296\ \ \ \textcolor{keyword}{using\ }std::sinh;}
\DoxyCodeLine{00297\ }
\DoxyCodeLine{00298\ \ \ ComplexScalar\ logCurr\ =\ \mbox{\hyperlink{abseil-cpp_2absl_2synchronization_2mutex_8cc_ae81d3246bfc238875eaecb9aff755a2e}{log}}(curr);}
\DoxyCodeLine{00299\ \ \ ComplexScalar\ logPrev\ =\ \mbox{\hyperlink{abseil-cpp_2absl_2synchronization_2mutex_8cc_ae81d3246bfc238875eaecb9aff755a2e}{log}}(prev);}
\DoxyCodeLine{00300\ \ \ RealScalar\ unwindingNumber\ =\ \mbox{\hyperlink{ArrayCwiseUnaryOps_8h_a63043b6807e8e10fb1adf4667e3664d2}{ceil}}((numext::imag(logCurr\ -\/\ logPrev)\ -\/\ RealScalar(\mbox{\hyperlink{Eigen_2src_2Core_2MathFunctions_8h_aebdd4427aa2148313c07b0eedad449ad}{EIGEN\_PI}}))\ /\ RealScalar(2*\mbox{\hyperlink{Eigen_2src_2Core_2MathFunctions_8h_aebdd4427aa2148313c07b0eedad449ad}{EIGEN\_PI}}));}
\DoxyCodeLine{00301\ \ \ ComplexScalar\ w\ =\ numext::log1p((curr-\/prev)/prev)/RealScalar(2)\ +\ ComplexScalar(0,\ RealScalar(\mbox{\hyperlink{Eigen_2src_2Core_2MathFunctions_8h_aebdd4427aa2148313c07b0eedad449ad}{EIGEN\_PI}})*unwindingNumber);}
\DoxyCodeLine{00302\ \ \ \textcolor{keywordflow}{return}\ RealScalar(2)\ *\ \mbox{\hyperlink{ArrayCwiseUnaryOps_8h_a2500b5d4f377a445cb98d3f1facfa1cf}{exp}}(RealScalar(0.5)\ *\ p\ *\ (logCurr\ +\ logPrev))\ *\ \mbox{\hyperlink{ArrayCwiseUnaryOps_8h_a2a79b4dc952416cf485d5f84af4c798e}{sinh}}(p\ *\ w)\ /\ (curr\ -\/\ prev);}
\DoxyCodeLine{00303\ \}}
\DoxyCodeLine{00304\ }
\DoxyCodeLine{00305\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00306\ \textcolor{keyword}{inline}\ \textcolor{keyword}{typename}\ MatrixPowerAtomic<MatrixType>::RealScalar}
\DoxyCodeLine{00307\ MatrixPowerAtomic<MatrixType>::computeSuperDiag(RealScalar\ curr,\ RealScalar\ prev,\ RealScalar\ p)}
\DoxyCodeLine{00308\ \{}
\DoxyCodeLine{00309\ \ \ \textcolor{keyword}{using\ }std::exp;}
\DoxyCodeLine{00310\ \ \ \textcolor{keyword}{using\ }std::log;}
\DoxyCodeLine{00311\ \ \ \textcolor{keyword}{using\ }std::sinh;}
\DoxyCodeLine{00312\ }
\DoxyCodeLine{00313\ \ \ RealScalar\ w\ =\ numext::log1p((curr-\/prev)/prev)/RealScalar(2);}
\DoxyCodeLine{00314\ \ \ \textcolor{keywordflow}{return}\ 2\ *\ \mbox{\hyperlink{ArrayCwiseUnaryOps_8h_a2500b5d4f377a445cb98d3f1facfa1cf}{exp}}(p\ *\ (\mbox{\hyperlink{abseil-cpp_2absl_2synchronization_2mutex_8cc_ae81d3246bfc238875eaecb9aff755a2e}{log}}(curr)\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2synchronization_2mutex_8cc_ae81d3246bfc238875eaecb9aff755a2e}{log}}(prev))\ /\ 2)\ *\ \mbox{\hyperlink{ArrayCwiseUnaryOps_8h_a2a79b4dc952416cf485d5f84af4c798e}{sinh}}(p\ *\ w)\ /\ (curr\ -\/\ prev);}
\DoxyCodeLine{00315\ \}}
\DoxyCodeLine{00316\ }
\DoxyCodeLine{00336\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00337\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classEigen_1_1MatrixPower}{MatrixPower}}\ :\ \mbox{\hyperlink{classEigen_1_1internal_1_1noncopyable}{internal::noncopyable}}}
\DoxyCodeLine{00338\ \{}
\DoxyCodeLine{00339\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00340\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ MatrixType::Scalar\ Scalar;}
\DoxyCodeLine{00341\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ MatrixType::RealScalar\ RealScalar;}
\DoxyCodeLine{00342\ }
\DoxyCodeLine{00343\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00352\ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{classEigen_1_1MatrixPower_a5eb445525601510413b53cd347c44716}{MatrixPower}}(\textcolor{keyword}{const}\ MatrixType\&\ A)\ :}
\DoxyCodeLine{00353\ \ \ \ \ \ \ m\_A(A),}
\DoxyCodeLine{00354\ \ \ \ \ \ \ m\_conditionNumber(0),}
\DoxyCodeLine{00355\ \ \ \ \ \ \ m\_rank(A.\mbox{\hyperlink{classEigen_1_1MatrixPower_a2e8d572202d337a5d651781fbcd72bbf}{cols}}()),}
\DoxyCodeLine{00356\ \ \ \ \ \ \ m\_nulls(0)}
\DoxyCodeLine{00357\ \ \ \ \ \{\ \mbox{\hyperlink{Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(A.rows()\ ==\ A.cols());\ \}}
\DoxyCodeLine{00358\ }
\DoxyCodeLine{00366\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1MatrixPowerParenthesesReturnValue}{MatrixPowerParenthesesReturnValue<MatrixType>}}\ \mbox{\hyperlink{classEigen_1_1MatrixPower_a97ae57c831001e267e5fdadfe325d641}{operator()}}(RealScalar\ p)}
\DoxyCodeLine{00367\ \ \ \ \ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classEigen_1_1MatrixPowerParenthesesReturnValue}{MatrixPowerParenthesesReturnValue<MatrixType>}}(*\textcolor{keyword}{this},\ p);\ \}}
\DoxyCodeLine{00368\ }
\DoxyCodeLine{00376\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ ResultType>}
\DoxyCodeLine{00377\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEigen_1_1MatrixPower_aa1258393dc13acd6e401e000f99b915f}{compute}}(ResultType\&\ res,\ RealScalar\ p);}
\DoxyCodeLine{00378\ \ \ \ \ }
\DoxyCodeLine{00379\ \ \ \ \ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ \mbox{\hyperlink{classEigen_1_1MatrixPower_ade4446998c2e4d83278c426944b7b72b}{rows}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ m\_A.rows();\ \}}
\DoxyCodeLine{00380\ \ \ \ \ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ \mbox{\hyperlink{classEigen_1_1MatrixPower_a2e8d572202d337a5d651781fbcd72bbf}{cols}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ m\_A.cols();\ \}}
\DoxyCodeLine{00381\ }
\DoxyCodeLine{00382\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00383\ \ \ \ \ \textcolor{keyword}{typedef}\ std::complex<RealScalar>\ ComplexScalar;}
\DoxyCodeLine{00384\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{classEigen_1_1Matrix}{Matrix}}<ComplexScalar,\ \mbox{\hyperlink{namespaceEigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic}},\ \mbox{\hyperlink{namespaceEigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic}},\ 0,}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ MatrixType::RowsAtCompileTime,\ MatrixType::ColsAtCompileTime>\ ComplexMatrix;}
\DoxyCodeLine{00386\ }
\DoxyCodeLine{00388\ \ \ \ \ \textcolor{keyword}{typename}\ MatrixType::Nested\ m\_A;}
\DoxyCodeLine{00389\ }
\DoxyCodeLine{00391\ \ \ \ \ MatrixType\ m\_tmp;}
\DoxyCodeLine{00392\ }
\DoxyCodeLine{00394\ \ \ \ \ ComplexMatrix\ m\_T,\ m\_U;}
\DoxyCodeLine{00395\ \ \ \ \ }
\DoxyCodeLine{00397\ \ \ \ \ ComplexMatrix\ m\_fT;}
\DoxyCodeLine{00398\ }
\DoxyCodeLine{00405\ \ \ \ \ RealScalar\ m\_conditionNumber;}
\DoxyCodeLine{00406\ }
\DoxyCodeLine{00408\ \ \ \ \ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ m\_rank;}
\DoxyCodeLine{00409\ \ \ \ \ }
\DoxyCodeLine{00411\ \ \ \ \ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ m\_nulls;}
\DoxyCodeLine{00412\ }
\DoxyCodeLine{00422\ \ \ \ \ \textcolor{keywordtype}{void}\ split(RealScalar\&\ p,\ RealScalar\&\ intpart);}
\DoxyCodeLine{00423\ }
\DoxyCodeLine{00425\ \ \ \ \ \textcolor{keywordtype}{void}\ initialize();}
\DoxyCodeLine{00426\ }
\DoxyCodeLine{00427\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ ResultType>}
\DoxyCodeLine{00428\ \ \ \ \ \textcolor{keywordtype}{void}\ computeIntPower(ResultType\&\ res,\ RealScalar\ p);}
\DoxyCodeLine{00429\ }
\DoxyCodeLine{00430\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ ResultType>}
\DoxyCodeLine{00431\ \ \ \ \ \textcolor{keywordtype}{void}\ computeFracPower(ResultType\&\ res,\ RealScalar\ p);}
\DoxyCodeLine{00432\ }
\DoxyCodeLine{00433\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keywordtype}{int}\ Rows,\ \textcolor{keywordtype}{int}\ Cols,\ \textcolor{keywordtype}{int}\ Options,\ \textcolor{keywordtype}{int}\ MaxRows,\ \textcolor{keywordtype}{int}\ MaxCols>}
\DoxyCodeLine{00434\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ revertSchur(}
\DoxyCodeLine{00435\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classEigen_1_1Matrix}{Matrix<ComplexScalar,\ Rows,\ Cols,\ Options,\ MaxRows,\ MaxCols>}}\&\ res,}
\DoxyCodeLine{00436\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ ComplexMatrix\&\ T,}
\DoxyCodeLine{00437\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ ComplexMatrix\&\ U);}
\DoxyCodeLine{00438\ }
\DoxyCodeLine{00439\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keywordtype}{int}\ Rows,\ \textcolor{keywordtype}{int}\ Cols,\ \textcolor{keywordtype}{int}\ Options,\ \textcolor{keywordtype}{int}\ MaxRows,\ \textcolor{keywordtype}{int}\ MaxCols>}
\DoxyCodeLine{00440\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ revertSchur(}
\DoxyCodeLine{00441\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classEigen_1_1Matrix}{Matrix<RealScalar,\ Rows,\ Cols,\ Options,\ MaxRows,\ MaxCols>}}\&\ res,}
\DoxyCodeLine{00442\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ ComplexMatrix\&\ T,}
\DoxyCodeLine{00443\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ ComplexMatrix\&\ U);}
\DoxyCodeLine{00444\ \};}
\DoxyCodeLine{00445\ }
\DoxyCodeLine{00446\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00447\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ ResultType>}
\DoxyCodeLine{00448\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEigen_1_1MatrixPower_aa1258393dc13acd6e401e000f99b915f}{MatrixPower<MatrixType>::compute}}(ResultType\&\ res,\ RealScalar\ p)}
\DoxyCodeLine{00449\ \{}
\DoxyCodeLine{00450\ \ \ \textcolor{keyword}{using\ }std::pow;}
\DoxyCodeLine{00451\ \ \ \textcolor{keywordflow}{switch}\ (cols())\ \{}
\DoxyCodeLine{00452\ \ \ \ \ \textcolor{keywordflow}{case}\ 0:}
\DoxyCodeLine{00453\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00454\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{00455\ \ \ \ \ \ \ res(0,0)\ =\ \mbox{\hyperlink{classEigen_1_1ArrayBase_acb769e1ab1d809abb77c7ab98021ad81}{pow}}(m\_A.coeff(0,0),\ p);}
\DoxyCodeLine{00456\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00457\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00458\ \ \ \ \ \ \ RealScalar\ intpart;}
\DoxyCodeLine{00459\ \ \ \ \ \ \ split(p,\ intpart);}
\DoxyCodeLine{00460\ }
\DoxyCodeLine{00461\ \ \ \ \ \ \ res\ =\ MatrixType::Identity(rows(),\ cols());}
\DoxyCodeLine{00462\ \ \ \ \ \ \ computeIntPower(res,\ intpart);}
\DoxyCodeLine{00463\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (p)\ computeFracPower(res,\ p);}
\DoxyCodeLine{00464\ \ \ \}}
\DoxyCodeLine{00465\ \}}
\DoxyCodeLine{00466\ }
\DoxyCodeLine{00467\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00468\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEigen_1_1MatrixPower}{MatrixPower<MatrixType>::split}}(RealScalar\&\ p,\ RealScalar\&\ intpart)}
\DoxyCodeLine{00469\ \{}
\DoxyCodeLine{00470\ \ \ \textcolor{keyword}{using\ }std::floor;}
\DoxyCodeLine{00471\ \ \ \textcolor{keyword}{using\ }std::pow;}
\DoxyCodeLine{00472\ }
\DoxyCodeLine{00473\ \ \ intpart\ =\ \mbox{\hyperlink{ArrayCwiseUnaryOps_8h_a3230e10964844c34fb73eaccc84dc8a7}{floor}}(p);}
\DoxyCodeLine{00474\ \ \ p\ -\/=\ intpart;}
\DoxyCodeLine{00475\ }
\DoxyCodeLine{00476\ \ \ \textcolor{comment}{//\ Perform\ Schur\ decomposition\ if\ it\ is\ not\ yet\ performed\ and\ the\ power\ is}}
\DoxyCodeLine{00477\ \ \ \textcolor{comment}{//\ not\ an\ integer.}}
\DoxyCodeLine{00478\ \ \ \textcolor{keywordflow}{if}\ (!m\_conditionNumber\ \&\&\ p)}
\DoxyCodeLine{00479\ \ \ \ \ initialize();}
\DoxyCodeLine{00480\ }
\DoxyCodeLine{00481\ \ \ \textcolor{comment}{//\ Choose\ the\ more\ stable\ of\ intpart\ =\ floor(p)\ and\ intpart\ =\ ceil(p).}}
\DoxyCodeLine{00482\ \ \ \textcolor{keywordflow}{if}\ (p\ >\ RealScalar(0.5)\ \&\&\ p\ >\ (1-\/p)\ *\ \mbox{\hyperlink{classEigen_1_1ArrayBase_acb769e1ab1d809abb77c7ab98021ad81}{pow}}(m\_conditionNumber,\ p))\ \{}
\DoxyCodeLine{00483\ \ \ \ \ -\/-\/p;}
\DoxyCodeLine{00484\ \ \ \ \ ++intpart;}
\DoxyCodeLine{00485\ \ \ \}}
\DoxyCodeLine{00486\ \}}
\DoxyCodeLine{00487\ }
\DoxyCodeLine{00488\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00489\ \textcolor{keywordtype}{void}\ MatrixPower<MatrixType>::initialize()}
\DoxyCodeLine{00490\ \{}
\DoxyCodeLine{00491\ \ \ \textcolor{keyword}{const}\ ComplexSchur<MatrixType>\ schurOfA(m\_A);}
\DoxyCodeLine{00492\ \ \ JacobiRotation<ComplexScalar>\ rot;}
\DoxyCodeLine{00493\ \ \ ComplexScalar\ eigenvalue;}
\DoxyCodeLine{00494\ }
\DoxyCodeLine{00495\ \ \ m\_fT.resizeLike(m\_A);}
\DoxyCodeLine{00496\ \ \ m\_T\ =\ schurOfA.matrixT();}
\DoxyCodeLine{00497\ \ \ m\_U\ =\ schurOfA.matrixU();}
\DoxyCodeLine{00498\ \ \ m\_conditionNumber\ =\ m\_T.diagonal().array().abs().maxCoeff()\ /\ m\_T.diagonal().array().abs().minCoeff();}
\DoxyCodeLine{00499\ }
\DoxyCodeLine{00500\ \ \ \textcolor{comment}{//\ Move\ zero\ eigenvalues\ to\ the\ bottom\ right\ corner.}}
\DoxyCodeLine{00501\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ cols()-\/1;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}>=0;\ -\/-\/\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ \{}
\DoxyCodeLine{00502\ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_rank\ <=\ 2)}
\DoxyCodeLine{00503\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00504\ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_T.coeff(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}},\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ ==\ RealScalar(0))\ \{}
\DoxyCodeLine{00505\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ j=\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}+1;\ \mbox{\hyperlink{namespaceabsl_adb6bd4a9012b471ac01613aff8d4d81ba363b122c528f54df4a0446b6bab05515}{j}}\ <\ m\_rank;\ ++\mbox{\hyperlink{namespaceabsl_adb6bd4a9012b471ac01613aff8d4d81ba363b122c528f54df4a0446b6bab05515}{j}})\ \{}
\DoxyCodeLine{00506\ \ \ \ \ \ \ \ \ eigenvalue\ =\ m\_T.coeff(j,j);}
\DoxyCodeLine{00507\ \ \ \ \ \ \ \ \ rot.makeGivens(m\_T.coeff(j-\/1,j),\ eigenvalue);}
\DoxyCodeLine{00508\ \ \ \ \ \ \ \ \ m\_T.applyOnTheRight(j-\/1,\ j,\ rot);}
\DoxyCodeLine{00509\ \ \ \ \ \ \ \ \ m\_T.applyOnTheLeft(j-\/1,\ j,\ rot.adjoint());}
\DoxyCodeLine{00510\ \ \ \ \ \ \ \ \ m\_T.coeffRef(j-\/1,j-\/1)\ =\ eigenvalue;}
\DoxyCodeLine{00511\ \ \ \ \ \ \ \ \ m\_T.coeffRef(j,j)\ =\ RealScalar(0);}
\DoxyCodeLine{00512\ \ \ \ \ \ \ \ \ m\_U.applyOnTheRight(j-\/1,\ j,\ rot);}
\DoxyCodeLine{00513\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00514\ \ \ \ \ \ \ -\/-\/m\_rank;}
\DoxyCodeLine{00515\ \ \ \ \ \}}
\DoxyCodeLine{00516\ \ \ \}}
\DoxyCodeLine{00517\ }
\DoxyCodeLine{00518\ \ \ m\_nulls\ =\ rows()\ -\/\ m\_rank;}
\DoxyCodeLine{00519\ \ \ \textcolor{keywordflow}{if}\ (m\_nulls)\ \{}
\DoxyCodeLine{00520\ \ \ \ \ \mbox{\hyperlink{Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(m\_T.bottomRightCorner(m\_nulls,\ m\_nulls).isZero()}
\DoxyCodeLine{00521\ \ \ \ \ \ \ \ \ \&\&\ \textcolor{stringliteral}{"{}Base\ of\ matrix\ power\ should\ be\ invertible\ or\ with\ a\ semisimple\ zero\ eigenvalue."{}});}
\DoxyCodeLine{00522\ \ \ \ \ m\_fT.bottomRows(m\_nulls).fill(RealScalar(0));}
\DoxyCodeLine{00523\ \ \ \}}
\DoxyCodeLine{00524\ \}}
\DoxyCodeLine{00525\ }
\DoxyCodeLine{00526\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00527\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ ResultType>}
\DoxyCodeLine{00528\ \textcolor{keywordtype}{void}\ MatrixPower<MatrixType>::computeIntPower(ResultType\&\ res,\ RealScalar\ p)}
\DoxyCodeLine{00529\ \{}
\DoxyCodeLine{00530\ \ \ \textcolor{keyword}{using\ }std::abs;}
\DoxyCodeLine{00531\ \ \ \textcolor{keyword}{using\ }std::fmod;}
\DoxyCodeLine{00532\ \ \ RealScalar\ pp\ =\ \mbox{\hyperlink{ArrayCwiseUnaryOps_8h_a35560f7dbf19244fda7e463d14157c43}{abs}}(p);}
\DoxyCodeLine{00533\ }
\DoxyCodeLine{00534\ \ \ \textcolor{keywordflow}{if}\ (p<0)\ }
\DoxyCodeLine{00535\ \ \ \ \ m\_tmp\ =\ m\_A.inverse();}
\DoxyCodeLine{00536\ \ \ \textcolor{keywordflow}{else}\ \ \ \ \ }
\DoxyCodeLine{00537\ \ \ \ \ m\_tmp\ =\ m\_A;}
\DoxyCodeLine{00538\ }
\DoxyCodeLine{00539\ \ \ \textcolor{keywordflow}{while}\ (\textcolor{keyword}{true})\ \{}
\DoxyCodeLine{00540\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespaceEigen_1_1bfloat16__impl_a89726c0bfa3ecbf0e150fb2cdf869340}{fmod}}(pp,\ 2)\ >=\ 1)}
\DoxyCodeLine{00541\ \ \ \ \ \ \ res\ =\ m\_tmp\ *\ res;}
\DoxyCodeLine{00542\ \ \ \ \ pp\ /=\ 2;}
\DoxyCodeLine{00543\ \ \ \ \ \textcolor{keywordflow}{if}\ (pp\ <\ 1)}
\DoxyCodeLine{00544\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00545\ \ \ \ \ m\_tmp\ *=\ m\_tmp;}
\DoxyCodeLine{00546\ \ \ \}}
\DoxyCodeLine{00547\ \}}
\DoxyCodeLine{00548\ }
\DoxyCodeLine{00549\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00550\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ ResultType>}
\DoxyCodeLine{00551\ \textcolor{keywordtype}{void}\ MatrixPower<MatrixType>::computeFracPower(ResultType\&\ res,\ RealScalar\ p)}
\DoxyCodeLine{00552\ \{}
\DoxyCodeLine{00553\ \ \ Block<ComplexMatrix,Dynamic,Dynamic>\ blockTp(m\_fT,\ 0,\ 0,\ m\_rank,\ m\_rank);}
\DoxyCodeLine{00554\ \ \ \mbox{\hyperlink{Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(m\_conditionNumber);}
\DoxyCodeLine{00555\ \ \ \mbox{\hyperlink{Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(m\_rank\ +\ m\_nulls\ ==\ rows());}
\DoxyCodeLine{00556\ }
\DoxyCodeLine{00557\ \ \ MatrixPowerAtomic<ComplexMatrix>(m\_T.topLeftCorner(m\_rank,\ m\_rank),\ p).compute(blockTp);}
\DoxyCodeLine{00558\ \ \ \textcolor{keywordflow}{if}\ (m\_nulls)\ \{}
\DoxyCodeLine{00559\ \ \ \ \ m\_fT.topRightCorner(m\_rank,\ m\_nulls)\ =\ m\_T.topLeftCorner(m\_rank,\ m\_rank).template\ triangularView<Upper>()}
\DoxyCodeLine{00560\ \ \ \ \ \ \ \ \ .solve(blockTp\ *\ m\_T.topRightCorner(m\_rank,\ m\_nulls));}
\DoxyCodeLine{00561\ \ \ \}}
\DoxyCodeLine{00562\ \ \ revertSchur(m\_tmp,\ m\_fT,\ m\_U);}
\DoxyCodeLine{00563\ \ \ res\ =\ m\_tmp\ *\ res;}
\DoxyCodeLine{00564\ \}}
\DoxyCodeLine{00565\ }
\DoxyCodeLine{00566\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00567\ \textcolor{keyword}{template}<\textcolor{keywordtype}{int}\ Rows,\ \textcolor{keywordtype}{int}\ Cols,\ \textcolor{keywordtype}{int}\ Options,\ \textcolor{keywordtype}{int}\ MaxRows,\ \textcolor{keywordtype}{int}\ MaxCols>}
\DoxyCodeLine{00568\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ MatrixPower<MatrixType>::revertSchur(}
\DoxyCodeLine{00569\ \ \ \ \ Matrix<ComplexScalar,\ Rows,\ Cols,\ Options,\ MaxRows,\ MaxCols>\&\ res,}
\DoxyCodeLine{00570\ \ \ \ \ \textcolor{keyword}{const}\ ComplexMatrix\&\ T,}
\DoxyCodeLine{00571\ \ \ \ \ \textcolor{keyword}{const}\ ComplexMatrix\&\ U)}
\DoxyCodeLine{00572\ \{\ res.noalias()\ =\ U\ *\ (T.template\ triangularView<Upper>()\ *\ U.adjoint());\ \}}
\DoxyCodeLine{00573\ }
\DoxyCodeLine{00574\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00575\ \textcolor{keyword}{template}<\textcolor{keywordtype}{int}\ Rows,\ \textcolor{keywordtype}{int}\ Cols,\ \textcolor{keywordtype}{int}\ Options,\ \textcolor{keywordtype}{int}\ MaxRows,\ \textcolor{keywordtype}{int}\ MaxCols>}
\DoxyCodeLine{00576\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ MatrixPower<MatrixType>::revertSchur(}
\DoxyCodeLine{00577\ \ \ \ \ Matrix<RealScalar,\ Rows,\ Cols,\ Options,\ MaxRows,\ MaxCols>\&\ res,}
\DoxyCodeLine{00578\ \ \ \ \ \textcolor{keyword}{const}\ ComplexMatrix\&\ T,}
\DoxyCodeLine{00579\ \ \ \ \ \textcolor{keyword}{const}\ ComplexMatrix\&\ U)}
\DoxyCodeLine{00580\ \{\ res.noalias()\ =\ (U\ *\ (T.template\ triangularView<Upper>()\ *\ U.adjoint())).\mbox{\hyperlink{CommonCwiseUnaryOps_8h_a560b678a662ccfce4da582595899a0b7}{real}}();\ \}}
\DoxyCodeLine{00581\ }
\DoxyCodeLine{00595\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Derived>}
\DoxyCodeLine{00596\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classEigen_1_1MatrixPowerReturnValue}{MatrixPowerReturnValue}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classEigen_1_1ReturnByValue}{ReturnByValue}}<\ MatrixPowerReturnValue<Derived>\ >}
\DoxyCodeLine{00597\ \{}
\DoxyCodeLine{00598\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00599\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ Derived::PlainObject\ \mbox{\hyperlink{classEigen_1_1MatrixPowerReturnValue_a417659116cd839311dbcbdb4a42d7ea1}{PlainObject}};}
\DoxyCodeLine{00600\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ Derived::RealScalar\ \mbox{\hyperlink{classEigen_1_1MatrixPowerReturnValue_a17f9f3029761d9d2a8b01dbb39186f74}{RealScalar}};}
\DoxyCodeLine{00601\ }
\DoxyCodeLine{00608\ \ \ \ \ \mbox{\hyperlink{classEigen_1_1MatrixPowerReturnValue_a3067e09b352f967a23bb2a9c50afee88}{MatrixPowerReturnValue}}(\textcolor{keyword}{const}\ Derived\&\ A,\ \mbox{\hyperlink{classEigen_1_1MatrixPowerReturnValue_a17f9f3029761d9d2a8b01dbb39186f74}{RealScalar}}\ p)\ :\ m\_A(A),\ m\_p(p)}
\DoxyCodeLine{00609\ \ \ \ \ \{\ \}}
\DoxyCodeLine{00610\ }
\DoxyCodeLine{00617\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ ResultType>}
\DoxyCodeLine{00618\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEigen_1_1MatrixPowerReturnValue_a5f15ad16576debad4d4cc0798ff63172}{evalTo}}(ResultType\&\ result)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00619\ \textcolor{keyword}{\ \ \ \ }\{\ \mbox{\hyperlink{classEigen_1_1MatrixPower}{MatrixPower<PlainObject>}}(m\_A.eval()).\mbox{\hyperlink{classEigen_1_1MatrixPower_aa1258393dc13acd6e401e000f99b915f}{compute}}(result,\ m\_p);\ \}}
\DoxyCodeLine{00620\ }
\DoxyCodeLine{00621\ \ \ \ \ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ \mbox{\hyperlink{classEigen_1_1MatrixPowerReturnValue_a91d8d3744aa95cdce4830c6baa1ccf06}{rows}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ m\_A.rows();\ \}}
\DoxyCodeLine{00622\ \ \ \ \ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ \mbox{\hyperlink{classEigen_1_1MatrixPowerReturnValue_a1feb1c3c50dc939a3e720824b4501abc}{cols}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ m\_A.cols();\ \}}
\DoxyCodeLine{00623\ }
\DoxyCodeLine{00624\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00625\ \ \ \ \ \textcolor{keyword}{const}\ Derived\&\ m\_A;}
\DoxyCodeLine{00626\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1MatrixPowerReturnValue_a17f9f3029761d9d2a8b01dbb39186f74}{RealScalar}}\ m\_p;}
\DoxyCodeLine{00627\ \};}
\DoxyCodeLine{00628\ }
\DoxyCodeLine{00642\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Derived>}
\DoxyCodeLine{00643\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classEigen_1_1MatrixComplexPowerReturnValue}{MatrixComplexPowerReturnValue}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classEigen_1_1ReturnByValue}{ReturnByValue}}<\ MatrixComplexPowerReturnValue<Derived>\ >}
\DoxyCodeLine{00644\ \{}
\DoxyCodeLine{00645\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00646\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ Derived::PlainObject\ \mbox{\hyperlink{classEigen_1_1MatrixComplexPowerReturnValue_a97bfb17352b9c41921ab0262fa5e302e}{PlainObject}};}
\DoxyCodeLine{00647\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ std::complex<typename\ Derived::RealScalar>\ \mbox{\hyperlink{classEigen_1_1MatrixComplexPowerReturnValue_a7f8f72b108a26bee8a04003f212e28e7}{ComplexScalar}};}
\DoxyCodeLine{00648\ }
\DoxyCodeLine{00655\ \ \ \ \ \mbox{\hyperlink{classEigen_1_1MatrixComplexPowerReturnValue_a3e5903e22f70e9deb07c3967ae52fd54}{MatrixComplexPowerReturnValue}}(\textcolor{keyword}{const}\ Derived\&\ A,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1MatrixComplexPowerReturnValue_a7f8f72b108a26bee8a04003f212e28e7}{ComplexScalar}}\&\ p)\ :\ m\_A(A),\ m\_p(p)}
\DoxyCodeLine{00656\ \ \ \ \ \{\ \}}
\DoxyCodeLine{00657\ }
\DoxyCodeLine{00667\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ ResultType>}
\DoxyCodeLine{00668\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEigen_1_1MatrixComplexPowerReturnValue_ac7a7947bc6cad6554d31b08b847bc6dd}{evalTo}}(ResultType\&\ result)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00669\ \textcolor{keyword}{\ \ \ \ }\{\ result\ =\ (m\_p\ *\ m\_A.log()).exp();\ \}}
\DoxyCodeLine{00670\ }
\DoxyCodeLine{00671\ \ \ \ \ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ \mbox{\hyperlink{classEigen_1_1MatrixComplexPowerReturnValue_ad64216fcb7130adeccb5301054c0b8fc}{rows}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ m\_A.rows();\ \}}
\DoxyCodeLine{00672\ \ \ \ \ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ \mbox{\hyperlink{classEigen_1_1MatrixComplexPowerReturnValue_a41bccc801f588f3312b002ee4b03833e}{cols}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ m\_A.cols();\ \}}
\DoxyCodeLine{00673\ }
\DoxyCodeLine{00674\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00675\ \ \ \ \ \textcolor{keyword}{const}\ Derived\&\ m\_A;}
\DoxyCodeLine{00676\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1MatrixComplexPowerReturnValue_a7f8f72b108a26bee8a04003f212e28e7}{ComplexScalar}}\ m\_p;}
\DoxyCodeLine{00677\ \};}
\DoxyCodeLine{00678\ }
\DoxyCodeLine{00679\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceinternal}{internal}}\ \{}
\DoxyCodeLine{00680\ }
\DoxyCodeLine{00681\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixPowerType>}
\DoxyCodeLine{00682\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}<\ \mbox{\hyperlink{classEigen_1_1MatrixPowerParenthesesReturnValue}{MatrixPowerParenthesesReturnValue}}<MatrixPowerType>\ >}
\DoxyCodeLine{00683\ \{\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ MatrixPowerType::PlainObject\ \mbox{\hyperlink{structEigen_1_1internal_1_1traits_3_01MatrixPowerParenthesesReturnValue_3_01MatrixPowerType_01_4_01_4_a0edd2175f1eda1837464abc66b2a1ccb}{ReturnType}};\ \};}
\DoxyCodeLine{00684\ }
\DoxyCodeLine{00685\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Derived>}
\DoxyCodeLine{00686\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}<\ \mbox{\hyperlink{classEigen_1_1MatrixPowerReturnValue}{MatrixPowerReturnValue}}<Derived>\ >}
\DoxyCodeLine{00687\ \{\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ Derived::PlainObject\ \mbox{\hyperlink{structEigen_1_1internal_1_1traits_3_01MatrixPowerReturnValue_3_01Derived_01_4_01_4_aab565006e03aecfdb7d88bbb0570e0bc}{ReturnType}};\ \};}
\DoxyCodeLine{00688\ }
\DoxyCodeLine{00689\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Derived>}
\DoxyCodeLine{00690\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structEigen_1_1internal_1_1traits}{traits}}<\ \mbox{\hyperlink{classEigen_1_1MatrixComplexPowerReturnValue}{MatrixComplexPowerReturnValue}}<Derived>\ >}
\DoxyCodeLine{00691\ \{\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ Derived::PlainObject\ \mbox{\hyperlink{structEigen_1_1internal_1_1traits_3_01MatrixComplexPowerReturnValue_3_01Derived_01_4_01_4_a2390b025a5d97a60440cd2d975e5d6ea}{ReturnType}};\ \};}
\DoxyCodeLine{00692\ }
\DoxyCodeLine{00693\ \}}
\DoxyCodeLine{00694\ }
\DoxyCodeLine{00695\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Derived>}
\DoxyCodeLine{00696\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1MatrixPowerReturnValue}{MatrixPowerReturnValue<Derived>}}\ \mbox{\hyperlink{classEigen_1_1MatrixBase}{MatrixBase<Derived>::pow}}(\textcolor{keyword}{const}\ RealScalar\&\ p)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00697\ \textcolor{keyword}{}\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classEigen_1_1MatrixPowerReturnValue}{MatrixPowerReturnValue<Derived>}}(derived(),\ p);\ \}}
\DoxyCodeLine{00698\ }
\DoxyCodeLine{00699\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Derived>}
\DoxyCodeLine{00700\ \textcolor{keyword}{const}\ MatrixComplexPowerReturnValue<Derived>\ MatrixBase<Derived>::pow(\textcolor{keyword}{const}\ std::complex<RealScalar>\&\ p)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00701\ \textcolor{keyword}{}\{\ \textcolor{keywordflow}{return}\ MatrixComplexPowerReturnValue<Derived>(derived(),\ p);\ \}}
\DoxyCodeLine{00702\ }
\DoxyCodeLine{00703\ \}\ \textcolor{comment}{//\ namespace\ Eigen}}
\DoxyCodeLine{00704\ }
\DoxyCodeLine{00705\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ EIGEN\_MATRIX\_POWER}}

\end{DoxyCode}
