\doxysection{tensor\+\_\+util.\+hpp}
\hypertarget{tensor_2tensor__util_8hpp_source}{}\label{tensor_2tensor__util_8hpp_source}\index{tensor/tensor\_util.hpp@{tensor/tensor\_util.hpp}}
\mbox{\hyperlink{tensor_2tensor__util_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#ifndef\ LLM\_CPP\_LLMCPP\_TENSOR\_UTIL\_HPP\_}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#define\ LLM\_CPP\_LLMCPP\_TENSOR\_UTIL\_HPP\_}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ "{}absl/container/inlined\_vector.h"{}}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{tensor_2tensor__types_8hpp}{tensor\_types.hpp}}"{}}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ "{}eigen/Eigen/Core"{}}}
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00008\ \textcolor{keyword}{using\ }\mbox{\hyperlink{dev_2cuda_2common_8h_a73bc90d2e378d172e206b528b3756c5a}{floatX}}\ =\ float;}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{comment}{//\ Raw\ pointer\ -\/>\ Flat}}
\DoxyCodeLine{00011\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00012\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{classEigen_1_1TensorMap}{TTypes<T>::Flat}}\ \mbox{\hyperlink{OriginalStuff_2tensor__util_8hpp_a9a087a9b5b6b2f4a06af705501667b9b}{MakeFlat}}(T*\ t,\ \textcolor{keywordtype}{int}\ length)\ \{}
\DoxyCodeLine{00013\ \ \ \textcolor{keywordflow}{return}\ \{t,\ length\};}
\DoxyCodeLine{00014\ \}}
\DoxyCodeLine{00015\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00016\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{classEigen_1_1TensorMap}{TTypes<T>::ConstFlat}}\ \mbox{\hyperlink{OriginalStuff_2tensor__util_8hpp_a21ac3a103525fe44360b799a17466f7c}{MakeConstFlat}}(T*\ t,\ \textcolor{keywordtype}{int}\ length)\ \{}
\DoxyCodeLine{00017\ \ \ \textcolor{keywordflow}{return}\ \{t,\ length\};}
\DoxyCodeLine{00018\ \}}
\DoxyCodeLine{00019\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00020\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{classEigen_1_1TensorMap}{TTypes<T>::ConstFlat}}\ \mbox{\hyperlink{OriginalStuff_2tensor__util_8hpp_a21ac3a103525fe44360b799a17466f7c}{MakeConstFlat}}(\textcolor{keyword}{const}\ T*\ t,\ \textcolor{keywordtype}{int}\ length)\ \{}
\DoxyCodeLine{00021\ \ \ \textcolor{keywordflow}{return}\ \{t,\ length\};}
\DoxyCodeLine{00022\ \}}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ \textcolor{comment}{//\ Raw\ pointer\ -\/>\ Matrix}}
\DoxyCodeLine{00025\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00026\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{classEigen_1_1TensorMap}{TTypes<T>::Matrix}}\ \mbox{\hyperlink{OriginalStuff_2tensor__util_8hpp_a30c79fba785f603a86fa02252305fbed}{MakeMatrix}}(T*\ t,\ \textcolor{keywordtype}{int}\ rows,\ \textcolor{keywordtype}{int}\ cols)\ \{}
\DoxyCodeLine{00027\ \ \ \textcolor{keywordflow}{return}\ \{t,\ rows,\ cols\};}
\DoxyCodeLine{00028\ \}}
\DoxyCodeLine{00029\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00030\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{classEigen_1_1TensorMap}{TTypes<T>::ConstMatrix}}\ \mbox{\hyperlink{OriginalStuff_2tensor__util_8hpp_ae8e963613cb1e2fe5d606c04433078fe}{MakeConstMatrix}}(T*\ t,\ \textcolor{keywordtype}{int}\ rows,\ \textcolor{keywordtype}{int}\ cols)\ \{}
\DoxyCodeLine{00031\ \ \ \textcolor{keywordflow}{return}\ \{t,\ rows,\ cols\};}
\DoxyCodeLine{00032\ \}}
\DoxyCodeLine{00033\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00034\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{classEigen_1_1TensorMap}{TTypes<T>::ConstMatrix}}\ \mbox{\hyperlink{OriginalStuff_2tensor__util_8hpp_ae8e963613cb1e2fe5d606c04433078fe}{MakeConstMatrix}}(\textcolor{keyword}{const}\ T*\ t,\ \textcolor{keywordtype}{int}\ rows,}
\DoxyCodeLine{00035\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ cols)\ \{}
\DoxyCodeLine{00036\ \ \ \textcolor{keywordflow}{return}\ \{t,\ rows,\ cols\};}
\DoxyCodeLine{00037\ \}}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ \textcolor{comment}{//\ Raw\ pointer\ -\/>\ 3D\ Tensor}}
\DoxyCodeLine{00040\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00041\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{classEigen_1_1TensorMap}{TTypes<T,\ 3>::Tensor}}\ \mbox{\hyperlink{OriginalStuff_2tensor__util_8hpp_a3bde9957ede93fa72beb44296e6ce586}{Make3DTensor}}(T*\ t,\ \textcolor{keywordtype}{int}\ dim0,\ \textcolor{keywordtype}{int}\ dim1,\ \textcolor{keywordtype}{int}\ dim2)\ \{}
\DoxyCodeLine{00042\ \ \ \textcolor{keywordflow}{return}\ \{t,\ dim0,\ dim1,\ dim2\};}
\DoxyCodeLine{00043\ \}}
\DoxyCodeLine{00044\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00045\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{classEigen_1_1TensorMap}{TTypes<T,\ 3>::ConstTensor}}\ \mbox{\hyperlink{OriginalStuff_2tensor__util_8hpp_a83376511964dada7d9134ac8a54a4c99}{MakeConst3DTensor}}(T*\ t,\ \textcolor{keywordtype}{int}\ dim0,\ \textcolor{keywordtype}{int}\ dim1,}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ dim2)\ \{}
\DoxyCodeLine{00047\ \ \ \textcolor{keywordflow}{return}\ \{t,\ dim0,\ dim1,\ dim2\};}
\DoxyCodeLine{00048\ \}}
\DoxyCodeLine{00049\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00050\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{classEigen_1_1TensorMap}{TTypes<T,\ 3>::ConstTensor}}\ \mbox{\hyperlink{OriginalStuff_2tensor__util_8hpp_a83376511964dada7d9134ac8a54a4c99}{MakeConst3DTensor}}(\textcolor{keyword}{const}\ T*\ t,\ \textcolor{keywordtype}{int}\ dim0,}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ dim1,\ \textcolor{keywordtype}{int}\ dim2)\ \{}
\DoxyCodeLine{00052\ \ \ \textcolor{keywordflow}{return}\ \{t,\ dim0,\ dim1,\ dim2\};}
\DoxyCodeLine{00053\ \}}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00055\ \textcolor{comment}{//\ Raw\ pointer\ -\/>\ 4D\ Tensor}}
\DoxyCodeLine{00056\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00057\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{classEigen_1_1TensorMap}{TTypes<T,\ 4>::Tensor}}\ \mbox{\hyperlink{OriginalStuff_2tensor__util_8hpp_ab98dd5748c5e28b574284e30efd8c2f2}{Make4DTensor}}(T*\ t,\ \textcolor{keywordtype}{int}\ dim0,\ \textcolor{keywordtype}{int}\ dim1,\ \textcolor{keywordtype}{int}\ dim2,}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ dim3)\ \{}
\DoxyCodeLine{00059\ \ \ \textcolor{keywordflow}{return}\ \{t,\ dim0,\ dim1,\ dim2,\ dim3\};}
\DoxyCodeLine{00060\ \}}
\DoxyCodeLine{00061\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00062\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{classEigen_1_1TensorMap}{TTypes<T,\ 4>::ConstTensor}}\ \mbox{\hyperlink{OriginalStuff_2tensor__util_8hpp_acb31798cfceea0b468d3c942367c6ccb}{MakeConst4DTensor}}(T*\ t,\ \textcolor{keywordtype}{int}\ dim0,\ \textcolor{keywordtype}{int}\ dim1,}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ dim2,\ \textcolor{keywordtype}{int}\ dim3)\ \{}
\DoxyCodeLine{00064\ \ \ \textcolor{keywordflow}{return}\ \{t,\ dim0,\ dim1,\ dim2,\ dim3\};}
\DoxyCodeLine{00065\ \}}
\DoxyCodeLine{00066\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00067\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{classEigen_1_1TensorMap}{TTypes<T,\ 4>::ConstTensor}}\ \mbox{\hyperlink{OriginalStuff_2tensor__util_8hpp_acb31798cfceea0b468d3c942367c6ccb}{MakeConst4DTensor}}(\textcolor{keyword}{const}\ T*\ t,\ \textcolor{keywordtype}{int}\ dim0,}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ dim1,\ \textcolor{keywordtype}{int}\ dim2,}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ dim3)\ \{}
\DoxyCodeLine{00070\ \ \ \textcolor{keywordflow}{return}\ \{t,\ dim0,\ dim1,\ dim2,\ dim3\};}
\DoxyCodeLine{00071\ \}}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ LLM\_CPP\_LLMCPP\_TENSOR\_UTIL\_HPP\_}}

\end{DoxyCode}
