\doxysection{Tensor\+Convolution\+Sycl.\+h}
\hypertarget{TensorConvolutionSycl_8h_source}{}\label{TensorConvolutionSycl_8h_source}\index{eigen/unsupported/Eigen/CXX11/src/Tensor/TensorConvolutionSycl.h@{eigen/unsupported/Eigen/CXX11/src/Tensor/TensorConvolutionSycl.h}}
\mbox{\hyperlink{TensorConvolutionSycl_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ This\ file\ is\ part\ of\ Eigen,\ a\ lightweight\ C++\ template\ library}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ for\ linear\ algebra.}}
\DoxyCodeLine{00003\ \textcolor{comment}{//}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ Mehdi\ Goli\ \ \ \ Codeplay\ Software\ Ltd.}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ Ralph\ Potter\ \ Codeplay\ Software\ Ltd.}}
\DoxyCodeLine{00006\ \textcolor{comment}{//\ Luke\ Iwanski\ \ Codeplay\ Software\ Ltd.}}
\DoxyCodeLine{00007\ \textcolor{comment}{//\ Contact:\ <eigen@codeplay.com>}}
\DoxyCodeLine{00008\ \textcolor{comment}{//\ Copyright\ (C)\ 2016\ Benoit\ Steiner\ <benoit.steiner.goog@gmail.com>}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{comment}{//}}
\DoxyCodeLine{00011\ \textcolor{comment}{//\ This\ Source\ Code\ Form\ is\ subject\ to\ the\ terms\ of\ the\ Mozilla}}
\DoxyCodeLine{00012\ \textcolor{comment}{//\ Public\ License\ v.\ 2.0.\ If\ a\ copy\ of\ the\ MPL\ was\ not\ distributed}}
\DoxyCodeLine{00013\ \textcolor{comment}{//\ with\ this\ file,\ You\ can\ obtain\ one\ at\ http://mozilla.org/MPL/2.0/.}}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#ifndef\ EIGEN\_CXX11\_TENSOR\_TENSOR\_CONVOLUTION\_SYCL\_H}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#define\ EIGEN\_CXX11\_TENSOR\_TENSOR\_CONVOLUTION\_SYCL\_H}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceEigen}{Eigen}}\ \{}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00028\ \textcolor{keyword}{enum\ class}\ \mbox{\hyperlink{namespaceEigen_aeae138f89644546cf3e6952820a4b85b}{convolution\_type}}\ \{\ \mbox{\hyperlink{namespaceEigen_aeae138f89644546cf3e6952820a4b85bad7bca9bc25850ed34f31ed3c9072309b}{CONV1D}},\ \mbox{\hyperlink{namespaceEigen_aeae138f89644546cf3e6952820a4b85ba2cafa280a722fa37eee8591ef10c012e}{CONV2D}},\ \mbox{\hyperlink{namespaceEigen_aeae138f89644546cf3e6952820a4b85baa27b4050cc42e50d0f765582a03cc1e6}{CONV3D}}\ \};}
\DoxyCodeLine{00029\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Evaluator,\ \textcolor{keyword}{typename}\ CoeffReturnType,\ \textcolor{keyword}{typename}\ KernelType,\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}},\ \textcolor{keyword}{typename}\ InputDims,}
\DoxyCodeLine{00030\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typename}\ Kernel\_accessor,\ \textcolor{keyword}{typename}\ Buffer\_accessor,\ \mbox{\hyperlink{namespaceEigen_aeae138f89644546cf3e6952820a4b85b}{convolution\_type}}\ Conv\_Dim>}
\DoxyCodeLine{00031\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel}{EigenConvolutionKernel}};}
\DoxyCodeLine{00032\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Evaluator,\ \textcolor{keyword}{typename}\ CoeffReturnType,\ \textcolor{keyword}{typename}\ KernelType,\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}},\ \textcolor{keyword}{typename}\ InputDims,}
\DoxyCodeLine{00033\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typename}\ Kernel\_accessor,\ \textcolor{keyword}{typename}\ Buffer\_accessor>}
\DoxyCodeLine{00034\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel}{EigenConvolutionKernel}}<Evaluator,\ CoeffReturnType,\ KernelType,\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}},\ InputDims,\ Kernel\_accessor,}
\DoxyCodeLine{00035\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Buffer\_accessor,\ \mbox{\hyperlink{namespaceEigen_aeae138f89644546cf3e6952820a4b85b}{convolution\_type}}::\mbox{\hyperlink{namespaceEigen_aeae138f89644546cf3e6952820a4b85bad7bca9bc25850ed34f31ed3c9072309b}{CONV1D}}>\ \{}
\DoxyCodeLine{00036\ \ \ \textcolor{keyword}{typedef}\ cl::sycl::accessor<CoeffReturnType,\ 1,\ cl::sycl::access::mode::read\_write,\ cl::sycl::access::target::local>}
\DoxyCodeLine{00037\ \ \ \ \ \ \ \mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel_3_01Evaluator_00_01CoeffReturnType_00_01KernelType_00_01In7d9bc47fe198f6b0f1b2af8aa5e85d7e_aec92e939f01eb227319faaec8b8f7e47}{Local\_accessor}};}
\DoxyCodeLine{00038\ \ \ \mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel_3_01Evaluator_00_01CoeffReturnType_00_01KernelType_00_01In7d9bc47fe198f6b0f1b2af8aa5e85d7e_aec92e939f01eb227319faaec8b8f7e47}{Local\_accessor}}\ \mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel_3_01Evaluator_00_01CoeffReturnType_00_01KernelType_00_01In7d9bc47fe198f6b0f1b2af8aa5e85d7e_a669abdebafb2e14ad81ce8057b7b7b73}{local\_acc}};}
\DoxyCodeLine{00039\ \ \ Evaluator\ \mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel_3_01Evaluator_00_01CoeffReturnType_00_01KernelType_00_01In7d9bc47fe198f6b0f1b2af8aa5e85d7e_a2e942d2fffb57c76959fbde7ca5de7b7}{device\_evaluator}};}
\DoxyCodeLine{00040\ \ \ Kernel\_accessor\ \mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel_3_01Evaluator_00_01CoeffReturnType_00_01KernelType_00_01In7d9bc47fe198f6b0f1b2af8aa5e85d7e_ae58497dc2dd19de3eeda75a5322c5555}{kernel\_filter}};}
\DoxyCodeLine{00041\ \ \ Buffer\_accessor\ \mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel_3_01Evaluator_00_01CoeffReturnType_00_01KernelType_00_01In7d9bc47fe198f6b0f1b2af8aa5e85d7e_a667cf09480ac73dca7e7ecfd4c4d051f}{buffer\_acc}};}
\DoxyCodeLine{00042\ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1IndexMapper}{internal::IndexMapper<Index,\ InputDims,\ 1,\ Evaluator::Layout>}}\ \mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel_3_01Evaluator_00_01CoeffReturnType_00_01KernelType_00_01In7d9bc47fe198f6b0f1b2af8aa5e85d7e_a75f8f5f343297f6d14817cc5d56aa538}{indexMapper}};}
\DoxyCodeLine{00043\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel_3_01Evaluator_00_01CoeffReturnType_00_01KernelType_00_01In7d9bc47fe198f6b0f1b2af8aa5e85d7e_acfd97a8ad9a567ec7a7b60afea352ffa}{kernelSize}};}
\DoxyCodeLine{00044\ \ \ \textcolor{keyword}{const}\ cl::sycl::range<2>\ \mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel_3_01Evaluator_00_01CoeffReturnType_00_01KernelType_00_01In7d9bc47fe198f6b0f1b2af8aa5e85d7e_a8dd475534e1b192bacfa51b8eb730c21}{input\_range}};}
\DoxyCodeLine{00045\ \ \ \mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel_3_01Evaluator_00_01CoeffReturnType_00_01KernelType_00_01In7d9bc47fe198f6b0f1b2af8aa5e85d7e_aacd6f7636e5858fb1352cef6b515c805}{EigenConvolutionKernel}}(\mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel_3_01Evaluator_00_01CoeffReturnType_00_01KernelType_00_01In7d9bc47fe198f6b0f1b2af8aa5e85d7e_aec92e939f01eb227319faaec8b8f7e47}{Local\_accessor}}\ local\_acc\_,\ Evaluator\ device\_evaluator\_,\ Kernel\_accessor\ kernel\_filter\_,}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Buffer\_accessor\ buffer\_acc\_,}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1IndexMapper}{internal::IndexMapper<Index,\ InputDims,\ 1,\ Evaluator::Layout>}}\ indexMapper\_,}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ kernelSize\_,\ \textcolor{keyword}{const}\ cl::sycl::range<2>\ input\_range\_)}
\DoxyCodeLine{00049\ \ \ \ \ \ \ :\ local\_acc(local\_acc\_),}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ device\_evaluator(device\_evaluator\_),}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ kernel\_filter(kernel\_filter\_),}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ buffer\_acc(buffer\_acc\_),}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ indexMapper(indexMapper\_),}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ kernelSize(kernelSize\_),}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ input\_range(input\_range\_)\ \{\}}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00057\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ BooleanDim2>}
\DoxyCodeLine{00058\ \ \ \mbox{\hyperlink{Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}\ \mbox{\hyperlink{Macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel_3_01Evaluator_00_01CoeffReturnType_00_01KernelType_00_01In7d9bc47fe198f6b0f1b2af8aa5e85d7e_ad632c5cf7fc3308f2b5999a254a9d080}{boundary\_check}}(\textcolor{keyword}{const}\ BooleanDim2\ boolean\_check)\ \{}
\DoxyCodeLine{00059\ \ \ \ \ \textcolor{keywordflow}{return}\ (boolean\_check[0]\ \&\&\ boolean\_check[1]);}
\DoxyCodeLine{00060\ \ \ \}}
\DoxyCodeLine{00061\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel_3_01Evaluator_00_01CoeffReturnType_00_01KernelType_00_01In7d9bc47fe198f6b0f1b2af8aa5e85d7e_ab2f19495ac1e71d225efd7467f9ac43a}{operator()}}(cl::sycl::nd\_item<2>\ itemID)\ \{}
\DoxyCodeLine{00062\ \ \ \ \ \textcolor{keyword}{auto}\ buffer\_ptr\ =\ buffer\_acc.get\_pointer();}
\DoxyCodeLine{00063\ \ \ \ \ \textcolor{keyword}{auto}\ kernel\_ptr\ =\ kernel\_filter.get\_pointer();}
\DoxyCodeLine{00064\ \ \ \ \ \textcolor{comment}{//\ the\ required\ row\ to\ be\ calculated\ for\ the\ for\ each\ plane\ in\ shered\ memory}}
\DoxyCodeLine{00065\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ num\_input\ =\ (itemID.get\_local\_range()[0]\ +\ kernelSize\ -\/\ 1);}
\DoxyCodeLine{00066\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ plane\_kernel\_offset\ =\ itemID.get\_local\_id(1)\ *\ num\_input;}
\DoxyCodeLine{00067\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ input\_offset\ =\ itemID.get\_group(0)\ *\ itemID.get\_local\_range()[0];}
\DoxyCodeLine{00068\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ plane\_tensor\_offset\ =\ indexMapper.\mbox{\hyperlink{classEigen_1_1internal_1_1IndexMapper_adbcf0372959bfcc5d9eee8f271a57796}{mapGpuInputPlaneToTensorInputOffset}}(itemID.get\_global\_id(1));}
\DoxyCodeLine{00070\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ itemID.get\_local\_id(0);\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ num\_input;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +=\ itemID.get\_local\_range()[0])\ \{}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ local\_index\ =\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +\ plane\_kernel\_offset;}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ tensor\_index\ =}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \ \ plane\_tensor\_offset\ +\ indexMapper.\mbox{\hyperlink{classEigen_1_1internal_1_1IndexMapper_a5f688e79fe8140b54d1a608f90b137a8}{mapGpuInputKernelToTensorInputOffset}}(\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +\ input\_offset);}
\DoxyCodeLine{00074\ }
\DoxyCodeLine{00075\ \ \ \ \ \ \ local\_acc[local\_index]\ =}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \ \ (((\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +\ input\_offset)\ <\ (input\_range[0]\ +\ kernelSize\ -\/\ 1))\ \&\&\ itemID.get\_global\_id(1)\ <\ input\_range[1])}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ?\ device\_evaluator.coeff(tensor\_index)}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ CoeffReturnType(0);}
\DoxyCodeLine{00079\ \ \ \ \ \}}
\DoxyCodeLine{00080\ }
\DoxyCodeLine{00081\ \ \ \ \ itemID.barrier(cl::sycl::access::fence\_space::local\_space);}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00083\ \ \ \ \ \textcolor{comment}{//\ calculate\ the\ convolution\ //\ output\ start\ x}}
\DoxyCodeLine{00084\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ first\_output\_start\ =\ itemID.get\_group(0)\ *\ (itemID.get\_local\_range()[0]);}
\DoxyCodeLine{00085\ \ \ \ \ \textcolor{keywordflow}{if}\ (boundary\_check(itemID.get\_global\_id()\ <\ input\_range))\ \{}
\DoxyCodeLine{00086\ \ \ \ \ \ \ CoeffReturnType\ result\ =\ \textcolor{keyword}{static\_cast<}CoeffReturnType\textcolor{keyword}{>}(0);}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ index\ =\ plane\_kernel\_offset\ +\ itemID.get\_local\_id(0);}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ k\ =\ 0;\ k\ <\ kernelSize;\ ++k)\ \{}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ result\ +=\ (local\_acc[k\ +\ index]\ *\ kernel\_ptr[k]);}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ tensor\_index\ =}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \ \ indexMapper.\mbox{\hyperlink{classEigen_1_1internal_1_1IndexMapper_a288a396c60dcaa11085593b7e7737bff}{mapGpuOutputPlaneToTensorOutputOffset}}(itemID.get\_global\_id(1))\ +}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ \ \ indexMapper.\mbox{\hyperlink{classEigen_1_1internal_1_1IndexMapper_af61ec2f629e94db0dbdd003ab786338f}{mapGpuOutputKernelToTensorOutputOffset}}(itemID.get\_local\_id(0)\ +\ first\_output\_start);}
\DoxyCodeLine{00094\ \ \ \ \ \ \ buffer\_ptr[tensor\_index]\ =\ result;}
\DoxyCodeLine{00095\ \ \ \ \ \}}
\DoxyCodeLine{00096\ \ \ \}}
\DoxyCodeLine{00097\ \};}
\DoxyCodeLine{00098\ }
\DoxyCodeLine{00099\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Evaluator,\ \textcolor{keyword}{typename}\ CoeffReturnType,\ \textcolor{keyword}{typename}\ KernelType,\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}},\ \textcolor{keyword}{typename}\ InputDims,}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typename}\ Kernel\_accessor,\ \textcolor{keyword}{typename}\ Buffer\_accessor>}
\DoxyCodeLine{00101\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel}{EigenConvolutionKernel}}<Evaluator,\ CoeffReturnType,\ KernelType,\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}},\ InputDims,\ Kernel\_accessor,}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Buffer\_accessor,\ \mbox{\hyperlink{namespaceEigen_aeae138f89644546cf3e6952820a4b85b}{convolution\_type}}::\mbox{\hyperlink{namespaceEigen_aeae138f89644546cf3e6952820a4b85ba2cafa280a722fa37eee8591ef10c012e}{CONV2D}}>\ \{}
\DoxyCodeLine{00103\ \ \ \textcolor{keyword}{typedef}\ cl::sycl::accessor<CoeffReturnType,\ 1,\ cl::sycl::access::mode::read\_write,\ cl::sycl::access::target::local>}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel_3_01Evaluator_00_01CoeffReturnType_00_01KernelType_00_01In02ad0cf76c6b89a09d948e57b1aea49a_ad0ce3ac5cd73c38c8ca7400e7bc98ada}{Local\_accessor}};}
\DoxyCodeLine{00105\ \ \ \mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel_3_01Evaluator_00_01CoeffReturnType_00_01KernelType_00_01In02ad0cf76c6b89a09d948e57b1aea49a_ad0ce3ac5cd73c38c8ca7400e7bc98ada}{Local\_accessor}}\ \mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel_3_01Evaluator_00_01CoeffReturnType_00_01KernelType_00_01In02ad0cf76c6b89a09d948e57b1aea49a_a99a65f4766ddf3ba879e9a5453d1848a}{local\_acc}};}
\DoxyCodeLine{00106\ \ \ Evaluator\ \mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel_3_01Evaluator_00_01CoeffReturnType_00_01KernelType_00_01In02ad0cf76c6b89a09d948e57b1aea49a_a5766436ebe6ad5e44f3776c0da9a1ea0}{device\_evaluator}};}
\DoxyCodeLine{00107\ \ \ Kernel\_accessor\ \mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel_3_01Evaluator_00_01CoeffReturnType_00_01KernelType_00_01In02ad0cf76c6b89a09d948e57b1aea49a_ad0d6af0516cd158cf959071346edce63}{kernel\_filter}};}
\DoxyCodeLine{00108\ \ \ Buffer\_accessor\ \mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel_3_01Evaluator_00_01CoeffReturnType_00_01KernelType_00_01In02ad0cf76c6b89a09d948e57b1aea49a_a44464640959e535d15de9c178723a859}{buffer\_acc}};}
\DoxyCodeLine{00109\ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1IndexMapper}{internal::IndexMapper<Index,\ InputDims,\ 2,\ Evaluator::Layout>}}\ \mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel_3_01Evaluator_00_01CoeffReturnType_00_01KernelType_00_01In02ad0cf76c6b89a09d948e57b1aea49a_ad6915de47978011e7e0dc7fd7428151c}{indexMapper}};}
\DoxyCodeLine{00110\ \ \ \textcolor{keyword}{const}\ cl::sycl::range<2>\ \mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel_3_01Evaluator_00_01CoeffReturnType_00_01KernelType_00_01In02ad0cf76c6b89a09d948e57b1aea49a_ad2816918b408cc89a6e558facfe66d2c}{kernel\_size}};}
\DoxyCodeLine{00111\ \ \ \textcolor{keyword}{const}\ cl::sycl::range<3>\ \mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel_3_01Evaluator_00_01CoeffReturnType_00_01KernelType_00_01In02ad0cf76c6b89a09d948e57b1aea49a_ad4dcd115cb8273f5ad42fdb2232911e0}{input\_range}};}
\DoxyCodeLine{00112\ \ \ \mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel_3_01Evaluator_00_01CoeffReturnType_00_01KernelType_00_01In02ad0cf76c6b89a09d948e57b1aea49a_aeaac5983136a26f70c341b62edbb5f87}{EigenConvolutionKernel}}(\mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel_3_01Evaluator_00_01CoeffReturnType_00_01KernelType_00_01In02ad0cf76c6b89a09d948e57b1aea49a_ad0ce3ac5cd73c38c8ca7400e7bc98ada}{Local\_accessor}}\ local\_acc\_,\ Evaluator\ device\_evaluator\_,\ Kernel\_accessor\ kernel\_filter\_,}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Buffer\_accessor\ buffer\_acc\_,}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1IndexMapper}{internal::IndexMapper<Index,\ InputDims,\ 2,\ Evaluator::Layout>}}\ indexMapper\_,}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cl::sycl::range<2>\ kernel\_size\_,\ \textcolor{keyword}{const}\ cl::sycl::range<3>\ input\_range\_)}
\DoxyCodeLine{00116\ \ \ \ \ \ \ :\ local\_acc(local\_acc\_),}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ device\_evaluator(device\_evaluator\_),}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ kernel\_filter(kernel\_filter\_),}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ buffer\_acc(buffer\_acc\_),}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ indexMapper(indexMapper\_),}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ kernel\_size(kernel\_size\_),}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ input\_range(input\_range\_)\ \{\}}
\DoxyCodeLine{00123\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ BooleanDim3>}
\DoxyCodeLine{00124\ \ \ \mbox{\hyperlink{Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}\ \mbox{\hyperlink{Macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel_3_01Evaluator_00_01CoeffReturnType_00_01KernelType_00_01In02ad0cf76c6b89a09d948e57b1aea49a_ac2c31b3184afb343ae1cdf267e8723a5}{boundary\_check}}(\textcolor{keyword}{const}\ BooleanDim3\ boolean\_check)\ \{}
\DoxyCodeLine{00125\ \ \ \ \ \textcolor{keywordflow}{return}\ (boolean\_check[0]\ \&\&\ boolean\_check[1]\ \&\&\ boolean\_check[2]);}
\DoxyCodeLine{00126\ \ \ \}}
\DoxyCodeLine{00127\ }
\DoxyCodeLine{00128\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel_3_01Evaluator_00_01CoeffReturnType_00_01KernelType_00_01In02ad0cf76c6b89a09d948e57b1aea49a_a269700cf7bfc8cbdc92ae48c77739dee}{operator()}}(cl::sycl::nd\_item<3>\ itemID)\ \{}
\DoxyCodeLine{00129\ \ \ \ \ \textcolor{keyword}{auto}\ buffer\_ptr\ =\ buffer\_acc.get\_pointer();}
\DoxyCodeLine{00130\ \ \ \ \ \textcolor{keyword}{auto}\ kernel\_ptr\ =\ kernel\_filter.get\_pointer();}
\DoxyCodeLine{00131\ \ \ \ \ \textcolor{comment}{//\ the\ required\ row\ to\ be\ calculated\ for\ the\ for\ each\ plane\ in\ shered\ memory}}
\DoxyCodeLine{00132\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ num\_input\ =\ cl::sycl::range<2>\{}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ (cl::sycl::range<2>(itemID.get\_local\_range()[0],\ itemID.get\_local\_range()[1])\ +\ kernel\_size\ -\/\ 1)\};}
\DoxyCodeLine{00134\ }
\DoxyCodeLine{00135\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ plane\_input\_offset\ =\ indexMapper.\mbox{\hyperlink{classEigen_1_1internal_1_1IndexMapper_adbcf0372959bfcc5d9eee8f271a57796}{mapGpuInputPlaneToTensorInputOffset}}(itemID.get\_global\_id(2));}
\DoxyCodeLine{00136\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ plane\_kernel\_offset\ =\ itemID.get\_local\_id(2)\ *\ num\_input[1];}
\DoxyCodeLine{00137\ }
\DoxyCodeLine{00138\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ input\_offset\ =\ cl::sycl::range<2>\{itemID.get\_group(0)\ *\ itemID.get\_local\_range()[0],}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ itemID.get\_group(1)\ *\ itemID.get\_local\_range()[1]\};}
\DoxyCodeLine{00140\ \ \ \ \ \ \ }
\DoxyCodeLine{00141\ \ \ \ \ \textcolor{comment}{//\ fill\ the\ local\ memory}}
\DoxyCodeLine{00142\ \ \ \ \ \textcolor{keywordtype}{bool}\ in\_range\_dim2\ =\ itemID.get\_global\_id(2)\ <\ input\_range[2];}
\DoxyCodeLine{00143\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ j\ =\ itemID.get\_local\_id(1);\ j\ <\ num\_input[1];\ j\ +=\ itemID.get\_local\_range()[1])\ \{}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ local\_input\_offset\ =\ num\_input[0]\ *\ (j\ +\ plane\_kernel\_offset);}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ in\_range\_dim1\ =\ ((j\ +\ input\_offset[1])\ <\ (input\_range[1]\ +\ kernel\_size[1]\ -\/\ 1));\ }
\DoxyCodeLine{00146\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ itemID.get\_local\_id(0);\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ num\_input[0];\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +=\ itemID.get\_local\_range()[0])\ \{}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ local\_index\ =\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +\ local\_input\_offset;}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ tensor\_index\ =\ plane\_input\_offset\ +\ indexMapper.\mbox{\hyperlink{classEigen_1_1internal_1_1IndexMapper_a5f688e79fe8140b54d1a608f90b137a8}{mapGpuInputKernelToTensorInputOffset}}(}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +\ input\_offset[0],\ j\ +\ input\_offset[1]);}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ local\_acc[local\_index]\ =\ (((\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +\ input\_offset[0])\ <\ (input\_range[0]\ +\ kernel\_size[0]\ -\/\ 1))\ \&\&}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ in\_range\_dim1\ \&\&\ in\_range\_dim2)}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ?\ device\_evaluator.coeff(tensor\_index)}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ CoeffReturnType(0);}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00155\ \ \ \ \ \}}
\DoxyCodeLine{00156\ }
\DoxyCodeLine{00157\ \ \ \ \ itemID.barrier(cl::sycl::access::fence\_space::local\_space);}
\DoxyCodeLine{00158\ }
\DoxyCodeLine{00159\ \ \ \ \ \textcolor{comment}{//\ output\ offset\ start\ for\ each\ thread}}
\DoxyCodeLine{00160\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ output\_offset\ =\ cl::sycl::range<2>\{itemID.get\_group(0)\ *\ itemID.get\_local\_range()[0],}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ itemID.get\_group(1)\ *\ itemID.get\_local\_range()[1]\};}
\DoxyCodeLine{00162\ }
\DoxyCodeLine{00163\ \ \ \ \ \textcolor{keywordflow}{if}\ (boundary\_check(itemID.get\_global\_id()\ <\ input\_range))\ \{}
\DoxyCodeLine{00164\ \ \ \ \ \ \ CoeffReturnType\ result\ =\ \textcolor{keyword}{static\_cast<}CoeffReturnType\textcolor{keyword}{>}(0);}
\DoxyCodeLine{00165\ }
\DoxyCodeLine{00166\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ j\ =\ 0;\ j\ <\ kernel\_size[1];\ j++)\ \{}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ kernel\_offset\ =\ kernel\_size[0]\ *\ j;}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ index\ =}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \ \ \ \ (num\_input[0]\ *\ (plane\_kernel\_offset\ +\ j\ +\ itemID.get\_local\_id(1)))\ +\ itemID.get\_local\_id(0);}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ kernel\_size[0];\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}++)\ \{}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ \ \ result\ +=\ (local\_acc[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +\ index]\ *\ kernel\_ptr[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +\ kernel\_offset]);}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ tensor\_index\ =}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \ \ indexMapper.\mbox{\hyperlink{classEigen_1_1internal_1_1IndexMapper_a288a396c60dcaa11085593b7e7737bff}{mapGpuOutputPlaneToTensorOutputOffset}}(itemID.get\_global\_id(2))\ +}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ \ \ indexMapper.\mbox{\hyperlink{classEigen_1_1internal_1_1IndexMapper_af61ec2f629e94db0dbdd003ab786338f}{mapGpuOutputKernelToTensorOutputOffset}}(itemID.get\_local\_id(0)\ +\ output\_offset[0],}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ itemID.get\_local\_id(1)\ +\ output\_offset[1]);}
\DoxyCodeLine{00178\ }
\DoxyCodeLine{00179\ \ \ \ \ \ \ buffer\_ptr[tensor\_index]\ =\ result;}
\DoxyCodeLine{00180\ \ \ \ \ \}}
\DoxyCodeLine{00181\ \ \ \}}
\DoxyCodeLine{00182\ \};}
\DoxyCodeLine{00183\ }
\DoxyCodeLine{00184\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Evaluator,\ \textcolor{keyword}{typename}\ CoeffReturnType,\ \textcolor{keyword}{typename}\ KernelType,\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}},\ \textcolor{keyword}{typename}\ InputDims,}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typename}\ Kernel\_accessor,\ \textcolor{keyword}{typename}\ Buffer\_accessor>}
\DoxyCodeLine{00186\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel}{EigenConvolutionKernel}}<Evaluator,\ CoeffReturnType,\ KernelType,\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}},\ InputDims,\ Kernel\_accessor,}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Buffer\_accessor,\ \mbox{\hyperlink{namespaceEigen_aeae138f89644546cf3e6952820a4b85b}{convolution\_type}}::\mbox{\hyperlink{namespaceEigen_aeae138f89644546cf3e6952820a4b85baa27b4050cc42e50d0f765582a03cc1e6}{CONV3D}}>\ \{}
\DoxyCodeLine{00188\ \ \ \textcolor{keyword}{typedef}\ cl::sycl::accessor<CoeffReturnType,\ 1,\ cl::sycl::access::mode::read\_write,\ cl::sycl::access::target::local>}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel_3_01Evaluator_00_01CoeffReturnType_00_01KernelType_00_01Ina3b20d6496a457db615c11ac009e5142_a713cd2784bbbf8c892cf178bb1317fae}{Local\_accessor}};}
\DoxyCodeLine{00190\ \ \ \mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel_3_01Evaluator_00_01CoeffReturnType_00_01KernelType_00_01Ina3b20d6496a457db615c11ac009e5142_a713cd2784bbbf8c892cf178bb1317fae}{Local\_accessor}}\ \mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel_3_01Evaluator_00_01CoeffReturnType_00_01KernelType_00_01Ina3b20d6496a457db615c11ac009e5142_abfa979d12309511905047a3ef65b84b3}{local\_acc}};}
\DoxyCodeLine{00191\ \ \ Evaluator\ \mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel_3_01Evaluator_00_01CoeffReturnType_00_01KernelType_00_01Ina3b20d6496a457db615c11ac009e5142_aa3e19a2691c6d4c39f2cf43120da0455}{device\_evaluator}};}
\DoxyCodeLine{00192\ \ \ Kernel\_accessor\ \mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel_3_01Evaluator_00_01CoeffReturnType_00_01KernelType_00_01Ina3b20d6496a457db615c11ac009e5142_a60b20880e2161c84efd4c746530508cd}{kernel\_filter}};}
\DoxyCodeLine{00193\ \ \ Buffer\_accessor\ \mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel_3_01Evaluator_00_01CoeffReturnType_00_01KernelType_00_01Ina3b20d6496a457db615c11ac009e5142_adf7e60b5ad5de60745f8908ea137ecb2}{buffer\_acc}};}
\DoxyCodeLine{00194\ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1IndexMapper}{internal::IndexMapper<Index,\ InputDims,\ 3,\ Evaluator::Layout>}}\ \mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel_3_01Evaluator_00_01CoeffReturnType_00_01KernelType_00_01Ina3b20d6496a457db615c11ac009e5142_a79facaa6cc79b077d5969fbd0b405476}{indexMapper}};}
\DoxyCodeLine{00195\ \ \ \textcolor{keyword}{const}\ cl::sycl::range<3>\ \mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel_3_01Evaluator_00_01CoeffReturnType_00_01KernelType_00_01Ina3b20d6496a457db615c11ac009e5142_afff1985e781613f1f5c280c726390525}{kernel\_size}};}
\DoxyCodeLine{00196\ \ \ \textcolor{keyword}{const}\ cl::sycl::range<3>\ \mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel_3_01Evaluator_00_01CoeffReturnType_00_01KernelType_00_01Ina3b20d6496a457db615c11ac009e5142_aa328fa24e89b3fe2d833017e53ebb2ab}{input\_range}};}
\DoxyCodeLine{00197\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel_3_01Evaluator_00_01CoeffReturnType_00_01KernelType_00_01Ina3b20d6496a457db615c11ac009e5142_af2ba58eab9fec732e158c1a28ee37249}{numP}};}
\DoxyCodeLine{00198\ }
\DoxyCodeLine{00199\ \ \ \mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel_3_01Evaluator_00_01CoeffReturnType_00_01KernelType_00_01Ina3b20d6496a457db615c11ac009e5142_af839619b379c92c8bb462dca6f892b4c}{EigenConvolutionKernel}}(\mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel_3_01Evaluator_00_01CoeffReturnType_00_01KernelType_00_01Ina3b20d6496a457db615c11ac009e5142_a713cd2784bbbf8c892cf178bb1317fae}{Local\_accessor}}\ local\_acc\_,\ Evaluator\ device\_evaluator\_,\ Kernel\_accessor\ kernel\_filter\_,}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Buffer\_accessor\ buffer\_acc\_,}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1IndexMapper}{internal::IndexMapper<Index,\ InputDims,\ 3,\ Evaluator::Layout>}}\ indexMapper\_,}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cl::sycl::range<3>\ kernel\_size\_,\ \textcolor{keyword}{const}\ cl::sycl::range<3>\ input\_range\_,}
\DoxyCodeLine{00203\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ numP\_)}
\DoxyCodeLine{00204\ \ \ \ \ \ \ :\ local\_acc(local\_acc\_),}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ device\_evaluator(device\_evaluator\_),}
\DoxyCodeLine{00206\ \ \ \ \ \ \ \ \ kernel\_filter(kernel\_filter\_),}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \ \ buffer\_acc(buffer\_acc\_),}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \ \ indexMapper(indexMapper\_),}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \ \ kernel\_size(kernel\_size\_),}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ input\_range(input\_range\_),}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \ \ numP(numP\_)\ \{\}}
\DoxyCodeLine{00212\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ BooleanDim3>}
\DoxyCodeLine{00213\ \ \ \mbox{\hyperlink{Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}\ \mbox{\hyperlink{Macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel_3_01Evaluator_00_01CoeffReturnType_00_01KernelType_00_01Ina3b20d6496a457db615c11ac009e5142_ad7af162cf320a312ab49c4aadf7390aa}{boundary\_check}}(\textcolor{keyword}{const}\ BooleanDim3\ boolean\_check)\ \{}
\DoxyCodeLine{00214\ \ \ \ \ \textcolor{keywordflow}{return}\ (boolean\_check[0]\ \&\&\ boolean\_check[1]\ \&\&\ boolean\_check[2]);}
\DoxyCodeLine{00215\ \ \ \}}
\DoxyCodeLine{00216\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel_3_01Evaluator_00_01CoeffReturnType_00_01KernelType_00_01Ina3b20d6496a457db615c11ac009e5142_a534b57ccc8c66dd6284b5ca66075d3d5}{operator()}}(cl::sycl::nd\_item<3>\ itemID)\ \{}
\DoxyCodeLine{00217\ \ \ \ \ \textcolor{keyword}{auto}\ buffer\_ptr\ =\ buffer\_acc.get\_pointer();}
\DoxyCodeLine{00218\ \ \ \ \ \textcolor{keyword}{auto}\ kernel\_ptr\ =\ kernel\_filter.get\_pointer();}
\DoxyCodeLine{00219\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ num\_input\ =\ cl::sycl::range<3>\{itemID.get\_local\_range()\ +\ kernel\_size\ -\/\ 1\};}
\DoxyCodeLine{00220\ }
\DoxyCodeLine{00221\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ input\_offset\ =\ cl::sycl::range<3>\{itemID.get\_group().get\_id()\ *\ itemID.get\_local\_range()\};}
\DoxyCodeLine{00222\ }
\DoxyCodeLine{00223\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ output\_offset\ =}
\DoxyCodeLine{00224\ \ \ \ \ \ \ \ \ \ \ cl::sycl::range<3>\{itemID.get\_group().get\_id()\ *\ itemID.get\_local\_range()\ +\ itemID.get\_local\_id()\};}
\DoxyCodeLine{00225\ }
\DoxyCodeLine{00226\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ p\ =\ 0;\ p\ <\ numP;\ p++)\ \{}
\DoxyCodeLine{00228\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ plane\_input\_offset\ =\ indexMapper.\mbox{\hyperlink{classEigen_1_1internal_1_1IndexMapper_adbcf0372959bfcc5d9eee8f271a57796}{mapGpuInputPlaneToTensorInputOffset}}(p);}
\DoxyCodeLine{00229\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ k\ =\ itemID.get\_local\_id(2);\ k\ <\ num\_input[2];\ k\ +=\ itemID.get\_local\_range()[2])\ \{}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ local\_index\_dim2\ =\ num\_input[0]\ *\ num\_input[1]\ *\ k;}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ cond\_k\_dim\ =\ (k\ +\ input\_offset[2]\ <\ (input\_range[2]\ +\ kernel\_size[2]\ -\/\ 1));}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ j\ =\ itemID.get\_local\_id(1);\ j\ <\ num\_input[1];\ j\ +=\ itemID.get\_local\_range()[1])\ \{}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ cond\_j\_dim\ =\ cond\_k\_dim\ \&\&\ (j\ +\ input\_offset[1]\ <\ (input\_range[1]\ +\ kernel\_size[1]\ -\/\ 1));}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ local\_index\_dim1\ =\ (num\_input[0]\ *\ j)\ \ +\ local\_index\_dim2;}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ itemID.get\_local\_id(0);\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ num\_input[0];\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +=\ itemID.get\_local\_range()[0])\ \{}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ conds\ =\ cond\_j\_dim\ \&\&\ (\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +\ input\_offset[0]\ <\ (input\_range[0]\ +\ kernel\_size[0]\ -\/\ 1));}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ local\_index\ =\ local\_index\_dim1\ +\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}};}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ tensor\_index\ =}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ plane\_input\_offset\ +\ indexMapper.\mbox{\hyperlink{classEigen_1_1internal_1_1IndexMapper_a5f688e79fe8140b54d1a608f90b137a8}{mapGpuInputKernelToTensorInputOffset}}(}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +\ input\_offset[0],\ j\ +\ input\_offset[1],\ k\ +\ input\_offset[2]);}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \ \ \ \ local\_acc[local\_index]\ =\ conds\ ?\ device\_evaluator.coeff(tensor\_index)\ :\ CoeffReturnType(0);}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00245\ \ \ \ \ \ \ itemID.barrier(cl::sycl::access::fence\_space::local\_space);}
\DoxyCodeLine{00246\ }
\DoxyCodeLine{00247\ \ \ \ \ \ \ \textcolor{comment}{//\ calculate\ the\ convolution}}
\DoxyCodeLine{00248\ }
\DoxyCodeLine{00249\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (boundary\_check(itemID.get\_global\_id()\ <\ input\_range))\ \{}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ CoeffReturnType\ result\ =\ \textcolor{keyword}{static\_cast<}CoeffReturnType\textcolor{keyword}{>}(0);}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ k\ =\ 0;\ k\ <\ kernel\_size[2];\ k++)\ \{}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ j\ =\ 0;\ j\ <\ kernel\_size[1];\ j++)\ \{}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ kernel\_size[0];\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}++)\ \{}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ kernel\_index\ =\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +\ kernel\_size[0]\ *\ (j\ +\ kernel\_size[1]\ *\ k);}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ local\_index\ =}
\DoxyCodeLine{00256\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ((\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ +\ itemID.get\_local\_id(0))\ +}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ num\_input[0]\ *\ ((j\ +\ itemID.get\_local\_id(1))\ +\ num\_input[1]\ *\ (k\ +\ itemID.get\_local\_id(2))));}
\DoxyCodeLine{00258\ }
\DoxyCodeLine{00259\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ result\ +=\ (local\_acc[local\_index]\ *\ kernel\_ptr[kernel\_index]);}
\DoxyCodeLine{00260\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00261\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00262\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00263\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ tensor\_index\ =}
\DoxyCodeLine{00264\ \ \ \ \ \ \ \ \ \ \ \ \ indexMapper.\mbox{\hyperlink{classEigen_1_1internal_1_1IndexMapper_a288a396c60dcaa11085593b7e7737bff}{mapGpuOutputPlaneToTensorOutputOffset}}(p)\ +}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \ \ \ \ \ \ indexMapper.\mbox{\hyperlink{classEigen_1_1internal_1_1IndexMapper_af61ec2f629e94db0dbdd003ab786338f}{mapGpuOutputKernelToTensorOutputOffset}}(output\_offset[0],\ output\_offset[1],\ output\_offset[2]);}
\DoxyCodeLine{00266\ \ \ \ \ \ \ \ \ buffer\_ptr[tensor\_index]\ =\ result;}
\DoxyCodeLine{00267\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00268\ }
\DoxyCodeLine{00269\ \ \ \ \ \ \ itemID.barrier(cl::sycl::access::fence\_space::local\_space);}
\DoxyCodeLine{00270\ \ \ \ \ \}}
\DoxyCodeLine{00271\ \ \ \}}
\DoxyCodeLine{00272\ \};}
\DoxyCodeLine{00273\ }
\DoxyCodeLine{00274\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Indices,\ \textcolor{keyword}{typename}\ InputArgType,\ \textcolor{keyword}{typename}\ KernelArgType>}
\DoxyCodeLine{00275\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structEigen_1_1TensorEvaluator}{TensorEvaluator}}<const\ \mbox{\hyperlink{classEigen_1_1TensorConvolutionOp}{TensorConvolutionOp}}<Indices,\ InputArgType,\ KernelArgType>,\ \mbox{\hyperlink{namespaceEigen}{Eigen}}::SyclDevice>\ \{}
\DoxyCodeLine{00276\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{classEigen_1_1TensorConvolutionOp}{TensorConvolutionOp<Indices,\ InputArgType,\ KernelArgType>}}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_3_01const_01TensorConvolutionOp_3_01Indices_00_01InputArgType_00_6ba4111b8d93caae0f8aeb88d1a4da91_a89670ecf9bcc8fadbc2a047c0ad6f33a}{XprType}};}
\DoxyCodeLine{00277\ }
\DoxyCodeLine{00278\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ NumDims\ =}
\DoxyCodeLine{00279\ \ \ \ \ \ \ \mbox{\hyperlink{structEigen_1_1internal_1_1array__size}{internal::array\_size<typename\ TensorEvaluator<InputArgType,\ Eigen::SyclDevice>::Dimensions}}>\mbox{\hyperlink{abseil-cpp_2absl_2container_2flat__hash__map__test_8cc_a54c2bae0f8aeed048a397b0618037252}{::value}};}
\DoxyCodeLine{00280\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ NumKernelDims\ =\ \mbox{\hyperlink{structEigen_1_1internal_1_1array__size}{internal::array\_size<Indices>::value}};}
\DoxyCodeLine{00281\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{classEigen_1_1TensorConvolutionOp_a8a381f13d4d9572dcdddded6aa91aacf}{XprType::Index}}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_3_01const_01TensorConvolutionOp_3_01Indices_00_01InputArgType_00_6ba4111b8d93caae0f8aeb88d1a4da91_a1b227e977328e14fcfd0d2a7c589cb35}{Index}};}
\DoxyCodeLine{00282\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{structEigen_1_1DSizes}{DSizes<Index,\ NumDims>}}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_3_01const_01TensorConvolutionOp_3_01Indices_00_01InputArgType_00_6ba4111b8d93caae0f8aeb88d1a4da91_a271f0d1c009de72e8a5ea0adb9d1e784}{Dimensions}};}
\DoxyCodeLine{00283\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_aa1d848f55dbb96ee9c789c995624a2cb}{TensorEvaluator<KernelArgType,\ Eigen::SyclDevice>::Dimensions}}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_3_01const_01TensorConvolutionOp_3_01Indices_00_01InputArgType_00_6ba4111b8d93caae0f8aeb88d1a4da91_a205b2375727ef22ccf1847f2b476a992}{KernelDimensions}};}
\DoxyCodeLine{00284\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{const}\ Eigen::SyclDevice\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_3_01const_01TensorConvolutionOp_3_01Indices_00_01InputArgType_00_6ba4111b8d93caae0f8aeb88d1a4da91_a5f4c2aba2dc7f8b115be67c17bee4f82}{Device}};}
\DoxyCodeLine{00285\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{classEigen_1_1TensorConvolutionOp_a9df61e987f370921c3bda147f1d97aae}{XprType::CoeffReturnType}}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_3_01const_01TensorConvolutionOp_3_01Indices_00_01InputArgType_00_6ba4111b8d93caae0f8aeb88d1a4da91_a5296cdbfdee5ab50da2e626dea9d7102}{CoeffReturnType}};}
\DoxyCodeLine{00286\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{structEigen_1_1PacketType_aef48fcc1b8cc8df3b7c667a52a792869}{PacketType<CoeffReturnType,\ Eigen::SyclDevice>::type}}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_3_01const_01TensorConvolutionOp_3_01Indices_00_01InputArgType_00_6ba4111b8d93caae0f8aeb88d1a4da91_a1015f63858972e83f199398114ef5736}{PacketReturnType}};}
\DoxyCodeLine{00287\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ InputArgType::Scalar\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_3_01const_01TensorConvolutionOp_3_01Indices_00_01InputArgType_00_6ba4111b8d93caae0f8aeb88d1a4da91_a7112c2af4b1de9c51f2c188ecc0c6ed6}{Scalar}};}
\DoxyCodeLine{00288\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_af01d9cb0f9c1d405b9d6a24843936d3f}{PacketSize}}\ =\ \mbox{\hyperlink{structEigen_1_1PacketType}{PacketType<CoeffReturnType,\ Device>::size}};}
\DoxyCodeLine{00289\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{structEigen_1_1StorageMemory}{StorageMemory<CoeffReturnType,\ Eigen::SyclDevice>}}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_3_01const_01TensorConvolutionOp_3_01Indices_00_01InputArgType_00_6ba4111b8d93caae0f8aeb88d1a4da91_a24099f6204e0b7cc4edba161dce91c4b}{Storage}};}
\DoxyCodeLine{00290\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{structEigen_1_1MakePointer_ad5ad877605f41bf69c9ffdf13567c693}{Storage::Type}}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_3_01const_01TensorConvolutionOp_3_01Indices_00_01InputArgType_00_6ba4111b8d93caae0f8aeb88d1a4da91_a19ebf21284a68dbd5f915fe6367c238f}{EvaluatorPointerType}};}
\DoxyCodeLine{00291\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{structEigen_1_1StorageMemory}{StorageMemory<const\ CoeffReturnType,\ Eigen::SyclDevice>}}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_3_01const_01TensorConvolutionOp_3_01Indices_00_01InputArgType_00_6ba4111b8d93caae0f8aeb88d1a4da91_af445174067a3368563cf4f9c202df9fa}{KernelStorage}};}
\DoxyCodeLine{00292\ }
\DoxyCodeLine{00293\ \ \ \textcolor{keyword}{enum}\ \{}
\DoxyCodeLine{00294\ \ \ \ \ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_ab7b4f74f4aa0536b0cf94e72acd3d7bfaf11db1f709324172bf7b0697066c3e32}{IsAligned}}\ =\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator}{TensorEvaluator<InputArgType,\ Eigen::SyclDevice>::IsAligned}}\ \&}
\DoxyCodeLine{00295\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structEigen_1_1TensorEvaluator}{TensorEvaluator<KernelArgType,\ Eigen::SyclDevice>::IsAligned}},}
\DoxyCodeLine{00296\ \ \ \ \ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_ab7b4f74f4aa0536b0cf94e72acd3d7bfa82e9bfc6394867187050ca7e4619cdf1}{PacketAccess}}\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00297\ \ \ \ \ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_ab7b4f74f4aa0536b0cf94e72acd3d7bfa11319c5d2ee534b9aff85a27b4423fe9}{BlockAccess}}\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00298\ \ \ \ \ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_ab7b4f74f4aa0536b0cf94e72acd3d7bfa3fe1a7f25f4c1da95f4f2c08ecb10450}{PreferBlockAccess}}\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00299\ \ \ \ \ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_ab7b4f74f4aa0536b0cf94e72acd3d7bfaaea01fe7598d6c1941853b693ec9f162}{Layout}}\ =\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator}{TensorEvaluator<InputArgType,\ Eigen::SyclDevice>::Layout}},}
\DoxyCodeLine{00300\ \ \ \ \ CoordAccess\ =\ \textcolor{keyword}{false},\ \ \textcolor{comment}{//\ to\ be\ implemented}}
\DoxyCodeLine{00301\ \ \ \ \ RawAccess\ =\ \textcolor{keyword}{false}}
\DoxyCodeLine{00302\ \ \ \};}
\DoxyCodeLine{00303\ }
\DoxyCodeLine{00304\ \ \ \textcolor{comment}{//===-\/\ Tensor\ block\ evaluation\ strategy\ (see\ TensorBlock.h)\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/===//}}
\DoxyCodeLine{00305\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorBlockNotImplemented}{internal::TensorBlockNotImplemented}}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_3_01const_01TensorConvolutionOp_3_01Indices_00_01InputArgType_00_6ba4111b8d93caae0f8aeb88d1a4da91_ab24f2710ab46c466f159861020bea0a2}{TensorBlock}};}
\DoxyCodeLine{00306\ \ \ \textcolor{comment}{//===-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/===//}}
\DoxyCodeLine{00307\ }
\DoxyCodeLine{00308\ \ \ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_3_01const_01TensorConvolutionOp_3_01Indices_00_01InputArgType_00_6ba4111b8d93caae0f8aeb88d1a4da91_a9e0c6f2332ba7dbc36dd540011f7804c}{TensorEvaluator}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1TensorConvolutionOp}{XprType}}\ \&op,\ \textcolor{keyword}{const}\ Eigen::SyclDevice\ \&device)}
\DoxyCodeLine{00309\ \ \ \ \ \ \ :\ m\_inputImpl(op.inputExpression(),\ device),}
\DoxyCodeLine{00310\ \ \ \ \ \ \ \ \ m\_kernelArg(op.kernelExpression()),}
\DoxyCodeLine{00311\ \ \ \ \ \ \ \ \ m\_kernelImpl(op.kernelExpression(),\ device),}
\DoxyCodeLine{00312\ \ \ \ \ \ \ \ \ m\_indices(op.indices()),}
\DoxyCodeLine{00313\ \ \ \ \ \ \ \ \ m\_buf(NULL),}
\DoxyCodeLine{00314\ \ \ \ \ \ \ \ \ m\_kernel(NULL),}
\DoxyCodeLine{00315\ \ \ \ \ \ \ \ \ m\_local\_kernel(false),}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_a28c329f710d33ba7243b5d194bdcdfca}{m\_device}}(device)\ \{}
\DoxyCodeLine{00317\ \ \ \ \ \mbox{\hyperlink{StaticAssert_8h_ac95cf960f4a8395b28af90edfda755f0}{EIGEN\_STATIC\_ASSERT}}((\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(\mbox{\hyperlink{structEigen_1_1TensorEvaluator}{TensorEvaluator<InputArgType,\ Eigen::SyclDevice>::Layout}})\ ==}
\DoxyCodeLine{00318\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(\mbox{\hyperlink{structEigen_1_1TensorEvaluator}{TensorEvaluator<KernelArgType,\ Eigen::SyclDevice>::Layout}})),}
\DoxyCodeLine{00319\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ YOU\_MADE\_A\_PROGRAMMING\_MISTAKE);}
\DoxyCodeLine{00320\ }
\DoxyCodeLine{00321\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_aa1d848f55dbb96ee9c789c995624a2cb}{TensorEvaluator<InputArgType,\ Eigen::SyclDevice>::Dimensions}}\ \&input\_dims\ =\ m\_inputImpl.dimensions();}
\DoxyCodeLine{00322\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_aa1d848f55dbb96ee9c789c995624a2cb}{TensorEvaluator<KernelArgType,\ Eigen::SyclDevice>::Dimensions}}\ \&kernel\_dims\ =}
\DoxyCodeLine{00323\ \ \ \ \ \ \ \ \ m\_kernelImpl.dimensions();}
\DoxyCodeLine{00324\ }
\DoxyCodeLine{00325\ \ \ \ \ m\_dimensions\ =\ m\_inputImpl.dimensions();}
\DoxyCodeLine{00326\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ =\ 0;\ \mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}\ <\ NumKernelDims;\ ++\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}})\ \{}
\DoxyCodeLine{00327\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_3_01const_01TensorConvolutionOp_3_01Indices_00_01InputArgType_00_6ba4111b8d93caae0f8aeb88d1a4da91_a1b227e977328e14fcfd0d2a7c589cb35}{Index}}\ index\ =\ op.\mbox{\hyperlink{classEigen_1_1TensorConvolutionOp_afb0c9994880e60c813a1723008c0b15f}{indices}}()[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}];}
\DoxyCodeLine{00328\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_3_01const_01TensorConvolutionOp_3_01Indices_00_01InputArgType_00_6ba4111b8d93caae0f8aeb88d1a4da91_a1b227e977328e14fcfd0d2a7c589cb35}{Index}}\ input\_dim\ =\ input\_dims[index];}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_3_01const_01TensorConvolutionOp_3_01Indices_00_01InputArgType_00_6ba4111b8d93caae0f8aeb88d1a4da91_a1b227e977328e14fcfd0d2a7c589cb35}{Index}}\ kernel\_dim\ =\ kernel\_dims[\mbox{\hyperlink{abseil-cpp_2absl_2container_2btree__benchmark_8cc_a717c50cfde3924051c279a89096afd3d}{i}}];}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_3_01const_01TensorConvolutionOp_3_01Indices_00_01InputArgType_00_6ba4111b8d93caae0f8aeb88d1a4da91_a1b227e977328e14fcfd0d2a7c589cb35}{Index}}\ result\_dim\ =\ input\_dim\ -\/\ kernel\_dim\ +\ 1;}
\DoxyCodeLine{00331\ \ \ \ \ \ \ m\_dimensions[index]\ =\ result\_dim;}
\DoxyCodeLine{00332\ \ \ \ \ \}}
\DoxyCodeLine{00333\ \ \ \}}
\DoxyCodeLine{00334\ }
\DoxyCodeLine{00335\ \ \ \mbox{\hyperlink{Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1DSizes}{Dimensions}}\ \&\mbox{\hyperlink{structEigen_1_1TensorEvaluator_3_01const_01TensorConvolutionOp_3_01Indices_00_01InputArgType_00_6ba4111b8d93caae0f8aeb88d1a4da91_a5db956c2ca9d5070ea4e0ce77f9dd9fa}{dimensions}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ m\_dimensions;\ \}}
\DoxyCodeLine{00336\ }
\DoxyCodeLine{00337\ \ \ \mbox{\hyperlink{Macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_3_01const_01TensorConvolutionOp_3_01Indices_00_01InputArgType_00_6ba4111b8d93caae0f8aeb88d1a4da91_a0234ac6cbd01216227a5c8083763de90}{evalSubExprsIfNeeded}}(\mbox{\hyperlink{structEigen_1_1TensorEvaluator_3_01const_01TensorConvolutionOp_3_01Indices_00_01InputArgType_00_6ba4111b8d93caae0f8aeb88d1a4da91_a19ebf21284a68dbd5f915fe6367c238f}{EvaluatorPointerType}}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_a61c77b3f2d2a7b97a9bcf04f25e5018f}{data}})\ \{}
\DoxyCodeLine{00338\ \ \ \ \ preloadKernel();}
\DoxyCodeLine{00339\ \ \ \ \ m\_inputImpl.evalSubExprsIfNeeded(NULL);}
\DoxyCodeLine{00340\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structEigen_1_1TensorEvaluator_a61c77b3f2d2a7b97a9bcf04f25e5018f}{data}})\ \{}
\DoxyCodeLine{00341\ \ \ \ \ \ \ executeEval(\mbox{\hyperlink{structEigen_1_1TensorEvaluator_a61c77b3f2d2a7b97a9bcf04f25e5018f}{data}});}
\DoxyCodeLine{00342\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00343\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00344\ \ \ \ \ \ \ m\_buf\ =\ (\mbox{\hyperlink{structEigen_1_1TensorEvaluator_a8939492a2914c3876935369a6ba88ec2}{EvaluatorPointerType}})\mbox{\hyperlink{structEigen_1_1TensorEvaluator_a28c329f710d33ba7243b5d194bdcdfca}{m\_device}}.get(}
\DoxyCodeLine{00345\ \ \ \ \ \ \ \ \ \ \ (\mbox{\hyperlink{structEigen_1_1TensorEvaluator_3_01const_01TensorConvolutionOp_3_01Indices_00_01InputArgType_00_6ba4111b8d93caae0f8aeb88d1a4da91_a7112c2af4b1de9c51f2c188ecc0c6ed6}{Scalar}}\ *)\mbox{\hyperlink{structEigen_1_1TensorEvaluator_a28c329f710d33ba7243b5d194bdcdfca}{m\_device}}.allocate\_temp(\mbox{\hyperlink{structEigen_1_1TensorEvaluator_a4b49b2c40bcb2220fb240083cd1833c6}{dimensions}}().TotalSize()\ *\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structEigen_1_1TensorEvaluator_3_01const_01TensorConvolutionOp_3_01Indices_00_01InputArgType_00_6ba4111b8d93caae0f8aeb88d1a4da91_a7112c2af4b1de9c51f2c188ecc0c6ed6}{Scalar}})));}
\DoxyCodeLine{00346\ \ \ \ \ \ \ executeEval(m\_buf);}
\DoxyCodeLine{00347\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00348\ \ \ \ \ \}}
\DoxyCodeLine{00349\ \ \ \}}
\DoxyCodeLine{00350\ }
\DoxyCodeLine{00351\ \ \ \mbox{\hyperlink{Macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_3_01const_01TensorConvolutionOp_3_01Indices_00_01InputArgType_00_6ba4111b8d93caae0f8aeb88d1a4da91_aa5b93e56c7e433af1aefa1a335f156bc}{cleanup}}()\ \{}
\DoxyCodeLine{00352\ \ \ \ \ m\_inputImpl.cleanup();}
\DoxyCodeLine{00353\ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_buf)\ \{}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_a28c329f710d33ba7243b5d194bdcdfca}{m\_device}}.deallocate\_temp(m\_buf);}
\DoxyCodeLine{00355\ \ \ \ \ \ \ m\_buf\ =\ NULL;}
\DoxyCodeLine{00356\ \ \ \ \ \}}
\DoxyCodeLine{00357\ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_local\_kernel)\ \{}
\DoxyCodeLine{00358\ \ \ \ \ \ \ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_a28c329f710d33ba7243b5d194bdcdfca}{m\_device}}.deallocate\_temp(m\_kernel);}
\DoxyCodeLine{00359\ \ \ \ \ \ \ m\_local\_kernel\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00360\ \ \ \ \ \}}
\DoxyCodeLine{00361\ \ \ \ \ m\_kernel\ =\ NULL;}
\DoxyCodeLine{00362\ \ \ \}}
\DoxyCodeLine{00364\ \ \ \mbox{\hyperlink{Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}\ \mbox{\hyperlink{Macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_3_01const_01TensorConvolutionOp_3_01Indices_00_01InputArgType_00_6ba4111b8d93caae0f8aeb88d1a4da91_a5f4c2aba2dc7f8b115be67c17bee4f82}{Device}}\ \&\mbox{\hyperlink{structEigen_1_1TensorEvaluator_3_01const_01TensorConvolutionOp_3_01Indices_00_01InputArgType_00_6ba4111b8d93caae0f8aeb88d1a4da91_a775bde052b2a99e9100ff4d3c380ad84}{device}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_a28c329f710d33ba7243b5d194bdcdfca}{m\_device}};\ \}}
\DoxyCodeLine{00366\ \ \ \mbox{\hyperlink{Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}\ \mbox{\hyperlink{Macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_3_01const_01TensorConvolutionOp_3_01Indices_00_01InputArgType_00_6ba4111b8d93caae0f8aeb88d1a4da91_a19ebf21284a68dbd5f915fe6367c238f}{EvaluatorPointerType}}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_3_01const_01TensorConvolutionOp_3_01Indices_00_01InputArgType_00_6ba4111b8d93caae0f8aeb88d1a4da91_a66ffa8ae9906b6dc639a9b1da4d2a070}{data}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ m\_buf;\ \}}
\DoxyCodeLine{00367\ }
\DoxyCodeLine{00368\ \ \ \mbox{\hyperlink{Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}\ \mbox{\hyperlink{Macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_3_01const_01TensorConvolutionOp_3_01Indices_00_01InputArgType_00_6ba4111b8d93caae0f8aeb88d1a4da91_afb07f51ef78ea7852d428368c406e528}{preloadKernel}}()\ \{}
\DoxyCodeLine{00369\ \ \ \ \ \textcolor{comment}{//\ Don't\ make\ a\ local\ copy\ of\ the\ kernel\ unless\ we\ have\ to\ (i.e.\ it's\ an}}
\DoxyCodeLine{00370\ \ \ \ \ \textcolor{comment}{//\ expression\ that\ needs\ to\ be\ evaluated)}}
\DoxyCodeLine{00371\ \ \ \ \ \textcolor{keyword}{typename}\ \mbox{\hyperlink{structEigen_1_1MakePointer_ad5ad877605f41bf69c9ffdf13567c693}{KernelStorage::Type}}\ in\_place\ =\ m\_kernelImpl.data();}
\DoxyCodeLine{00372\ \ \ \ \ \textcolor{keywordflow}{if}\ (in\_place)\ \{}
\DoxyCodeLine{00373\ \ \ \ \ \ \ m\_kernel\ =\ in\_place;}
\DoxyCodeLine{00374\ \ \ \ \ \ \ m\_local\_kernel\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00375\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00376\ \ \ \ \ \ \ ptrdiff\_t\ kernel\_sz\ =\ m\_kernelImpl.dimensions().TotalSize()\ *\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structEigen_1_1TensorEvaluator_aeb27d9f39037993ed07dd4338312b172}{Scalar}});}
\DoxyCodeLine{00377\ \ \ \ \ \ \ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_3_01const_01TensorConvolutionOp_3_01Indices_00_01InputArgType_00_6ba4111b8d93caae0f8aeb88d1a4da91_a19ebf21284a68dbd5f915fe6367c238f}{EvaluatorPointerType}}\ local\ =\ (\mbox{\hyperlink{structEigen_1_1TensorEvaluator_a8939492a2914c3876935369a6ba88ec2}{EvaluatorPointerType}})\mbox{\hyperlink{structEigen_1_1TensorEvaluator_a28c329f710d33ba7243b5d194bdcdfca}{m\_device}}.get((\mbox{\hyperlink{structEigen_1_1TensorEvaluator_3_01const_01TensorConvolutionOp_3_01Indices_00_01InputArgType_00_6ba4111b8d93caae0f8aeb88d1a4da91_a7112c2af4b1de9c51f2c188ecc0c6ed6}{Scalar}}\ *)\mbox{\hyperlink{structEigen_1_1TensorEvaluator_a28c329f710d33ba7243b5d194bdcdfca}{m\_device}}.allocate\_temp(kernel\_sz));}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{classEigen_1_1TensorEvalToOp}{TensorEvalToOp<const\ KernelArgType>}}\ EvalTo;}
\DoxyCodeLine{00379\ \ \ \ \ \ \ EvalTo\ evalToTmp(\mbox{\hyperlink{structEigen_1_1TensorEvaluator_a28c329f710d33ba7243b5d194bdcdfca}{m\_device}}.get(local),\ m\_kernelArg);}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_ab7b4f74f4aa0536b0cf94e72acd3d7bfa82e9bfc6394867187050ca7e4619cdf1}{PacketAccess}}\ =\ \mbox{\hyperlink{structEigen_1_1internal_1_1IsVectorizable}{internal::IsVectorizable<Eigen::SyclDevice,\ KernelArgType>::value}};}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1TensorExecutor_a50325b41f927e2c29141c7ac671efdec}{internal::TensorExecutor<const\ EvalTo,\ Eigen::SyclDevice,\ PacketAccess>::run}}(evalToTmp,\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_a28c329f710d33ba7243b5d194bdcdfca}{m\_device}});}
\DoxyCodeLine{00382\ \ \ \ \ \ \ m\_kernel\ =\ local;}
\DoxyCodeLine{00383\ \ \ \ \ \ \ m\_local\_kernel\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00384\ \ \ \ \ \}}
\DoxyCodeLine{00385\ \ \ \}}
\DoxyCodeLine{00386\ }
\DoxyCodeLine{00387\ \ \ \mbox{\hyperlink{Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}\ \mbox{\hyperlink{Macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_3_01const_01TensorConvolutionOp_3_01Indices_00_01InputArgType_00_6ba4111b8d93caae0f8aeb88d1a4da91_a93ff0b42495e2113197f984832ad5aa7}{executeEval}}(\mbox{\hyperlink{structEigen_1_1TensorEvaluator_3_01const_01TensorConvolutionOp_3_01Indices_00_01InputArgType_00_6ba4111b8d93caae0f8aeb88d1a4da91_a19ebf21284a68dbd5f915fe6367c238f}{EvaluatorPointerType}}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_a61c77b3f2d2a7b97a9bcf04f25e5018f}{data}})\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00388\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator}{TensorEvaluator<InputArgType,\ Eigen::SyclDevice>}}\ InputEvaluator;}
\DoxyCodeLine{00389\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ InputEvaluator::Dimensions\ InputDims;}
\DoxyCodeLine{00390\ \ \ \ \ \textcolor{keywordflow}{switch}\ (NumKernelDims)\ \{}
\DoxyCodeLine{00391\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ \{}
\DoxyCodeLine{00392\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ numX\ =\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_a4b49b2c40bcb2220fb240083cd1833c6}{dimensions}}()[m\_indices[0]];}
\DoxyCodeLine{00393\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ numP\ =\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_a4b49b2c40bcb2220fb240083cd1833c6}{dimensions}}().TotalSize()\ /\ numX;}
\DoxyCodeLine{00394\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ input\_dim\ =\ std::array<size\_t,\ 2>\{numX,\ numP\};}
\DoxyCodeLine{00395\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ global\_range\ =\ cl::sycl::range<2>\{\};}
\DoxyCodeLine{00396\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ local\_range\ =\ cl::sycl::range<2>\{\};}
\DoxyCodeLine{00397\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ kernel\_size\ =\ m\_kernelImpl.dimensions().TotalSize();}
\DoxyCodeLine{00398\ }
\DoxyCodeLine{00399\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_a28c329f710d33ba7243b5d194bdcdfca}{m\_device}}.parallel\_for\_setup(input\_dim,\ global\_range,\ local\_range);}
\DoxyCodeLine{00400\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ local\_memory\_size\ =\ (local\_range[0]\ +\ kernel\_size\ -\/\ 1)\ *\ (local\_range[1]);}
\DoxyCodeLine{00401\ \ \ \ \ \ \ \ \ gpu\_assert(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\textcolor{keyword}{>}(local\_memory\_size)\ <=\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_a28c329f710d33ba7243b5d194bdcdfca}{m\_device}}.sharedMemPerBlock());}
\DoxyCodeLine{00402\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1array}{array<Index,\ 1>}}\ indices\{\{m\_indices[0]\}\};}
\DoxyCodeLine{00403\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1array}{array<Index,\ 1>}}\ kernel\_dims\{\{m\_kernelImpl.dimensions()[0]\}\};}
\DoxyCodeLine{00404\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1IndexMapper}{internal::IndexMapper<Index,\ InputDims,\ 1,\ Layout>}}\ indexMapper(m\_inputImpl.dimensions(),\ kernel\_dims,\ indices);}
\DoxyCodeLine{00405\ }
\DoxyCodeLine{00406\ \ \ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel}{EigenConvolutionKernel}}<InputEvaluator,\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_ab9f94deb25a2d2b52dd0e827ef49ce3c}{CoeffReturnType}},\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_aeb27d9f39037993ed07dd4338312b172}{Scalar}},\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_ab03361de0cb621f807b20cdeb621b807}{Index}},\ InputDims,}
\DoxyCodeLine{00407\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typename}\ \mbox{\hyperlink{structEigen_1_1MakePointer_ad5ad877605f41bf69c9ffdf13567c693}{KernelStorage::Type}},\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_a8939492a2914c3876935369a6ba88ec2}{EvaluatorPointerType}},\ \mbox{\hyperlink{namespaceEigen_aeae138f89644546cf3e6952820a4b85bad7bca9bc25850ed34f31ed3c9072309b}{convolution\_type::CONV1D}}>}
\DoxyCodeLine{00408\ \ \ \ \ \ \ \ \ \ \ \ \ ConvKernel;}
\DoxyCodeLine{00409\ }
\DoxyCodeLine{00410\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_a28c329f710d33ba7243b5d194bdcdfca}{m\_device}}.template\ binary\_kernel\_launcher<CoeffReturnType,\ ConvKernel>(}
\DoxyCodeLine{00411\ \ \ \ \ \ \ \ \ \ \ \ \ m\_inputImpl,\ m\_kernel,\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_a61c77b3f2d2a7b97a9bcf04f25e5018f}{data}},\ cl::sycl::nd\_range<2>(global\_range,\ local\_range),\ local\_memory\_size,}
\DoxyCodeLine{00412\ \ \ \ \ \ \ \ \ \ \ \ \ indexMapper,\ kernel\_size,\ cl::sycl::range<2>(input\_dim[0],\ input\_dim[1]));}
\DoxyCodeLine{00413\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00414\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00415\ }
\DoxyCodeLine{00416\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 2:\ \{}
\DoxyCodeLine{00417\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ kernel\_index\ =\ std::array<size\_t,\ 2>\{\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(\mbox{\hyperlink{structEigen_1_1TensorEvaluator_ab7b4f74f4aa0536b0cf94e72acd3d7bfaaea01fe7598d6c1941853b693ec9f162}{Layout}})\ ==\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(\mbox{\hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13a0103672ae41005ab03b4176c765afd62}{ColMajor}})\ ?\ 0\ :\ 1,}
\DoxyCodeLine{00418\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(\mbox{\hyperlink{structEigen_1_1TensorEvaluator_ab7b4f74f4aa0536b0cf94e72acd3d7bfaaea01fe7598d6c1941853b693ec9f162}{Layout}})\ ==\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(\mbox{\hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13a0103672ae41005ab03b4176c765afd62}{ColMajor}})\ ?\ 1\ :\ 0\};}
\DoxyCodeLine{00419\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ kernel\_size\ =\ cl::sycl::range<2>\{(size\_t)m\_kernelImpl.dimensions()[kernel\_index[0]],}
\DoxyCodeLine{00420\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (size\_t)m\_kernelImpl.dimensions()[kernel\_index[1]]\};}
\DoxyCodeLine{00421\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ numX\ =\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_a4b49b2c40bcb2220fb240083cd1833c6}{dimensions}}()[m\_indices[kernel\_index[0]]];}
\DoxyCodeLine{00422\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ numY\ =\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_a4b49b2c40bcb2220fb240083cd1833c6}{dimensions}}()[m\_indices[kernel\_index[1]]];}
\DoxyCodeLine{00423\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ numP\ =\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_a4b49b2c40bcb2220fb240083cd1833c6}{dimensions}}().TotalSize()\ /\ (numX\ *\ numY);}
\DoxyCodeLine{00424\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ input\_dim\ =\ std::array<size\_t,\ 3>\{numX,\ numY,\ numP\};}
\DoxyCodeLine{00425\ }
\DoxyCodeLine{00426\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ global\_range\ =\ cl::sycl::range<3>\{\};}
\DoxyCodeLine{00427\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ local\_range\ =\ cl::sycl::range<3>\{\};}
\DoxyCodeLine{00428\ }
\DoxyCodeLine{00429\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_a28c329f710d33ba7243b5d194bdcdfca}{m\_device}}.parallel\_for\_setup(input\_dim,\ global\_range,\ local\_range);}
\DoxyCodeLine{00430\ }
\DoxyCodeLine{00431\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ local\_memory\_size\ =}
\DoxyCodeLine{00432\ \ \ \ \ \ \ \ \ \ \ \ \ (local\_range[0]\ +\ kernel\_size[0]\ -\/\ 1)\ *\ (local\_range[1]\ +\ kernel\_size[1]\ -\/\ 1)\ *\ local\_range[2];}
\DoxyCodeLine{00433\ \ \ \ \ \ \ \ \ gpu\_assert(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\textcolor{keyword}{>}(local\_memory\_size)\ <=\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_a28c329f710d33ba7243b5d194bdcdfca}{m\_device}}.sharedMemPerBlock());}
\DoxyCodeLine{00434\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1array}{array<Index,\ 2>}}\ indices\{\{m\_indices[kernel\_index[0]],\ m\_indices[kernel\_index[1]]\}\};}
\DoxyCodeLine{00435\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1array}{array<Index,\ 2>}}\ kernel\_dims\{}
\DoxyCodeLine{00436\ \ \ \ \ \ \ \ \ \ \ \ \ \{m\_kernelImpl.dimensions()[kernel\_index[0]],\ m\_kernelImpl.dimensions()[kernel\_index[1]]\}\};}
\DoxyCodeLine{00437\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1IndexMapper}{internal::IndexMapper<Index,\ InputDims,\ 2,\ Layout>}}\ indexMapper(m\_inputImpl.dimensions(),\ kernel\_dims,\ indices);}
\DoxyCodeLine{00438\ \ \ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel}{EigenConvolutionKernel}}<InputEvaluator,\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_ab9f94deb25a2d2b52dd0e827ef49ce3c}{CoeffReturnType}},\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_aeb27d9f39037993ed07dd4338312b172}{Scalar}},\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_ab03361de0cb621f807b20cdeb621b807}{Index}},\ InputDims,}
\DoxyCodeLine{00439\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typename}\ \mbox{\hyperlink{structEigen_1_1MakePointer_ad5ad877605f41bf69c9ffdf13567c693}{KernelStorage::Type}},\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_a8939492a2914c3876935369a6ba88ec2}{EvaluatorPointerType}},\ \mbox{\hyperlink{namespaceEigen_aeae138f89644546cf3e6952820a4b85ba2cafa280a722fa37eee8591ef10c012e}{convolution\_type::CONV2D}}>}
\DoxyCodeLine{00440\ \ \ \ \ \ \ \ \ \ \ \ \ ConvKernel;}
\DoxyCodeLine{00441\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_a28c329f710d33ba7243b5d194bdcdfca}{m\_device}}.template\ binary\_kernel\_launcher<CoeffReturnType,\ ConvKernel>(}
\DoxyCodeLine{00442\ \ \ \ \ \ \ \ \ \ \ \ \ m\_inputImpl,\ m\_kernel,\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_a61c77b3f2d2a7b97a9bcf04f25e5018f}{data}},\ cl::sycl::nd\_range<3>(global\_range,\ local\_range),\ local\_memory\_size,}
\DoxyCodeLine{00443\ \ \ \ \ \ \ \ \ \ \ \ \ indexMapper,\ kernel\_size,\ cl::sycl::range<3>\{input\_dim[0],\ input\_dim[1],\ input\_dim[2]\});}
\DoxyCodeLine{00444\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00445\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00446\ }
\DoxyCodeLine{00447\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 3:\ \{}
\DoxyCodeLine{00448\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ kernel\_index\ =\ std::array<size\_t,\ 3>\{\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(\mbox{\hyperlink{structEigen_1_1TensorEvaluator_ab7b4f74f4aa0536b0cf94e72acd3d7bfaaea01fe7598d6c1941853b693ec9f162}{Layout}})\ ==\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(\mbox{\hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13a0103672ae41005ab03b4176c765afd62}{ColMajor}})\ ?\ 0\ :\ 2,}
\DoxyCodeLine{00449\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(\mbox{\hyperlink{structEigen_1_1TensorEvaluator_ab7b4f74f4aa0536b0cf94e72acd3d7bfaaea01fe7598d6c1941853b693ec9f162}{Layout}})\ ==\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(\mbox{\hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13a0103672ae41005ab03b4176c765afd62}{ColMajor}})\ ?\ 1\ :\ 1,}
\DoxyCodeLine{00450\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(\mbox{\hyperlink{structEigen_1_1TensorEvaluator_ab7b4f74f4aa0536b0cf94e72acd3d7bfaaea01fe7598d6c1941853b693ec9f162}{Layout}})\ ==\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(\mbox{\hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13a0103672ae41005ab03b4176c765afd62}{ColMajor}})\ ?\ 2\ :\ 0\};}
\DoxyCodeLine{00451\ }
\DoxyCodeLine{00452\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ kernel\_size\ =\ cl::sycl::range<3>\{(size\_t)m\_kernelImpl.dimensions()[kernel\_index[0]],}
\DoxyCodeLine{00453\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (size\_t)m\_kernelImpl.dimensions()[kernel\_index[1]],}
\DoxyCodeLine{00454\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (size\_t)m\_kernelImpl.dimensions()[kernel\_index[2]]\};}
\DoxyCodeLine{00455\ }
\DoxyCodeLine{00456\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ numX\ =\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_a4b49b2c40bcb2220fb240083cd1833c6}{dimensions}}()[m\_indices[kernel\_index[0]]];}
\DoxyCodeLine{00457\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ numY\ =\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_a4b49b2c40bcb2220fb240083cd1833c6}{dimensions}}()[m\_indices[kernel\_index[1]]];}
\DoxyCodeLine{00458\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ numZ\ =\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_a4b49b2c40bcb2220fb240083cd1833c6}{dimensions}}()[m\_indices[kernel\_index[2]]];}
\DoxyCodeLine{00459\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ input\_dim\ =\ std::array<size\_t,\ 3>\{numX,\ numY,\ numZ\};}
\DoxyCodeLine{00460\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ numP\ =\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_a4b49b2c40bcb2220fb240083cd1833c6}{dimensions}}().TotalSize()\ /\ (numX\ *\ numY\ *\ numZ);}
\DoxyCodeLine{00461\ }
\DoxyCodeLine{00462\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1array}{array<Index,\ 3>}}\ indices\{}
\DoxyCodeLine{00463\ \ \ \ \ \ \ \ \ \ \ \ \ \{m\_indices[kernel\_index[0]],\ m\_indices[kernel\_index[1]],\ m\_indices[kernel\_index[2]]\}\};}
\DoxyCodeLine{00464\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1array}{array<Index,\ 3>}}\ kernel\_dims\{\{m\_kernelImpl.dimensions()[kernel\_index[0]],}
\DoxyCodeLine{00465\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_kernelImpl.dimensions()[kernel\_index[1]],}
\DoxyCodeLine{00466\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_kernelImpl.dimensions()[kernel\_index[2]]\}\};}
\DoxyCodeLine{00467\ }
\DoxyCodeLine{00468\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classEigen_1_1internal_1_1IndexMapper}{internal::IndexMapper<Index,\ InputDims,\ 3,\ Layout>}}\ indexMapper(m\_inputImpl.dimensions(),\ kernel\_dims,\ indices);}
\DoxyCodeLine{00469\ }
\DoxyCodeLine{00470\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ global\_range\ =\ cl::sycl::range<3>\{\};}
\DoxyCodeLine{00471\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ local\_range\ =\ cl::sycl::range<3>\{\};}
\DoxyCodeLine{00472\ }
\DoxyCodeLine{00473\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_a28c329f710d33ba7243b5d194bdcdfca}{m\_device}}.parallel\_for\_setup(input\_dim,\ global\_range,\ local\_range);}
\DoxyCodeLine{00474\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ local\_memory\_range\ =\ (local\_range\ +\ kernel\_size\ -\/\ 1);}
\DoxyCodeLine{00475\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ local\_memory\_size\ =\ local\_memory\_range[0]\ *\ local\_memory\_range[1]\ *\ local\_memory\_range[2];}
\DoxyCodeLine{00476\ }
\DoxyCodeLine{00477\ \ \ \ \ \ \ \ \ gpu\_assert(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\textcolor{keyword}{>}(local\_memory\_size)\ <=\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_a28c329f710d33ba7243b5d194bdcdfca}{m\_device}}.sharedMemPerBlock());}
\DoxyCodeLine{00478\ \ \ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{structEigen_1_1EigenConvolutionKernel}{EigenConvolutionKernel}}<InputEvaluator,\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_ab9f94deb25a2d2b52dd0e827ef49ce3c}{CoeffReturnType}},\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_aeb27d9f39037993ed07dd4338312b172}{Scalar}},\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_ab03361de0cb621f807b20cdeb621b807}{Index}},\ InputDims,}
\DoxyCodeLine{00479\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typename}\ \mbox{\hyperlink{structEigen_1_1MakePointer_ad5ad877605f41bf69c9ffdf13567c693}{KernelStorage::Type}},\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_a8939492a2914c3876935369a6ba88ec2}{EvaluatorPointerType}},\ \mbox{\hyperlink{namespaceEigen_aeae138f89644546cf3e6952820a4b85baa27b4050cc42e50d0f765582a03cc1e6}{convolution\_type::CONV3D}}>}
\DoxyCodeLine{00480\ \ \ \ \ \ \ \ \ \ \ \ \ ConvKernel;}
\DoxyCodeLine{00481\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_a28c329f710d33ba7243b5d194bdcdfca}{m\_device}}.template\ binary\_kernel\_launcher<CoeffReturnType,\ ConvKernel>(}
\DoxyCodeLine{00482\ \ \ \ \ \ \ \ \ \ \ \ \ m\_inputImpl,\ m\_kernel,\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_a61c77b3f2d2a7b97a9bcf04f25e5018f}{data}},\ cl::sycl::nd\_range<3>(global\_range,\ local\_range),\ local\_memory\_size,}
\DoxyCodeLine{00483\ \ \ \ \ \ \ \ \ \ \ \ \ indexMapper,\ kernel\_size,\ cl::sycl::range<3>(input\_dim[0],\ input\_dim[1],\ input\_dim[2]),\ numP);}
\DoxyCodeLine{00484\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00485\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00486\ }
\DoxyCodeLine{00487\ \ \ \ \ \ \ \textcolor{keywordflow}{default}:\ \{}
\DoxyCodeLine{00488\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{StaticAssert_8h_ac95cf960f4a8395b28af90edfda755f0}{EIGEN\_STATIC\_ASSERT}}((NumKernelDims\ >=\ 1\ \&\&\ NumKernelDims\ <=\ 3),}
\DoxyCodeLine{00489\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ THIS\_METHOD\_IS\_ONLY\_FOR\_OBJECTS\_OF\_A\_SPECIFIC\_SIZE);}
\DoxyCodeLine{00490\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00491\ \ \ \ \ \}}
\DoxyCodeLine{00492\ \ \ \}}
\DoxyCodeLine{00493\ }
\DoxyCodeLine{00494\ \ \ \mbox{\hyperlink{Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}\ \mbox{\hyperlink{Macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_3_01const_01TensorConvolutionOp_3_01Indices_00_01InputArgType_00_6ba4111b8d93caae0f8aeb88d1a4da91_a5296cdbfdee5ab50da2e626dea9d7102}{CoeffReturnType}}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_3_01const_01TensorConvolutionOp_3_01Indices_00_01InputArgType_00_6ba4111b8d93caae0f8aeb88d1a4da91_affa3cf3255c5dcbc565b643e179a6ec4}{coeff}}(\mbox{\hyperlink{structEigen_1_1TensorEvaluator_3_01const_01TensorConvolutionOp_3_01Indices_00_01InputArgType_00_6ba4111b8d93caae0f8aeb88d1a4da91_a1b227e977328e14fcfd0d2a7c589cb35}{Index}}\ index)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00495\ \ \ \ \ \mbox{\hyperlink{Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(m\_buf\ !=\ NULL);}
\DoxyCodeLine{00496\ \ \ \ \ \mbox{\hyperlink{Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(index\ <\ m\_dimensions.TotalSize());}
\DoxyCodeLine{00497\ \ \ \ \ \textcolor{keywordflow}{return}\ m\_buf[index];}
\DoxyCodeLine{00498\ \ \ \}}
\DoxyCodeLine{00499\ }
\DoxyCodeLine{00500\ \ \ \textcolor{keyword}{template}\ <\textcolor{keywordtype}{int}\ LoadMode>}
\DoxyCodeLine{00501\ \ \ \mbox{\hyperlink{Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}\ \mbox{\hyperlink{Macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_3_01const_01TensorConvolutionOp_3_01Indices_00_01InputArgType_00_6ba4111b8d93caae0f8aeb88d1a4da91_a1015f63858972e83f199398114ef5736}{PacketReturnType}}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_3_01const_01TensorConvolutionOp_3_01Indices_00_01InputArgType_00_6ba4111b8d93caae0f8aeb88d1a4da91_a9dc639251ad93436b76eec6d61a38290}{packet}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_3_01const_01TensorConvolutionOp_3_01Indices_00_01InputArgType_00_6ba4111b8d93caae0f8aeb88d1a4da91_a1b227e977328e14fcfd0d2a7c589cb35}{Index}}\ index)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00502\ \ \ \ \ \mbox{\hyperlink{Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(m\_buf\ !=\ NULL);}
\DoxyCodeLine{00503\ \ \ \ \ \mbox{\hyperlink{Macros_8h_acaa7ba89800cfe18d5fd6eed620aea9c}{eigen\_assert}}(index\ <\ m\_dimensions.TotalSize());}
\DoxyCodeLine{00504\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespaceEigen_1_1internal_a100dabe02b9d7dafb1a39d7d4dbbdd4a}{internal::ploadt<PacketReturnType,\ LoadMode>}}(m\_buf\ +\ index);}
\DoxyCodeLine{00505\ \ \ \}}
\DoxyCodeLine{00506\ }
\DoxyCodeLine{00507\ \ \ \mbox{\hyperlink{Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}\ \mbox{\hyperlink{Macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \mbox{\hyperlink{classEigen_1_1TensorOpCost}{TensorOpCost}}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_3_01const_01TensorConvolutionOp_3_01Indices_00_01InputArgType_00_6ba4111b8d93caae0f8aeb88d1a4da91_a320d90cce3a327e616429db1a3cbf781}{costPerCoeff}}(\textcolor{keywordtype}{bool}\ vectorized)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00508\ \ \ \ \ \textcolor{comment}{//\ TODO(rmlarsen):\ FIXME:\ For\ now,\ this\ is\ just\ a\ copy\ of\ the\ CPU\ cost}}
\DoxyCodeLine{00509\ \ \ \ \ \textcolor{comment}{//\ model.}}
\DoxyCodeLine{00510\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ kernel\_size\ =\ m\_kernelImpl.dimensions().TotalSize();}
\DoxyCodeLine{00511\ \ \ \ \ \textcolor{comment}{//\ We\ ignore\ the\ use\ of\ fused\ multiply-\/add.}}
\DoxyCodeLine{00512\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ convolve\_compute\_cost\ =\ \mbox{\hyperlink{classEigen_1_1TensorOpCost_a7c74e94f5c5992ddd756ba868df98441}{TensorOpCost::AddCost<Scalar>}}()\ +\ \mbox{\hyperlink{classEigen_1_1TensorOpCost_a6beccb61485f429ac575d0a22abf9014}{TensorOpCost::MulCost<Scalar>}}();}
\DoxyCodeLine{00513\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ firstIndex\_compute\_cost\ =}
\DoxyCodeLine{00514\ \ \ \ \ \ \ \ \ NumDims\ *}
\DoxyCodeLine{00515\ \ \ \ \ \ \ \ \ (2\ *\ \mbox{\hyperlink{classEigen_1_1TensorOpCost_a7c74e94f5c5992ddd756ba868df98441}{TensorOpCost::AddCost<Index>}}()\ +\ 2\ *\ \mbox{\hyperlink{classEigen_1_1TensorOpCost_a6beccb61485f429ac575d0a22abf9014}{TensorOpCost::MulCost<Index>}}()\ +\ \mbox{\hyperlink{classEigen_1_1TensorOpCost_ab5da69fab8e443d48fafa9880aa8691c}{TensorOpCost::DivCost<Index>}}());}
\DoxyCodeLine{00516\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classEigen_1_1TensorOpCost}{TensorOpCost}}(0,\ 0,\ firstIndex\_compute\_cost,\ vectorized,\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_af01d9cb0f9c1d405b9d6a24843936d3f}{PacketSize}})\ +}
\DoxyCodeLine{00517\ \ \ \ \ \ \ \ \ \ \ \ kernel\_size\ *\ (m\_inputImpl.costPerCoeff(vectorized)\ +\ m\_kernelImpl.costPerCoeff(vectorized)\ +}
\DoxyCodeLine{00518\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classEigen_1_1TensorOpCost}{TensorOpCost}}(0,\ 0,\ convolve\_compute\_cost,\ vectorized,\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_af01d9cb0f9c1d405b9d6a24843936d3f}{PacketSize}}));}
\DoxyCodeLine{00519\ \ \ \}}
\DoxyCodeLine{00520\ \ \ \textcolor{comment}{//\ binding\ placeholder\ accessors\ to\ a\ command\ group\ handler\ for\ SYCL}}
\DoxyCodeLine{00521\ \ \ \mbox{\hyperlink{Macros_8h_a9efec3cfd22b9a33bead9c6718d128da}{EIGEN\_DEVICE\_FUNC}}\ \mbox{\hyperlink{Macros_8h_af2b60117c00a6e75812de43bfe7db3b1}{EIGEN\_STRONG\_INLINE}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_3_01const_01TensorConvolutionOp_3_01Indices_00_01InputArgType_00_6ba4111b8d93caae0f8aeb88d1a4da91_a0a89d12a54bb7b1e669c21765b45b68f}{bind}}(cl::sycl::handler\ \&cgh)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00522\ \ \ \ \ m\_kernelImpl.bind(cgh);}
\DoxyCodeLine{00523\ \ \ \ \ m\_inputImpl.bind(cgh);}
\DoxyCodeLine{00524\ \ \ \ \ m\_buf.bind(cgh);}
\DoxyCodeLine{00525\ \ \ \ \ m\_kernel.bind(cgh);}
\DoxyCodeLine{00526\ \ \ \}}
\DoxyCodeLine{00527\ }
\DoxyCodeLine{00528\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00529\ \ \ \textcolor{comment}{//\ No\ assignment\ (copies\ are\ needed\ by\ the\ kernels)}}
\DoxyCodeLine{00530\ \ \ \mbox{\hyperlink{structEigen_1_1TensorEvaluator}{TensorEvaluator}}\ \&operator=(\textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator}{TensorEvaluator}}\ \&);}
\DoxyCodeLine{00531\ \ \ \mbox{\hyperlink{structEigen_1_1TensorEvaluator}{TensorEvaluator<InputArgType,\ Eigen::SyclDevice>}}\ m\_inputImpl;}
\DoxyCodeLine{00532\ \ \ KernelArgType\ m\_kernelArg;}
\DoxyCodeLine{00533\ \ \ \mbox{\hyperlink{structEigen_1_1TensorEvaluator}{TensorEvaluator<KernelArgType,\ Eigen::SyclDevice>}}\ m\_kernelImpl;}
\DoxyCodeLine{00534\ \ \ Indices\ m\_indices;}
\DoxyCodeLine{00535\ \ \ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_aa1d848f55dbb96ee9c789c995624a2cb}{Dimensions}}\ m\_dimensions;}
\DoxyCodeLine{00536\ \ \ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_a8939492a2914c3876935369a6ba88ec2}{EvaluatorPointerType}}\ m\_buf;}
\DoxyCodeLine{00537\ \ \ \textcolor{keyword}{typename}\ KernelStorage::Type\ m\_kernel;}
\DoxyCodeLine{00538\ \ \ \textcolor{keywordtype}{bool}\ m\_local\_kernel;}
\DoxyCodeLine{00539\ \ \ \textcolor{keyword}{const}\ Eigen::SyclDevice\ \mbox{\hyperlink{TensorMacros_8h_ab1d48616b1c0fcce6dc3f01cad41b1d8}{EIGEN\_DEVICE\_REF}}\ \mbox{\hyperlink{structEigen_1_1TensorEvaluator_a28c329f710d33ba7243b5d194bdcdfca}{m\_device}};}
\DoxyCodeLine{00540\ \};\ \ \textcolor{comment}{//\ namespace\ Eigen}}
\DoxyCodeLine{00541\ }
\DoxyCodeLine{00542\ \}\ \ \textcolor{comment}{//\ end\ namespace\ Eigen}}
\DoxyCodeLine{00543\ }
\DoxyCodeLine{00544\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ EIGEN\_CXX11\_TENSOR\_TENSOR\_CONVOLUTION\_H}}

\end{DoxyCode}
