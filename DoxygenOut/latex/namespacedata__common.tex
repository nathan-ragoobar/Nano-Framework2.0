\doxysection{data\+\_\+common Namespace Reference}
\hypertarget{namespacedata__common}{}\label{namespacedata__common}\index{data\_common@{data\_common}}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacedata__common_a69faab450abdd05f085f829b73e8766f}{download\+\_\+file}} (str url, str fname, chunk\+\_\+size=1024)
\item 
\mbox{\hyperlink{namespacedata__common_a8b725bdbe9228caeed1a9d16c41e91db}{write\+\_\+datafile}} (filename, toks)
\item 
\mbox{\hyperlink{namespacedata__common_a296ddfaf21f0f6e74be694c37db6b76a}{write\+\_\+evalfile}} (filename, datas)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\begin{DoxyVerb}Common utilities for the datasets
\end{DoxyVerb}
 

\doxysubsection{Function Documentation}
\Hypertarget{namespacedata__common_a69faab450abdd05f085f829b73e8766f}\index{data\_common@{data\_common}!download\_file@{download\_file}}
\index{download\_file@{download\_file}!data\_common@{data\_common}}
\doxysubsubsection{\texorpdfstring{download\_file()}{download\_file()}}
{\footnotesize\ttfamily \label{namespacedata__common_a69faab450abdd05f085f829b73e8766f} 
data\+\_\+common.\+download\+\_\+file (\begin{DoxyParamCaption}\item[{str}]{url}{, }\item[{str}]{fname}{, }\item[{}]{chunk\+\_\+size}{ = {\ttfamily 1024}}\end{DoxyParamCaption})}

\begin{DoxyVerb}Helper function to download a file from a given url\end{DoxyVerb}
 \Hypertarget{namespacedata__common_a8b725bdbe9228caeed1a9d16c41e91db}\index{data\_common@{data\_common}!write\_datafile@{write\_datafile}}
\index{write\_datafile@{write\_datafile}!data\_common@{data\_common}}
\doxysubsubsection{\texorpdfstring{write\_datafile()}{write\_datafile()}}
{\footnotesize\ttfamily \label{namespacedata__common_a8b725bdbe9228caeed1a9d16c41e91db} 
data\+\_\+common.\+write\+\_\+datafile (\begin{DoxyParamCaption}\item[{}]{filename}{, }\item[{}]{toks}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Saves token data as a .bin file, for reading in C.
- First comes a header with 256 int32s
- The tokens follow, each as a uint16
\end{DoxyVerb}
 \Hypertarget{namespacedata__common_a296ddfaf21f0f6e74be694c37db6b76a}\index{data\_common@{data\_common}!write\_evalfile@{write\_evalfile}}
\index{write\_evalfile@{write\_evalfile}!data\_common@{data\_common}}
\doxysubsubsection{\texorpdfstring{write\_evalfile()}{write\_evalfile()}}
{\footnotesize\ttfamily \label{namespacedata__common_a296ddfaf21f0f6e74be694c37db6b76a} 
data\+\_\+common.\+write\+\_\+evalfile (\begin{DoxyParamCaption}\item[{}]{filename}{, }\item[{}]{datas}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Saves eval data as a .bin file, for reading in C.
Used for multiple-choice style evals, e.g. HellaSwag and MMLU
- First comes a header with 256 int32s
- The examples follow, each example is a stream of uint16_t:
    - <START_EXAMPLE> delimiter of 2**16-1, i.e. 65,535
    - <EXAMPLE_BYTES>, bytes encoding this example, allowing efficient skip to next
    - <EXAMPLE_INDEX>, the index of the example in the dataset
    - <LABEL>, the index of the correct completion
    - <NUM_COMPLETIONS>, indicating the number of completions (usually 4)
    - <NUM><CONTEXT_TOKENS>, where <NUM> is the number of tokens in the context
    - <NUM><COMPLETION_TOKENS>, repeated NUM_COMPLETIONS times
\end{DoxyVerb}
 